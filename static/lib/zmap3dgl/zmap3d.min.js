var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}();!function(Cegore){Cegore.Version=103}(Cegore||(Cegore={})),function(Cegore){var TypeCheck=function(){function TypeCheck(){}return TypeCheck.defaultValue=function(value,defaut){return null!=value?value:defaut},TypeCheck.isDefined=function(value){return null!=value},TypeCheck.isNull=function(value){return null===value},TypeCheck.typeOf=function(value){var s=typeof value;if("object"==s){if(!value)return"null";if(value instanceof Array)return"array";if(value instanceof Object)return s;var className=Object.prototype.toString.call(value);if("[object Window]"==className)return"object";if("[object Array]"==className||"number"==typeof value.length&&void 0!==value.splice&&void 0!==value.propertyIsEnumerable&&!value.propertyIsEnumerable("splice"))return"array";if("[object Function]"==className||void 0!==value.call&&void 0!==value.propertyIsEnumerable&&!value.propertyIsEnumerable("call"))return"function"}else if("function"==s&&void 0===value.call)return"object";return s},TypeCheck.isFunction=function(value){return"function"==typeof value},TypeCheck.isString=function(value){return"string"==typeof value},TypeCheck.isNumber=function(value){return"number"==typeof value},TypeCheck.isObject=function(value){var type=typeof value;return"object"==type&&null!=value||"function"==type},TypeCheck.isBool=function(value){return"boolean"==typeof value},TypeCheck.isArray=function(value){return"array"==TypeCheck.typeOf(value)},TypeCheck.isInstanceOf=function(val,type){return val instanceof type},TypeCheck.freezeObject=function(o){return TypeCheck._freezeObject(o)},TypeCheck._freezeObject=Object.freeze?Object.freeze:function(o){return o},TypeCheck}();Cegore.TypeCheck=TypeCheck}(Cegore||(Cegore={})),function(Cegore){var HashMap=function(){function HashMap(creator){this._data={},this._creator=null,this._creator=creator}return HashMap.prototype.getOrCreate=function(key,def){var item=this._data[key];return Cegore.TypeCheck.isDefined(item)?item.val:Cegore.TypeCheck.isDefined(def)?(item={val:def},(this._data[key]=item).val):Cegore.TypeCheck.isDefined(this._creator)?(item={val:this._creator()},(this._data[key]=item).val):void 0},HashMap.prototype.get=function(key){var item=this._data[key];if(Cegore.TypeCheck.isDefined(item))return item.val},HashMap.prototype.put=function(key,val){this._data[key]={val:val}},HashMap.prototype.key=function(val){for(var key in this._data)if(this._data[key].val===val)return key},HashMap.prototype.keys=function(){var keys=[];for(var key in this._data)keys.push(key);return keys},HashMap.prototype.exist=function(key){return Cegore.TypeCheck.isDefined(this._data[key])},HashMap.prototype.remove=function(key){delete this._data[key]},HashMap.prototype.clear=function(){this._data={}},HashMap.prototype.removeAll=function(){this.clear()},HashMap}();Cegore.HashMap=HashMap}(Cegore||(Cegore={})),function(Cegore){var StringUtil=function(){function StringUtil(){}return StringUtil.startsWidth=function(str,pattern,ignoreCase){var thisLen=this.length,patternLen=pattern.length;if(thisLen<patternLen||0==patternLen)return!1;var startOfThis=str.substr(0,patternLen);return ignoreCase&&(startOfThis=startOfThis.toLowerCase(),pattern=pattern.toLowerCase()),startOfThis===pattern},StringUtil.endsWidth=function(str,pattern,ignoreCase){var thisLen=this.length,patternLen=pattern.length;if(thisLen<patternLen||0==patternLen)return!1;var endOfThis=str.substr(thisLen-patternLen,patternLen);return ignoreCase&&(endOfThis=endOfThis.toLowerCase(),pattern=pattern.toLowerCase()),endOfThis===pattern},StringUtil.parseInt=function(value,def,radix){var ret=parseInt(value,radix);return isNaN(ret)?Cegore.TypeCheck.isDefined(def)?def:0:ret},StringUtil.parseFloat=function(value,def){var ret=parseFloat(value);return isNaN(ret)?Cegore.TypeCheck.isDefined(def)?def:0:ret},StringUtil}();Cegore.StringUtil=StringUtil}(Cegore||(Cegore={})),function(Cegore){var ArrayUtil=function(){function ArrayUtil(){}return ArrayUtil.indexOf=function(item,array,cmp){if(!Cegore.TypeCheck.isFunction(cmp))throw"cmp must be function.";for(var i=0;i<array.length;++i)if(cmp(array[i],item))return i;return-1},ArrayUtil.EmptyArray=Cegore.TypeCheck.freezeObject([]),ArrayUtil}();Cegore.ArrayUtil=ArrayUtil}(Cegore||(Cegore={})),function(Cegore){var LoadWithXhr=function(){function LoadWithXhr(){}return LoadWithXhr.loadWithXhr=function(options){LoadWithXhr.onPromise(Cesium.Resource.fetch(options),options)},LoadWithXhr.loadJSON=function(options){LoadWithXhr.onPromise(Cesium.Resource.fetchJson(options.url),options)},LoadWithXhr.onPromise=function(promise,options){Cegore.TypeCheck.isDefined(promise)&&(Cegore.TypeCheck.isFunction(options.success)&&promise.then(options.success),Cegore.TypeCheck.isFunction(options.error)&&promise.otherwise(options.error))},LoadWithXhr}();Cegore.LoadWithXhr=LoadWithXhr}(Cegore||(Cegore={})),function(Cegore){var DOM=function(){function DOM(){}return DOM.createContext2D=function(width,height){var canvas=document.createElement("CANVAS");return width&&(canvas.width=width),height&&(canvas.height=height),canvas.getContext("2d")},DOM}();Cegore.DOM=DOM}(Cegore||(Cegore={})),function(Cegore){var Vector2=function(){function Vector2(v0,v1){this.x=0,this.y=0,this.set(v0,v1)}return Object.defineProperty(Vector2.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},enumerable:!0,configurable:!0}),Object.defineProperty(Vector2.prototype,"magnitude",{get:function(){return this.length},enumerable:!0,configurable:!0}),Object.defineProperty(Vector2.prototype,"squaredLength",{get:function(){return this.x*this.x+this.y*this.y},enumerable:!0,configurable:!0}),Vector2.prototype.set=function(v0,v1){var x,y;switch(Cegore.TypeCheck.typeOf(v0)){case"number":x=v0,y=v1;break;case"array":x=v0[0],y=v0[1];break;case"object":x=v0.x,y=v0.y}this.x=Cegore.StringUtil.parseFloat(x),this.y=Cegore.StringUtil.parseFloat(y)},Vector2.prototype.clone=function(result){return Vector2.clone(this,result)},Vector2.prototype.equals=function(right){return Vector2.equals(this,right)},Vector2.prototype.toString=function(){return"("+this.x+","+this.y+")"},Vector2.prototype._asCzVector2=function(){return new Cesium.Cartesian2(this.x,this.y)},Vector2.distance=function(left,right){return Math.sqrt(Vector2.squaredDistance(left,right))},Vector2.squaredDistance=function(left,right){var x=left.x-right.x,y=left.y-right.y;return x*x+y*y},Vector2.clone=function(target,result){return Vector2.newOrResult(target.x,target.y,result)},Vector2.equals=function(left,right){return left===right||Cegore.TypeCheck.isDefined(left)&&Cegore.TypeCheck.isDefined(right)&&left.x===right.x&&left.y===right.y},Vector2.add=function(left,right,result){return Vector2.newOrResult(left.x+right.x,left.y+right.y,result)},Vector2.sub=function(left,right,result){return Vector2.newOrResult(left.x-right.x,left.y-right.y,result)},Vector2.mul=function(left,right,result){if(Cegore.TypeCheck.isNumber(right))return Vector2.newOrResult(left.x*right,left.y*right,result);if(Cegore.TypeCheck.isInstanceOf(right,Vector2))return Vector2.newOrResult(left.x*right.x,left.y*right.y,result);throw"unknown param right."},Vector2.div=function(left,right,result){if(Cegore.TypeCheck.isNumber(right))return Vector2.newOrResult(left.x/right,left.y/right,result);if(Cegore.TypeCheck.isInstanceOf(right,Vector2))return Vector2.newOrResult(left.x/right.x,left.y/right.y,result);throw"unknown param right."},Vector2.negate=function(target,result){return Vector2.newOrResult(-target.x,-target.y,result)},Vector2.dot=function(left,right){return left.x*right.x+left.y*right.y},Vector2.cross=function(left,right,result){return Vector2.newOrResult(-right.y,right.x,result)},Vector2.normalize=function(target,result){var fLength=target.length,x=target.x,y=target.y;return 1e-8<fLength&&(x*=fLength=1/fLength,y*=fLength),Vector2.newOrResult(x,y,result)},Vector2.middle=function(left,right,result){return Vector2.newOrResult(.5*(left.x+right.x),.5*(left.y+right.y),result)},Vector2.floor=function(left,right,result){var x=left.x<right.x?left.x:right.x,y=left.y<right.y?left.y:right.y;return Vector2.newOrResult(x,y,result)},Vector2.ceil=function(left,right,result){var x=left.x>right.x?left.x:right.x,y=left.y>right.y?left.y:right.y;return Vector2.newOrResult(x,y,result)},Vector2.lerp=function(start,end,t,result){return t=Cegore.GeoMath.clamp(t,0,1),Vector2.mul(start,1-t,Vector2._LerpStart),Vector2.mul(end,t,Vector2._LerpEnd),Vector2.add(Vector2._LerpStart,Vector2._LerpEnd,result)},Vector2.angle=function(start,end){return Vector2.normalize(start,Vector2._AngleStart),Vector2.normalize(end,Vector2._AngleEnd),Cegore.GeoMath.acosClamped(Vector2.dot(Vector2._AngleStart,Vector2._AngleEnd))},Vector2.newOrResult=function(x,y,result){return Cegore.TypeCheck.isInstanceOf(result,Vector2)?(result.x=x,result.y=y,result):new Vector2(x,y)},Vector2._LerpStart=new Vector2,Vector2._LerpEnd=new Vector2,Vector2.ZERO=Cegore.TypeCheck.freezeObject(new Vector2(0,0)),Vector2.UNIT=Cegore.TypeCheck.freezeObject(new Vector2(1,1)),Vector2.UNIT_X=Cegore.TypeCheck.freezeObject(new Vector2(1,0)),Vector2.UNIT_Y=Cegore.TypeCheck.freezeObject(new Vector2(0,1)),Vector2}();Cegore.Vector2=Vector2}(Cegore||(Cegore={})),function(Cegore){var Vector3=function(){function Vector3(v0,v1,v2){this.x=0,this.y=0,this.z=0,this.set(v0,v1,v2)}return Object.defineProperty(Vector3.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},enumerable:!0,configurable:!0}),Object.defineProperty(Vector3.prototype,"magnitude",{get:function(){return this.length},enumerable:!0,configurable:!0}),Object.defineProperty(Vector3.prototype,"squaredLength",{get:function(){return this.x*this.x+this.y*this.y+this.z*this.z},enumerable:!0,configurable:!0}),Vector3.prototype.set=function(v0,v1,v2){var x,y,z;switch(Cegore.TypeCheck.typeOf(v0)){case"number":x=v0,y=v1,z=v2;break;case"array":x=v0[0],y=v0[1],z=v0[2];break;case"object":x=v0.x,y=v0.y,z=v0.z}this.x=Cegore.StringUtil.parseFloat(x),this.y=Cegore.StringUtil.parseFloat(y),this.z=Cegore.StringUtil.parseFloat(z)},Vector3.prototype.clone=function(result){return Vector3.clone(this,result)},Vector3.prototype.equals=function(right){return Vector3.equals(this,right)},Vector3.prototype.toString=function(){return"("+this.x+","+this.y+","+this.z+")"},Vector3.prototype._asCzVector3=function(){return new Cesium.Cartesian3(this.x,this.y,this.z)},Vector3.distance=function(left,right){return Math.sqrt(Vector3.squaredDistance(left,right))},Vector3.squaredDistance=function(left,right){var x=left.x-right.x,y=left.y-right.y,z=left.z-right.z;return x*x+y*y+z*z},Vector3.clone=function(target,result){return Vector3.newOrResult(target.x,target.y,target.z,result)},Vector3.equals=function(left,right){return left===right||Cegore.TypeCheck.isDefined(left)&&Cegore.TypeCheck.isDefined(right)&&left.x===right.x&&left.y===right.y&&left.z===right.z},Vector3.add=function(left,right,result){return Vector3.newOrResult(left.x+right.x,left.y+right.y,left.z+right.z,result)},Vector3.sub=function(left,right,result){return Vector3.newOrResult(left.x-right.x,left.y-right.y,left.z-right.z,result)},Vector3.mul=function(left,right,result){if(Cegore.TypeCheck.isNumber(right))return Vector3.newOrResult(left.x*right,left.y*right,left.z*right,result);if(Cegore.TypeCheck.isInstanceOf(right,Vector3))return Vector3.newOrResult(left.x*right.x,left.y*right.y,left.z*right.z,result);throw"unknown param right."},Vector3.div=function(left,right,result){if(Cegore.TypeCheck.isNumber(right))return Vector3.newOrResult(left.x/right,left.y/right,left.z/right,result);if(Cegore.TypeCheck.isInstanceOf(right,Vector3))return Vector3.newOrResult(left.x/right.x,left.y/right.y,left.z/right.z,result);throw"unknown param right."},Vector3.negate=function(target,result){return Vector3.newOrResult(-target.x,-target.y,-target.z,result)},Vector3.dot=function(left,right){return left.x*right.x+left.y*right.y+left.z*right.z},Vector3.cross=function(left,right,result){var x=left.y*right.z-left.z*right.y,y=left.z*right.x-left.x*right.z,z=left.x*right.y-left.y*right.x;return Vector3.newOrResult(x,y,z,result)},Vector3.normalize=function(target,result){var fLength=target.length,x=target.x,y=target.y,z=target.z;return 1e-8<fLength&&(x*=fLength=1/fLength,y*=fLength,z*=fLength),Vector3.newOrResult(x,y,z,result)},Vector3.middle=function(left,right,result){return Vector3.newOrResult(.5*(left.x+right.x),.5*(left.y+right.y),.5*(left.z+right.z),result)},Vector3.floor=function(left,right,result){var x=left.x<right.x?left.x:right.x,y=left.y<right.y?left.y:right.y,z=left.z<right.z?left.z:right.z;return Vector3.newOrResult(x,y,z,result)},Vector3.ceil=function(left,right,result){var x=left.x>right.x?left.x:right.x,y=left.y>right.y?left.y:right.y,z=left.z>right.z?left.z:right.z;return Vector3.newOrResult(x,y,z,result)},Vector3.lerp=function(start,end,t,result){return t=Cegore.GeoMath.clamp(t,0,1),Vector3.mul(start,1-t,Vector3._LerpStart),Vector3.mul(end,t,Vector3._LerpEnd),Vector3.add(Vector3._LerpStart,Vector3._LerpEnd,result)},Vector3.angle=function(start,end){Vector3.normalize(start,Vector3._AngleStart),Vector3.normalize(end,Vector3._AngleEnd);var cosine=Vector3.dot(Vector3._AngleStart,Vector3._AngleEnd),sine=Vector3.cross(Vector3._AngleStart,Vector3._AngleEnd,Vector3._AngleCross).length;return Math.atan2(sine,cosine)},Vector3.newOrResult=function(x,y,z,result){return Cegore.TypeCheck.isInstanceOf(result,Vector3)?(result.x=x,result.y=y,result.z=z,result):new Vector3(x,y,z)},Vector3._LerpStart=new Vector3,Vector3._LerpEnd=new Vector3,Vector3.ZERO=Cegore.TypeCheck.freezeObject(new Vector3(0,0,0)),Vector3.UNIT=Cegore.TypeCheck.freezeObject(new Vector3(1,1,1)),Vector3.UNIT_X=Cegore.TypeCheck.freezeObject(new Vector3(1,0,0)),Vector3.UNIT_Y=Cegore.TypeCheck.freezeObject(new Vector3(0,1,0)),Vector3.UNIT_Z=Cegore.TypeCheck.freezeObject(new Vector3(0,0,1)),Vector3}();Cegore.Vector3=Vector3}(Cegore||(Cegore={})),function(Cegore){var Position=function(){function Position(p0,p1,p2){this.set(p0,p1,p2)}return Object.defineProperty(Position.prototype,"lon",{get:function(){return this._x},set:function(value){this._x=Cegore.StringUtil.parseFloat(value)},enumerable:!0,configurable:!0}),Object.defineProperty(Position.prototype,"lat",{get:function(){return this._y},set:function(value){this._y=Cegore.StringUtil.parseFloat(value)},enumerable:!0,configurable:!0}),Object.defineProperty(Position.prototype,"altitude",{get:function(){return this._z},set:function(value){this._z=Cegore.StringUtil.parseFloat(value)},enumerable:!0,configurable:!0}),Object.defineProperty(Position.prototype,"x",{get:function(){return this.lon},set:function(val){this.lon=val},enumerable:!0,configurable:!0}),Object.defineProperty(Position.prototype,"y",{get:function(){return this.lat},set:function(val){this.lat=val},enumerable:!0,configurable:!0}),Object.defineProperty(Position.prototype,"z",{get:function(){return this.altitude},set:function(val){this.altitude=val},enumerable:!0,configurable:!0}),Position.prototype.set=function(p0,p1,p2){var x,y,z;if(Cegore.TypeCheck.isInstanceOf(p0,Cesium.Cartographic))x=Cegore.GeoMath.toDegree(p0.longitude),y=Cegore.GeoMath.toDegree(p0.latitude),z=p0.height;else switch(Cegore.TypeCheck.typeOf(p0)){case"array":x=p0[0],y=p0[1],z=p0[2];break;case"object":x=p0.x,y=p0.y,z=p0.z;break;case"number":case"string":x=p0,y=p1,z=p2}this.lon=Cegore.TypeCheck.defaultValue(x,0),this.lat=Cegore.TypeCheck.defaultValue(y,0),this.altitude=Cegore.TypeCheck.defaultValue(z,0)},Position.from=function(p0,p1,p2){return Cegore.TypeCheck.isInstanceOf(p0,Position)?p0:new Position(p0,p1,p2)},Position.parsePoints=function(lineStr){for(var lonlats=[],pts=lineStr.split("|"),i=0;i<pts.length;++i){var pt=pts.split(",");lonlats.push(pt[0],pt[1],pt[2])}return lonlats},Position}();Cegore.Position=Position}(Cegore||(Cegore={})),function(Cegore){var Rectangle=function(){function Rectangle(v1,v2,v3,v4,v5){this._minx=0,this._miny=0,this._maxx=0,this._maxy=0,this._isEmpty=!0,this._isGeographical=!0;var type=Cegore.TypeCheck.typeOf(v1);if("number"===type);else if("array"===type){var array=v1;v5=v2,v1=array[0],v2=array[1],v3=array[2],v4=array[3]}else if(Cegore.TypeCheck.isInstanceOf(v1,Cesium.Rectangle)){var rc=v1;v1=Cegore.GeoMath.toDegree(rc.west),v2=Cegore.GeoMath.toDegree(rc.south),v3=Cegore.GeoMath.toDegree(rc.east),v4=Cegore.GeoMath.toDegree(rc.north)}else if("object"===type){var obj=v1;v5=v2,Cegore.TypeCheck.isDefined(v1.minx)?(v1=obj.minx,v2=obj.miny,v3=obj.maxx,v4=obj.maxy):Cegore.TypeCheck.isDefined(v1.west)?(v1=obj.west,v2=obj.south,v3=obj.east,v4=obj.north):Cegore.TypeCheck.isDefined(v1.left)&&(v1=obj.left,v2=obj.bottom,v3=obj.right,v4=obj.top)}else{if("boolean"!==type)return;v5=v1}this._minx=Cegore.TypeCheck.defaultValue(v1,0),this._miny=Cegore.TypeCheck.defaultValue(v2,0),this._maxx=Cegore.TypeCheck.defaultValue(v3,0),this._maxy=Cegore.TypeCheck.defaultValue(v4,0),this._isGeographical=Cegore.TypeCheck.defaultValue(v5,!0),this._isEmpty=!1}return Object.defineProperty(Rectangle.prototype,"minx",{get:function(){return this._isEmpty?0:this._minx},set:function(val){this._minx=this._isGeographical?Rectangle.normalizeLongitude(val):val,this._isEmpty=!1},enumerable:!0,configurable:!0}),Object.defineProperty(Rectangle.prototype,"maxx",{get:function(){return this._isEmpty?0:this._maxx},set:function(val){this._maxx=this._isGeographical?Rectangle.normalizeLongitude(val):val,this._isEmpty=!1},enumerable:!0,configurable:!0}),Object.defineProperty(Rectangle.prototype,"miny",{get:function(){return this._isEmpty?0:this._miny},set:function(val){this._miny=this._isGeographical?Rectangle.normalizeLatitude(val):val,this._isEmpty=!1},enumerable:!0,configurable:!0}),Object.defineProperty(Rectangle.prototype,"maxy",{get:function(){return this._isEmpty?0:this._maxy},set:function(val){this._maxy=this._isGeographical?Rectangle.normalizeLatitude(val):val,this._isEmpty=!1},enumerable:!0,configurable:!0}),Object.defineProperty(Rectangle.prototype,"empty",{get:function(){return this._isEmpty},set:function(empty){this._isEmpty=empty},enumerable:!0,configurable:!0}),Object.defineProperty(Rectangle.prototype,"isGeographical",{get:function(){return this._isGeographical},enumerable:!0,configurable:!0}),Object.defineProperty(Rectangle.prototype,"width",{get:function(){return this.maxx-this.minx},enumerable:!0,configurable:!0}),Object.defineProperty(Rectangle.prototype,"height",{get:function(){return this.maxy-this.miny},enumerable:!0,configurable:!0}),Object.defineProperty(Rectangle.prototype,"west",{get:function(){return this.minx},set:function(val){this.minx=val},enumerable:!0,configurable:!0}),Object.defineProperty(Rectangle.prototype,"east",{get:function(){return this.maxx},set:function(val){this.maxx=val},enumerable:!0,configurable:!0}),Object.defineProperty(Rectangle.prototype,"south",{get:function(){return this.miny},set:function(val){this.miny=val},enumerable:!0,configurable:!0}),Object.defineProperty(Rectangle.prototype,"north",{get:function(){return this.maxy},set:function(val){this.maxy=val},enumerable:!0,configurable:!0}),Object.defineProperty(Rectangle.prototype,"left",{get:function(){return this.minx},set:function(val){this.minx=val},enumerable:!0,configurable:!0}),Object.defineProperty(Rectangle.prototype,"right",{get:function(){return this.maxx},set:function(val){this.maxx=val},enumerable:!0,configurable:!0}),Object.defineProperty(Rectangle.prototype,"bottom",{get:function(){return this.miny},set:function(val){this.miny=val},enumerable:!0,configurable:!0}),Object.defineProperty(Rectangle.prototype,"top",{get:function(){return this.maxy},set:function(val){this.maxy=val},enumerable:!0,configurable:!0}),Rectangle.prototype.center=function(result){if(Cegore.TypeCheck.isInstanceOf(result,Cegore.Position)||(result=new Cegore.Position),this._isGeographical){var minx=this.minx,maxx=this.maxx;maxx<minx&&(maxx+=360),result.x=Cegore.GeoMath.stdAngle((maxx+minx)/2)}else result.x=(this.minx+this.maxx)/2;return result.y=(this.miny+this.maxy)/2,result},Rectangle.prototype.min=function(result){return Cegore.TypeCheck.isInstanceOf(result,Cegore.Position)||(result=new Cegore.Position),result.x=this.minx,result.y=this.miny,result},Rectangle.prototype.max=function(result){return Cegore.TypeCheck.isInstanceOf(result,Cegore.Position)||(result=new Cegore.Position),result.x=this.maxx,result.y=this.maxy,result},Rectangle.prototype.leftBottom=function(result){return this.min(result)},Rectangle.prototype.leftTop=function(result){return Cegore.TypeCheck.isInstanceOf(result,Cegore.Position)||(result=new Cegore.Position),result.x=this.minx,result.y=this.maxy,result},Rectangle.prototype.rightTop=function(result){return this.max(result)},Rectangle.prototype.rightBottom=function(result){return Cegore.TypeCheck.isInstanceOf(result,Cegore.Position)||(result=new Cegore.Position),result.x=this.maxx,result.y=this.miny,result},Rectangle.prototype.southWest=function(result){return this.leftBottom(result)},Rectangle.prototype.southEast=function(result){return this.rightBottom(result)},Rectangle.prototype.northWest=function(result){return this.leftTop(result)},Rectangle.prototype.northEast=function(result){return this.rightTop(result)},Rectangle.prototype.inflate=function(v1,v2){if(Cegore.TypeCheck.isNumber(v1))Cegore.TypeCheck.isNumber(v2)||(v2=v1);else if(Cegore.TypeCheck.isInstanceOf(v1,Cegore.Vector2)){v1=(pt=v1).x,v2=pt.y}else if(Cegore.TypeCheck.isInstanceOf(v1,Cegore.Position)){var pt;v1=(pt=v1).x,v2=pt.y}this.minx-=v1,this.maxx+=v1,this.miny-=v2,this.maxy+=v2},Rectangle.prototype.merge=function(v,w){if(Cegore.TypeCheck.isArray(v))for(var i=0;i<v.length;++i)this.merge(v[i]);else{if(Cegore.TypeCheck.isNumber(v)){var x=v,y=w;if(this.empty)return this.minx=this.maxx=x,this.miny=this.maxy=y,void(this.empty=!1);if(this._isGeographical)(sminx=Cegore.GeoMath.innerAngle(x,this.minx))<=(smaxx=Cegore.GeoMath.innerAngle(x,this.maxx))&&x<this.minx&&(this.minx=x),smaxx<=sminx&&x>this.maxx&&(this.maxx=x);else x<this.minx&&(this.minx=x),x>this.maxx&&(this.maxx=x);return y<this.miny&&(this.miny=y),void(y>this.maxy&&(this.maxy=y))}if(Cegore.TypeCheck.isInstanceOf(v,Cegore.Position))this.merge(v.x,v.y);else if(Cegore.TypeCheck.isInstanceOf(v,Rectangle)){var rc=v;if(this.empty)return this.minx=rc.minx,this.miny=rc.miny,this.maxx=rc.maxx,this.maxy=rc.maxy,void(this.empty=!1);if(this._isGeographical){var sminx,smaxx,ct=this.center();(sminx=Cegore.GeoMath.innerAngle(ct.x,this.minx))<=(smaxx=Cegore.GeoMath.innerAngle(ct.x,this.maxx))&&rc.minx<this.minx&&(this.minx=rc.minx),smaxx<=sminx&&rc.maxx>this.maxx&&(this.maxx=rc.maxx)}else rc.minx<this.minx&&(this.minx=rc.minx),rc.maxx>this.maxx&&(this.maxx=rc.maxx);return rc.miny<this.miny&&(this.miny=rc.miny),void(rc.maxy>this.maxy&&(this.maxy=rc.maxy))}}},Rectangle.prototype.asArray=function(result){return Cegore.TypeCheck.isArray(result)||(result=[]),result[0]=this.minx,result[1]=this.miny,result[2]=this.maxx,result[3]=this.maxy,result},Rectangle.prototype.clone=function(result){return Cegore.TypeCheck.isInstanceOf(result,Rectangle)||(result=new Rectangle),result.minx=this.minx,result.miny=this.miny,result.maxx=this.maxx,result.maxy=this.maxy,result},Rectangle.prototype.contains=function(v){if(Cegore.TypeCheck.isInstanceOf(v,Cegore.Position)){var p=v;if(this.isGeographical){var x=p.x,minx=this.miny,maxx=this.maxx;if(maxx<minx&&(maxx+=360),x<minx&&(x+=360),x<minx||maxx<x)return!1}else if(p.x<this.minx||p.x>this.maxx)return!1;return!(p.y<this.miny||p.y>this.maxy)}if(Cegore.TypeCheck.isInstanceOf(v,Rectangle)){var rc=v;return this.contains(rc.min())&&this.contains(rc.max())}throw"unknow param v, v must be a Position or Rectangle."},Rectangle.prototype.intersection=function(rc,result){var x1,x2,y1,y2;if(this._isGeographical){var minx1=this.minx,maxx1=this.maxx,minx2=rc.minx,maxx2=rc.maxx;if(maxx1<minx1?(maxx2<minx2?minx2+=360:minx2<maxx1&&(minx2+=360,maxx2+=360),maxx1+=360):maxx2<minx2&&(minx1<maxx2&&(minx1+=360,maxx1+=360),maxx2+=360),(x2=maxx1<maxx2?maxx1:maxx2)<(x1=minx2<minx1?minx1:minx2))return}else if(x1=this.minx>rc.minx?this.minx:rc.minx,(x2=this.maxx<rc.maxx?this.maxx:rc.maxx)<x1)return;if(y1=this.miny>rc.miny?this.miny:rc.miny,!((y2=this.maxy<rc.maxy?this.maxy:rc.maxy)<y1))return Cegore.TypeCheck.isInstanceOf(result,Rectangle)||(result=new Rectangle),result.minx=x1,result.maxx=x2,result.miny=y1,result.maxy=y2,result},Rectangle.prototype.toCZRectangle=function(){return Cesium.Rectangle.fromDegrees(this._minx,this.miny,this.maxx,this.maxy)},Rectangle.normalizeLongitude=function(lon){return Cegore.GeoMath.stdAngle(lon)},Rectangle.normalizeLatitude=function(lat){return Cegore.GeoMath.clamp(lat,-90,90)},Rectangle}();Cegore.Rectangle=Rectangle}(Cegore||(Cegore={})),function(Cegore){var HeadingPitchRoll=function(){function HeadingPitchRoll(v0,v1,v2){this._heading=0,this._pitch=0,this._roll=0,this.set(v0,v1,v2)}return Object.defineProperty(HeadingPitchRoll.prototype,"heading",{get:function(){return this._heading},set:function(heading){this._heading=heading},enumerable:!0,configurable:!0}),Object.defineProperty(HeadingPitchRoll.prototype,"pitch",{get:function(){return this._pitch},set:function(pitch){this._pitch=pitch},enumerable:!0,configurable:!0}),Object.defineProperty(HeadingPitchRoll.prototype,"roll",{get:function(){return this._roll},set:function(roll){this._roll=roll},enumerable:!0,configurable:!0}),HeadingPitchRoll.prototype.set=function(v0,v1,v2){var h,p,r;if(Cegore.TypeCheck.isArray(v0))h=(hpr=v0)[0],p=hpr[1],r=hpr[2];else if(Cegore.TypeCheck.isObject(v0)){var hpr;h=(hpr=v0).heading,p=hpr.pitch,r=hpr.roll}else Cegore.TypeCheck.isNumber(v0)&&(h=v0,p=v1,r=v2);this.heading=Cegore.TypeCheck.defaultValue(h,0),this.pitch=Cegore.TypeCheck.defaultValue(p,0),this.roll=Cegore.TypeCheck.defaultValue(r,0)},HeadingPitchRoll.prototype.setFromRadius=function(v0,v1,v2){var h,p,r;if(Cegore.TypeCheck.isArray(v0))h=(hpr=v0)[0],p=hpr[1],r=hpr[2];else if(Cegore.TypeCheck.isObject(v0)){var hpr;h=(hpr=v0).heading,p=hpr.pitch,r=hpr.roll}else Cegore.TypeCheck.isNumber(v0)&&(h=v0,p=v1,r=v2);this.heading=Cegore.GeoMath.toDegree(Cegore.TypeCheck.defaultValue(h,0)),this.pitch=Cegore.GeoMath.toDegree(Cegore.TypeCheck.defaultValue(p,0)),this.roll=Cegore.GeoMath.toDegree(Cegore.TypeCheck.defaultValue(r,0))},HeadingPitchRoll}();Cegore.HeadingPitchRoll=HeadingPitchRoll}(Cegore||(Cegore={})),function(Cegore){var HeadingPitchDistance=function(){function HeadingPitchDistance(v0,v1,v2){this.heading=0,this.pitch=0,this.distance=0,this.set(v0,v1,v2)}return HeadingPitchDistance.prototype.set=function(v0,v1,v2){var h,p,d;switch(Cegore.TypeCheck.typeOf(v0)){case"number":h=v0,p=v1,d=v2;break;case"array":h=v0[0],p=v0[1],d=v0[2];break;case"object":h=v0.heading,p=v0.pitch,d=v0.distance}this.heading=Cegore.TypeCheck.defaultValue(h,0),this.pitch=Cegore.TypeCheck.defaultValue(p,0),this.distance=Cegore.TypeCheck.defaultValue(d,0)},HeadingPitchDistance.prototype._asCzObject=function(result){return Cegore.TypeCheck.isInstanceOf(result,Cesium.HeadingPitchRange)||(result=new Cesium.HeadingPitchRange),result.heading=Cegore.GeoMath.toRadian(this.heading),result.pitch=Cegore.GeoMath.toRadian(this.pitch),result.range=this.distance,result},HeadingPitchDistance}();Cegore.HeadingPitchDistance=HeadingPitchDistance}(Cegore||(Cegore={})),function(Cegore){var GeoMath=function(){function GeoMath(){}return GeoMath.toRadian=function(degree){return degree*this._degree2radian},GeoMath.toDegree=function(radian){return radian*this._radian2degree},GeoMath.clamp=function(val,min,max){return val<min&&(val=min),max<val&&(val=max),val},GeoMath.acosClamped=function(value){return Math.acos(GeoMath.clamp(value,-1,1))},GeoMath.asinClamped=function(value){return Math.asin(GeoMath.clamp(value,-1,1))},GeoMath.random=function(v1,v2){var r=Math.random(),min=Cegore.TypeCheck.defaultValue(v1,0);return min+(Cegore.TypeCheck.defaultValue(v2,1)-min)*r},GeoMath.surfaceDistance=function(p0,p1,radius){if(Cegore.TypeCheck.isArray(p0)){for(var sum=0,i=1;i<p0.length;++i)sum+=GeoMath.surfaceDistance(p0[i-1],p0[i],radius);return sum}Cegore.TypeCheck.isInstanceOf(p0,Cegore.Position)||(p0=new Cegore.Position(p0)),Cegore.TypeCheck.isInstanceOf(p1,Cegore.Position)||(p1=new Cegore.Position(p1)),Cegore.TypeCheck.isDefined(radius)||(radius=6378137);var radLatA=GeoMath.toRadian(p0.lat),radLatB=GeoMath.toRadian(p1.lat),radLonA=GeoMath.toRadian(p0.lon),radLonB=GeoMath.toRadian(p1.lon),ac=Math.cos(radLatA)*Math.cos(radLatB)*Math.cos(radLonA-radLonB),as=Math.sin(radLatA)*Math.sin(radLatB),a=GeoMath.clamp(ac+as,-1,1);return Math.acos(a)*radius},GeoMath.innerAngle=function(a1,a2){a1=GeoMath.stdAngle(a1),a2=GeoMath.stdAngle(a2);var s=Math.abs(a1-a2);return 180<s&&(s=360-s),s},GeoMath.stdAngle=function(angle){var n=angle%360;return 180<n&&(n-=360),n<-180&&(n+=360),n},GeoMath.surfaceArea=function(polygon,radius){for(var outs=[],rect=new Cegore.Rectangle,i=0;i<polygon.length;++i)rect.merge(polygon[i]);var ori=rect.min();for(i=0;i<polygon.length;++i){var pt=new Cegore.Position(polygon[i]),x=GeoMath.surfaceDistance(new Cegore.Position(pt.x,pt.y),new Cegore.Position(pt.x,ori.y),radius),y=GeoMath.surfaceDistance(new Cegore.Position(pt.x,pt.y),new Cegore.Position(ori.x,pt.y),radius);outs.push(new Cegore.Position(x,y))}return GeoMath.area(outs)},GeoMath.area=function(polygon){return Math.abs(GeoMath.signedArea(polygon))},GeoMath.signedArea=function(pts){if(null==pts||pts.length<3)return 0;for(var point_num=pts.length,p0=pts[point_num-1],p1=pts[0],p2=pts[1],s=p1.y*(p0.x-p2.x),i=1;i<point_num;++i)p0=p1,p1=p2,p2=pts[(i+1)%point_num],s+=p1.y*(p0.x-p2.x);return s/2},GeoMath._degree2radian=Math.PI/180,GeoMath._radian2degree=180/Math.PI,GeoMath}();Cegore.GeoMath=GeoMath}(Cegore||(Cegore={})),function(Cegore){var Segment=function(){function Segment(begin,end){this._begin=begin,this._end=end,this._interp=new Cegore.Vector2}return Segment.prototype.interp=function(amount){return Cegore.Vector2.lerp(this._begin,this._end,amount,this._interp)},Segment}(),LineBridge=function(){function LineBridge(begins,ends){this._segments=[];for(var num=begins.length<ends.length?begins.length:ends.length,i=0;i<num;++i)this._segments[i]=new Segment(begins[i],ends[i]);this._interp=[]}return LineBridge.prototype.interp=function(amount){for(var i=0;i<this._segments.length;++i)this._interp[i]=this._segments[i].interp(amount);return this._interp},LineBridge}(),MultiLineInterp=(function(){function InterpTool(){}InterpTool.nearPoint=function(p,pts){for(var index=0,length=Cegore.Vector2.squaredDistance(p,pts[0]),i=1;i<pts.length;++i){var l=Cegore.Vector2.squaredDistance(p,pts[i]);l<length&&(length=l,index=i)}return index}}(),function(){function MultiLineInterp(options){for(var lines=options.lines.slice(),i=0;i<lines.length;++i)for(var pts=lines[i],j=0;j<pts.length;++j)Cegore.TypeCheck.isInstanceOf(pts[j],Cegore.Vector2)||(pts[j]=new Cegore.Vector2(pts[j]));this._bridges=[];for(i=1;i<lines.length;++i){var pts0=lines[i-1],pts1=lines[i];this._bridges.push(new LineBridge(pts0,pts1))}}return MultiLineInterp.prototype.interp=function(amount){var bri,ba,tamount=(amount=Cegore.GeoMath.clamp(amount,0,1))*this._bridges.length;return ba=1==amount?(bri=this._bridges.length-1,1):tamount-(bri=Math.floor(tamount)),this._bridges[bri].interp(ba)},MultiLineInterp}());Cegore.MultiLineInterp=MultiLineInterp}(Cegore||(Cegore={})),function(Cegore){var CanvasDraw=function(){function CanvasDraw(options){var width=Cegore.TypeCheck.defaultValue(options.width,512),height=Cegore.TypeCheck.defaultValue(options.height,512);this._ctx=this.createCanvasContext2D(options.canvas,width,height),this._canvas=this._ctx.canvas}return Object.defineProperty(CanvasDraw.prototype,"canvas",{get:function(){return this._canvas},enumerable:!0,configurable:!0}),Object.defineProperty(CanvasDraw.prototype,"context",{get:function(){return this._ctx},enumerable:!0,configurable:!0}),Object.defineProperty(CanvasDraw.prototype,"rect",{get:function(){return this._rect},enumerable:!0,configurable:!0}),Object.defineProperty(CanvasDraw.prototype,"width",{get:function(){return this._canvas.width},enumerable:!0,configurable:!0}),Object.defineProperty(CanvasDraw.prototype,"height",{get:function(){return this._canvas.height},enumerable:!0,configurable:!0}),CanvasDraw.prototype.clear=function(){this._ctx.clearRect(0,0,this.width,this.height)},CanvasDraw.prototype.calcRect=function(lines){Cegore.TypeCheck.isDefined(this._rect)?this._rect.empty=!0:this._rect=new Cegore.Rectangle,function calc(lines,rect){for(var i=0;i<lines.length;++i){var line=lines[i];Cegore.TypeCheck.isInstanceOf(line,Cegore.Vector2)?rect.merge(line.x,line.y):Cegore.TypeCheck.isNumber(line[0])?(lines[i]=new Cegore.Vector2(line),rect.merge(line[0],line[1])):calc(line,rect)}}(lines,this._rect),this._geoWidth=this._rect.width,this._getHeight=this._rect.height},CanvasDraw.prototype.convertX=function(x){return(x-this._rect.minx)/this._geoWidth*this.width},CanvasDraw.prototype.convertY=function(y){return(this._rect.maxy-y)/this._getHeight*this.height},CanvasDraw.prototype.createCanvasContext2D=function(canvas,width,height){var result;return Cegore.TypeCheck.isDefined(canvas)&&(Cegore.TypeCheck.isString(canvas)?result=document.getElementById(canvas):Cegore.TypeCheck.isInstanceOf(canvas,HTMLCanvasElement)&&(result=canvas)),result||(result=document.createElement("CANVAS")),width&&(result.width=width),height&&(result.height=height),result.getContext("2d")},CanvasDraw}();Cegore.CanvasDraw=CanvasDraw}(Cegore||(Cegore={})),function(Cegore){var PolygonMask=function(_super){function PolygonMask(lines,options){var _this=_super.call(this,options)||this;return _this.calcRect(lines),_this._interp=new Cegore.MultiLineInterp({lines:lines}),_this}return __extends(PolygonMask,_super),PolygonMask.prototype.draw=function(amount){var ctx=this.context;ctx.fillStyle="#FF0000";var pts=this._interp.interp(amount);this.clear(),ctx.beginPath(),ctx.moveTo(this.convertX(pts[0].x),this.convertY(pts[0].y));for(var i=1;i<pts.length;++i)ctx.lineTo(this.convertX(pts[i].x),this.convertY(pts[i].y));ctx.closePath(),ctx.fill()},PolygonMask}(Cegore.CanvasDraw);Cegore.PolygonMask=PolygonMask}(Cegore||(Cegore={})),function(Cegore){var PolylineGradual=function(_super){function PolylineGradual(lines,options){var _this=_super.call(this,options)||this;return _this._fill=!0,_this._ctx1=_this.createCanvasContext2D(null,_this.width,_this.height),_this._canvas1=_this._ctx1.canvas,_this._ctx2=_this.createCanvasContext2D(null,_this.width,_this.height),_this._canvas2=_this._ctx2.canvas,_this._lines=lines,_this.calcRect(lines),_this}return __extends(PolylineGradual,_super),PolylineGradual.prototype.draw=function(amount){this.clear(),this.context.fillStyle="#FF0000",this.context.strokeStyle="#FF0000";var tamount=(amount=Cegore.GeoMath.clamp(amount,0,1))*(this._lines.length-1),bri1=Math.floor(tamount);bri1===this._lines.length-1&&bri1--;var bri2=bri1+1,ba=tamount-bri1;this.drawLine(this._ctx1,this._lines[bri1]),this.drawLine(this._ctx2,this._lines[bri2]),this.drawMix(this._ctx1,this._ctx2,ba)},PolylineGradual.prototype.drawLine=function(ctx,line){this._fill;ctx.fillStyle="#FFFFFF",ctx.strokeStyle="#FFFFFF",ctx.clearRect(0,0,this.width,this.height),ctx.beginPath();var self=this;!function draw(line){if(!Cegore.TypeCheck.isInstanceOf(line[0],Cegore.Vector2))for(var i_1=0;i_1<line.length;++i_1)draw(line[i_1]);ctx.moveTo(self.convertX(line[0].x),self.convertY(line[0].y));for(var i=1;i<line.length;++i)ctx.lineTo(self.convertX(line[i].x),self.convertY(line[i].y))}(line),this._fill?ctx.fill():ctx.stroke()},PolylineGradual.prototype.drawMix=function(ctx1,ctx2,alpha){for(var width=this.width,height=this.height,imgdata1=ctx1.getImageData(0,0,width,height),imgdata2=ctx2.getImageData(0,0,width,height),imgdatat=this.context.getImageData(0,0,width,height),d1=imgdata1.data,d2=imgdata2.data,dt=imgdatat.data,length=width*height*4,i=0;i<length;i+=4)dt[i]=255,dt[i+1]=dt[i+2]=0,0!=d1[i+3]&&0!=d2[i+3]?dt[i+3]=(d1[i]+d2[i])/2:0!=d1[i+3]?dt[i+3]=(1-alpha)*d1[i+3]:0!=d2[i+3]?dt[i+3]=alpha*d2[i+3]:dt[i+3]=0,dt[i]=dt[i+3];this.context.putImageData(imgdatat,0,0)},PolylineGradual}(Cegore.CanvasDraw);Cegore.PolylineGradual=PolylineGradual}(Cegore||(Cegore={})),function(Cegore){var DynamicArea=function(){function DynamicArea(options){this._viewer=options.viewer;var size=Cegore.TypeCheck.defaultValue(options.textureSize,{});var result={isEquel:!1,isSimple:!0},lines=options.lines.slice();!function initLines(lines,level,result){if(0!=lines.length){for(var equel=!0,length=lines[0].length,i=0;i<lines.length;++i){var line=lines[i];Cegore.TypeCheck.isNumber(line[0])?lines[i]=new Cegore.Vector2(line):initLines(line,level+1,result),length!=line.length&&(equel=!1)}0==level&&(result.isEquel=equel),1<level&&(result.isSimple=!1)}}(lines,0,result),this._polygonMask=result.isEquel&&result.isSimple?new Cegore.PolygonMask(lines,{canvas:options.canvas,width:size.width,height:size.height}):new Cegore.PolylineGradual(lines,{canvas:options.canvas,width:size.width,height:size.height}),this._material=new Cesium.Material({fabric:{type:"Water",uniforms:{specularMap:this._polygonMask.canvas,normalMap:"../../build/dep.debug/Assets/Textures/waterNormals.jpg",frequency:1e4,animationSpeed:.01,amplitude:1}}}),this._appearance=new Cesium.EllipsoidSurfaceAppearance({aboveGround:!0,faceForward:!1,material:this._material,renderState:{fog:{enabled:!0,density:.01}}}),this._geometry=new Cesium.RectangleGeometry({rectangle:this._polygonMask.rect.toCZRectangle(),vertexFormat:Cesium.EllipsoidSurfaceAppearance.VERTEX_FORMAT,height:options.height,extrudedHeight:options.extrudedHeight,granularity:Math.PI/5e3}),this._primitive=options.viewer._czdata.viewer.scene.primitives.add(new Cesium.Primitive({geometryInstances:new Cesium.GeometryInstance({geometry:this._geometry}),appearance:this._appearance,show:!0}))}return DynamicArea.prototype.draw=function(amount){this._polygonMask.draw(amount);var tex=this._material._textures.specularMap,canvas=this._polygonMask.canvas;tex&&tex.width==canvas.width&&tex.height==canvas.height&&tex.copyFrom(canvas)},Object.defineProperty(DynamicArea.prototype,"visible",{get:function(){return!!this._primitive&&this._primitive.show},set:function(visible){this._primitive&&(this._primitive.show=visible)},enumerable:!0,configurable:!0}),DynamicArea.prototype.remove=function(){this._viewer._czdata.viewer.scene.primitives.remove(this._primitive),this._primitive=this._primitive.destroy(),this._appearance=null,this._material=this._material.destroy(),this._geometry=null,this._polygonMask=null},DynamicArea}();Cegore.DynamicArea=DynamicArea}(Cegore||(Cegore={})),function(Cegore){var Color=function(){function Color(r,g,b,a){this._r=0,this._g=0,this._b=0,this._a=0,this.set(r,g,b,a)}return Color.prototype.set=function(r,g,b,a){if(Cegore.TypeCheck.isInstanceOf(r,Cesium.Color))r=(c=r).red,g=c.green,b=c.blue,a=c.alpha;else if(Cegore.TypeCheck.isString(r)){var c;r=(c=Color.fromCssColor(r)).r,g=c.g,b=c.b,a=c.a}else if(Cegore.TypeCheck.isArray(r)){var arr=r;r=arr[0],g=arr[1],b=arr[2],a=arr[3]}else if(Cegore.TypeCheck.isObject(r)){var obj=r;r=obj.r,g=obj.g,b=obj.b,a=obj.a}this.r=r,this.g=g,this.b=b,this.a=a},Object.defineProperty(Color.prototype,"red",{get:function(){return this._r},enumerable:!0,configurable:!0}),Object.defineProperty(Color.prototype,"green",{get:function(){return this._g},enumerable:!0,configurable:!0}),Object.defineProperty(Color.prototype,"blue",{get:function(){return this._b},enumerable:!0,configurable:!0}),Object.defineProperty(Color.prototype,"alpha",{get:function(){return this._a},enumerable:!0,configurable:!0}),Object.defineProperty(Color.prototype,"r",{get:function(){return this._r},set:function(value){this._r=Cegore.GeoMath.clamp(Cegore.TypeCheck.defaultValue(value,0),0,1)},enumerable:!0,configurable:!0}),Object.defineProperty(Color.prototype,"g",{get:function(){return this._g},set:function(value){this._g=Cegore.GeoMath.clamp(Cegore.TypeCheck.defaultValue(value,0),0,1)},enumerable:!0,configurable:!0}),Object.defineProperty(Color.prototype,"b",{get:function(){return this._b},set:function(value){this._b=Cegore.GeoMath.clamp(Cegore.TypeCheck.defaultValue(value,0),0,1)},enumerable:!0,configurable:!0}),Object.defineProperty(Color.prototype,"a",{get:function(){return this._a},set:function(value){this._a=Cegore.GeoMath.clamp(Cegore.TypeCheck.defaultValue(value,0),0,1)},enumerable:!0,configurable:!0}),Color.fromCssColor=function(css){return new Color(Cesium.Color.fromCssColorString(css))},Color.fromBytes=function(r,g,b,a,result){return Cegore.TypeCheck.isInstanceOf(result,Color)||(result=Color.BLACK),result.r=r/255,result.g=g/255,result.b=b/255,result.a=a/255,result},Color.fromRGBA32=function(rgba,result){return Color.UnionUint32[0]=rgba,Color.fromBytes(Color.UnionUint8[0],Color.UnionUint8[1],Color.UnionUint8[2],Color.UnionUint8[3],result)},Color.fromRandom=function(options,result){function random(v,min,max){return Cegore.TypeCheck.isNumber(v)?v:(min=Cegore.TypeCheck.defaultValue(min,0),max=Cegore.TypeCheck.defaultValue(max,1),Cegore.GeoMath.random(min,max))}return Cegore.TypeCheck.isInstanceOf(result,Color)||(result=Color.BLACK),result.r=random(options.red,options.minRed,options.maxRed),result.g=random(options.green,options.minGreen,options.maxGreen),result.b=random(options.blue,options.minBlue,options.maxBlue),result.a=random(options.alpha,options.minAlpha,options.maxAlpha),result},Color.prototype.toCssColor=function(){return new Cesium.Color(this._r,this._g,this._b,this._a).toCssColorString()},Color.prototype.toBytes=function(result){return Cegore.TypeCheck.isArray(result)||(result=[]),result[0]=Math.floor(255*this._r),result[1]=Math.floor(255*this._g),result[2]=Math.floor(255*this._b),result[3]=Math.floor(255*this._a),result},Color.prototype.toRGBA32=function(){var bytes=this.toBytes();return Color.UnionUint8[0]=bytes[0],Color.UnionUint8[1]=bytes[1],Color.UnionUint8[2]=bytes[2],Color.UnionUint8[3]=bytes[3],Color.UnionUint32[0]},Color.prototype.toCZColor=function(){return new Cesium.Color(this._r,this._g,this._b,this._a)},Color.RED=Cegore.TypeCheck.freezeObject(Color.fromCssColor("#FF0000")),Color.GREEN=Cegore.TypeCheck.freezeObject(Color.fromCssColor("#00FF00")),Color.BLUE=Cegore.TypeCheck.freezeObject(Color.fromCssColor("#0000FF")),Color.BLACK=Cegore.TypeCheck.freezeObject(Color.fromCssColor("#000000")),Color.WHITE=Cegore.TypeCheck.freezeObject(Color.fromCssColor("#FFFFFF")),Color.YELLOW=Cegore.TypeCheck.freezeObject(Color.fromCssColor("#FFFF00")),Color.AUQA=Cegore.TypeCheck.freezeObject(Color.fromCssColor("#00FFFF")),Color.FUCHSIA=Cegore.TypeCheck.freezeObject(Color.fromCssColor("#FF00FF")),Color.GRAY=Cegore.TypeCheck.freezeObject(Color.fromCssColor("#808080")),Color.ScratchArrayBuffer=new ArrayBuffer(4),Color.UnionUint32=new Uint32Array(Color.ScratchArrayBuffer),Color.UnionUint8=new Uint8Array(Color.ScratchArrayBuffer),Color}();Cegore.Color=Color}(Cegore||(Cegore={})),function(Cegore){var Material=function(){},ColorMaterial=function(_super){function ColorMaterial(color){var _this=_super.call(this)||this;return _this._color=new Cegore.Color(Cegore.Color.WHITE),Cegore.TypeCheck.isInstanceOf(color,Cegore.Color)||(color=new Cegore.Color(color)),_this._czmat=new Cesium.ColorMaterialProperty(color.toCZColor()),_this}return __extends(ColorMaterial,_super),Object.defineProperty(ColorMaterial.prototype,"type",{get:function(){return"Color"},enumerable:!0,configurable:!0}),Object.defineProperty(ColorMaterial.prototype,"czmat",{get:function(){return this._czmat},enumerable:!0,configurable:!0}),Object.defineProperty(ColorMaterial.prototype,"color",{get:function(){return this._color},set:function(val){this._color.set(val),this._czmat.color=this._color.toCZColor()},enumerable:!0,configurable:!0}),ColorMaterial}(Cegore.Material=Material);Cegore.ColorMaterial=ColorMaterial;var ImageMaterial=function(_super){function ImageMaterial(options){var _this=_super.call(this)||this;return _this._color=new Cegore.Color(Cegore.Color.WHITE),_this._repeat=new Cegore.Vector2(1,1),_this._transparent=!1,_this._czmat=new Cesium.ImageMaterialProperty,_this.color=options.color,_this.image=options.image,_this.repeat=options.repeat,_this.transparent=options.transparent,_this}return __extends(ImageMaterial,_super),Object.defineProperty(ImageMaterial.prototype,"type",{get:function(){return"Image"},enumerable:!0,configurable:!0}),Object.defineProperty(ImageMaterial.prototype,"czmat",{get:function(){return this._czmat},enumerable:!0,configurable:!0}),Object.defineProperty(ImageMaterial.prototype,"color",{get:function(){return this._color},set:function(val){this._color.set(val),this._czmat.color=this._color.toCZColor()},enumerable:!0,configurable:!0}),Object.defineProperty(ImageMaterial.prototype,"image",{get:function(){return this._image},set:function(img){this._image=img,this._czmat.image=img},enumerable:!0,configurable:!0}),Object.defineProperty(ImageMaterial.prototype,"repeat",{get:function(){return this._repeat},set:function(repeat){this._repeat.set(repeat),this._czmat.repeat=this._repeat._asCzVector2()},enumerable:!0,configurable:!0}),Object.defineProperty(ImageMaterial.prototype,"transparent",{get:function(){return this._transparent},set:function(val){this._transparent=val,this._czmat.transparent=val},enumerable:!0,configurable:!0}),ImageMaterial}(Material);Cegore.ImageMaterial=ImageMaterial}(Cegore||(Cegore={})),function(Cegore){var EventListener=function(){function EventListener(callback,self){this._callback=callback,this._self=self}return EventListener.equal=function(e1,e2){return e1._callback===e2._callback&&e1._self===e2._self},EventListener.prototype.fire=function(args){try{this._callback.apply(this._self,args)}catch(error){console.error("fire event error.")}},EventListener}(),Event=function(){function Event(){this._listeners=[]}return Event.prototype.on=function(callback,self){if(!Cegore.TypeCheck.isFunction(callback))throw"need param 'callback' is Function.";var event=new EventListener(callback,self);-1===Cegore.ArrayUtil.indexOf(event,this._listeners,EventListener.equal)&&this._listeners.push(event)},Event.prototype.off=function(callback,self){var event=new EventListener(callback,self),index=Cegore.ArrayUtil.indexOf(event,this._listeners,EventListener.equal);-1!==index&&this._listeners.splice(index)},Event.prototype.fire=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];for(var i=0;i<this._listeners.length;++i)this._listeners[i].fire(args)},Event.prototype.addEventListener=function(callback,self){this.on(callback,self)},Event.prototype.removeEventListener=function(callback,self){this.off(callback,self)},Event}();Cegore.Event=Event}(Cegore||(Cegore={})),function(Cegore){var EventHandle=function(){function EventHandle(options){if(this._events=new Cegore.HashMap(function(){return new Cegore.Event}),Cegore.TypeCheck.isArray(options))for(var i=0;i<options.length;++i){var ev=options[i];Cegore.TypeCheck.isString(ev.type)&&Cegore.TypeCheck.isFunction(ev.callback)&&this.on(ev.type,ev.callback,ev.self)}else if(Cegore.TypeCheck.isObject(options))for(var type in options){var callback=options[type];Cegore.TypeCheck.isFunction(callback)&&this.on(type,callback)}}return EventHandle.prototype.on=function(type,callback,self){if(!Cegore.TypeCheck.isString(type))throw"need param 'type' is string.";if(!Cegore.TypeCheck.isFunction(callback))throw"need param 'callback' is Function.";this._events.getOrCreate(type).on(callback,self)},EventHandle.prototype.off=function(type,callback,self){var handles=this._events.get(type);Cegore.TypeCheck.isDefined(handles)&&handles.off(callback,self)},EventHandle.prototype.fire=function(type){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];var handles=this._events.get(type);Cegore.TypeCheck.isDefined(handles)&&handles.fire.apply(handles,args)},EventHandle}();Cegore.EventHandle=EventHandle}(Cegore||(Cegore={})),function(Cegore){var AutoNames=function(){function AutoNames(){}return AutoNames.genName=function(name,prefix){return Cegore.TypeCheck.isDefined(name)?name:Cegore.TypeCheck.isDefined(prefix)?prefix+"-"+AutoNames.NextIndex++:"AutoName-"+AutoNames.NextIndex++},AutoNames.NextIndex=0,AutoNames}();Cegore.AutoNames=AutoNames}(Cegore||(Cegore={})),function(Cegore){var Clock=function(){function Clock(viewer){var _this=this;this._onTick=new Cegore.Event,this._czClock=viewer._czdata.viewer.clock,this._czClock.onTick.addEventListener(function(){_this._onTick.fire(_this)})}return Object.defineProperty(Clock.prototype,"onTick",{get:function(){return this._onTick},enumerable:!0,configurable:!0}),Object.defineProperty(Clock.prototype,"currentTime",{get:function(){return Cesium.JulianDate.toDate(this._czClock.currentTime)},set:function(value){this._czClock.currentTime=Cesium.JulianDate.fromDate(value)},enumerable:!0,configurable:!0}),Object.defineProperty(Clock.prototype,"startTime",{get:function(){return Cesium.JulianDate.toDate(this._czClock.startTime)},set:function(value){this._czClock.startTime=Cesium.JulianDate.fromDate(value)},enumerable:!0,configurable:!0}),Object.defineProperty(Clock.prototype,"stopTime",{get:function(){return Cesium.JulianDate.toDate(this._czClock.stopTime)},set:function(value){this._czClock.stopTime=Cesium.JulianDate.fromDate(value)},enumerable:!0,configurable:!0}),Clock}();Cegore.Clock=Clock}(Cegore||(Cegore={})),function(Cegore){var Camera=function(){function Camera(viewer){var _this=this;this._position=new Cegore.Position,this._orientation=new Cegore.HeadingPitchRoll,this._eventChanged=new Cegore.Event,this._eventMoveStart=new Cegore.Event,this._eventMoveEnd=new Cegore.Event,this._viewer=viewer,this._czData=viewer._czdata,this._czCamera=this._czData.camera,this._czCamera.changed.addEventListener(function(){_this._eventChanged.fire(_this)}),this._czCamera.moveStart.addEventListener(function(){_this._eventMoveStart.fire(_this)}),this._czCamera.moveEnd.addEventListener(function(){_this._eventMoveEnd.fire(_this)})}return Object.defineProperty(Camera.prototype,"position",{get:function(){return this._position.set(this._czData.camera.positionCartographic),this._position},set:function(pos){Cegore.TypeCheck.isInstanceOf(pos,Cegore.Position)||(this._position.set(pos),pos=this._position),this.setView({position:pos})},enumerable:!0,configurable:!0}),Object.defineProperty(Camera.prototype,"orientation",{get:function(){return this._orientation.setFromRadius(this._czData.camera.heading,this._czData.camera.pitch,this._czData.camera.roll),this._orientation},set:function(hpr){Cegore.TypeCheck.isInstanceOf(hpr,Cegore.HeadingPitchRoll)||(this._orientation.set(hpr),hpr=this._orientation),this.setView({orientation:hpr})},enumerable:!0,configurable:!0}),Object.defineProperty(Camera.prototype,"changed",{get:function(){return this._eventChanged},enumerable:!0,configurable:!0}),Object.defineProperty(Camera.prototype,"moveStart",{get:function(){return this._eventMoveStart},enumerable:!0,configurable:!0}),Object.defineProperty(Camera.prototype,"moveEnd",{get:function(){return this._eventMoveEnd},enumerable:!0,configurable:!0}),Camera.prototype.flyTo=function(options){var destination,orientation;if(Cegore.TypeCheck.isDefined(options.position))destination=this.fromPosition(options.position);else{if(!Cegore.TypeCheck.isDefined(options.rect))throw"position or rect is need.";destination=this.fromRectange(options.rect)}return Cegore.TypeCheck.isDefined(options.orientation)&&(orientation=this.fromOrientation(options.orientation)),this._czCamera.flyTo({destination:destination,orientation:orientation,duration:options.duration,complete:options.complete,cancel:options.cancel,endTransform:Cesium.Matrix4.IDENTITY})},Camera.prototype.flyToSphere=function(options){var center=options.center,offset=options.offset;Cegore.TypeCheck.isInstanceOf(center,Cegore.Position)||(center=new Cegore.Position(center)),Cegore.TypeCheck.isInstanceOf(offset,Cegore.HeadingPitchDistance)||(offset=new Cegore.HeadingPitchDistance(offset));var czoffset,bs=new Cesium.BoundingSphere(this.fromPosition(center),options.radius);Cegore.TypeCheck.isDefined(options.offset)&&(czoffset=offset._asCzObject()),this._czCamera.flyToBoundingSphere(bs,{offset:czoffset,duration:options.duration,complete:options.complete,cancel:options.cancel,endTransform:Cesium.Matrix4.IDENTITY})},Camera.prototype.stopFly=function(){this._czData.camera.cancelFlight()},Camera.prototype.setView=function(options){var destination,orientation;if(Cegore.TypeCheck.isDefined(options.position))destination=this.fromPosition(options.position);else{if(!Cegore.TypeCheck.isDefined(options.rect))throw"position or rect is need.";destination=this.fromRectange(options.rect)}return Cegore.TypeCheck.isDefined(options.orientation)&&(orientation=this.fromOrientation(options.orientation)),this._czData.camera.setView({destination:destination,orientation:orientation,endTransform:Cesium.Matrix4.IDENTITY})},Camera.prototype.getView=function(){return{position:this.position,orientation:this.orientation}},Camera.prototype.lookAt=function(target,offset){Cegore.TypeCheck.isInstanceOf(target,Cegore.Position)||(target=new Cegore.Position(target)),Cegore.TypeCheck.isInstanceOf(offset,Cegore.HeadingPitchDistance)||(offset=new Cegore.HeadingPitchDistance(offset)),this._czCamera.lookAt(this.fromPosition(target),offset._asCzObject())},Camera.prototype.lookAtFromTo=function(eye,target){Cegore.TypeCheck.isInstanceOf(target,Cegore.Position)||(target=new Cegore.Position(target)),Cegore.TypeCheck.isInstanceOf(eye,Cegore.Position)||(eye=new Cegore.Position(eye));var cpos=this.fromPosition(eye),ctar=this.fromPosition(target),offset=Cesium.Cartesian3.subtract(cpos,ctar,cpos);this._czCamera.lookAt(ctar,offset)},Camera.prototype.clearLookAt=function(){this._czCamera.lookAtTransform(Cesium.Matrix4.IDENTITY)},Camera.prototype.fromRectange=function(rect){return Cegore.TypeCheck.isInstanceOf(rect,Cegore.Rectangle)||(rect=new Cegore.Rectangle(rect)),Cesium.Rectangle.fromDegrees(rect.minx,rect.miny,rect.maxx,rect.maxy)},Camera.prototype.fromPosition=function(pos){return Cegore.TypeCheck.isInstanceOf(pos,Cegore.Position)||(pos=new Cegore.Position(pos)),Cesium.Cartesian3.fromDegrees(pos.x,pos.y,pos.z,this._czData.ellipsoid)},Camera.prototype.fromOrientation=function(ori){return Cegore.TypeCheck.isInstanceOf(ori,Cegore.HeadingPitchRoll)||(ori=new Cegore.HeadingPitchRoll(ori)),{heading:Cegore.GeoMath.toRadian(ori.heading),pitch:Cegore.GeoMath.toRadian(ori.pitch),roll:Cegore.GeoMath.toRadian(ori.roll)}},Camera}();Cegore.Camera=Camera}(Cegore||(Cegore={})),function(Cegore){var Renderable=function(){function Renderable(){this._position=new Cegore.Position,this._orientation=new Cegore.HeadingPitchRoll}return Renderable.applyProps=function(o,keys,props){for(var i=0;i<keys.length;++i){var val=props[keys[i]];Cegore.TypeCheck.isDefined(val)&&(o[keys[i]]=val)}},Renderable.prototype.applyProps=function(options){Renderable.applyProps(this,Renderable.RenderablePropList,options)},Object.defineProperty(Renderable.prototype,"id",{get:function(){return this._czRenderable.id},enumerable:!0,configurable:!0}),Object.defineProperty(Renderable.prototype,"visible",{get:function(){return this._czRenderable.show},set:function(visible){this._czRenderable.show=visible},enumerable:!0,configurable:!0}),Object.defineProperty(Renderable.prototype,"position",{get:function(){return this._position},set:function(pos){this._position.set(pos),this.applyPose()},enumerable:!0,configurable:!0}),Object.defineProperty(Renderable.prototype,"orientation",{get:function(){return this._orientation},set:function(o){this._orientation.set(o),this.applyPose()},enumerable:!0,configurable:!0}),Renderable.prototype.applyPose=function(){var position=new Cesium.Cartesian3.fromDegrees(this._position.lon,this._position.lat,this._position.altitude),hpr=new Cesium.HeadingPitchRoll(Cesium.Math.toRadians(this._orientation.heading),Cesium.Math.toRadians(this._orientation.pitch),Cesium.Math.toRadians(this._orientation.roll)),orientation=Cesium.Transforms.headingPitchRollQuaternion(position,hpr);this._czRenderable.position=position,this._czRenderable.orientation=orientation},Renderable.RenderablePropList=["visible","position","orientation"],Renderable}();Cegore.Renderable=Renderable}(Cegore||(Cegore={})),function(Cegore){var ProviderCollection=function(){function ProviderCollection(def){this.mFactories=new Cegore.HashMap,this.mDefaultFac=def}return ProviderCollection.prototype.regFactory=function(type,provider){this.mFactories.put(type,provider)},ProviderCollection.prototype.unregFactory=function(type){this.mFactories.remove(type)},ProviderCollection.prototype.createProvider=function(type,options){type=Cegore.TypeCheck.defaultValue(type,this.mDefaultFac);var provider=this.mFactories.get(type);if(provider)return provider.createProvider(options)},ProviderCollection}();Cegore.ProviderCollection=ProviderCollection;var Providers=function(){function Providers(){}return Providers.TerrainProviders=new ProviderCollection("ZMapTerrain"),Providers.ImageProviders=new ProviderCollection("ZMapImage"),Providers}();Cegore.Providers=Providers}(Cegore||(Cegore={})),function(Cegore){var ImageLayer=function(){function ImageLayer(options){if(!Cegore.TypeCheck.isObject(options))throw"Invalid iamge info";var provider=this.createProvider(options);if(!Cegore.TypeCheck.isDefined(provider))throw'Can not create image layer by type : "'+options.type+'"';this._name=Cegore.AutoNames.genName(options.name,"ImageLayer"),this._type=options.type,this._czLayer=new Cesium.ImageryLayer(provider),(this._czLayer._ZMapLayer=this).visible=Cegore.TypeCheck.defaultValue(options.visible,!0),this.alpha=Cegore.TypeCheck.defaultValue(options.alpha,1)}return Object.defineProperty(ImageLayer.prototype,"_czlayer",{get:function(){return this._czLayer},enumerable:!0,configurable:!0}),Object.defineProperty(ImageLayer.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(ImageLayer.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(ImageLayer.prototype,"visible",{get:function(){return this._visible},set:function(value){this._visible=value,this._czLayer.show=value},enumerable:!0,configurable:!0}),Object.defineProperty(ImageLayer.prototype,"alpha",{get:function(){return this._alpha},set:function(value){this._alpha=value,this._czLayer.alpha=value},enumerable:!0,configurable:!0}),ImageLayer.prototype.createProvider=function(options){var copy={};for(var key in options)this.hasOwnProperty(key)||(copy[key]=options[key]);return Cegore.Providers.ImageProviders.createProvider(options.type,copy)},ImageLayer}();Cegore.ImageLayer=ImageLayer}(Cegore||(Cegore={})),function(Cegore){var ImageLayerCollection=function(){function ImageLayerCollection(globe){this._layers=new Cegore.HashMap,this._globe=globe,this._czLayers=this._globe._czglobe.imageryLayers}return Object.defineProperty(ImageLayerCollection.prototype,"length",{get:function(){return this._czLayers.length},enumerable:!0,configurable:!0}),ImageLayerCollection.prototype.add=function(layer,index){if(Cegore.TypeCheck.isInstanceOf(layer,Cegore.ImageLayer)||(layer=new Cegore.ImageLayer(layer)),this._layers.exist(layer.name))throw"image layer named :"+layer.name+" allready exist.";this._czLayers.add(layer._czlayer,index),this._layers.put(layer.name,layer)},ImageLayerCollection.prototype.get=function(id){if(Cegore.TypeCheck.isNumber(id)){var czlayer=this._czLayers.get(id);if(czlayer)return czlayer._ZMapLayer}else if(Cegore.TypeCheck.isString(id))return this._layers.get(id);throw"id must be string or number"},ImageLayerCollection.prototype.remove=function(id){if(Cegore.TypeCheck.isNumber(id)||Cegore.TypeCheck.isString(id))this.remove(this.get(id));else if(Cegore.TypeCheck.isInstanceOf(id,Cegore.ImageLayer)){var layer=id;this._czLayers.remove(layer._czlayer),this._layers.remove(id.name)}throw"id must be string or number or ImageLayer"},ImageLayerCollection.prototype.removeAll=function(){this._czLayers.removeAll(),this._layers.removeAll()},ImageLayerCollection.prototype.clear=function(){this.removeAll()},ImageLayerCollection}();Cegore.ImageLayerCollection=ImageLayerCollection}(Cegore||(Cegore={})),function(Cegore){var scratchCartesian,Globe=function(){function Globe(scene){this._scene=scene,this._czData=scene._czdata,this._czGlobe=this._czData.globe,this._images=new Cegore.ImageLayerCollection(this)}return Globe.prototype.setTerrain=function(options){var provider=this.createProvider(options);if(null==provider)throw"Invalid terrain info";this._czData.globe.terrainProvider=provider},Object.defineProperty(Globe.prototype,"_czglobe",{get:function(){return this._czGlobe},enumerable:!0,configurable:!0}),Object.defineProperty(Globe.prototype,"images",{get:function(){return this._images},enumerable:!0,configurable:!0}),Object.defineProperty(Globe.prototype,"baseColor",{get:function(){return new Cegore.Color(this._czGlobe.baseColor)},set:function(val){Cegore.TypeCheck.isInstanceOf(val,Cegore.Color)||(val=new Cegore.Color(val)),this._czGlobe.baseColor=val.toCZColor()},enumerable:!0,configurable:!0}),Object.defineProperty(Globe.prototype,"enableDepthTest",{get:function(){return this._czGlobe.depthTestAgainstTerrain},set:function(val){this._czGlobe.depthTestAgainstTerrain=val},enumerable:!0,configurable:!0}),Object.defineProperty(Globe.prototype,"enableLighting",{get:function(){return this._czGlobe.enableLighting},set:function(enable){this._czGlobe.enableLighting=enable},enumerable:!0,configurable:!0}),Object.defineProperty(Globe.prototype,"enableWaterEffect",{get:function(){return this._czGlobe.showWaterEffect},set:function(enable){this._czGlobe.showWaterEffect=enable},enumerable:!0,configurable:!0}),Object.defineProperty(Globe.prototype,"tileCacheSize",{get:function(){return this._czGlobe.tileCacheSize},set:function(val){this._czGlobe.tileCacheSize=val},enumerable:!0,configurable:!0}),Object.defineProperty(Globe.prototype,"tileLoadProgress",{get:function(){var _this=this;return Cegore.TypeCheck.isDefined(this._tileLoadProgress)||(this._tileLoadProgress=new Cegore.Event,this._czGlobe.tileLoadProgressEvent.addEventListener(function(length){_this._tileLoadProgress.fire(length)})),this._tileLoadProgress},enumerable:!0,configurable:!0}),Globe.prototype.createProvider=function(options){return Cegore.Providers.TerrainProviders.createProvider(options.type,options)},Globe}();Cegore.Globe=Globe,scratchCartesian=new Cesium.Cartesian3,Cesium.EllipsoidalOccluder.prototype.isScaledSpacePointVisibleOld=Cesium.EllipsoidalOccluder.prototype.isScaledSpacePointVisible,Cesium.EllipsoidalOccluder.prototype.isScaledSpacePointVisible=function(occludeeScaledSpacePosition){return Cesium.Cartesian3.multiplyByScalar(occludeeScaledSpacePosition,1.001,scratchCartesian),this.isScaledSpacePointVisibleOld(scratchCartesian)}}(Cegore||(Cegore={})),function(Cegore){var Model=function(_super){function Model(){return _super.call(this)||this}return __extends(Model,_super),Model.prototype.applyProps=function(props){_super.prototype.applyProps.call(this,props)},Object.defineProperty(Model.prototype,"name",{get:function(){return this._name},set:function(name){this._name=name},enumerable:!0,configurable:!0}),Object.defineProperty(Model.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(Model.prototype,"children",{get:function(){return Cegore.ArrayUtil.EmptyArray},enumerable:!0,configurable:!0}),Object.defineProperty(Model.prototype,"isLeaf",{get:function(){return!0},enumerable:!0,configurable:!0}),Model.prototype.onAdded=function(parent){this._parent=parent},Model.prototype.onRemoved=function(){this._parent=null},Model.prototype.onAttachRoot=function(){this._parent.models._onAddModel(this)},Model.prototype.onDetachRoot=function(){this._parent.models._onRemoveModel(this)},Model.ModelPropList=["name"],Model}(Cegore.Renderable);Cegore.Model=Model}(Cegore||(Cegore={})),function(Cegore){var ModelGroup=function(){function ModelGroup(options){this._children=[],options=Cegore.TypeCheck.defaultValue(options,{}),this._name=Cegore.TypeCheck.defaultValue(options.name,"未命名")}return Object.defineProperty(ModelGroup.prototype,"models",{get:function(){return this._models},enumerable:!0,configurable:!0}),Object.defineProperty(ModelGroup.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(ModelGroup.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(ModelGroup.prototype,"children",{get:function(){return this._children},enumerable:!0,configurable:!0}),Object.defineProperty(ModelGroup.prototype,"isLeaf",{get:function(){return!1},enumerable:!0,configurable:!0}),ModelGroup.prototype.add=function(m){m.parent!==this&&(m.parent&&m.parent.remove(m),this._children.push(m),m.onAdded(this),this._models&&m.onAttachRoot())},ModelGroup.prototype.remove=function(m){if(m.parent===this){var index=this._children.indexOf(m);this._children.splice(index),m.onDetachRoot(),m.onRemoved()}},ModelGroup.prototype.removeAll=function(){for(var i=0;i<this._children.length;++i)this._children[i].onDetachRoot(),this._children[i].onRemoved();this._children=[]},ModelGroup.prototype.setModelCollection=function(modelCollection){this._models=modelCollection},ModelGroup.prototype.onAdded=function(parent){this._parent=parent,this._models=parent._models,this._models&&this.onAttachRoot()},ModelGroup.prototype.onRemoved=function(){this._models&&this.onDetachRoot(),this._parent=null,this._models=null},ModelGroup.prototype.onAttachRoot=function(){for(var i=0;i<this._children.length;++i)this._children[i].onAttachRoot()},ModelGroup.prototype.onDetachRoot=function(){for(var i=0;i<this._children.length;++i)this._children[i].onDetachRoot()},ModelGroup.getAllModels=function(mg,ms){for(var i=0;i<mg.children.length;++i){var ti=mg.children[i];Cegore.TypeCheck.isInstanceOf(ti,ModelGroup)?ModelGroup.getAllModels(ti,ms):ms.push(ti)}return ms},ModelGroup}();Cegore.ModelGroup=ModelGroup}(Cegore||(Cegore={})),function(Cegore){var ModelCollection=function(){function ModelCollection(scene){this._models=new Cegore.HashMap,this._czData=scene._czdata,this._DataSource=new Cesium.CustomDataSource("ModelCollection"),this._czData.viewer.dataSources.add(this._DataSource),this._entities=this._DataSource.entities,this._root=new Cegore.ModelGroup({name:"根节点"}),this._root.setModelCollection(this)}return Object.defineProperty(ModelCollection.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),ModelCollection.prototype.add=function(m){this._root.add(m)},ModelCollection.prototype.remove=function(m){this._root.remove(m)},ModelCollection.prototype._onAddModel=function(model){this._models.put(model.id,model),this._entities.add(model._czRenderable)},ModelCollection.prototype._onRemoveModel=function(model){this._models.remove(model.id),this._entities.remove(model._czRenderable)},ModelCollection}();Cegore.ModelCollection=ModelCollection}(Cegore||(Cegore={})),function(Cegore){var GltfModel=function(_super){function GltfModel(options){var _this=_super.call(this)||this;return _this._enablePcik=!0,_this._color=new Cegore.Color(Cegore.Color.WHITE),_this._outlineColor=new Cegore.Color(Cegore.Color.BLACK),_this._outlineSize=0,_this._czEntity=new Cesium.Entity,_this._czModel=new Cesium.ModelGraphics,_this._czEntity.model=_this._czModel,_this.applyProps(options),_this}return __extends(GltfModel,_super),GltfModel.prototype.applyProps=function(props){_super.prototype.applyProps.call(this,props),Cegore.Renderable.applyProps(this,GltfModel.GltfModelPropList,props)},Object.defineProperty(GltfModel.prototype,"_czRenderable",{get:function(){return this._czEntity},enumerable:!0,configurable:!0}),Object.defineProperty(GltfModel.prototype,"type",{get:function(){return"GltfModel"},enumerable:!0,configurable:!0}),Object.defineProperty(GltfModel.prototype,"uri",{get:function(){return this._uri},set:function(uri){this._uri=uri,this._czModel.uri=uri},enumerable:!0,configurable:!0}),Object.defineProperty(GltfModel.prototype,"enablePick",{get:function(){return this._enablePcik},set:function(enable){this._enablePcik=enable,this._czModel.allowPicking=enable},enumerable:!0,configurable:!0}),Object.defineProperty(GltfModel.prototype,"minPixelSize",{get:function(){return this._minPixelSize},set:function(size){this._minPixelSize=size,this._czModel.minimumPixelSize=size},enumerable:!0,configurable:!0}),Object.defineProperty(GltfModel.prototype,"color",{get:function(){return this._color},set:function(color){this._color.set(color),this._czModel.color=this._color.toCZColor()},enumerable:!0,configurable:!0}),Object.defineProperty(GltfModel.prototype,"outlineColor",{get:function(){return this._outlineColor},set:function(color){this._outlineColor.set(color),this._czModel.silhouetteColor=this._outlineColor.toCZColor()},enumerable:!0,configurable:!0}),Object.defineProperty(GltfModel.prototype,"outlineSize",{get:function(){return this._outlineSize},set:function(size){this._outlineSize=size,this._czModel.silhouetteSize=size},enumerable:!0,configurable:!0}),GltfModel.GltfModelPropList=["uri","enablePick","minPixelSize","color","outlineColor","outlineSize"],GltfModel}(Cegore.Model);Cegore.GltfModel=GltfModel}(Cegore||(Cegore={})),function(Cegore){var Shape=function(_super){function Shape(){var _this=_super.call(this)||this;return _this._fill=!0,_this._outline=!1,_this._outlineColor=new Cegore.Color(Cegore.Color.BLACK),_this._outlineWidth=1,_this._shadows=Cegore.ShadowMode.DISABLED,_this}return __extends(Shape,_super),Shape.prototype.applyProps=function(props){_super.prototype.applyProps.call(this,props),Cegore.Renderable.applyProps(this,Shape.ShapePropList,props)},Object.defineProperty(Shape.prototype,"fill",{get:function(){return this._fill},set:function(fill){this._fill=fill,this._czShape.fill=fill},enumerable:!0,configurable:!0}),Object.defineProperty(Shape.prototype,"material",{get:function(){return this._material},set:function(mat){var mm=mat;Cegore.TypeCheck.isInstanceOf(mm,Cegore.Material)?this._material=mm:Cegore.TypeCheck.isInstanceOf(mm,Cegore.Color)?this._material=new Cegore.ColorMaterial(mm):Cegore.TypeCheck.isString(mm)||Cegore.TypeCheck.isInstanceOf(mm,HTMLImageElement)||Cegore.TypeCheck.isInstanceOf(mm,HTMLCanvasElement)||Cegore.TypeCheck.isInstanceOf(mm,HTMLVideoElement)?this._material=new Cegore.ImageMaterial({image:mm}):Cegore.TypeCheck.isObject(mm)&&(this._material=new Cegore.ImageMaterial(mm)),this._czShape.material=this._material.czmat},enumerable:!0,configurable:!0}),Object.defineProperty(Shape.prototype,"outline",{get:function(){return this._outline},set:function(val){this._outline=val,this._czShape.outline=val},enumerable:!0,configurable:!0}),Object.defineProperty(Shape.prototype,"outlineColor",{get:function(){return new Cegore.Color(this._czShape.outlineColor)},set:function(val){this._outlineColor.set(val),this._czShape.outlineColor=this._outlineColor.toCZColor()},enumerable:!0,configurable:!0}),Object.defineProperty(Shape.prototype,"outlineWidth",{get:function(){return this._czShape.outlineWidth},set:function(val){this._outlineWidth=val,this._czShape.outlineWidth=val},enumerable:!0,configurable:!0}),Object.defineProperty(Shape.prototype,"shadows",{get:function(){return this._czShape.shadows},set:function(mode){this._shadows=mode,this._czShape.shadows=mode},enumerable:!0,configurable:!0}),Object.defineProperty(Shape.prototype,"displayDistance",{get:function(){return this._displayDistance},set:function(distance){this._displayDistance=distance,this._czShape.distanceDisplayCondition=distance},enumerable:!0,configurable:!0}),Shape.ShapePropList=["material","fill","outline","outlineColor","outlineWidth","shadows","displayDistance"],Shape}(Cegore.Model);Cegore.Shape=Shape}(Cegore||(Cegore={})),function(Cegore){var ShapeExtruded=function(_super){function ShapeExtruded(options){return _super.call(this)||this}return __extends(ShapeExtruded,_super),ShapeExtruded.prototype.applyProps=function(props){_super.prototype.applyProps.call(this,props),Cegore.Renderable.applyProps(this,ShapeExtruded.ShapeExtrudedPropList,props)},Object.defineProperty(ShapeExtruded.prototype,"height",{get:function(){return this._height},set:function(height){this._height=height,this._czShape.height=height},enumerable:!0,configurable:!0}),Object.defineProperty(ShapeExtruded.prototype,"extrudedHeight",{get:function(){return this._extrudedHeight},set:function(exheight){this._extrudedHeight=exheight,this._czShape.extrudedHeight=exheight},enumerable:!0,configurable:!0}),Object.defineProperty(ShapeExtruded.prototype,"rotation",{get:function(){return this._rotation},set:function(r){this._rotation=r,this._czShape.rotation=Cegore.GeoMath.toRadian(r)},enumerable:!0,configurable:!0}),ShapeExtruded.ShapeExtrudedPropList=["height","extrudedHeight","rotation"],ShapeExtruded}(Cegore.Shape);Cegore.ShapeExtruded=ShapeExtruded}(Cegore||(Cegore={})),function(Cegore){var BoxModel=function(_super){function BoxModel(options){var _this=_super.call(this)||this;return _this._dimensions=new Cegore.Vector3,_this._czEntity=new Cesium.Entity,_this._czBox=new Cesium.BoxGraphics,_this._czEntity.box=_this._czBox,_this.applyProps(options),_this}return __extends(BoxModel,_super),BoxModel.prototype.applyProps=function(props){_super.prototype.applyProps.call(this,props),Cegore.Renderable.applyProps(this,BoxModel.BoxPropList,props)},Object.defineProperty(BoxModel.prototype,"_czRenderable",{get:function(){return this._czEntity},enumerable:!0,configurable:!0}),Object.defineProperty(BoxModel.prototype,"_czShape",{get:function(){return this._czBox},enumerable:!0,configurable:!0}),Object.defineProperty(BoxModel.prototype,"type",{get:function(){return"BoxModel"},enumerable:!0,configurable:!0}),Object.defineProperty(BoxModel.prototype,"dimensions",{get:function(){return this._dimensions},set:function(dimensions){this._dimensions.set(dimensions),this._czBox.dimensions=this._dimensions._asCzVector3()},enumerable:!0,configurable:!0}),BoxModel.BoxPropList=["dimensions"],BoxModel}(Cegore.Shape);Cegore.BoxModel=BoxModel}(Cegore||(Cegore={})),function(Cegore){var CylinderModel=function(_super){function CylinderModel(options){var _this=_super.call(this)||this;return _this._czEntity=new Cesium.Entity,_this._czCylinder=new Cesium.CylinderGraphics,_this._czEntity.cylinder=_this._czCylinder,_this.applyProps(options),_this}return __extends(CylinderModel,_super),CylinderModel.prototype.applyProps=function(props){_super.prototype.applyProps.call(this,props),Cegore.Renderable.applyProps(this,CylinderModel.CylinderPropList,props)},Object.defineProperty(CylinderModel.prototype,"_czRenderable",{get:function(){return this._czEntity},enumerable:!0,configurable:!0}),Object.defineProperty(CylinderModel.prototype,"_czShape",{get:function(){return this._czCylinder},enumerable:!0,configurable:!0}),Object.defineProperty(CylinderModel.prototype,"type",{get:function(){return"CylinderModel"},enumerable:!0,configurable:!0}),Object.defineProperty(CylinderModel.prototype,"length",{get:function(){return this._length},set:function(length){this._length=length,this._czCylinder.length=length},enumerable:!0,configurable:!0}),Object.defineProperty(CylinderModel.prototype,"topRadius",{get:function(){return this._topRadius},set:function(radius){this._topRadius=radius,this._czCylinder.topRadius=radius},enumerable:!0,configurable:!0}),Object.defineProperty(CylinderModel.prototype,"bottomRadius",{get:function(){return this._bottomRadius},set:function(radius){this._bottomRadius=radius,this._czCylinder.bottomRadius=radius},enumerable:!0,configurable:!0}),Object.defineProperty(CylinderModel.prototype,"slices",{get:function(){return this._slices},set:function(slices){this._slices=slices,this._czCylinder.slices=slices},enumerable:!0,configurable:!0}),Object.defineProperty(CylinderModel.prototype,"verticalLines",{get:function(){return this._verticalLines},set:function(num){this._verticalLines=num,this._czCylinder.numberOfVerticalLines=num},enumerable:!0,configurable:!0}),CylinderModel.CylinderPropList=["length","topRadius","bottomRadius","slices","verticalLines"],CylinderModel}(Cegore.Shape);Cegore.CylinderModel=CylinderModel}(Cegore||(Cegore={})),function(Cegore){var EllipseModel=function(_super){function EllipseModel(options){var _this=_super.call(this)||this;return _this._czEntity=new Cesium.Entity,_this._czEllipse=new Cesium.EllipseGraphics,_this._czEntity.ellipse=_this._czEllipse,_this.applyProps(options),_this}return __extends(EllipseModel,_super),EllipseModel.prototype.applyProps=function(props){_super.prototype.applyProps.call(this,props),Cegore.Renderable.applyProps(this,EllipseModel.EllipsePropList,props)},Object.defineProperty(EllipseModel.prototype,"_czRenderable",{get:function(){return this._czEntity},enumerable:!0,configurable:!0}),Object.defineProperty(EllipseModel.prototype,"_czShape",{get:function(){return this._czEllipse},enumerable:!0,configurable:!0}),Object.defineProperty(EllipseModel.prototype,"type",{get:function(){return"EllipseModel"},enumerable:!0,configurable:!0}),Object.defineProperty(EllipseModel.prototype,"semiMajorAxis",{get:function(){return this._semiMajorAxis},set:function(len){this._semiMajorAxis=len,this._czEllipse.semiMajorAxis=len},enumerable:!0,configurable:!0}),Object.defineProperty(EllipseModel.prototype,"semiMinorAxis",{get:function(){return this._semiMinorAxis},set:function(len){this._semiMinorAxis=len,this._czEllipse.semiMinorAxis=len},enumerable:!0,configurable:!0}),Object.defineProperty(EllipseModel.prototype,"slices",{get:function(){return this._slices},set:function(slices){this._slices=slices,this._czEllipse.granularity=Math.PI/4/slices},enumerable:!0,configurable:!0}),Object.defineProperty(EllipseModel.prototype,"verticalLines",{get:function(){return this._verticalLines},set:function(num){this._verticalLines=num,this._czEllipse.numberOfVerticalLines=num},enumerable:!0,configurable:!0}),EllipseModel.EllipsePropList=["semiMajorAxis","semiMinorAxis","slices","verticalLines"],EllipseModel}(Cegore.ShapeExtruded);Cegore.EllipseModel=EllipseModel}(Cegore||(Cegore={})),function(Cegore){var EllipsoidModel=function(_super){function EllipsoidModel(options){var _this=_super.call(this)||this;return _this._czEntity=new Cesium.Entity,_this._czEllipsoid=new Cesium.EllipsoidGraphics,_this._czEntity.ellipsoid=_this._czEllipsoid,_this.applyProps(options),_this}return __extends(EllipsoidModel,_super),EllipsoidModel.prototype.applyProps=function(props){_super.prototype.applyProps.call(this,props),Cegore.Renderable.applyProps(this,EllipsoidModel.EllipsoidPropList,props)},Object.defineProperty(EllipsoidModel.prototype,"_czRenderable",{get:function(){return this._czEntity},enumerable:!0,configurable:!0}),Object.defineProperty(EllipsoidModel.prototype,"_czShape",{get:function(){return this._czEllipsoid},enumerable:!0,configurable:!0}),Object.defineProperty(EllipsoidModel.prototype,"type",{get:function(){return"EllipsoidModel"},enumerable:!0,configurable:!0}),Object.defineProperty(EllipsoidModel.prototype,"semiMajorAxis",{get:function(){return this._semiMajorAxis},set:function(len){this._semiMajorAxis=len,this._czEllipsoid.semiMajorAxis=len},enumerable:!0,configurable:!0}),Object.defineProperty(EllipsoidModel.prototype,"semiMinorAxis",{get:function(){return this._semiMinorAxis},set:function(len){this._semiMinorAxis=len,this._czEllipsoid.semiMinorAxis=len},enumerable:!0,configurable:!0}),Object.defineProperty(EllipsoidModel.prototype,"height",{get:function(){return this._height},set:function(height){this._height=height,this._czEllipsoid.height=height},enumerable:!0,configurable:!0}),Object.defineProperty(EllipsoidModel.prototype,"extrudedHeight",{get:function(){return this._extrudedHeight},set:function(exheight){this._extrudedHeight=exheight,this._czEllipsoid.extrudedHeight=exheight},enumerable:!0,configurable:!0}),Object.defineProperty(EllipsoidModel.prototype,"rotation",{get:function(){return this._rotation},set:function(r){this._rotation=r,this._czEllipsoid.rotation=Cegore.GeoMath.toRadian(r)},enumerable:!0,configurable:!0}),Object.defineProperty(EllipsoidModel.prototype,"slices",{get:function(){return this._slices},set:function(slices){this._slices=slices,this._czEllipsoid.granularity=Math.PI/4/slices},enumerable:!0,configurable:!0}),Object.defineProperty(EllipsoidModel.prototype,"verticalLines",{get:function(){return this._verticalLines},set:function(num){this._verticalLines=num,this._czEllipsoid.numberOfVerticalLines=num},enumerable:!0,configurable:!0}),EllipsoidModel.EllipsoidPropList=["semiMajorAxis","semiMinorAxis","height","extrudedHeight","slices","rotation","verticalLines"],EllipsoidModel}(Cegore.Shape);Cegore.EllipsoidModel=EllipsoidModel}(Cegore||(Cegore={})),function(Cegore){var PolylineStyle;!function(PolylineStyle){PolylineStyle[PolylineStyle.NONE=0]="NONE",PolylineStyle[PolylineStyle.GLOW=1]="GLOW",PolylineStyle[PolylineStyle.OUTLINE=2]="OUTLINE",PolylineStyle[PolylineStyle.DASH=3]="DASH",PolylineStyle[PolylineStyle.ARROW=4]="ARROW"}(PolylineStyle=Cegore.PolylineStyle||(Cegore.PolylineStyle={}));var PolylineModel=function(_super){function PolylineModel(options){var _this=_super.call(this)||this;return _this._dynamic=!1,_this._color=new Cegore.Color(Cegore.Color.WHITE),_this._style=PolylineStyle.NONE,_this._outlineColor=new Cegore.Color(Cegore.Color.BLACK),_this._outlineWidth=1,_this._shadows=Cegore.ShadowMode.DISABLED,_this._czEntity=new Cesium.Entity,_this._czPolyline=new Cesium.PolylineGraphics,_this._czEntity.polyline=_this._czPolyline,_this._dynamic=Cegore.TypeCheck.defaultValue(options.dynamic,!1),_this.applyProps(options),_this}return __extends(PolylineModel,_super),PolylineModel.prototype.applyProps=function(props){_super.prototype.applyProps.call(this,props),Cegore.Renderable.applyProps(this,PolylineModel.PolylinePropList,props)},Object.defineProperty(PolylineModel.prototype,"_czRenderable",{get:function(){return this._czEntity},enumerable:!0,configurable:!0}),Object.defineProperty(PolylineModel.prototype,"_czShape",{get:function(){return this._czPolyline},enumerable:!0,configurable:!0}),Object.defineProperty(PolylineModel.prototype,"type",{get:function(){return"PolylineModel"},enumerable:!0,configurable:!0}),Object.defineProperty(PolylineModel.prototype,"positions",{get:function(){return this._positions},set:function(points){this._positions=[],this._czPositions=[];for(var i=0;i<points.length;++i){var pt=new Cegore.Position(points[i]);this._positions.push(pt),this._czPositions.push(new Cesium.Cartesian3.fromDegrees(pt.lon,pt.lat,pt.altitude))}var pos=this._czPositions;this._dynamic&&!Cegore.TypeCheck.isInstanceOf(this._czShape.positions,Cesium.CallbackProperty)?this._czShape.positions=new Cesium.CallbackProperty(function(time,result){return pos},!1):this._czShape.positions=pos},enumerable:!0,configurable:!0}),Object.defineProperty(PolylineModel.prototype,"followSurface",{get:function(){return this._followSurface},set:function(follow){this._followSurface=follow,this._czShape.followSuface=follow},enumerable:!0,configurable:!0}),Object.defineProperty(PolylineModel.prototype,"color",{get:function(){return this._color},set:function(color){this._color.set(color),this._style==PolylineStyle.NONE?this._czShape.material=color.toCZColor():this._czShape.material.color=color.toCZColor()},enumerable:!0,configurable:!0}),Object.defineProperty(PolylineModel.prototype,"width",{get:function(){return this._width},set:function(width){this._width=width,this._czShape.width=width},enumerable:!0,configurable:!0}),Object.defineProperty(PolylineModel.prototype,"style",{get:function(){return this._style},set:function(style){if(this._style!=style){this._style=style;var czColor=this._color.toCZColor();switch(style){case PolylineStyle.GLOW:this._czShape.material=new Cesium.PolylineGlowMaterialProperty({color:czColor,glowPower:this._glow});break;case PolylineStyle.DASH:this._czShape.material=new Cesium.PolylineDashMaterialProperty({color:czColor});break;case PolylineStyle.ARROW:this._czShape.material=new Cesium.PolylineArrowMaterialProperty(czColor);break;case PolylineStyle.OUTLINE:this._czShape.material=new Cesium.PolylineOutlineMaterialProperty({color:czColor,outlineWidth:this._outlineWidth,outlineColor:this._outlineColor.toCZColor});break;case PolylineStyle.NONE:default:this._czShape.material=this._color.toCZColor()}}},enumerable:!0,configurable:!0}),Object.defineProperty(PolylineModel.prototype,"glow",{get:function(){return this._glow},set:function(glow){this._style==PolylineStyle.GLOW&&(this._czShape.material.glowPower=glow)},enumerable:!0,configurable:!0}),Object.defineProperty(PolylineModel.prototype,"outlineColor",{get:function(){return this._outlineColor},set:function(val){this._outlineColor.set(val),this._style==PolylineStyle.OUTLINE&&(this._czShape.material.outlineColor=this._outlineColor.toCZColor())},enumerable:!0,configurable:!0}),Object.defineProperty(PolylineModel.prototype,"outlineWidth",{get:function(){return this._outlineWidth},set:function(val){this._outlineWidth=val,this._style==PolylineStyle.OUTLINE&&(this._czShape.material.outlineWidth=val)},enumerable:!0,configurable:!0}),Object.defineProperty(PolylineModel.prototype,"shadows",{get:function(){return this._czShape.shadows},set:function(mode){this._shadows=mode,this._czShape.shadows=mode},enumerable:!0,configurable:!0}),Object.defineProperty(PolylineModel.prototype,"displayDistance",{get:function(){return this._displayDistance},set:function(distance){this._displayDistance=distance,this._czShape.distanceDisplayCondition=distance},enumerable:!0,configurable:!0}),PolylineModel.PolylinePropList=["positions","followSurface","width","style","color","glow","outlineWidth","outlineColor","shadows","displayDistance"],PolylineModel}(Cegore.Model);Cegore.PolylineModel=PolylineModel}(Cegore||(Cegore={})),function(Cegore){var PolygonHierarchy=function(){};Cegore.PolygonHierarchy=PolygonHierarchy;var PolygonModel=function(_super){function PolygonModel(options){var _this=_super.call(this)||this;return _this._dynamic=!1,_this._usePositionHeight=!1,_this._closeTop=!0,_this._closeBottom=!0,_this._czEntity=new Cesium.Entity,_this._czPolygon=new Cesium.PolygonGraphics,_this._czEntity.polygon=_this._czPolygon,_this._dynamic=Cegore.TypeCheck.defaultValue(options.dynamic,!1),_this.applyProps(options),_this}return __extends(PolygonModel,_super),PolygonModel.prototype.applyProps=function(props){_super.prototype.applyProps.call(this,props),Cegore.Renderable.applyProps(this,PolygonModel.PolygonPropList,props)},Object.defineProperty(PolygonModel.prototype,"_czRenderable",{get:function(){return this._czEntity},enumerable:!0,configurable:!0}),Object.defineProperty(PolygonModel.prototype,"_czShape",{get:function(){return this._czPolygon},enumerable:!0,configurable:!0}),Object.defineProperty(PolygonModel.prototype,"type",{get:function(){return"PolygonModel"},enumerable:!0,configurable:!0}),Object.defineProperty(PolygonModel.prototype,"positions",{get:function(){return this._positions},set:function(polygon){this._positions=[];for(var pts,holes=[],i=0;i<polygon.length;++i){for(var ring=polygon[i],sring=[],czring=[],j=0;j<ring.length;++j){var pt=new Cegore.Position(ring[j]);sring.push(pt),czring.push(new Cesium.Cartesian3.fromDegrees(pt.lon,pt.lat,pt.altitude))}this._positions(sring),0==i?pts=czring:holes.push(new Cesium.PolygonHierarchy(czring))}this._czPositions=new Cesium.PolygonHierarchy(pts,holes);var pos=this._czPositions;this._dynamic&&!Cegore.TypeCheck.isInstanceOf(this._czShape.positions,Cesium.CallbackProperty)?this._czShape.positions=new Cesium.CallbackProperty(function(time,result){return pos},!1):this._czShape.positions=pos},enumerable:!0,configurable:!0}),Object.defineProperty(PolygonModel.prototype,"usePositionHeight",{get:function(){return this._usePositionHeight},set:function(use){this._usePositionHeight=use,this._czShape.perPositionHeight=use},enumerable:!0,configurable:!0}),Object.defineProperty(PolygonModel.prototype,"closeTop",{get:function(){return this._closeTop},set:function(close){this._closeTop=close,this._czShape.closeTop=close},enumerable:!0,configurable:!0}),Object.defineProperty(PolygonModel.prototype,"closeBottom",{get:function(){return this._closeBottom},set:function(close){this._closeBottom=close,this._czShape.closeBottom=close},enumerable:!0,configurable:!0}),PolygonModel.PolygonPropList=["positions","usePositionHeight","closeTop","closeBottom"],PolygonModel}(Cegore.ShapeExtruded);Cegore.PolygonModel=PolygonModel}(Cegore||(Cegore={})),function(Cegore){var PrimitiveModel=function(_super){function PrimitiveModel(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(PrimitiveModel,_super),PrimitiveModel}(Cegore.Renderable);Cegore.PrimitiveModel=PrimitiveModel}(Cegore||(Cegore={})),function(Cegore){var Label=function(_super){function Label(options){var _this=_super.call(this)||this;if(_this._layer="",_this.mAutoOffset=!0,!Cegore.TypeCheck.isDefined(options.text)&&!Cegore.TypeCheck.isDefined(options.icon))throw"need options.text or options.icon";return _this._name=Cegore.AutoNames.genName(options.name,"Label"),_this._layer=Cegore.TypeCheck.defaultValue(options.layer,""),_this._events=new Cegore.EventHandle(options.labelevent),_this._czEntity=new Cesium.Entity({name:_this._layer+" "+_this._name}),(_this._czEntity._zMapRenderable=_this).setText(options.text),_this.setIcon(options.icon),_super.prototype.applyProps.call(_this,{position:options.pos,visible:options.visible}),_this}return __extends(Label,_super),Object.defineProperty(Label.prototype,"_czRenderable",{get:function(){return this._czEntity},enumerable:!0,configurable:!0}),Object.defineProperty(Label.prototype,"type",{get:function(){return"Label"},enumerable:!0,configurable:!0}),Object.defineProperty(Label.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(Label.prototype,"layer",{get:function(){return this._layer},enumerable:!0,configurable:!0}),Object.defineProperty(Label.prototype,"text",{get:function(){if(Cegore.TypeCheck.isDefined(this._czText))return this._czText.text},set:function(value){this.setText({title:value})},enumerable:!0,configurable:!0}),Object.defineProperty(Label.prototype,"icon",{get:function(){if(Cegore.TypeCheck.isDefined(this._czIcon))return this._czIcon.image.src},set:function(value){this.setIcon({img:value})},enumerable:!0,configurable:!0}),Object.defineProperty(Label.prototype,"events",{get:function(){return this._events},enumerable:!0,configurable:!0}),Label.prototype._applyProp=function(val,tar,name,type){if(Cegore.TypeCheck.isDefined(val)){var propval;switch(type){case"Cartesian2":propval=new Cesium.Cartesian2(val[0],val[1]);break;case"Color":propval=Cesium.Color.fromCssColorString(val);break;default:propval=val}tar[name]=propval}},Label.prototype._applyTextProp=function(val,name,type){this._applyProp(val,this._czText,name,type)},Label.prototype._applyIconProp=function(val,name,type){this._applyProp(val,this._czIcon,name,type)},Label.prototype.setText=function(text){if(Cegore.TypeCheck.isDefined(text)){if(Cegore.TypeCheck.isDefined(this._czText)||(this._czText=new Cesium.LabelGraphics,this._czEntity.label=this._czText),Cegore.TypeCheck.isDefined(text.font)||Cegore.TypeCheck.isDefined(text.size)){var fontname=Cegore.TypeCheck.defaultValue(text.font,"sans-serif"),fontsize=Cegore.TypeCheck.defaultValue(text.size,"10");this._czText.font=fontsize+"px "+fontname}this._applyTextProp(text.title,"text"),this._applyTextProp(text.color,"fillColor","Color"),Cegore.TypeCheck.isDefined(text.border)&&(this._applyTextProp(text.border.color,"outlineColor","Color"),this._applyTextProp(text.border.width,"outlineWidth")),Cegore.TypeCheck.isDefined(text.unit)&&(this._applyTextProp(text.unit.offset,"pixelOffset","Cartesian2"),Cegore.TypeCheck.isDefined(text.unit.offset)&&(this.mAutoOffset=!1))}},Label.prototype.setIcon=function(icon){if(Cegore.TypeCheck.isDefined(icon)){var imgurl;if(Cegore.TypeCheck.isDefined(this._czIcon)||(this._czIcon=new Cesium.BillboardGraphics,this._czEntity.billboard=this._czIcon),Cegore.TypeCheck.isString(icon.img)?imgurl=icon.img:Cegore.TypeCheck.isArray(icon.img)&&0<icon.img.length&&(imgurl=icon.img[0]),Cegore.TypeCheck.isDefined(imgurl)){var _self_1=this,img_1=new Image;img_1.src=imgurl,img_1.onload=function(){if(_self_1._czIcon.image=img_1,_self_1.mAutoOffset&&Cegore.TypeCheck.isDefined(_self_1._czText)){var scale=_self_1._czIcon.scale?_self_1._czIcon.scale.getValue():1,off=img_1.height*scale;_self_1._czText.pixelOffset=new Cesium.Cartesian2(0,-off)}}}this._applyIconProp(icon.scale,"scale"),this._applyIconProp(icon.color,"color","Color"),Cegore.TypeCheck.isDefined(icon.unit)&&this._applyIconProp(icon.unit.offset,"pixelOffset","Cartesian2")}},Label}(Cegore.Renderable);Cegore.Label=Label}(Cegore||(Cegore={})),function(Cegore){var LabelCollection=function(){function LabelCollection(scene){var _this=this;this._layers=new Cegore.HashMap(function(){return new Cegore.HashMap}),this.mLabelEvent=new Cegore.EventHandle,this._scene=scene,this._czData=scene._czdata,this._czDataSource=new Cesium.CustomDataSource("LabelCollection"),this._czData.viewer.dataSources.add(this._czDataSource),this._czEntities=this._czDataSource.entities;this.mCZHandle=new Cesium.ScreenSpaceEventHandler(this._czData.scene.canvas),this.mCZHandle.setInputAction(function(movement){_this.onLabelMoveEvent(movement)},Cesium.ScreenSpaceEventType.MOUSE_MOVE),this.mCZHandle.setInputAction(function(movement){_this.onLabelClickEvent(movement)},Cesium.ScreenSpaceEventType.LEFT_CLICK)}return LabelCollection.prototype.onLabelMoveEvent=function(movement){},LabelCollection.prototype.onLabelClickEvent=function(movement){var label=this.pick(movement.position);Cegore.TypeCheck.isDefined(label)&&(label.events.fire("onclick",label,movement.position),this.mLabelEvent.fire("onclick",label,movement.position))},LabelCollection.prototype._getOrCreateLayer=function(layerName){return this._layers.getOrCreate(layerName,null)},LabelCollection.prototype._getLayer=function(layerName){return this._layers.get(layerName)},Object.defineProperty(LabelCollection.prototype,"events",{get:function(){return this.mLabelEvent},enumerable:!0,configurable:!0}),LabelCollection.prototype.add=function(label){return this.remove(label),Cegore.TypeCheck.isInstanceOf(label,Cegore.Label)||(label=new Cegore.Label(label)),this._getOrCreateLayer(label.layer).put(label.name,label),this._czEntities.add(label._czRenderable),label},LabelCollection.prototype.get=function(name,layer){layer=Cegore.TypeCheck.defaultValue(layer,"");var lyr=this._getLayer(layer);if(Cegore.TypeCheck.isDefined(lyr))return lyr.get(name)},LabelCollection.prototype.pick=function(p1,p2){var pt;if(Cegore.TypeCheck.isArray(p1)){var arr=p1;pt=new Cesium.Cartesian2(arr[0],arr[1])}else if(p1 instanceof Cesium.Cartesian2)pt=p1;else if(Cegore.TypeCheck.isObject(p1)){var obj=p1;pt=new Cesium.Cartesian2(obj.x,obj.y)}else pt=new Cesium.Cartesian2(p1,p2);var pickObj=this._czData.scene.pick(pt);if(Cegore.TypeCheck.isDefined(pickObj)){var id=Cegore.TypeCheck.defaultValue(pickObj.id,pickObj.primitive.id);if(id instanceof Cesium.Entity&&id._zMapRenderable instanceof Cegore.Label)return id._zMapRenderable}},LabelCollection.prototype.remove=function(p1,p2){var label;if(Cegore.TypeCheck.isString(p1))label=this.get(p1,p2);else if(Cegore.TypeCheck.isInstanceOf(p1,Cegore.Label))label=p1;else{if(!Cegore.TypeCheck.isObject(p1))throw"invaild param!";label=this.get(p1.name,p1.layer)}if(Cegore.TypeCheck.isInstanceOf(label,Cegore.Label)){var entity=label._czRenderable;this._czEntities.remove(entity);var layer=this._getLayer(label.layer);Cegore.TypeCheck.isDefined(layer)&&layer.remove(label.name)}},LabelCollection.prototype.removeLayer=function(layerName){var layer=this._getLayer(layerName);if(Cegore.TypeCheck.isDefined(layer)){for(var labels=layer.keys(),i=0;i<labels.length;++i){var entity=layer.get(labels[i]);this._czEntities.remove(entity)}this._layers.remove(layerName)}},LabelCollection.prototype.removeAll=function(){this._czEntities.removeAll(),this._layers.clear()},LabelCollection.prototype.clear=function(){this.removeAll()},LabelCollection}();Cegore.LabelCollection=LabelCollection}(Cegore||(Cegore={})),function(Cegore){!function(SceneMode){SceneMode[SceneMode.COLUMBUS_VIEW=Cesium.SceneMode.COLUMBUS_VIEW]="COLUMBUS_VIEW",SceneMode[SceneMode.MORPHING=Cesium.SceneMode.MORPHING]="MORPHING",SceneMode[SceneMode.SCENE2D=Cesium.SceneMode.SCENE2D]="SCENE2D",SceneMode[SceneMode.SCENE3D=Cesium.SceneMode.SCENE3D]="SCENE3D"}(Cegore.SceneMode||(Cegore.SceneMode={})),function(ShadowMode){ShadowMode[ShadowMode.DISABLED=Cesium.ShadowMode.DISABLED]="DISABLED",ShadowMode[ShadowMode.ENABLED=Cesium.ShadowMode.ENABLED]="ENABLED",ShadowMode[ShadowMode.CAST_ONLY=Cesium.ShadowMode.CAST_ONLY]="CAST_ONLY",ShadowMode[ShadowMode.RECEIVE_ONLY=Cesium.ShadowMode.RECEIVE_ONLY]="RECEIVE_ONLY"}(Cegore.ShadowMode||(Cegore.ShadowMode={}));var Scene=function(){function Scene(viewer){this._isUnderWater=!1,this._viewer=viewer,this._czData=viewer._czdata,this._czScene=this._czData.scene,this._globe=new Cegore.Globe(this),this._labels=new Cegore.LabelCollection(this),this._models=new Cegore.ModelCollection(this)}return Object.defineProperty(Scene.prototype,"_czdata",{get:function(){return this._czData},enumerable:!0,configurable:!0}),Object.defineProperty(Scene.prototype,"mode",{get:function(){return this._czScene.mode},set:function(mode){this._czScene.mode=mode},enumerable:!0,configurable:!0}),Object.defineProperty(Scene.prototype,"globe",{get:function(){return this._globe},enumerable:!0,configurable:!0}),Object.defineProperty(Scene.prototype,"models",{get:function(){return this._models},enumerable:!0,configurable:!0}),Object.defineProperty(Scene.prototype,"labels",{get:function(){return this._labels},enumerable:!0,configurable:!0}),Object.defineProperty(Scene.prototype,"enableFog",{get:function(){return this._czScene.fog.enabled},set:function(enable){this._czScene.fog.enabled=enable},enumerable:!0,configurable:!0}),Object.defineProperty(Scene.prototype,"fogDensity",{get:function(){return this._czScene.fog.density},set:function(value){this._czScene.fog.density=value},enumerable:!0,configurable:!0}),Object.defineProperty(Scene.prototype,"enableFXAA",{get:function(){return this._czScene.fxaa},set:function(enable){this._czScene.fxaa=enable},enumerable:!0,configurable:!0}),Object.defineProperty(Scene.prototype,"terrainScale",{get:function(){return this._czScene.terrainExaggeration},set:function(scale){this._czScene.terrainExaggeration=scale},enumerable:!0,configurable:!0}),Object.defineProperty(Scene.prototype,"preRender",{get:function(){var _this=this;return Cegore.TypeCheck.isDefined(this._preRender)||(this._preRender=new Cegore.Event,this._czScene.preRender.addEventListener(function(sc,t){_this._preRender.fire(Cesium.JulianDate.toDate(t))})),this._preRender},enumerable:!0,configurable:!0}),Object.defineProperty(Scene.prototype,"postRender",{get:function(){var _this=this;return Cegore.TypeCheck.isDefined(this._poseRender)||(this._poseRender=new Cegore.Event,this._czScene.poseRender.addEventListener(function(sc,t){_this._poseRender.fire(Cesium.JulianDate.toDate(t))})),this._poseRender},enumerable:!0,configurable:!0}),Object.defineProperty(Scene.prototype,"underWater",{get:function(){return this._isUnderWater},set:function(enable){if(Cegore.TypeCheck.isDefined(this._UnderWaterMaterial)||(this._UnderWaterMaterial=new Cesium.Material({fabric:{type:"GlobeFog",uniforms:{fogColor:new Cesium.Color.fromBytes(44,59,103)},source:Scene._GlobeFog},translucent:function(material){return!1}})),enable){this._czScene.globe.material=this._UnderWaterMaterial;var globeps=Cesium._shaders.GlobeFS,pos=globeps.indexOf("czm_material material = czm_getMaterial(materialInput);\n");globeps=globeps.substr(0,pos)+"materialInput.positionToEyeEC = v_positionEC;\n"+globeps.substr(pos),this._czScene.globe._surfaceShaderSet.baseFragmentShaderSource.sources[1]=globeps}else this._czScene.globe.material=void 0;this.enableFog=!enable,this._isUnderWater=enable},enumerable:!0,configurable:!0}),Scene.prototype.pick=function(v0,v1){var pt=Scene.asCartesian2(v0,v1),pickObj=this._czScene.pick(pt);if(Cegore.TypeCheck.isDefined(pickObj)){var id=Cegore.TypeCheck.defaultValue(pickObj.id,pickObj.primitive.id);return id instanceof Cesium.Entity&&id._zMapRenderable instanceof Cegore.Renderable?id._zMapRenderable:void 0}},Scene.prototype.pickMulti=function(v0,v1,max){var picks=[],pt=Scene.asCartesian2(v0,v1),objs=this._czScene.pick(pt);if(!Cegore.TypeCheck.isArray(objs))return picks;for(var i=0;i<objs.length;++i){objs[i];var id=Cegore.TypeCheck.defaultValue(objs.id,objs.primitive.id);id instanceof Cesium.Entity&&id._zMapRenderable instanceof Cegore.Renderable&&picks.push(id._zMapRenderable)}return picks},Scene.prototype.pickPosition=function(v0,v1){var pos2d=Scene.asCartesian2(v0,v1),pos3d=this._czScene.pickPosition(pos2d),posgeo=Cesium.Cartographic.fromCartesian(pos3d);return new Cegore.Position(posgeo)},Scene.prototype.calcDistance=function(pts){return Cegore.GeoMath.surfaceDistance(pts,this._czData.ellipsoid.x)},Scene.prototype.calcArea=function(pts){return Cegore.GeoMath.surfaceArea(pts,this._czData.ellipsoid.x)},Scene.asCartesian2=function(p1,p2){if(Cegore.TypeCheck.isInstanceOf(p1,Cesium.Cartesian2))return p1;var x,y;switch(Cegore.TypeCheck.typeOf(p1)){case"number":Cegore.TypeCheck.isNumber(p2)&&(x=p1,y=p2);break;case"array":x=Cegore.StringUtil.parseFloat(p1[0]),y=Cegore.StringUtil.parseFloat(p1[1]);break;case"object":x=Cegore.StringUtil.parseFloat(p1.x),y=Cegore.StringUtil.parseFloat(p1.y)}if(!Cegore.TypeCheck.isDefined(x)||!Cegore.TypeCheck.isDefined(y)||isNaN(x)||isNaN(y))throw"error params!";return new Cesium.Cartesian2(x,y)},Scene._GlobeFog="        uniform vec4 fogColor;\n        czm_material czm_getMaterial(czm_materialInput materialInput)\n        {\n            czm_material material = czm_getDefaultMaterial(materialInput);\n            float distanceToCamera = length(materialInput.positionToEyeEC);\n            float scalar = distanceToCamera * 0.00005;\n            float fog = 1.0 - exp(-(scalar * scalar));\n            material.diffuse = fogColor.rgb;\n            material.alpha = fog;\n            return material;\n        }\n",Scene}();Cegore.Scene=Scene}(Cegore||(Cegore={})),function(Cegore){var CesiumData=function(){function CesiumData(viewer){this.mViewer=viewer}return Object.defineProperty(CesiumData.prototype,"viewer",{get:function(){return this.mViewer},enumerable:!0,configurable:!0}),Object.defineProperty(CesiumData.prototype,"scene",{get:function(){return this.mViewer.scene},enumerable:!0,configurable:!0}),Object.defineProperty(CesiumData.prototype,"camera",{get:function(){return this.mViewer.camera},enumerable:!0,configurable:!0}),Object.defineProperty(CesiumData.prototype,"globe",{get:function(){return this.mViewer.scene.globe},enumerable:!0,configurable:!0}),Object.defineProperty(CesiumData.prototype,"ellipsoid",{get:function(){return this.mViewer.scene.globe.ellipsoid},enumerable:!0,configurable:!0}),CesiumData}(),Viewer=function(){function Viewer(container,options){options||(options={});var defOptions=options.czops||{};defOptions.animation=!1,defOptions.baseLayerPicker=!1,defOptions.homeButton=!1,defOptions.geocoder=!1,defOptions.navigationHelpButton=!1,defOptions.imageryProvider=!1,defOptions.timeline=!1,defOptions.sceneModePicker=!1,defOptions.selectionIndicator=!1,defOptions.infoBox=!1,defOptions.sceneMode=Cegore.TypeCheck.defaultValue(options.sceneMode,Cesium.SceneMode.SCENE3D),defOptions.fullscreenButton=Cegore.TypeCheck.defaultValue(options.fullscreenButton,!0),defOptions.fullscreenElement=Cegore.TypeCheck.defaultValue(options.fullscreenElement,container);var czviewer=new Cesium.Viewer(container,defOptions);czviewer._cesiumWidget._creditContainer.style.display="none",this._czData=new CesiumData(czviewer),this._camera=new Cegore.Camera(this),this._clock=new Cegore.Clock(this),this._scene=new Cegore.Scene(this);var ctrl=czviewer.scene.screenSpaceCameraController;if(ctrl.tiltEventTypes=[Cesium.CameraEventType.RIGHT_DRAG,Cesium.CameraEventType.PINCH],ctrl.zoomEventTypes=[Cesium.CameraEventType.WHEEL,Cesium.CameraEventType.PINCH,{eventType:Cesium.CameraEventType.LEFT_DRAG,modifier:Cesium.KeyboardEventModifier.CTRL}],Cegore.TypeCheck.isObject(options.terrain)&&this.globe.setTerrain(options.terrain),Cegore.TypeCheck.isArray(options.images))for(var i=0;i<options.images.length;++i)this.globe.images.add(options.images[i]);Cegore.TypeCheck.isDefined(options.currentTime)&&(this._clock.currentTime=options.currentTime)}return Object.defineProperty(Viewer,"version",{get:function(){return"1.1.0"},enumerable:!0,configurable:!0}),Object.defineProperty(Viewer.prototype,"_czdata",{get:function(){return this._czData},enumerable:!0,configurable:!0}),Object.defineProperty(Viewer.prototype,"camera",{get:function(){return this._camera},enumerable:!0,configurable:!0}),Object.defineProperty(Viewer.prototype,"scene",{get:function(){return this._scene},enumerable:!0,configurable:!0}),Object.defineProperty(Viewer.prototype,"models",{get:function(){return this._scene.models},enumerable:!0,configurable:!0}),Object.defineProperty(Viewer.prototype,"labels",{get:function(){return this._scene.labels},enumerable:!0,configurable:!0}),Object.defineProperty(Viewer.prototype,"globe",{get:function(){return this._scene.globe},enumerable:!0,configurable:!0}),Object.defineProperty(Viewer.prototype,"images",{get:function(){return this.globe.images},enumerable:!0,configurable:!0}),Object.defineProperty(Viewer.prototype,"clock",{get:function(){return this._clock},enumerable:!0,configurable:!0}),Object.defineProperty(Viewer.prototype,"canvas",{get:function(){return this._czData.viewer.canvas},enumerable:!0,configurable:!0}),Viewer.getBaseUrlFromScript=function(){for(var scripts=document.getElementsByTagName("script"),i=0,len=scripts.length;i<len;++i){var src=scripts[i].getAttribute("src"),result=Viewer.cesiumScriptRegex.exec(src);if(null!==result)return result[1]}},Viewer.cesiumScriptRegex=/((?:.*\/)|^)depmain[\w-]*\.js(?:\W|$)/i,Viewer}();Cegore.Viewer=Viewer,CESIUM_BASE_URL=Viewer.getBaseUrlFromScript()}(Cegore||(Cegore={})),function(Cegore){var AbstractImageProvider=function(){function AbstractImageProvider(){this._readyPromise=Cesium.when.resolve(!0),this._tileWidth=256,this._tileHeight=256,this._minimumLevel=0,this._maximumLevel=18,this._errorEvent=new Cesium.Event,this._hasAlphaChannel=!1}return Object.defineProperty(AbstractImageProvider.prototype,"ready",{get:function(){return this._ready},enumerable:!0,configurable:!0}),Object.defineProperty(AbstractImageProvider.prototype,"readyPromise",{get:function(){return this._readyPromise},enumerable:!0,configurable:!0}),Object.defineProperty(AbstractImageProvider.prototype,"rectangle",{get:function(){return Cegore.TypeCheck.isDefined(this._rectangle)||(this._rectangle=Cesium.Rectangle.MAX_VALUE),this._rectangle},enumerable:!0,configurable:!0}),Object.defineProperty(AbstractImageProvider.prototype,"tileWidth",{get:function(){return this._tileWidth},enumerable:!0,configurable:!0}),Object.defineProperty(AbstractImageProvider.prototype,"tileHeight",{get:function(){return this._tileHeight},enumerable:!0,configurable:!0}),Object.defineProperty(AbstractImageProvider.prototype,"minimumLevel",{get:function(){return this._minimumLevel},enumerable:!0,configurable:!0}),Object.defineProperty(AbstractImageProvider.prototype,"maximumLevel",{get:function(){return this._maximumLevel},enumerable:!0,configurable:!0}),Object.defineProperty(AbstractImageProvider.prototype,"tilingScheme",{get:function(){return Cegore.TypeCheck.isDefined(this._tilingScheme)||(this._tilingScheme=new Cesium.GeographicTilingScheme),this._tilingScheme},enumerable:!0,configurable:!0}),Object.defineProperty(AbstractImageProvider.prototype,"tileDiscardPolicy",{get:function(){return this._tileDiscardPolicy},enumerable:!0,configurable:!0}),Object.defineProperty(AbstractImageProvider.prototype,"errorEvent",{get:function(){return this._errorEvent},enumerable:!0,configurable:!0}),Object.defineProperty(AbstractImageProvider.prototype,"credit",{get:function(){return this._credit},enumerable:!0,configurable:!0}),Object.defineProperty(AbstractImageProvider.prototype,"proxy",{get:function(){return this._proxy},enumerable:!0,configurable:!0}),Object.defineProperty(AbstractImageProvider.prototype,"hasAlphaChannel",{get:function(){return this._hasAlphaChannel},enumerable:!0,configurable:!0}),AbstractImageProvider.prototype.getTileCredits=function(x,y,level){},AbstractImageProvider.prototype.pickFeatures=function(x,y,level,longitude,latitude){},AbstractImageProvider}();Cegore.AbstractImageProvider=AbstractImageProvider}(Cegore||(Cegore={})),function(Cegore){Cegore.Providers.ImageProviders.regFactory("ArcGisMapServer",{createProvider:function(options){return new Cesium.ArcGisMapServerImageryProvider(options)}}),Cegore.Providers.ImageProviders.regFactory("BingMaps",{createProvider:function(options){return new Cesium.BingMapsImageryProvider(options)}}),Cegore.Providers.ImageProviders.regFactory("Grid",{createProvider:function(options){return new Cesium.GridImageryProvider(options)}}),Cegore.Providers.ImageProviders.regFactory("Mapbox",{createProvider:function(options){return new Cesium.MapboxImageryProvider(options)}}),Cegore.Providers.ImageProviders.regFactory("SingleTile",{createProvider:function(options){return new Cesium.SingleTileImageryProvider(options)}}),Cegore.Providers.ImageProviders.regFactory("WMS",{createProvider:function(options){return new Cesium.WebMapServiceImageryProvider(options)}}),Cegore.Providers.ImageProviders.regFactory("WMTS",{createProvider:function(options){return new Cesium.WebMapTileServiceImageryProvider(options)}}),Cegore.Providers.ImageProviders.regFactory("UrlTemplate",{createProvider:function(options){return new Cesium.UrlTemplateImageryProvider(options)}}),Cegore.Providers.ImageProviders.regFactory("TileCoordinates",{createProvider:function(options){return new Cesium.TileCoordinatesImageryProvider(options)}})}(Cegore||(Cegore={})),function(Cegore){var ZMapImageProvider=function(){function ZMapImageProvider(opt){this.getTileCredits=function(x,y,level){},this.requestImage=function(x,y,level){if(!this._ready)throw new Cesium.DeveloperError("requestImage must not be called before the imagery provider is ready.");var url=ZMapImageProvider.buildImageUrl(this,x,y,level);return Cesium.ImageryProvider.loadImage(this,url)};var defaultCredit=new Cesium.Credit("WMTS");opt=Cesium.defaultValue(opt,{});var url=Cesium.defaultValue(opt.url,"http://localhost:88/wmts");/\/$/.test(url),this._url=url,-1==this._url.indexOf("?")&&(Cegore.StringUtil.endsWidth(this._url,"/tile/map",!0)||(this._url+="/tile/map"),this._url+="?"),this._url+="&origin=left|top",this._proxy=opt.proxy,this._tileDiscardPolicy=opt.tileDiscardPolicy,this._scheme=Cesium.defaultValue(opt.scheme,"Geographic"),"WebMercator"===this._scheme?this._tilingScheme=new Cesium.WebMercatorTilingScheme({ellipsoid:opt.ellipsoid}):this._scheme.endsWith("level-0")?this._tilingScheme=new Cesium.GeographicTilingScheme({ellipsoid:opt.ellipsoid}):this._tilingScheme=new Cesium.GeographicTilingScheme({ellipsoid:opt.ellipsoid,numberOfLevelZeroTilesX:8,numberOfLevelZeroTilesY:4}),this._tileWidth=256,this._tileHeight=256,this._minimumLevel=Cesium.defaultValue(opt.minimumLevel,0),this._maximumLevel=Cesium.defaultValue(opt.maximumLevel,18),this._extent=Cesium.defaultValue(opt.extent,this._tilingScheme.extent),this._rectangle=Cesium.defaultValue(opt.rectangle,this._tilingScheme.rectangle),this._errorEvent=new Cesium.Event,this._ready=!0;var credit=Cesium.defaultValue(opt.credit,defaultCredit);"string"==typeof credit&&(credit=new Cesium.Credit(credit)),this._credit=credit}return Object.defineProperty(ZMapImageProvider.prototype,"url",{get:function(){return this._url},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapImageProvider.prototype,"hasAlphaChannel",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapImageProvider.prototype,"proxy",{get:function(){return this._proxy},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapImageProvider.prototype,"tileWidth",{get:function(){return this._tileWidth},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapImageProvider.prototype,"tileHeight",{get:function(){return this._tileHeight},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapImageProvider.prototype,"maximumLevel",{get:function(){return this._maximumLevel},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapImageProvider.prototype,"minimumLevel",{get:function(){return this._minimumLevel},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapImageProvider.prototype,"tilingScheme",{get:function(){return this._tilingScheme},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapImageProvider.prototype,"extent",{get:function(){return this._extent},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapImageProvider.prototype,"rectangle",{get:function(){return this._rectangle},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapImageProvider.prototype,"ileDiscardPolicy",{get:function(){return this._tileDiscardPolicy},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapImageProvider.prototype,"errorEvent",{get:function(){return this._errorEvent},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapImageProvider.prototype,"ready",{get:function(){return this._ready},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapImageProvider.prototype,"credit",{get:function(){return this._credit},enumerable:!0,configurable:!0}),ZMapImageProvider.buildImageUrl=function(provider,x,y,level){var proxy=provider._proxy;"WebMercator"!==provider._scheme&&(provider._scheme.endsWith("level-0")?level+=1:level=level);var url=provider._url+"&id="+level+","+y+","+x;return Cesium.defined(proxy)&&(url=proxy.getURL(url)),url},ZMapImageProvider}(),ZMapImageProviderFactory=function(){function ZMapImageProviderFactory(){}return ZMapImageProviderFactory.prototype.createProvider=function(options){return new ZMapImageProvider(options)},ZMapImageProviderFactory}();Cegore.Providers.ImageProviders.regFactory("ZMapImage",new ZMapImageProviderFactory)}(Cegore||(Cegore={})),function(Cegore){var ZMapDemImageProvider=function(){function ZMapDemImageProvider(opt){this.getTileCredits=function(x,y,level){},this.requestImage=function(x,y,level){if(!this._ready)throw new Cesium.DeveloperError("requestImage must not be called before the imagery provider is ready.");var url=this.buildImageUrl(this,x,y,level);return Cesium.ImageryProvider.loadImage(this,url)};var defaultCredit=new Cesium.Credit("WMTS");opt=Cegore.TypeCheck.defaultValue(opt,{});var url=Cesium.defaultValue(opt.url,"http://localhost:88/wmts");/\/$/.test(url),this._url=url,-1==this._url.indexOf("?")&&(Cegore.StringUtil.endsWidth(this._url,"/tile/dem",!0)||(this._url+="/tile/dem"),this._url+="?"),this._url+="&origin=left|top",this._proxy=opt.proxy,this._scheme=Cesium.defaultValue(opt.scheme,"Geographic"),"WebMercator"===this._scheme?this._tilingScheme=new Cesium.WebMercatorTilingScheme({ellipsoid:opt.ellipsoid}):this._scheme.endsWith("level-0")?this._tilingScheme=new Cesium.GeographicTilingScheme({ellipsoid:opt.ellipsoid}):this._tilingScheme=new Cesium.GeographicTilingScheme({ellipsoid:opt.ellipsoid,numberOfLevelZeroTilesX:8,numberOfLevelZeroTilesY:4}),this._tileWidth=Cegore.TypeCheck.defaultValue(opt.tileWidth,128),this._tileHeight=Cegore.TypeCheck.defaultValue(opt.tileHeight,128),this._minVal=Cegore.TypeCheck.defaultValue(opt.minVal,0),this._maxVal=Cegore.TypeCheck.defaultValue(opt.maxVal,1e3),this._minimumLevel=Cesium.defaultValue(opt.minimumLevel,0),this._maximumLevel=Cesium.defaultValue(opt.maximumLevel,18),this._extent=Cesium.defaultValue(opt.extent,this._tilingScheme.extent),this._rectangle=Cesium.defaultValue(opt.rectangle,this._tilingScheme.rectangle),this._errorEvent=new Cesium.Event,this._ready=!0;var credit=Cesium.defaultValue(opt.credit,defaultCredit);"string"==typeof credit&&(credit=new Cesium.Credit(credit)),this._credit=credit}return Object.defineProperty(ZMapDemImageProvider.prototype,"url",{get:function(){return this._url},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapDemImageProvider.prototype,"hasAlphaChannel",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapDemImageProvider.prototype,"proxy",{get:function(){return this._proxy},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapDemImageProvider.prototype,"tileWidth",{get:function(){return this._tileWidth},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapDemImageProvider.prototype,"tileHeight",{get:function(){return this._tileHeight},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapDemImageProvider.prototype,"maximumLevel",{get:function(){return this._maximumLevel},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapDemImageProvider.prototype,"minimumLevel",{get:function(){return this._minimumLevel},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapDemImageProvider.prototype,"tilingScheme",{get:function(){return this._tilingScheme},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapDemImageProvider.prototype,"extent",{get:function(){return this._extent},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapDemImageProvider.prototype,"rectangle",{get:function(){return this._rectangle},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapDemImageProvider.prototype,"ileDiscardPolicy",{get:function(){},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapDemImageProvider.prototype,"errorEvent",{get:function(){return this._errorEvent},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapDemImageProvider.prototype,"ready",{get:function(){return this._ready},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapDemImageProvider.prototype,"credit",{get:function(){return this._credit},enumerable:!0,configurable:!0}),ZMapDemImageProvider.prototype.buildImageUrl=function(provider,x,y,level){provider._proxy;"WebMercator"!==provider._scheme&&(provider._scheme.endsWith("level-0")?level+=1:level=level);var rectangle=this._tilingScheme.tileXYToRectangle(x,y,level),bbox=(rectangle.east,rectangle.west,this._tileWidth,rectangle.north,rectangle.south,this._tileHeight,[Cesium.Math.toDegrees(rectangle.west),Cesium.Math.toDegrees(rectangle.south),Cesium.Math.toDegrees(rectangle.east),Cesium.Math.toDegrees(rectangle.north)]),url=this._url;return url+="&id="+level+","+y+","+x,url+="&size="+this._tileWidth+"%2C"+this._tileHeight,url+="&range="+bbox.join(","),url+="&style=image&min="+this._minVal+"&max="+this._maxVal},ZMapDemImageProvider}(),ZMapImageProviderFactory=function(){function ZMapImageProviderFactory(){}return ZMapImageProviderFactory.prototype.createProvider=function(options){return new ZMapDemImageProvider(options)},ZMapImageProviderFactory}();Cegore.Providers.ImageProviders.regFactory("ZMapDemImage",new ZMapImageProviderFactory)}(Cegore||(Cegore={})),function(Cegore){var ZMapTerrainProvider=function(){function ZMapTerrainProvider(options){this._tileWidth=65,this._tileHeight=65,this._heightOffset=0,this._url=options.url,-1==this._url.indexOf("?")&&(Cegore.StringUtil.endsWidth(this._url,"/tile/dem",!0)||(this._url+="/tile/dem"),this._url+="?"),this._url+="&origin=left|top",this._token=options.token,this._waterMask=Cegore.TypeCheck.defaultValue(options.waterMask,!1),this._waterHeight=Cegore.TypeCheck.defaultValue(options.waterHeight,0),this._tileWidth=Cegore.TypeCheck.defaultValue(options.tileWidth,20),this._tileHeight=Cegore.TypeCheck.defaultValue(options.tileHeight,20),this._heightOffset=Cegore.TypeCheck.defaultValue(options.heightOffset,0),this._tilingScheme=options.tilingScheme,Cesium.defined(this._tilingScheme)||(this._tilingScheme=new Cesium.GeographicTilingScheme({ellipsoid:Cesium.defaultValue(options.ellipsoid,Cesium.Ellipsoid.WGS84)})),this._levelZeroMaximumGeometricError=Cesium.TerrainProvider.getEstimatedLevelZeroGeometricErrorForAHeightmap(this._tilingScheme.ellipsoid,this._tileWidth,this._tilingScheme.getNumberOfXTilesAtLevel(0)),this._proxy=options.proxy,this._dataStruct={heightScale:1,heightOffset:this._heightOffset,elementsPerHeight:1,stride:1,elementMultiplier:256,isBigEndian:!1},this._errorEvent=new Cesium.Event;var credit=options.credit;"string"==typeof credit&&(credit=new Cesium.Credit(credit)),this._credit=credit,this._readyPromise=Cesium.when.resolve(!0)}return Object.defineProperty(ZMapTerrainProvider.prototype,"errorEvent",{get:function(){return this._errorEvent},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapTerrainProvider.prototype,"credit",{get:function(){return this._credit},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapTerrainProvider.prototype,"tilingScheme",{get:function(){return this._tilingScheme},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapTerrainProvider.prototype,"ready",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapTerrainProvider.prototype,"readyPromise",{get:function(){return this._readyPromise},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapTerrainProvider.prototype,"hasWaterMask",{get:function(){return this._waterMask},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapTerrainProvider.prototype,"hasVertexNormals",{get:function(){return!1},enumerable:!0,configurable:!0}),ZMapTerrainProvider.prototype.requestTileGeometry=function(x,y,level,request){var _this=this,rectangle=this._tilingScheme.tileXYToRectangle(x,y,level),bbox=(rectangle.east,rectangle.west,this._tileWidth,rectangle.north,rectangle.south,this._tileHeight,[Cesium.Math.toDegrees(rectangle.west),Cesium.Math.toDegrees(rectangle.south),Cesium.Math.toDegrees(rectangle.east),Cesium.Math.toDegrees(rectangle.north)]),url=this._url;url+="&id="+level+","+y+","+x,url+="&size="+this._tileWidth+"%2C"+this._tileHeight,url+="&range="+bbox.join(",");var proxy=this._proxy;Cesium.defined(proxy)&&(url=proxy.getURL(url));var promise=Cesium.Resource.fetchArrayBuffer(url,void 0,request);if(Cesium.defined(promise))return Cesium.when(promise,function(image){var water,buffer,length=_this._tileWidth*_this._tileHeight,byteNum=8*length;if(buffer=new Float32Array(length),_this._waterMask&&(water=new Uint8Array(length)),image.byteLength!=byteNum);else for(var data=new Float64Array(image),i=0;i<length;++i)buffer[i]=data[i],data[i]<=-1e10&&(buffer[i]=0),_this._waterMask&&(buffer[i]<_this._waterHeight?water[i]=255:water[i]=0);return new Cesium.HeightmapTerrainData({buffer:buffer,width:_this._tileWidth,height:_this._tileWidth,childTileMask:15,waterMask:water,structure:_this._dataStruct})})},ZMapTerrainProvider.prototype.getLevelMaximumGeometricError=function(level){return this._levelZeroMaximumGeometricError/(1<<level)},ZMapTerrainProvider.prototype.getTileDataAvailable=function(x,y,level){},ZMapTerrainProvider}(),ZMapTerrainProviderFactory=function(){function ZMapTerrainProviderFactory(){}return ZMapTerrainProviderFactory.prototype.createProvider=function(options){return new ZMapTerrainProvider(options)},ZMapTerrainProviderFactory}();Cegore.Providers.TerrainProviders.regFactory("ZMapTerrain",new ZMapTerrainProviderFactory)}(Cegore||(Cegore={})),function(Cegore){var HeatmapImageProvider=function(_super){function HeatmapImageProvider(options){var _this=_super.call(this)||this;return _this._weightScale=1,_this._shadow=250,options=Cesium.defaultValue(options,Cesium.defaultValue.EMPTY_OBJECT),_this._xfield=options.xField,_this._yfield=options.yField,_this._weightField=options.weightField,_this._weightScale=Cesium.defaultValue(options.weightScale,1),_this._weightCalc=options.weightCalc,_this._tilingScheme=new Cesium.GeographicTilingScheme,_this._minimumLevel=Cesium.defaultValue(options.minimumLevel,0),_this._maximumLevel=Cesium.defaultValue(options.maximumLevel,18),_this._hasAlphaChannel=!0,_this.initData(options.data),_this.setBlurRadius(options.blur,options.radius),_this.setGradient(options.gradient),_this}return __extends(HeatmapImageProvider,_super),HeatmapImageProvider.prototype.setBlurRadius=function(blur,radius){this._blur=Cegore.TypeCheck.defaultValue(blur,15),this._radius=Cegore.TypeCheck.defaultValue(radius,8),this._circleImage=this.createCircle()},HeatmapImageProvider.prototype.setGradient=function(gradient){this._gradient=Cegore.TypeCheck.defaultValue(gradient,HeatmapImageProvider.DEFAULT_GRADIENT),this._colorTable=this.createGradientColorTable(this._gradient)},HeatmapImageProvider.prototype.initData=function(data){this._data=[];for(var rect=new Cegore.Rectangle,i=0;i<data.length;++i){var o=data[i],v={x:this.xCoord(o),y:this.yCoord(o),v:this.value(o)};this._data.push(v),rect.merge(v.x,v.y)}this._rectangle=rect.toCZRectangle(),this._ready=!0},HeatmapImageProvider.fieldsValue=function(o,fields,def){for(var value=Cegore.TypeCheck.defaultValue(def,0),i=0;i<fields.length;++i){var f=fields[i];if(Cegore.TypeCheck.isDefined(f)&&(value=o[f],Cegore.TypeCheck.isDefined(value)))break}return Cegore.TypeCheck.isNumber(value)||(value=Cegore.StringUtil.parseFloat(value)),value},HeatmapImageProvider.prototype.xCoord=function(o){return HeatmapImageProvider.fieldsValue(o,[this._xfield,"x","X"])},HeatmapImageProvider.prototype.yCoord=function(o){return HeatmapImageProvider.fieldsValue(o,[this._yfield,"y","Y"])},HeatmapImageProvider.prototype.value=function(o){return Cegore.TypeCheck.isFunction(this._weightCalc)?this._weightCalc(o):HeatmapImageProvider.fieldsValue(o,[this._weightField,"value","Value","VALUE"])},HeatmapImageProvider.prototype.createGradientColorTable=function(colors){for(var context=Cegore.DOM.createContext2D(1,256),gradient=context.createLinearGradient(0,0,1,256),step=1/(colors.length-1),i=0,ii=colors.length;i<ii;++i)gradient.addColorStop(i*step,colors[i]);return context.fillStyle=gradient,context.fillRect(0,0,1,256),context.getImageData(0,0,1,256).data},HeatmapImageProvider.prototype.createCircle=function(){var radius=this._radius,blur=this._blur,halfSize=radius+blur+1,size=2*halfSize,context=Cegore.DOM.createContext2D(size,size);context.shadowOffsetX=context.shadowOffsetY=this._shadow,context.shadowBlur=blur,context.shadowColor="#000",context.beginPath();var center=halfSize-this._shadow;return context.arc(center,center,radius,0,2*Math.PI,!0),context.fill(),context.canvas},HeatmapImageProvider.prototype.requestImage=function(x,y,level){var ctx=Cegore.DOM.createContext2D(this.tileWidth,this.tileHeight),canvas=ctx.canvas,circle=this._circleImage,hw=circle.width/2,hh=circle.height/2,pos=new Cegore.Position,rect=new Cegore.Rectangle(this.tilingScheme.tileXYToRectangle(x,y,level)),gwidth=rect.width,gheight=rect.height,checkRect=rect.clone();checkRect.inflate(rect.width/2,rect.height/2);for(var i=0;i<this._data.length;++i){var o=this._data[i];if(pos.set(o.x,o.y),checkRect.contains(pos)){var ix=(o.x-rect.minx)/gwidth*canvas.width,iy=(rect.maxy-o.y)/gheight*canvas.height;ctx.globalAlpha=o.v*this._weightScale,ctx.drawImage(circle,ix-hw,iy-hh)}}for(var alpha,image=ctx.getImageData(0,0,canvas.width,canvas.height),view8=image.data,ii=(i=0,view8.length);i<ii;i+=4)(alpha=4*view8[i+3])&&(view8[i]=this._colorTable[alpha],view8[i+1]=this._colorTable[alpha+1],view8[i+2]=this._colorTable[alpha+2]);return ctx.putImageData(image,0,0),canvas},HeatmapImageProvider.DEFAULT_GRADIENT=["#00f","#0ff","#0f0","#ff0","#f00"],HeatmapImageProvider}(Cegore.AbstractImageProvider),HeatmapImageProviderFactory=function(){function HeatmapImageProviderFactory(){}return HeatmapImageProviderFactory.prototype.createProvider=function(options){return new HeatmapImageProvider(options)},HeatmapImageProviderFactory}();Cegore.Providers.ImageProviders.regFactory("Heatmap",new HeatmapImageProviderFactory)}(Cegore||(Cegore={})),function(Cegore){var ZMapModelLoader=function(){function ZMapModelLoader(){}return ZMapModelLoader.LoadModel=function(url,mg,item,options){var offset=new Cegore.Position(options.offset),pos=item.pos.split(",");pos[0]=parseFloat(pos[0])+offset.x,pos[1]=parseFloat(pos[1])+offset.y,pos[2]=parseFloat(pos[2])+offset.z,url=url+"/model?style=glb&id="+encodeURIComponent(item.model);var model=new Cegore.GltfModel({name:item.name,uri:url,position:pos,minPixelSize:10});mg.add(model)},ZMapModelLoader.LoadFromPubModel=function(name,url,options){var mg=new Cegore.ModelGroup({name:name});return Cegore.LoadWithXhr.loadJSON({url:url+"/model?filter=detail",success:function(data){for(var i=0;i<data.items.length;++i)ZMapModelLoader.LoadModel(url,mg,data.items[i],options)}}),mg},ZMapModelLoader}();Cegore.ZMapModelLoader=ZMapModelLoader}(Cegore||(Cegore={})),function(root,factory){"use strict";"function"==typeof define&&define.amd&&define([],factory),Cesium.viewerCesiumNavigationMixin=factory()}("undefined"!=typeof window?window:"undefined"!=typeof self&&self,function(){var requirejs,require,define,c,d,a,i,s;return function(undef){var main,req,makeMap,handlers,defined={},waiting={},config={},defining={},hasOwn=Object.prototype.hasOwnProperty,aps=[].slice,jsSuffixRegExp=/\.js$/;function hasProp(obj,prop){return hasOwn.call(obj,prop)}function normalize(name,baseName){var nameParts,nameSegment,mapValue,foundMap,lastIndex,foundI,foundStarMap,starI,i,j,part,baseParts=baseName&&baseName.split("/"),map=config.map,starMap=map&&map["*"]||{};if(name){for(lastIndex=(name=name.split("/")).length-1,config.nodeIdCompat&&jsSuffixRegExp.test(name[lastIndex])&&(name[lastIndex]=name[lastIndex].replace(jsSuffixRegExp,"")),"."===name[0].charAt(0)&&baseParts&&(name=baseParts.slice(0,baseParts.length-1).concat(name)),i=0;i<name.length;i++)if("."===(part=name[i]))name.splice(i,1),i-=1;else if(".."===part){if(0===i||1===i&&".."===name[2]||".."===name[i-1])continue;0<i&&(name.splice(i-1,2),i-=2)}name=name.join("/")}if((baseParts||starMap)&&map){for(i=(nameParts=name.split("/")).length;0<i;i-=1){if(nameSegment=nameParts.slice(0,i).join("/"),baseParts)for(j=baseParts.length;0<j;j-=1)if((mapValue=map[baseParts.slice(0,j).join("/")])&&(mapValue=mapValue[nameSegment])){foundMap=mapValue,foundI=i;break}if(foundMap)break;!foundStarMap&&starMap&&starMap[nameSegment]&&(foundStarMap=starMap[nameSegment],starI=i)}!foundMap&&foundStarMap&&(foundMap=foundStarMap,foundI=starI),foundMap&&(nameParts.splice(0,foundI,foundMap),name=nameParts.join("/"))}return name}function makeRequire(relName,forceSync){return function(){var args=aps.call(arguments,0);return"string"!=typeof args[0]&&1===args.length&&args.push(null),req.apply(void 0,args.concat([relName,forceSync]))}}function makeLoad(depName){return function(value){defined[depName]=value}}function callDep(name){if(hasProp(waiting,name)){var args=waiting[name];delete waiting[name],defining[name]=!0,main.apply(void 0,args)}if(!hasProp(defined,name)&&!hasProp(defining,name))throw new Error("No "+name);return defined[name]}function splitPrefix(name){var prefix,index=name?name.indexOf("!"):-1;return-1<index&&(prefix=name.substring(0,index),name=name.substring(index+1,name.length)),[prefix,name]}makeMap=function(name,relName){var plugin,parts=splitPrefix(name),prefix=parts[0];return name=parts[1],prefix&&(plugin=callDep(prefix=normalize(prefix,relName))),prefix?name=plugin&&plugin.normalize?plugin.normalize(name,function(relName){return function(name){return normalize(name,relName)}}(relName)):normalize(name,relName):(prefix=(parts=splitPrefix(name=normalize(name,relName)))[0],name=parts[1],prefix&&(plugin=callDep(prefix))),{f:prefix?prefix+"!"+name:name,n:name,pr:prefix,p:plugin}},handlers={require:function(name){return makeRequire(name)},exports:function(name){var e=defined[name];return void 0!==e?e:defined[name]={}},module:function(name){return{id:name,uri:"",exports:defined[name],config:function(name){return function(){return config&&config.config&&config.config[name]||{}}}(name)}}},main=function(name,deps,callback,relName){var cjsModule,depName,ret,map,i,usingExports,args=[],callbackType=typeof callback;if(relName=relName||name,"undefined"===callbackType||"function"===callbackType){for(deps=!deps.length&&callback.length?["require","exports","module"]:deps,i=0;i<deps.length;i+=1)if("require"===(depName=(map=makeMap(deps[i],relName)).f))args[i]=handlers.require(name);else if("exports"===depName)args[i]=handlers.exports(name),usingExports=!0;else if("module"===depName)cjsModule=args[i]=handlers.module(name);else if(hasProp(defined,depName)||hasProp(waiting,depName)||hasProp(defining,depName))args[i]=callDep(depName);else{if(!map.p)throw new Error(name+" missing "+depName);map.p.load(map.n,makeRequire(relName,!0),makeLoad(depName),{}),args[i]=defined[depName]}ret=callback?callback.apply(defined[name],args):void 0,name&&(cjsModule&&void 0!==cjsModule.exports&&cjsModule.exports!==defined[name]?defined[name]=cjsModule.exports:void 0===ret&&usingExports||(defined[name]=ret))}else name&&(defined[name]=callback)},requirejs=require=req=function(deps,callback,relName,forceSync,alt){if("string"==typeof deps)return handlers[deps]?handlers[deps](callback):callDep(makeMap(deps,callback).f);if(!deps.splice){if((config=deps).deps&&req(config.deps,config.callback),!callback)return;callback.splice?(deps=callback,callback=relName,relName=null):deps=void 0}return callback=callback||function(){},"function"==typeof relName&&(relName=forceSync,forceSync=alt),forceSync?main(void 0,deps,callback,relName):setTimeout(function(){main(void 0,deps,callback,relName)},4),req},req.config=function(cfg){return req(cfg)},requirejs._defined=defined,(define=function(name,deps,callback){if("string"!=typeof name)throw new Error("See almond README: incorrect module build, no module name");deps.splice||(callback=deps,deps=[]),hasProp(defined,name)||hasProp(waiting,name)||(waiting[name]=[name,deps,callback])}).amd={jQuery:!0}}(),define("almond",function(){}),function(n){var x=this||eval("this"),u=x.document,M=x.navigator,v=x.jQuery,F=x.JSON;!function(n){"function"==typeof define&&define.amd?define("knockout",["exports","require"],n):"object"==typeof exports&&"object"==typeof module?n(module.exports||exports):n(x.ko={})}(function(N,O){function J(a,c){return(null===a||typeof a in T)&&a===c}function U(b,c){var d;return function(){d||(d=a.a.setTimeout(function(){d=n,b()},c))}}function V(b,c){var d;return function(){clearTimeout(d),d=a.a.setTimeout(b,c)}}function W(a,c){c&&c!==I?"beforeChange"===c?this.Kb(a):this.Ha(a,c):this.Lb(a)}function X(a,c){null!==c&&c.k&&c.k()}function Y(a,c){var d=this.Hc,e=d[s];e.R||(this.lb&&this.Ma[c]?(d.Pb(c,a,this.Ma[c]),this.Ma[c]=null,--this.lb):e.r[c]||d.Pb(c,a,e.s?{ia:a}:d.uc(a)))}function K(b,c,d,e){a.d[b]={init:function(b,g,k,l,m){var h,r;return a.m(function(){var q=a.a.c(g()),p=!d!=!q,A=!r;(A||c||p!==h)&&(A&&a.va.Aa()&&(r=a.a.ua(a.f.childNodes(b),!0)),p?(A||a.f.da(b,a.a.ua(r)),a.eb(e?e(m,q):m,b)):a.f.xa(b),h=p)},null,{i:b}),{controlsDescendantBindings:!0}}},a.h.ta[b]=!1,a.f.Z[b]=!0}var b,c,d,e,f,g,a=void 0!==N?N:{};a.b=function(b,c){for(var d=b.split("."),e=a,f=0;f<d.length-1;f++)e=e[d[f]];e[d[d.length-1]]=c},a.G=function(a,c,d){a[c]=d},a.version="3.4.0",a.b("version",a.version),a.options={deferUpdates:!1,useOnlyNativeEvents:!1},a.a=function(){function b(a,b){for(var c in a)a.hasOwnProperty(c)&&b(c,a[c])}function c(a,b){if(b)for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function d(a,b){return a.__proto__=b,a}function e(b,c,d,e){var h=b[c].match(r)||[];a.a.q(d.match(r),function(b){a.a.pa(h,b,e)}),b[c]=h.join(" ")}var f={__proto__:[]}instanceof Array,g="function"==typeof Symbol,k={},l={};k[M&&/Firefox\/2/i.test(M.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"],k.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" "),b(k,function(a,b){if(b.length)for(var c=0,d=b.length;c<d;c++)l[b[c]]=a});var m={propertychange:!0},h=u&&function(){for(var a=3,b=u.createElement("div"),c=b.getElementsByTagName("i");b.innerHTML="\x3c!--[if gt IE "+ ++a+"]><i></i><![endif]--\x3e",c[0];);return 4<a?a:n}(),r=/\S+/g;return{cc:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],q:function(a,b){for(var c=0,d=a.length;c<d;c++)b(a[c],c)},o:function(a,b){if("function"==typeof Array.prototype.indexOf)return Array.prototype.indexOf.call(a,b);for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},Sb:function(a,b,c){for(var d=0,e=a.length;d<e;d++)if(b.call(c,a[d],d))return a[d];return null},La:function(b,c){var d=a.a.o(b,c);0<d?b.splice(d,1):0===d&&b.shift()},Tb:function(b){for(var c=[],d=0,e=(b=b||[]).length;d<e;d++)a.a.o(c,b[d])<0&&c.push(b[d]);return c},fb:function(a,b){for(var c=[],d=0,e=(a=a||[]).length;d<e;d++)c.push(b(a[d],d));return c},Ka:function(a,b){for(var c=[],d=0,e=(a=a||[]).length;d<e;d++)b(a[d],d)&&c.push(a[d]);return c},ra:function(a,b){if(b instanceof Array)a.push.apply(a,b);else for(var c=0,d=b.length;c<d;c++)a.push(b[c]);return a},pa:function(b,c,d){var e=a.a.o(a.a.zb(b),c);e<0?d&&b.push(c):d||b.splice(e,1)},ka:f,extend:c,Xa:d,Ya:f?d:c,D:b,Ca:function(a,b){if(!a)return a;var d,c={};for(d in a)a.hasOwnProperty(d)&&(c[d]=b(a[d],d,a));return c},ob:function(b){for(;b.firstChild;)a.removeNode(b.firstChild)},jc:function(b){for(var c=((b=a.a.V(b))[0]&&b[0].ownerDocument||u).createElement("div"),d=0,e=b.length;d<e;d++)c.appendChild(a.$(b[d]));return c},ua:function(b,c){for(var d=0,e=b.length,h=[];d<e;d++){var m=b[d].cloneNode(!0);h.push(c?a.$(m):m)}return h},da:function(b,c){if(a.a.ob(b),c)for(var d=0,e=c.length;d<e;d++)b.appendChild(c[d])},qc:function(b,c){var d=b.nodeType?[b]:b;if(0<d.length){for(var e=d[0],h=e.parentNode,m=0,l=c.length;m<l;m++)h.insertBefore(c[m],e);for(m=0,l=d.length;m<l;m++)a.removeNode(d[m])}},za:function(a,b){if(a.length){for(b=8===b.nodeType&&b.parentNode||b;a.length&&a[0].parentNode!==b;)a.splice(0,1);for(;1<a.length&&a[a.length-1].parentNode!==b;)a.length--;if(1<a.length){var c=a[0],d=a[a.length-1];for(a.length=0;c!==d;)a.push(c),c=c.nextSibling;a.push(d)}}return a},sc:function(a,b){h<7?a.setAttribute("selected",b):a.selected=b},$a:function(a){return null===a||a===n?"":a.trim?a.trim():a.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},nd:function(a,b){return a=a||"",!(b.length>a.length)&&a.substring(0,b.length)===b},Mc:function(a,b){if(a===b)return!0;if(11===a.nodeType)return!1;if(b.contains)return b.contains(3===a.nodeType?a.parentNode:a);if(b.compareDocumentPosition)return 16==(16&b.compareDocumentPosition(a));for(;a&&a!=b;)a=a.parentNode;return!!a},nb:function(b){return a.a.Mc(b,b.ownerDocument.documentElement)},Qb:function(b){return!!a.a.Sb(b,a.a.nb)},A:function(a){return a&&a.tagName&&a.tagName.toLowerCase()},Wb:function(b){return a.onError?function(){try{return b.apply(this,arguments)}catch(c){throw a.onError&&a.onError(c),c}}:b},setTimeout:function(b,c){return setTimeout(a.a.Wb(b),c)},$b:function(b){setTimeout(function(){throw a.onError&&a.onError(b),b},0)},p:function(b,c,d){var e=a.a.Wb(d);if(d=h&&m[c],a.options.useOnlyNativeEvents||d||!v)if(d||"function"!=typeof b.addEventListener){if(void 0===b.attachEvent)throw Error("Browser doesn't support addEventListener or attachEvent");var l=function(a){e.call(b,a)},f="on"+c;b.attachEvent(f,l),a.a.F.oa(b,function(){b.detachEvent(f,l)})}else b.addEventListener(c,e,!1);else v(b).bind(c,e)},Da:function(b,c){if(!b||!b.nodeType)throw Error("element must be a DOM node when calling triggerEvent");var d;if(d=!("input"!==a.a.A(b)||!b.type||"click"!=c.toLowerCase()||"checkbox"!=(d=b.type)&&"radio"!=d),a.options.useOnlyNativeEvents||!v||d)if("function"==typeof u.createEvent){if("function"!=typeof b.dispatchEvent)throw Error("The supplied element doesn't support dispatchEvent");(d=u.createEvent(l[c]||"HTMLEvents")).initEvent(c,!0,!0,x,0,0,0,0,0,!1,!1,!1,!1,0,b),b.dispatchEvent(d)}else if(d&&b.click)b.click();else{if(void 0===b.fireEvent)throw Error("Browser doesn't support triggering events");b.fireEvent("on"+c)}else v(b).trigger(c)},c:function(b){return a.H(b)?b():b},zb:function(b){return a.H(b)?b.t():b},bb:function(b,c,d){var h;c&&("object"==typeof b.classList?(h=b.classList[d?"add":"remove"],a.a.q(c.match(r),function(a){h.call(b.classList,a)})):"string"==typeof b.className.baseVal?e(b.className,"baseVal",c,d):e(b,"className",c,d))},Za:function(b,c){var d=a.a.c(c);null!==d&&d!==n||(d="");var e=a.f.firstChild(b);!e||3!=e.nodeType||a.f.nextSibling(e)?a.f.da(b,[b.ownerDocument.createTextNode(d)]):e.data=d,a.a.Rc(b)},rc:function(a,b){if(a.name=b,h<=7)try{a.mergeAttributes(u.createElement("<input name='"+a.name+"'/>"),!1)}catch(c){}},Rc:function(a){9<=h&&(a=1==a.nodeType?a:a.parentNode).style&&(a.style.zoom=a.style.zoom)},Nc:function(a){if(h){var b=a.style.width;a.style.width=0,a.style.width=b}},hd:function(b,c){b=a.a.c(b),c=a.a.c(c);for(var d=[],e=b;e<=c;e++)d.push(e);return d},V:function(a){for(var b=[],c=0,d=a.length;c<d;c++)b.push(a[c]);return b},Yb:function(a){return g?Symbol(a):a},rd:6===h,sd:7===h,C:h,ec:function(b,c){for(var d=a.a.V(b.getElementsByTagName("input")).concat(a.a.V(b.getElementsByTagName("textarea"))),e="string"==typeof c?function(a){return a.name===c}:function(a){return c.test(a.name)},h=[],m=d.length-1;0<=m;m--)e(d[m])&&h.push(d[m]);return h},ed:function(b){return"string"==typeof b&&(b=a.a.$a(b))?F&&F.parse?F.parse(b):new Function("return "+b)():null},Eb:function(b,c,d){if(!F||!F.stringify)throw Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return F.stringify(a.a.c(b),c,d)},fd:function(c,d,e){var h=(e=e||{}).params||{},m=e.includeFields||this.cc,l=c;if("object"==typeof c&&"form"===a.a.A(c)){l=c.action;for(var f=m.length-1;0<=f;f--)for(var g=a.a.ec(c,m[f]),k=g.length-1;0<=k;k--)h[g[k].name]=g[k].value}d=a.a.c(d);var r=u.createElement("form");for(var n in r.style.display="none",r.action=l,r.method="post",d)(c=u.createElement("input")).type="hidden",c.name=n,c.value=a.a.Eb(a.a.c(d[n])),r.appendChild(c);b(h,function(a,b){var c=u.createElement("input");c.type="hidden",c.name=a,c.value=b,r.appendChild(c)}),u.body.appendChild(r),e.submitter?e.submitter(r):r.submit(),setTimeout(function(){r.parentNode.removeChild(r)},0)}}}(),a.b("utils",a.a),a.b("utils.arrayForEach",a.a.q),a.b("utils.arrayFirst",a.a.Sb),a.b("utils.arrayFilter",a.a.Ka),a.b("utils.arrayGetDistinctValues",a.a.Tb),a.b("utils.arrayIndexOf",a.a.o),a.b("utils.arrayMap",a.a.fb),a.b("utils.arrayPushAll",a.a.ra),a.b("utils.arrayRemoveItem",a.a.La),a.b("utils.extend",a.a.extend),a.b("utils.fieldsIncludedWithJsonPost",a.a.cc),a.b("utils.getFormFields",a.a.ec),a.b("utils.peekObservable",a.a.zb),a.b("utils.postJson",a.a.fd),a.b("utils.parseJson",a.a.ed),a.b("utils.registerEventHandler",a.a.p),a.b("utils.stringifyJson",a.a.Eb),a.b("utils.range",a.a.hd),a.b("utils.toggleDomNodeCssClass",a.a.bb),a.b("utils.triggerEvent",a.a.Da),a.b("utils.unwrapObservable",a.a.c),a.b("utils.objectForEach",a.a.D),a.b("utils.addOrRemoveItem",a.a.pa),a.b("utils.setTextContent",a.a.Za),a.b("unwrap",a.a.c),Function.prototype.bind||(Function.prototype.bind=function(a){var c=this;if(1===arguments.length)return function(){return c.apply(a,arguments)};var d=Array.prototype.slice.call(arguments,1);return function(){var e=d.slice(0);return e.push.apply(e,arguments),c.apply(a,e)}}),a.a.e=new function(){function a(b,g){var k=b[d];if(!k||"null"===k||!e[k]){if(!g)return n;k=b[d]="ko"+c++,e[k]={}}return e[k]}var c=0,d="__ko__"+(new Date).getTime(),e={};return{get:function(c,d){var e=a(c,!1);return e===n?n:e[d]},set:function(c,d,e){e===n&&a(c,!1)===n||(a(c,!0)[d]=e)},clear:function(a){var b=a[d];return!(!b||(delete e[b],a[d]=null))},I:function(){return c+++d}}},a.b("utils.domData",a.a.e),a.b("utils.domData.clear",a.a.e.clear),a.a.F=new function(){function b(b,c){var e=a.a.e.get(b,d);return e===n&&c&&(e=[],a.a.e.set(b,d,e)),e}function c(d){if(e=b(d,!1))for(var e=e.slice(0),l=0;l<e.length;l++)e[l](d);if(a.a.e.clear(d),a.a.F.cleanExternalData(d),f[d.nodeType])for(e=d.firstChild;d=e;)e=d.nextSibling,8===d.nodeType&&c(d)}var d=a.a.e.I(),e={1:!0,8:!0,9:!0},f={1:!0,9:!0};return{oa:function(a,c){if("function"!=typeof c)throw Error("Callback must be a function");b(a,!0).push(c)},pc:function(c,e){var l=b(c,!1);l&&(a.a.La(l,e),0==l.length&&a.a.e.set(c,d,n))},$:function(b){if(e[b.nodeType]&&(c(b),f[b.nodeType])){var d=[];a.a.ra(d,b.getElementsByTagName("*"));for(var l=0,m=d.length;l<m;l++)c(d[l])}return b},removeNode:function(b){a.$(b),b.parentNode&&b.parentNode.removeChild(b)},cleanExternalData:function(a){v&&"function"==typeof v.cleanData&&v.cleanData([a])}}},a.$=a.a.F.$,a.removeNode=a.a.F.removeNode,a.b("cleanNode",a.$),a.b("removeNode",a.removeNode),a.b("utils.domNodeDisposal",a.a.F),a.b("utils.domNodeDisposal.addDisposeCallback",a.a.F.oa),a.b("utils.domNodeDisposal.removeDisposeCallback",a.a.F.pc),b=[0,"",""],f={thead:c=[1,"<table>","</table>"],tbody:c,tfoot:c,tr:[2,"<table><tbody>","</tbody></table>"],td:d=[3,"<table><tbody><tr>","</tr></tbody></table>"],th:d,option:e=[1,"<select multiple='multiple'>","</select>"],optgroup:e},g=a.a.C<=8,a.a.ma=function(c,d){var e;if(v){if(v.parseHTML)e=v.parseHTML(c,d)||[];else if((e=v.clean([c],d))&&e[0]){for(var h=e[0];h.parentNode&&11!==h.parentNode.nodeType;)h=h.parentNode;h.parentNode&&h.parentNode.removeChild(h)}}else{(e=d)||(e=u),h=e.parentWindow||e.defaultView||x;var p,r=a.a.$a(c).toLowerCase(),q=e.createElement("div");for(r=(p=(r=r.match(/^<([a-z]+)[ >]/))&&f[r[1]]||b)[0],p="ignored<div>"+p[1]+c+p[2]+"</div>","function"==typeof h.innerShiv?q.appendChild(h.innerShiv(p)):(g&&e.appendChild(q),q.innerHTML=p,g&&q.parentNode.removeChild(q));r--;)q=q.lastChild;e=a.a.V(q.lastChild.childNodes)}return e},a.a.Cb=function(b,c){if(a.a.ob(b),null!==(c=a.a.c(c))&&c!==n)if("string"!=typeof c&&(c=c.toString()),v)v(b).html(c);else for(var d=a.a.ma(c,b.ownerDocument),e=0;e<d.length;e++)b.appendChild(d[e])},a.b("utils.parseHtmlFragment",a.a.ma),a.b("utils.setHtml",a.a.Cb),a.M=function(){var c={};return{wb:function(a){if("function"!=typeof a)throw Error("You can only pass a function to ko.memoization.memoize()");var b=(4294967296*(1+Math.random())|0).toString(16).substring(1)+(4294967296*(1+Math.random())|0).toString(16).substring(1);return c[b]=a,"\x3c!--[ko_memo:"+b+"]--\x3e"},xc:function(a,b){var f=c[a];if(f===n)throw Error("Couldn't find any memo with ID "+a+". Perhaps it's already been unmemoized.");try{return f.apply(null,b||[]),!0}finally{delete c[a]}},yc:function(c,e){var f=[];!function b(c,e){if(c)if(8==c.nodeType)null!=(f=a.M.lc(c.nodeValue))&&e.push({Lc:c,cd:f});else if(1==c.nodeType)for(var f=0,g=c.childNodes,k=g.length;f<k;f++)b(g[f],e)}(c,f);for(var g=0,k=f.length;g<k;g++){var l=f[g].Lc,m=[l];e&&a.a.ra(m,e),a.M.xc(f[g].cd,m),l.nodeValue="",l.parentNode&&l.parentNode.removeChild(l)}},lc:function(a){return(a=a.match(/^\[ko_memo\:(.*?)\]$/))?a[1]:null}}}(),a.b("memoization",a.M),a.b("memoization.memoize",a.M.wb),a.b("memoization.unmemoize",a.M.xc),a.b("memoization.parseMemoText",a.M.lc),a.b("memoization.unmemoizeDomNodeAndDescendants",a.M.yc),a.Y=function(){function b(){if(e)for(var m,b=e,c=0;g<e;)if(m=d[g++]){if(b<g){if(5e3<=++c){g=e,a.a.$b(Error("'Too much recursion' after processing "+c+" task groups."));break}b=e}try{m()}catch(h){a.a.$b(h)}}}function c(){b(),g=e=d.length=0}var d=[],e=0,f=1,g=0;return{scheduler:x.MutationObserver?function(a){var b=u.createElement("div");return new MutationObserver(a).observe(b,{attributes:!0}),function(){b.classList.toggle("foo")}}(c):u&&"onreadystatechange"in u.createElement("script")?function(a){var b=u.createElement("script");b.onreadystatechange=function(){b.onreadystatechange=null,u.documentElement.removeChild(b),b=null,a()},u.documentElement.appendChild(b)}:function(a){setTimeout(a,0)},Wa:function(b){return e||a.Y.scheduler(c),d[e++]=b,f++},cancel:function(a){g<=(a-=f-e)&&a<e&&(d[a]=null)},resetForTesting:function(){var a=e-g;return g=e=d.length=0,a},md:b}}(),a.b("tasks",a.Y),a.b("tasks.schedule",a.Y.Wa),a.b("tasks.runEarly",a.Y.md),a.ya={throttle:function(b,c){b.throttleEvaluation=c;var d=null;return a.B({read:b,write:function(e){clearTimeout(d),d=a.a.setTimeout(function(){b(e)},c)}})},rateLimit:function(a,c){var d,e,f;"number"==typeof c?d=c:(d=c.timeout,e=c.method),a.cb=!1,f="notifyWhenChangesStop"==e?V:U,a.Ta(function(a){return f(a,d)})},deferred:function(b,c){if(!0!==c)throw Error("The 'deferred' extender only accepts the value 'true', because it is not supported to turn deferral off once enabled.");b.cb||(b.cb=!0,b.Ta(function(c){var e;return function(){a.Y.cancel(e),e=a.Y.Wa(c),b.notifySubscribers(n,"dirty")}}))},notify:function(a,c){a.equalityComparer="always"==c?null:J}};var T={undefined:1,boolean:1,number:1,string:1};a.b("extenders",a.ya),a.vc=function(b,c,d){this.ia=b,this.gb=c,this.Kc=d,this.R=!1,a.G(this,"dispose",this.k)},a.vc.prototype.k=function(){this.R=!0,this.Kc()},a.J=function(){a.a.Ya(this,D),D.rb(this)};var I="change",D={rb:function(a){a.K={},a.Nb=1},X:function(b,c,d){var e=this;d=d||I;var f=new a.vc(e,c?b.bind(c):b,function(){a.a.La(e.K[d],f),e.Ia&&e.Ia(d)});return e.sa&&e.sa(d),e.K[d]||(e.K[d]=[]),e.K[d].push(f),f},notifySubscribers:function(b,c){if((c=c||I)===I&&this.zc(),this.Pa(c))try{a.l.Ub();for(var f,d=this.K[c].slice(0),e=0;f=d[e];++e)f.R||f.gb(b)}finally{a.l.end()}},Na:function(){return this.Nb},Uc:function(a){return this.Na()!==a},zc:function(){++this.Nb},Ta:function(b){var e,f,g,c=this,d=a.H(c);c.Ha||(c.Ha=c.notifySubscribers,c.notifySubscribers=W);var k=b(function(){c.Mb=!1,d&&g===c&&(g=c()),e=!1,c.tb(f,g)&&c.Ha(f=g)});c.Lb=function(a){c.Mb=e=!0,g=a,k()},c.Kb=function(a){e||(f=a,c.Ha(a,"beforeChange"))}},Pa:function(a){return this.K[a]&&this.K[a].length},Sc:function(b){if(b)return this.K[b]&&this.K[b].length||0;var c=0;return a.a.D(this.K,function(a,b){"dirty"!==a&&(c+=b.length)}),c},tb:function(a,c){return!this.equalityComparer||!this.equalityComparer(a,c)},extend:function(b){var c=this;return b&&a.a.D(b,function(b,e){var f=a.ya[b];"function"==typeof f&&(c=f(c,e)||c)}),c}};a.G(D,"subscribe",D.X),a.G(D,"extend",D.extend),a.G(D,"getSubscriptionsCount",D.Sc),a.a.ka&&a.a.Xa(D,Function.prototype),a.J.fn=D,a.hc=function(a){return null!=a&&"function"==typeof a.X&&"function"==typeof a.notifySubscribers},a.b("subscribable",a.J),a.b("isSubscribable",a.hc),a.va=a.l=function(){function b(a){d.push(e),e=a}function c(){e=d.pop()}var e,d=[],f=0;return{Ub:b,end:c,oc:function(b){if(e){if(!a.hc(b))throw Error("Only subscribable things can act as dependencies");e.gb.call(e.Gc,b,b.Cc||(b.Cc=++f))}},w:function(a,d,e){try{return b(),a.apply(d,e||[])}finally{c()}},Aa:function(){if(e)return e.m.Aa()},Sa:function(){if(e)return e.Sa}}}(),a.b("computedContext",a.va),a.b("computedContext.getDependenciesCount",a.va.Aa),a.b("computedContext.isInitial",a.va.Sa),a.b("ignoreDependencies",a.qd=a.l.w);var E=a.a.Yb("_latestValue");a.N=function(b){function c(){return 0<arguments.length?(c.tb(c[E],arguments[0])&&(c.ga(),c[E]=arguments[0],c.fa()),this):(a.l.oc(c),c[E])}return c[E]=b,a.a.ka||a.a.extend(c,a.J.fn),a.J.fn.rb(c),a.a.Ya(c,B),a.options.deferUpdates&&a.ya.deferred(c,!0),c};var B={equalityComparer:J,t:function(){return this[E]},fa:function(){this.notifySubscribers(this[E])},ga:function(){this.notifySubscribers(this[E],"beforeChange")}};a.a.ka&&a.a.Xa(B,a.J.fn);var H=a.N.gd="__ko_proto__";B[H]=a.N,a.Oa=function(b,c){return null!==b&&b!==n&&b[H]!==n&&(b[H]===c||a.Oa(b[H],c))},a.H=function(b){return a.Oa(b,a.N)},a.Ba=function(b){return!!("function"==typeof b&&b[H]===a.N||"function"==typeof b&&b[H]===a.B&&b.Vc)},a.b("observable",a.N),a.b("isObservable",a.H),a.b("isWriteableObservable",a.Ba),a.b("isWritableObservable",a.Ba),a.b("observable.fn",B),a.G(B,"peek",B.t),a.G(B,"valueHasMutated",B.fa),a.G(B,"valueWillMutate",B.ga),a.la=function(b){if("object"!=typeof(b=b||[])||!("length"in b))throw Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");return b=a.N(b),a.a.Ya(b,a.la.fn),b.extend({trackArrayChanges:!0})},a.la.fn={remove:function(b){for(var c=this.t(),d=[],e="function"!=typeof b||a.H(b)?function(a){return a===b}:b,f=0;f<c.length;f++){var g=c[f];e(g)&&(0===d.length&&this.ga(),d.push(g),c.splice(f,1),f--)}return d.length&&this.fa(),d},removeAll:function(b){if(b!==n)return b?this.remove(function(c){return 0<=a.a.o(b,c)}):[];var c=this.t(),d=c.slice(0);return this.ga(),c.splice(0,c.length),this.fa(),d},destroy:function(b){var c=this.t(),d="function"!=typeof b||a.H(b)?function(a){return a===b}:b;this.ga();for(var e=c.length-1;0<=e;e--)d(c[e])&&(c[e]._destroy=!0);this.fa()},destroyAll:function(b){return b===n?this.destroy(function(){return!0}):b?this.destroy(function(c){return 0<=a.a.o(b,c)}):[]},indexOf:function(b){var c=this();return a.a.o(c,b)},replace:function(a,c){var d=this.indexOf(a);0<=d&&(this.ga(),this.t()[d]=c,this.fa())}},a.a.ka&&a.a.Xa(a.la.fn,a.N.fn),a.a.q("pop push reverse shift sort splice unshift".split(" "),function(b){a.la.fn[b]=function(){var a=this.t();this.ga(),this.Vb(a,b,arguments);var d=a[b].apply(a,arguments);return this.fa(),d===a?this:d}}),a.a.q(["slice"],function(b){a.la.fn[b]=function(){var a=this();return a[b].apply(a,arguments)}}),a.b("observableArray",a.la),a.ya.trackArrayChanges=function(b,c){function d(){if(!e){e=!0;var c=b.notifySubscribers;b.notifySubscribers=function(a,b){return b&&b!==I||++k,c.apply(this,arguments)};var d=[].concat(b.t()||[]);f=null,g=b.X(function(c){var e;c=[].concat(c||[]),b.Pa("arrayChange")&&((!f||1<k)&&(f=a.a.ib(d,c,b.hb)),e=f),d=c,f=null,k=0,e&&e.length&&b.notifySubscribers(e,"arrayChange")})}}if(b.hb={},c&&"object"==typeof c&&a.a.extend(b.hb,c),b.hb.sparse=!0,!b.Vb){var g,e=!1,f=null,k=0,l=b.sa,m=b.Ia;b.sa=function(a){l&&l.call(b,a),"arrayChange"===a&&d()},b.Ia=function(a){m&&m.call(b,a),"arrayChange"!==a||b.Pa("arrayChange")||(g.k(),e=!1)},b.Vb=function(b,c,d){function m(a,b,c){return l[l.length]={status:a,value:b,index:c}}if(e&&!k){var l=[],g=b.length,t=d.length,G=0;switch(c){case"push":G=g;case"unshift":for(c=0;c<t;c++)m("added",d[c],G+c);break;case"pop":G=g-1;case"shift":g&&m("deleted",b[G],G);break;case"splice":c=Math.min(Math.max(0,d[0]<0?g+d[0]:d[0]),g),g=1===t?g:Math.min(c+(d[1]||0),g),t=c+t-2,G=Math.max(g,t);for(var P=[],n=[],Q=2;c<G;++c,++Q)c<g&&n.push(m("deleted",b[c],c)),c<t&&P.push(m("added",d[Q],c));a.a.dc(n,P);break;default:return}f=l}}}};var s=a.a.Yb("_state");a.m=a.B=function(b,c,d){function e(){if(0<arguments.length){if("function"!=typeof f)throw Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");return f.apply(g.pb,arguments),this}return a.l.oc(e),(g.S||g.s&&e.Qa())&&e.aa(),g.T}if("object"==typeof b?d=b:(d=d||{},b&&(d.read=b)),"function"!=typeof d.read)throw Error("Pass a function that returns the value of the ko.computed");var f=d.write,g={T:n,S:!0,Ra:!1,Fb:!1,R:!1,Va:!1,s:!1,jd:d.read,pb:c||d.owner,i:d.disposeWhenNodeIsRemoved||d.i||null,wa:d.disposeWhen||d.wa,mb:null,r:{},L:0,bc:null};return e[s]=g,e.Vc="function"==typeof f,a.a.ka||a.a.extend(e,a.J.fn),a.J.fn.rb(e),a.a.Ya(e,z),d.pure?(g.Va=!0,g.s=!0,a.a.extend(e,$)):d.deferEvaluation&&a.a.extend(e,aa),a.options.deferUpdates&&a.ya.deferred(e,!0),g.i&&(g.Fb=!0,g.i.nodeType||(g.i=null)),g.s||d.deferEvaluation||e.aa(),g.i&&e.ba()&&a.a.F.oa(g.i,g.mb=function(){e.k()}),e};var z={equalityComparer:J,Aa:function(){return this[s].L},Pb:function(a,c,d){if(this[s].Va&&c===this)throw Error("A 'pure' computed must not be called recursively");(this[s].r[a]=d).Ga=this[s].L++,d.na=c.Na()},Qa:function(){var a,c,d=this[s].r;for(a in d)if(d.hasOwnProperty(a)&&(c=d[a]).ia.Uc(c.na))return!0},bd:function(){this.Fa&&!this[s].Ra&&this.Fa()},ba:function(){return this[s].S||0<this[s].L},ld:function(){this.Mb||this.ac()},uc:function(a){if(!a.cb||this[s].i)return a.X(this.ac,this);var c=a.X(this.bd,this,"dirty"),d=a.X(this.ld,this);return{ia:a,k:function(){c.k(),d.k()}}},ac:function(){var b=this,c=b.throttleEvaluation;c&&0<=c?(clearTimeout(this[s].bc),this[s].bc=a.a.setTimeout(function(){b.aa(!0)},c)):b.Fa?b.Fa():b.aa(!0)},aa:function(b){var c=this[s],d=c.wa;if(!c.Ra&&!c.R){if(c.i&&!a.a.nb(c.i)||d&&d()){if(!c.Fb)return void this.k()}else c.Fb=!1;c.Ra=!0;try{this.Qc(b)}finally{c.Ra=!1}c.L||this.k()}},Qc:function(b){var c=this[s],d=c.Va?n:!c.L,e={Hc:this,Ma:c.r,lb:c.L};a.l.Ub({Gc:e,gb:Y,m:this,Sa:d}),c.r={},c.L=0,e=this.Pc(c,e),this.tb(c.T,e)&&(c.s||this.notifySubscribers(c.T,"beforeChange"),c.T=e,c.s?this.zc():b&&this.notifySubscribers(c.T)),d&&this.notifySubscribers(c.T,"awake")},Pc:function(b,c){try{var d=b.jd;return b.pb?d.call(b.pb):d()}finally{a.l.end(),c.lb&&!b.s&&a.a.D(c.Ma,X),b.S=!1}},t:function(){var a=this[s];return(a.S&&!a.L||a.s&&this.Qa())&&this.aa(),a.T},Ta:function(b){a.J.fn.Ta.call(this,b),this.Fa=function(){this.Kb(this[s].T),this[s].S=!0,this.Lb(this)}},k:function(){var b=this[s];!b.s&&b.r&&a.a.D(b.r,function(a,b){b.k&&b.k()}),b.i&&b.mb&&a.a.F.pc(b.i,b.mb),b.r=null,b.L=0,b.R=!0,b.S=!1,b.s=!1,b.i=null}},$={sa:function(b){var c=this,d=c[s];if(!d.R&&d.s&&"change"==b){if(d.s=!1,d.S||c.Qa())d.r=null,d.L=0,d.S=!0,c.aa();else{var e=[];a.a.D(d.r,function(a,b){e[b.Ga]=a}),a.a.q(e,function(a,b){var e=d.r[a],l=c.uc(e.ia);l.Ga=b,l.na=e.na,d.r[a]=l})}d.R||c.notifySubscribers(d.T,"awake")}},Ia:function(b){var c=this[s];c.R||"change"!=b||this.Pa("change")||(a.a.D(c.r,function(a,b){b.k&&(c.r[a]={ia:b.ia,Ga:b.Ga,na:b.na},b.k())}),c.s=!0,this.notifySubscribers(n,"asleep"))},Na:function(){var b=this[s];return b.s&&(b.S||this.Qa())&&this.aa(),a.J.fn.Na.call(this)}},aa={sa:function(a){"change"!=a&&"beforeChange"!=a||this.t()}};a.a.ka&&a.a.Xa(z,a.J.fn);var R=a.N.gd;a.m[R]=a.N,z[R]=a.m,a.Xc=function(b){return a.Oa(b,a.m)},a.Yc=function(b){return a.Oa(b,a.m)&&b[s]&&b[s].Va},a.b("computed",a.m),a.b("dependentObservable",a.m),a.b("isComputed",a.Xc),a.b("isPureComputed",a.Yc),a.b("computed.fn",z),a.G(z,"peek",z.t),a.G(z,"dispose",z.k),a.G(z,"isActive",z.ba),a.G(z,"getDependenciesCount",z.Aa),a.nc=function(b,c){return"function"==typeof b?a.m(b,c,{pure:!0}):((b=a.a.extend({},b)).pure=!0,a.m(b,c))},a.b("pureComputed",a.nc),function(){function b(a,f,g){if(g=g||new d,"object"!=typeof(a=f(a))||null===a||a===n||a instanceof RegExp||a instanceof Date||a instanceof String||a instanceof Number||a instanceof Boolean)return a;var k=a instanceof Array?[]:{};return g.save(a,k),function(a,b){if(a instanceof Array){for(var c=0;c<a.length;c++)b(c);"function"==typeof a.toJSON&&b("toJSON")}else for(c in a)b(c)}(a,function(c){var d=f(a[c]);switch(typeof d){case"boolean":case"number":case"string":case"function":k[c]=d;break;case"object":case"undefined":var h=g.get(d);k[c]=h!==n?h:b(d,f,g)}}),k}function d(){this.keys=[],this.Ib=[]}a.wc=function(c){if(0==arguments.length)throw Error("When calling ko.toJS, pass the object you want to convert.");return b(c,function(b){for(var c=0;a.H(b)&&c<10;c++)b=b();return b})},a.toJSON=function(b,c,d){return b=a.wc(b),a.a.Eb(b,c,d)},d.prototype={save:function(b,c){var d=a.a.o(this.keys,b);0<=d?this.Ib[d]=c:(this.keys.push(b),this.Ib.push(c))},get:function(b){return 0<=(b=a.a.o(this.keys,b))?this.Ib[b]:n}}}(),a.b("toJS",a.wc),a.b("toJSON",a.toJSON),a.j={u:function(b){switch(a.a.A(b)){case"option":return!0===b.__ko__hasDomDataOptionValue__?a.a.e.get(b,a.d.options.xb):a.a.C<=7?b.getAttributeNode("value")&&b.getAttributeNode("value").specified?b.value:b.text:b.value;case"select":return 0<=b.selectedIndex?a.j.u(b.options[b.selectedIndex]):n;default:return b.value}},ha:function(b,c,d){switch(a.a.A(b)){case"option":switch(typeof c){case"string":a.a.e.set(b,a.d.options.xb,n),"__ko__hasDomDataOptionValue__"in b&&delete b.__ko__hasDomDataOptionValue__,b.value=c;break;default:a.a.e.set(b,a.d.options.xb,c),b.__ko__hasDomDataOptionValue__=!0,b.value="number"==typeof c?c:""}break;case"select":""!==c&&null!==c||(c=n);for(var k,e=-1,f=0,g=b.options.length;f<g;++f)if((k=a.j.u(b.options[f]))==c||""==k&&c===n){e=f;break}(d||0<=e||c===n&&1<b.size)&&(b.selectedIndex=e);break;default:null!==c&&c!==n||(c=""),b.value=c}}},a.b("selectExtensions",a.j),a.b("selectExtensions.readValue",a.j.u),a.b("selectExtensions.writeValue",a.j.ha),a.h=function(){function b(b){123===(b=a.a.$a(b)).charCodeAt(0)&&(b=b.slice(1,-1));var r,c=[],d=b.match(e),k=[],p=0;if(d){d.push(",");for(var y,A=0;y=d[A];++A){var t=y.charCodeAt(0);if(44===t){if(p<=0){c.push(r&&k.length?{key:r,value:k.join("")}:{unknown:r||k.join("")}),r=p=0,k=[];continue}}else if(58===t){if(!p&&!r&&1===k.length){r=k.pop();continue}}else 47===t&&A&&1<y.length?(t=d[A-1].match(f))&&!g[t[0]]&&((d=(b=b.substr(b.indexOf(y)+1)).match(e)).push(","),A=-1,y="/"):40===t||123===t||91===t?++p:41===t||125===t||93===t?--p:r||k.length||34!==t&&39!==t||(y=y.slice(1,-1));k.push(y)}}return c}var c=["true","false","null","undefined"],d=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,e=RegExp("\"(?:[^\"\\\\]|\\\\.)*\"|'(?:[^'\\\\]|\\\\.)*'|/(?:[^/\\\\]|\\\\.)*/w*|[^\\s:,/][^,\"'{}()/:[\\]]*[^\\s,\"'{}()/:[\\]]|[^\\s]","g"),f=/[\])"'A-Za-z0-9_$]+$/,g={in:1,return:1,typeof:1},k={};return{ta:[],ea:k,yb:b,Ua:function(e,m){function h(b,e){var m;if(!A){var l=a.getBindingHandler(b);if(l&&l.preprocess&&!(e=l.preprocess(e,b,h)))return;(l=k[b])&&(m=e,l=m=!(0<=a.a.o(c,m))&&null!==(l=m.match(d))&&(l[1]?"Object("+l[1]+")"+l[2]:m)),l&&g.push("'"+b+"':function(_z){"+m+"=_z}")}p&&(e="function(){return "+e+" }"),f.push("'"+b+"':"+e)}var f=[],g=[],p=(m=m||{}).valueAccessors,A=m.bindingParams,y="string"==typeof e?b(e):e;return a.a.q(y,function(a){h(a.key||a.unknown,a.value)}),g.length&&h("_ko_property_writers","{"+g.join(",")+" }"),f.join(",")},ad:function(a,b){for(var c=0;c<a.length;c++)if(a[c].key==b)return!0;return!1},Ea:function(b,c,d,e,f){b&&a.H(b)?!a.Ba(b)||f&&b.t()===e||b(e):(b=c.get("_ko_property_writers"))&&b[d]&&b[d](e)}}}(),a.b("expressionRewriting",a.h),a.b("expressionRewriting.bindingRewriteValidators",a.h.ta),a.b("expressionRewriting.parseObjectLiteral",a.h.yb),a.b("expressionRewriting.preProcessBindings",a.h.Ua),a.b("expressionRewriting._twoWayBindings",a.h.ea),a.b("jsonExpressionRewriting",a.h),a.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",a.h.Ua),function(){function b(a){return 8==a.nodeType&&g.test(f?a.text:a.nodeValue)}function c(a){return 8==a.nodeType&&k.test(f?a.text:a.nodeValue)}function d(a,d){for(var e=a,f=1,l=[];e=e.nextSibling;){if(c(e)&&0==--f)return l;l.push(e),b(e)&&f++}if(!d)throw Error("Cannot find closing comment tag to match: "+a.nodeValue);return null}function e(a,b){var c=d(a,b);return c?0<c.length?c[c.length-1].nextSibling:a.nextSibling:null}var f=u&&"\x3c!--test--\x3e"===u.createComment("test").text,g=f?/^\x3c!--\s*ko(?:\s+([\s\S]+))?\s*--\x3e$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,k=f?/^\x3c!--\s*\/ko\s*--\x3e$/:/^\s*\/ko\s*$/,l={ul:!0,ol:!0};a.f={Z:{},childNodes:function(a){return b(a)?d(a):a.childNodes},xa:function(c){if(b(c))for(var d=0,e=(c=a.f.childNodes(c)).length;d<e;d++)a.removeNode(c[d]);else a.a.ob(c)},da:function(c,d){if(b(c)){a.f.xa(c);for(var e=c.nextSibling,f=0,l=d.length;f<l;f++)e.parentNode.insertBefore(d[f],e)}else a.a.da(c,d)},mc:function(a,c){b(a)?a.parentNode.insertBefore(c,a.nextSibling):a.firstChild?a.insertBefore(c,a.firstChild):a.appendChild(c)},gc:function(c,d,e){e?b(c)?c.parentNode.insertBefore(d,e.nextSibling):e.nextSibling?c.insertBefore(d,e.nextSibling):c.appendChild(d):a.f.mc(c,d)},firstChild:function(a){return b(a)?!a.nextSibling||c(a.nextSibling)?null:a.nextSibling:a.firstChild},nextSibling:function(a){return b(a)&&(a=e(a)),a.nextSibling&&c(a.nextSibling)?null:a.nextSibling},Tc:b,pd:function(a){return(a=(f?a.text:a.nodeValue).match(g))?a[1]:null},kc:function(d){if(l[a.a.A(d)]){var h=d.firstChild;if(h)do{if(1===h.nodeType){var f,g=null;if(f=h.firstChild)do{if(g)g.push(f);else if(b(f)){var k=e(f,!0);k?f=k:g=[f]}else c(f)&&(g=[f])}while(f=f.nextSibling);if(f=g)for(g=h.nextSibling,k=0;k<f.length;k++)g?d.insertBefore(f[k],g):d.appendChild(f[k])}}while(h=h.nextSibling)}}}}(),a.b("virtualElements",a.f),a.b("virtualElements.allowedBindings",a.f.Z),a.b("virtualElements.emptyNode",a.f.xa),a.b("virtualElements.insertAfter",a.f.gc),a.b("virtualElements.prepend",a.f.mc),a.b("virtualElements.setDomNodeChildren",a.f.da),a.Q=function(){this.Fc={}},a.a.extend(a.Q.prototype,{nodeHasBindings:function(b){switch(b.nodeType){case 1:return null!=b.getAttribute("data-bind")||a.g.getComponentNameForNode(b);case 8:return a.f.Tc(b);default:return!1}},getBindings:function(b,c){var d=(d=this.getBindingsString(b,c))?this.parseBindingsString(d,c,b):null;return a.g.Ob(d,b,c,!1)},getBindingAccessors:function(b,c){var d=(d=this.getBindingsString(b,c))?this.parseBindingsString(d,c,b,{valueAccessors:!0}):null;return a.g.Ob(d,b,c,!0)},getBindingsString:function(b){switch(b.nodeType){case 1:return b.getAttribute("data-bind");case 8:return a.f.pd(b);default:return null}},parseBindingsString:function(b,c,d,e){try{var k,f=this.Fc,g=b+(e&&e.valueAccessors||"");if(!(k=f[g])){var l,m="with($context){with($data||{}){return{"+a.h.Ua(b,e)+"}}}";l=new Function("$context","$element",m),k=f[g]=l}return k(c,d)}catch(h){throw h.message="Unable to parse bindings.\nBindings value: "+b+"\nMessage: "+h.message,h}}}),a.Q.instance=new a.Q,a.b("bindingProvider",a.Q),function(){function b(a){return function(){return a}}function c(a){return a()}function d(b){return a.a.Ca(a.l.w(b),function(a,c){return function(){return b()[c]}})}function e(c,e,h){return"function"==typeof c?d(c.bind(null,e,h)):a.a.Ca(c,b)}function f(a,b){return d(this.getBindings.bind(this,a,b))}function g(b,c,d){var e,h=a.f.firstChild(c),f=a.Q.instance,m=f.preprocessNode;if(m){for(;e=h;)h=a.f.nextSibling(e),m.call(f,e);h=a.f.firstChild(c)}for(;e=h;)h=a.f.nextSibling(e),k(b,e,d)}function k(b,c,d){var e=!0,h=1===c.nodeType;h&&a.f.kc(c),(h&&d||a.Q.instance.nodeHasBindings(c))&&(e=m(c,null,b,d).shouldBindDescendants),e&&!r[a.a.A(c)]&&g(b,c,!h)}function m(b,d,e,h){var g,u,m=a.a.e.get(b,q);if(!d){if(m)throw Error("You cannot apply bindings multiple times to the same element.");a.a.e.set(b,q,!0)}if(!m&&h&&a.tc(b,e),d&&"function"!=typeof d)g=d;else{var k=a.Q.instance,r=k.getBindingAccessors||f,p=a.B(function(){return(g=d?d(e,b):r.call(k,b,e))&&e.P&&e.P(),g},null,{i:b});g&&p.ba()||(p=null)}if(g){var v=p?function(a){return function(){return c(p()[a])}}:function(a){return g[a]},s=function(){return a.a.Ca(p?p():g,c)};s.get=function(a){return g[a]&&c(v(a))},s.has=function(a){return a in g},h=function(b){var c=[],d={},e=[];return a.a.D(b,function Z(h){if(!d[h]){var f=a.getBindingHandler(h);f&&(f.after&&(e.push(h),a.a.q(f.after,function(c){if(b[c]){if(-1!==a.a.o(e,c))throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+e.join(", "));Z(c)}}),e.length--),c.push({key:h,fc:f})),d[h]=!0}}),c}(g),a.a.q(h,function(c){var d=c.fc.init,h=c.fc.update,f=c.key;if(8===b.nodeType&&!a.f.Z[f])throw Error("The binding '"+f+"' cannot be used with virtual elements");try{"function"==typeof d&&a.l.w(function(){var a=d(b,v(f),s,e.$data,e);if(a&&a.controlsDescendantBindings){if(u!==n)throw Error("Multiple bindings ("+u+" and "+f+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");u=f}}),"function"==typeof h&&a.B(function(){h(b,v(f),s,e.$data,e)},null,{i:b})}catch(m){throw m.message='Unable to process binding "'+f+": "+g[f]+'"\nMessage: '+m.message,m}})}return{shouldBindDescendants:u===n}}function h(b){return b&&b instanceof a.U?b:new a.U(b)}a.d={};var r={script:!0,textarea:!0,template:!0};a.getBindingHandler=function(b){return a.d[b]},a.U=function(b,c,d,e){var m,h=this,f="function"==typeof b&&!a.H(b),g=a.B(function(){var m=f?b():b,l=a.a.c(m);return c?(c.P&&c.P(),a.a.extend(h,c),g&&(h.P=g)):(h.$parents=[],h.$root=l,h.ko=a),h.$rawData=m,h.$data=l,d&&(h[d]=l),e&&e(h,c,l),h.$data},null,{wa:function(){return m&&!a.a.Qb(m)},i:!0});g.ba()&&((h.P=g).equalityComparer=null,m=[],g.Ac=function(b){m.push(b),a.a.F.oa(b,function(b){a.a.La(m,b),m.length||(g.k(),h.P=g=n)})})},a.U.prototype.createChildContext=function(b,c,d){return new a.U(b,this,c,function(a,b){a.$parentContext=b,a.$parent=b.$data,a.$parents=(b.$parents||[]).slice(0),a.$parents.unshift(a.$parent),d&&d(a)})},a.U.prototype.extend=function(b){return new a.U(this.P||this.$data,this,null,function(c,d){c.$rawData=d.$rawData,a.a.extend(c,"function"==typeof b?b():b)})};var q=a.a.e.I(),p=a.a.e.I();a.tc=function(b,c){if(2!=arguments.length)return a.a.e.get(b,p);a.a.e.set(b,p,c),c.P&&c.P.Ac(b)},a.Ja=function(b,c,d){return 1===b.nodeType&&a.f.kc(b),m(b,c,h(d),!0)},a.Dc=function(b,c,d){return d=h(d),a.Ja(b,e(c,d,b),d)},a.eb=function(a,b){1!==b.nodeType&&8!==b.nodeType||g(h(a),b,!0)},a.Rb=function(a,b){if(!v&&x.jQuery&&(v=x.jQuery),b&&1!==b.nodeType&&8!==b.nodeType)throw Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");b=b||x.document.body,k(h(a),b,!0)},a.kb=function(b){switch(b.nodeType){case 1:case 8:var c=a.tc(b);if(c)return c;if(b.parentNode)return a.kb(b.parentNode)}return n},a.Jc=function(b){return(b=a.kb(b))?b.$data:n},a.b("bindingHandlers",a.d),a.b("applyBindings",a.Rb),a.b("applyBindingsToDescendants",a.eb),a.b("applyBindingAccessorsToNode",a.Ja),a.b("applyBindingsToNode",a.Dc),a.b("contextFor",a.kb),a.b("dataFor",a.Jc)}(),function(b){function c(c,e){var h,m=f.hasOwnProperty(c)?f[c]:b;m?m.X(e):((m=f[c]=new a.J).X(e),d(c,function(b,d){var e=!(!d||!d.synchronous);g[c]={definition:b,Zc:e},delete f[c],h||e?m.notifySubscribers(b):a.Y.Wa(function(){m.notifySubscribers(b)})}),h=!0)}function d(a,b){e("getConfig",[a],function(c){c?e("loadComponent",[a,c],function(a){b(a,c)}):b(null,null)})}function e(c,d,f,h){h||(h=a.g.loaders.slice(0));var g=h.shift();if(g){var q=g[c];if(q){var p=!1;if(q.apply(g,d.concat(function(a){p?f(null):null!==a?f(a):e(c,d,f,h)}))!==b&&(p=!0,!g.suppressLoaderExceptions))throw Error("Component loaders must supply values by invoking the callback, not by returning values synchronously.")}else e(c,d,f,h)}else f(null)}var f={},g={};a.g={get:function(d,e){var f=g.hasOwnProperty(d)?g[d]:b;f?f.Zc?a.l.w(function(){e(f.definition)}):a.Y.Wa(function(){e(f.definition)}):c(d,e)},Xb:function(a){delete g[a]},Jb:e},a.g.loaders=[],a.b("components",a.g),a.b("components.get",a.g.get),a.b("components.clearCachedDefinition",a.g.Xb)}(),function(){function b(b,c,d,e){function g(){0==--y&&e(k)}var k={},y=2,t=d.template;d=d.viewModel,t?f(c,t,function(c){a.g.Jb("loadTemplate",[b,c],function(a){k.template=a,g()})}):g(),d?f(c,d,function(c){a.g.Jb("loadViewModel",[b,c],function(a){k[l]=a,g()})}):g()}function d(b){switch(a.a.A(b)){case"script":return a.a.ma(b.text);case"textarea":return a.a.ma(b.value);case"template":if(e(b.content))return a.a.ua(b.content.childNodes)}return a.a.ua(b.childNodes)}function e(a){return x.DocumentFragment?a instanceof DocumentFragment:a&&11===a.nodeType}function f(a,b,c){"string"==typeof b.require?O||x.require?(O||x.require)([b.require],c):a("Uses require, but no AMD loader is present"):c(b)}function g(a){return function(b){throw Error("Component '"+a+"': "+b)}}var k={};a.g.register=function(b,c){if(!c)throw Error("Invalid configuration for "+b);if(a.g.ub(b))throw Error("Component "+b+" is already registered");k[b]=c},a.g.ub=function(a){return k.hasOwnProperty(a)},a.g.od=function(b){delete k[b],a.g.Xb(b)},a.g.Zb={getConfig:function(a,b){b(k.hasOwnProperty(a)?k[a]:null)},loadComponent:function(a,c,d){var e=g(a);f(e,c,function(c){b(a,e,c,d)})},loadTemplate:function(b,c,f){if(b=g(b),"string"==typeof c)f(a.a.ma(c));else if(c instanceof Array)f(c);else if(e(c))f(a.a.V(c.childNodes));else if(c.element)if(c=c.element,x.HTMLElement?c instanceof HTMLElement:c&&c.tagName&&1===c.nodeType)f(d(c));else if("string"==typeof c){var l=u.getElementById(c);l?f(d(l)):b("Cannot find element with ID "+c)}else b("Unknown element type: "+c);else b("Unknown template value: "+c)},loadViewModel:function(a,b,d){!function c(a,b,d){if("function"==typeof b)d(function(a){return new b(a)});else if("function"==typeof b[l])d(b[l]);else if("instance"in b){var e=b.instance;d(function(){return e})}else"viewModel"in b?c(a,b.viewModel,d):a("Unknown viewModel value: "+b)}(g(a),b,d)}};var l="createViewModel";a.b("components.register",a.g.register),a.b("components.isRegistered",a.g.ub),a.b("components.unregister",a.g.od),a.b("components.defaultLoader",a.g.Zb),a.g.loaders.push(a.g.Zb),a.g.Bc=k}(),function(){function b(b,e){if(f=b.getAttribute("params")){var f=c.parseBindingsString(f,e,b,{valueAccessors:!0,bindingParams:!0}),g=(f=a.a.Ca(f,function(c){return a.m(c,null,{i:b})}),a.a.Ca(f,function(c){var e=c.t();return c.ba()?a.m({read:function(){return a.a.c(c())},write:a.Ba(e)&&function(a){c()(a)},i:b}):e}));return g.hasOwnProperty("$raw")||(g.$raw=f),g}return{$raw:{}}}a.g.getComponentNameForNode=function(b){var c=a.a.A(b);if(a.g.ub(c)&&(-1!=c.indexOf("-")||"[object HTMLUnknownElement]"==""+b||a.a.C<=8&&b.tagName===c))return c},a.g.Ob=function(c,e,f,g){if(1===e.nodeType){var k=a.g.getComponentNameForNode(e);if(k){if((c=c||{}).component)throw Error('Cannot use the "component" binding on a custom element matching a component');var l={name:k,params:b(e,f)};c.component=g?function(){return l}:l}}return c};var c=new a.Q;a.a.C<9&&(a.g.register=function(a){return function(b){return u.createElement(b),a.apply(this,arguments)}}(a.g.register),u.createDocumentFragment=function(b){return function(){var g,c=b(),f=a.g.Bc;for(g in f)f.hasOwnProperty(g)&&c.createElement(g);return c}}(u.createDocumentFragment))}(),function(b){var e=0;a.d.component={init:function(f,g,k,l,m){function h(){var a=r&&r.dispose;"function"==typeof a&&a.call(r),q=r=null}var r,q,p=a.a.V(a.f.childNodes(f));return a.a.F.oa(f,h),a.m(function(){var k,t,l=a.a.c(g());if("string"==typeof l?k=l:(k=a.a.c(l.name),t=a.a.c(l.params)),!k)throw Error("No component name specified");var n=q=++e;a.g.get(k,function(e){if(q===n){if(h(),!e)throw Error("Unknown component '"+k+"'");!function(b,c,d){if(!(c=c.template))throw Error("Component '"+b+"' has no template");b=a.a.ua(c),a.f.da(d,b)}(k,e,f);var g=function(a,b,c,d){var e=a.createViewModel;return e?e.call(a,d,{element:b,templateNodes:c}):d}(e,f,p,t);e=m.createChildContext(g,void 0,function(a){a.$component=g,a.$componentTemplateNodes=p}),r=g,a.eb(e,f)}})},null,{i:f}),{controlsDescendantBindings:!0}}},a.f.Z.component=!0}();var S={class:"className",for:"htmlFor"};a.d.attr={update:function(b,c){var d=a.a.c(c())||{};a.a.D(d,function(c,d){var g=!1===(d=a.a.c(d))||null===d||d===n;g&&b.removeAttribute(c),a.a.C<=8&&c in S?(c=S[c],g?b.removeAttribute(c):b[c]=d):g||b.setAttribute(c,d.toString()),"name"===c&&a.a.rc(b,g?"":d.toString())})}},a.d.checked={after:["value","attr"],init:function(b,c,d){function e(){var e=b.checked,f=p?g():e;if(!a.va.Sa()&&(!l||e)){var m=a.l.w(c);if(h){var k=r?m.t():m;q!==f?(e&&(a.a.pa(k,f,!0),a.a.pa(k,q,!1)),q=f):a.a.pa(k,f,e),r&&a.Ba(m)&&m(k)}else a.h.Ea(m,d,"checked",f,!0)}}var g=a.nc(function(){return d.has("checkedValue")?a.a.c(d.get("checkedValue")):d.has("value")?a.a.c(d.get("value")):b.value}),k="checkbox"==b.type,l="radio"==b.type;if(k||l){var m=c(),h=k&&a.a.c(m)instanceof Array,r=!(h&&m.push&&m.splice),q=h?g():n,p=l||h;l&&!b.name&&a.d.uniqueName.init(b,function(){return!0}),a.m(e,null,{i:b}),a.a.p(b,"click",e),a.m(function(){var d=a.a.c(c());b.checked=h?0<=a.a.o(d,g()):k?d:g()===d},null,{i:b}),m=n}}},a.h.ea.checked=!0,a.d.checkedValue={update:function(b,c){b.value=a.a.c(c())}},a.d.css={update:function(b,c){var d=a.a.c(c());null!==d&&"object"==typeof d?a.a.D(d,function(c,d){d=a.a.c(d),a.a.bb(b,c,d)}):(d=a.a.$a(String(d||"")),a.a.bb(b,b.__ko__cssValue,!1),b.__ko__cssValue=d,a.a.bb(b,d,!0))}},a.d.enable={update:function(b,c){var d=a.a.c(c());d&&b.disabled?b.removeAttribute("disabled"):d||b.disabled||(b.disabled=!0)}},a.d.disable={update:function(b,c){a.d.enable.update(b,function(){return!a.a.c(c())})}},a.d.event={init:function(b,c,d,e,f){var g=c()||{};a.a.D(g,function(g){"string"==typeof g&&a.a.p(b,g,function(b){var m,h=c()[g];if(h){try{var r=a.a.V(arguments);e=f.$data,r.unshift(e),m=h.apply(e,r)}finally{!0!==m&&(b.preventDefault?b.preventDefault():b.returnValue=!1)}!1===d.get(g+"Bubble")&&(b.cancelBubble=!0,b.stopPropagation&&b.stopPropagation())}})})}},a.d.foreach={ic:function(b){return function(){var c=b(),d=a.a.zb(c);return d&&"number"!=typeof d.length?(a.a.c(c),{foreach:d.data,as:d.as,includeDestroyed:d.includeDestroyed,afterAdd:d.afterAdd,beforeRemove:d.beforeRemove,afterRender:d.afterRender,beforeMove:d.beforeMove,afterMove:d.afterMove,templateEngine:a.W.sb}):{foreach:c,templateEngine:a.W.sb}}},init:function(b,c){return a.d.template.init(b,a.d.foreach.ic(c))},update:function(b,c,d,e,f){return a.d.template.update(b,a.d.foreach.ic(c),d,e,f)}},a.h.ta.foreach=!1,a.f.Z.foreach=!0,a.d.hasfocus={init:function(b,c,d){function e(e){b.__ko_hasfocusUpdating=!0;var f=b.ownerDocument;if("activeElement"in f){var g;try{g=f.activeElement}catch(h){g=f.body}e=g===b}f=c(),a.h.Ea(f,d,"hasfocus",e,!0),b.__ko_hasfocusLastValue=e,b.__ko_hasfocusUpdating=!1}var f=e.bind(null,!0),g=e.bind(null,!1);a.a.p(b,"focus",f),a.a.p(b,"focusin",f),a.a.p(b,"blur",g),a.a.p(b,"focusout",g)},update:function(b,c){var d=!!a.a.c(c());b.__ko_hasfocusUpdating||b.__ko_hasfocusLastValue===d||(d?b.focus():b.blur(),!d&&b.__ko_hasfocusLastValue&&b.ownerDocument.body.focus(),a.l.w(a.a.Da,null,[b,d?"focusin":"focusout"]))}},a.h.ea.hasfocus=!0,a.d.hasFocus=a.d.hasfocus,a.h.ea.hasFocus=!0,a.d.html={init:function(){return{controlsDescendantBindings:!0}},update:function(b,c){a.a.Cb(b,c())}},K("if"),K("ifnot",!1,!0),K("with",!0,!1,function(a,c){return a.createChildContext(c)});var L={};a.d.options={init:function(b){if("select"!==a.a.A(b))throw Error("options binding applies only to SELECT elements");for(;0<b.length;)b.remove(0);return{controlsDescendantBindings:!0}},update:function(b,c,d){function e(){return a.a.Ka(b.options,function(a){return a.selected})}function f(a,b,c){var d=typeof b;return"function"==d?b(a):"string"==d?a[b]:c}function g(c,e){if(A&&h)a.j.ha(b,a.a.c(d.get("value")),!0);else if(p.length){var f=0<=a.a.o(p,a.j.u(e[0]));a.a.sc(e[0],f),A&&!f&&a.l.w(a.a.Da,null,[b,"change"])}}var k=b.multiple,l=0!=b.length&&k?b.scrollTop:null,m=a.a.c(c()),h=d.get("valueAllowUnset")&&d.has("value"),r=d.get("optionsIncludeDestroyed");c={};var q,p=[];h||(k?p=a.a.fb(e(),a.j.u):0<=b.selectedIndex&&p.push(a.j.u(b.options[b.selectedIndex]))),m&&(void 0===m.length&&(m=[m]),q=a.a.Ka(m,function(b){return r||b===n||null===b||!a.a.c(b._destroy)}),d.has("optionsCaption")&&null!==(m=a.a.c(d.get("optionsCaption")))&&m!==n&&q.unshift(L));var A=!1;c.beforeRemove=function(a){b.removeChild(a)},m=g,d.has("optionsAfterRender")&&"function"==typeof d.get("optionsAfterRender")&&(m=function(b,c){g(0,c),a.l.w(d.get("optionsAfterRender"),null,[c[0],b!==L?b:n])}),a.a.Bb(b,q,function(c,e,g){return g.length&&(p=!h&&g[0].selected?[a.j.u(g[0])]:[],A=!0),e=b.ownerDocument.createElement("option"),c===L?(a.a.Za(e,d.get("optionsCaption")),a.j.ha(e,n)):(g=f(c,d.get("optionsValue"),c),a.j.ha(e,a.a.c(g)),c=f(c,d.get("optionsText"),g),a.a.Za(e,c)),[e]},c,m),a.l.w(function(){h?a.j.ha(b,a.a.c(d.get("value")),!0):(k?p.length&&e().length<p.length:p.length&&0<=b.selectedIndex?a.j.u(b.options[b.selectedIndex])!==p[0]:p.length||0<=b.selectedIndex)&&a.a.Da(b,"change")}),a.a.Nc(b),l&&20<Math.abs(l-b.scrollTop)&&(b.scrollTop=l)}},a.d.options.xb=a.a.e.I(),a.d.selectedOptions={after:["options","foreach"],init:function(b,c,d){a.a.p(b,"change",function(){var e=c(),f=[];a.a.q(b.getElementsByTagName("option"),function(b){b.selected&&f.push(a.j.u(b))}),a.h.Ea(e,d,"selectedOptions",f)})},update:function(b,c){if("select"!=a.a.A(b))throw Error("values binding applies only to SELECT elements");var d=a.a.c(c()),e=b.scrollTop;d&&"number"==typeof d.length&&a.a.q(b.getElementsByTagName("option"),function(b){var c=0<=a.a.o(d,a.j.u(b));b.selected!=c&&a.a.sc(b,c)}),b.scrollTop=e}},a.h.ea.selectedOptions=!0,a.d.style={update:function(b,c){var d=a.a.c(c()||{});a.a.D(d,function(c,d){null!==(d=a.a.c(d))&&d!==n&&!1!==d||(d=""),b.style[c]=d})}},a.d.submit={init:function(b,c,d,e,f){if("function"!=typeof c())throw Error("The value for a submit binding must be a function");a.a.p(b,"submit",function(a){var d,e=c();try{d=e.call(f.$data,b)}finally{!0!==d&&(a.preventDefault?a.preventDefault():a.returnValue=!1)}})}},a.d.text={init:function(){return{controlsDescendantBindings:!0}},update:function(b,c){a.a.Za(b,c())}},a.f.Z.text=!0,function(){if(x&&x.navigator)var b=function(a){if(a)return parseFloat(a[1])},c=x.opera&&x.opera.version&&parseInt(x.opera.version()),d=x.navigator.userAgent,e=b(d.match(/^(?:(?!chrome).)*version\/([^ ]*) safari/i)),f=b(d.match(/Firefox\/([^ ]*)/));if(a.a.C<10)var g=a.a.e.I(),k=a.a.e.I(),l=function(b){var c=this.activeElement;(c=c&&a.a.e.get(c,k))&&c(b)},m=function(b,c){var d=b.ownerDocument;a.a.e.get(d,g)||(a.a.e.set(d,g,!0),a.a.p(d,"selectionchange",l)),a.a.e.set(b,k,c)};a.d.textInput={init:function(b,d,g){function l(c,d){a.a.p(b,c,d)}function y(){s||(v=b.value,s=a.a.setTimeout(t,4))}function t(){clearTimeout(s),v=s=n;var c=b.value;u!==c&&(u=c,a.h.Ea(d(),g,"textInput",c))}var s,v,u=b.value,x=9==a.a.C?y:t;a.a.C<10?(l("propertychange",function(a){"value"===a.propertyName&&x(a)}),8==a.a.C&&(l("keyup",t),l("keydown",t)),8<=a.a.C&&(m(b,x),l("dragend",y))):(l("input",t),e<5&&"textarea"===a.a.A(b)?(l("keydown",y),l("paste",y),l("cut",y)):c<11?l("keydown",y):f<4&&(l("DOMAutoComplete",t),l("dragdrop",t),l("drop",t))),l("change",t),a.m(function k(){var c=a.a.c(d());null!==c&&c!==n||(c=""),v!==n&&c===v?a.a.setTimeout(k,4):b.value!==c&&(u=c,b.value=c)},null,{i:b})}},a.h.ea.textInput=!0,a.d.textinput={preprocess:function(a,b,c){c("textInput",a)}}}(),a.d.uniqueName={init:function(b,c){if(c()){var d="ko_unique_"+ ++a.d.uniqueName.Ic;a.a.rc(b,d)}}},a.d.uniqueName.Ic=0,a.d.value={after:["options","foreach"],init:function(b,c,d){if("input"!=b.tagName.toLowerCase()||"checkbox"!=b.type&&"radio"!=b.type){var e=["change"],f=d.get("valueUpdate"),g=!1,k=null;f&&("string"==typeof f&&(f=[f]),a.a.ra(e,f),e=a.a.Tb(e));var l=function(){k=null,g=!1;var e=c(),f=a.j.u(b);a.h.Ea(e,d,"value",f)};!a.a.C||"input"!=b.tagName.toLowerCase()||"text"!=b.type||"off"==b.autocomplete||b.form&&"off"==b.form.autocomplete||-1!=a.a.o(e,"propertychange")||(a.a.p(b,"propertychange",function(){g=!0}),a.a.p(b,"focus",function(){g=!1}),a.a.p(b,"blur",function(){g&&l()})),a.a.q(e,function(c){var d=l;a.a.nd(c,"after")&&(d=function(){k=a.j.u(b),a.a.setTimeout(l,0)},c=c.substring(5)),a.a.p(b,c,d)});var m=function(){var e=a.a.c(c()),f=a.j.u(b);if(null!==k&&e===k)a.a.setTimeout(m,0);else if(e!==f)if("select"===a.a.A(b)){var g=d.get("valueAllowUnset");(f=function(){a.j.ha(b,e,g)})(),g||e===a.j.u(b)?a.a.setTimeout(f,0):a.l.w(a.a.Da,null,[b,"change"])}else a.j.ha(b,e)};a.m(m,null,{i:b})}else a.Ja(b,{checkedValue:c})},update:function(){}},a.h.ea.value=!0,a.d.visible={update:function(b,c){var d=a.a.c(c()),e="none"!=b.style.display;d&&!e?b.style.display="":!d&&e&&(b.style.display="none")}},function(b){a.d[b]={init:function(c,d,e,f,g){return a.d.event.init.call(this,c,function(){var a={};return a[b]=d(),a},e,f,g)}}}("click"),a.O=function(){},a.O.prototype.renderTemplateSource=function(){throw Error("Override renderTemplateSource")},a.O.prototype.createJavaScriptEvaluatorBlock=function(){throw Error("Override createJavaScriptEvaluatorBlock")},a.O.prototype.makeTemplateSource=function(b,c){if("string"==typeof b){var d=(c=c||u).getElementById(b);if(!d)throw Error("Cannot find template with ID "+b);return new a.v.n(d)}if(1==b.nodeType||8==b.nodeType)return new a.v.qa(b);throw Error("Unknown template type: "+b)},a.O.prototype.renderTemplate=function(a,c,d,e){return a=this.makeTemplateSource(a,e),this.renderTemplateSource(a,c,d,e)},a.O.prototype.isTemplateRewritten=function(a,c){return!1===this.allowTemplateRewriting||this.makeTemplateSource(a,c).data("isRewritten")},a.O.prototype.rewriteTemplate=function(a,c,d){c=c((a=this.makeTemplateSource(a,d)).text()),a.text(c),a.data("isRewritten",!0)},a.b("templateEngine",a.O),a.Gb=function(){function b(b,c,d,k){b=a.h.yb(b);for(var l=a.h.ta,m=0;m<b.length;m++){var h=b[m].key;if(l.hasOwnProperty(h)){var r=l[h];if("function"==typeof r){if(h=r(b[m].value))throw Error(h)}else if(!r)throw Error("This template engine does not support the '"+h+"' binding within its templates")}}return d="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+a.h.Ua(b,{valueAccessors:!0})+" } })()},'"+d.toLowerCase()+"')",k.createJavaScriptEvaluatorBlock(d)+c}var c=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'|[^>]*))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,d=/\x3c!--\s*ko\b\s*([\s\S]*?)\s*--\x3e/g;return{Oc:function(b,c,d){c.isTemplateRewritten(b,d)||c.rewriteTemplate(b,function(b){return a.Gb.dd(b,c)},d)},dd:function(a,f){return a.replace(c,function(a,c,d,e,h){return b(h,c,d,f)}).replace(d,function(a,c){return b(c,"\x3c!-- ko --\x3e","#comment",f)})},Ec:function(b,c){return a.M.wb(function(d,k){var l=d.nextSibling;l&&l.nodeName.toLowerCase()===c&&a.Ja(l,b,k)})}}}(),a.b("__tr_ambtns",a.Gb.Ec),function(){a.v={},a.v.n=function(b){if(this.n=b){var c=a.a.A(b);this.ab="script"===c?1:"textarea"===c?2:"template"==c&&b.content&&11===b.content.nodeType?3:4}},a.v.n.prototype.text=function(){var b=1===this.ab?"text":2===this.ab?"value":"innerHTML";if(0==arguments.length)return this.n[b];var c=arguments[0];"innerHTML"===b?a.a.Cb(this.n,c):this.n[b]=c};var b=a.a.e.I()+"_";a.v.n.prototype.data=function(c){if(1===arguments.length)return a.a.e.get(this.n,b+c);a.a.e.set(this.n,b+c,arguments[1])};var c=a.a.e.I();a.v.n.prototype.nodes=function(){var b=this.n;if(0==arguments.length)return(a.a.e.get(b,c)||{}).jb||(3===this.ab?b.content:4===this.ab?b:n);a.a.e.set(b,c,{jb:arguments[0]})},a.v.qa=function(a){this.n=a},a.v.qa.prototype=new a.v.n,a.v.qa.prototype.text=function(){if(0==arguments.length){var b=a.a.e.get(this.n,c)||{};return b.Hb===n&&b.jb&&(b.Hb=b.jb.innerHTML),b.Hb}a.a.e.set(this.n,c,{Hb:arguments[0]})},a.b("templateSources",a.v),a.b("templateSources.domElement",a.v.n),a.b("templateSources.anonymousTemplate",a.v.qa)}(),function(){function b(b,c,d){var e;for(c=a.f.nextSibling(c);b&&(e=b)!==c;)d(e,b=a.f.nextSibling(e))}function c(c,d){if(c.length){var e=c[0],f=c[c.length-1],g=e.parentNode,k=a.Q.instance,n=k.preprocessNode;if(n){if(b(e,f,function(a,b){var c=a.previousSibling,d=n.call(k,a);d&&(a===e&&(e=d[0]||b),a===f&&(f=d[d.length-1]||c))}),c.length=0,!e)return;e===f?c.push(e):(c.push(e,f),a.a.za(c,g))}b(e,f,function(b){1!==b.nodeType&&8!==b.nodeType||a.Rb(d,b)}),b(e,f,function(b){1!==b.nodeType&&8!==b.nodeType||a.M.yc(b,[d])}),a.a.za(c,g)}}function d(a){return a.nodeType?a:0<a.length?a[0]:null}function e(b,e,f,k,q){q=q||{};var p=(b&&d(b)||f||{}).ownerDocument,n=q.templateEngine||g;if(a.Gb.Oc(f,n,p),"number"!=typeof(f=n.renderTemplate(f,k,q,p)).length||0<f.length&&"number"!=typeof f[0].nodeType)throw Error("Template engine must return an array of DOM nodes");switch(p=!1,e){case"replaceChildren":a.f.da(b,f),p=!0;break;case"replaceNode":a.a.qc(b,f),p=!0;break;case"ignoreTargetNode":break;default:throw Error("Unknown renderMode: "+e)}return p&&(c(f,k),q.afterRender&&a.l.w(q.afterRender,null,[f,k.$data])),f}function f(b,c,d){return a.H(b)?b():"function"==typeof b?b(c,d):b}var g;a.Db=function(b){if(b!=n&&!(b instanceof a.O))throw Error("templateEngine must inherit from ko.templateEngine");g=b},a.Ab=function(b,c,h,k,q){if(((h=h||{}).templateEngine||g)==n)throw Error("Set a template engine before calling renderTemplate");if(q=q||"replaceChildren",k){var p=d(k);return a.B(function(){var g=c&&c instanceof a.U?c:new a.U(a.a.c(c)),n=f(b,g.$data,g);g=e(k,q,n,g,h),"replaceNode"==q&&(p=d(k=g))},null,{wa:function(){return!p||!a.a.nb(p)},i:p&&"replaceNode"==q?p.parentNode:p})}return a.M.wb(function(d){a.Ab(b,c,h,d,"replaceNode")})},a.kd=function(b,d,g,k,q){function p(a,b){c(b,s),g.afterRender&&g.afterRender(b,a),s=null}function u(a,c){return s=q.createChildContext(a,g.as,function(a){a.$index=c}),e(null,"ignoreTargetNode",f(b,a,s),s,g)}var s;return a.B(function(){var b=a.a.c(d)||[];void 0===b.length&&(b=[b]),b=a.a.Ka(b,function(b){return g.includeDestroyed||b===n||null===b||!a.a.c(b._destroy)}),a.l.w(a.a.Bb,null,[k,b,u,g,p])},null,{i:k})};var k=a.a.e.I();a.d.template={init:function(b,c){var d=a.a.c(c());if("string"==typeof d||d.name)a.f.xa(b);else{if("nodes"in d){if(d=d.nodes||[],a.H(d))throw Error('The "nodes" option must be a plain, non-observable array.')}else d=a.f.childNodes(b);d=a.a.jc(d),new a.v.qa(b).nodes(d)}return{controlsDescendantBindings:!0}},update:function(b,c,d,e,f){var s,g=c();d=!0,e=null,"string"==typeof(c=a.a.c(g))?c={}:(g=c.name,"if"in c&&(d=a.a.c(c.if)),d&&"ifnot"in c&&(d=!a.a.c(c.ifnot)),s=a.a.c(c.data)),"foreach"in c?e=a.kd(g||b,d&&c.foreach||[],c,b,f):d?(f="data"in c?f.createChildContext(s,c.as):f,e=a.Ab(g||b,f,c,b)):a.f.xa(b),f=e,(s=a.a.e.get(b,k))&&"function"==typeof s.k&&s.k(),a.a.e.set(b,k,f&&f.ba()?f:n)}},a.h.ta.template=function(b){return 1==(b=a.h.yb(b)).length&&b[0].unknown||a.h.ad(b,"name")?null:"This template engine does not support anonymous templates nested within its templates"},a.f.Z.template=!0}(),a.b("setTemplateEngine",a.Db),a.b("renderTemplate",a.Ab),a.a.dc=function(a,c,d){var e,f,g,k,l;if(a.length&&c.length)for(e=f=0;(!d||e<d)&&(k=a[f]);++f){for(g=0;l=c[g];++g)if(k.value===l.value){k.moved=l.index,l.moved=k.index,c.splice(g,1),e=g=0;break}e+=g}},a.a.ib=function(){function b(b,d,e,f,g){var h,q,t,v,x,k=Math.min,l=Math.max,m=[],n=b.length,p=d.length,s=p-n||1,u=n+p+1;for(h=0;h<=n;h++)for(v=t,m.push(t=[]),x=k(p,h+s),q=l(0,h-1);q<=x;q++)t[q]=q?h?b[h-1]===d[q-1]?v[q-1]:k(v[q]||u,t[q-1]||u)+1:q+1:h+1;for(k=[],l=[],s=[],h=n,q=p;h||q;)p=m[h][q]-1,q&&p===m[h][q-1]?l.push(k[k.length]={status:e,value:d[--q],index:q}):h&&p===m[h-1][q]?s.push(k[k.length]={status:f,value:b[--h],index:h}):(--q,--h,g.sparse||k.push({status:"retained",value:d[q]}));return a.a.dc(s,l,!g.dontLimitMoves&&10*n),k.reverse()}return function(a,d,e){return e="boolean"==typeof e?{dontLimitMoves:e}:e||{},d=d||[],(a=a||[]).length<d.length?b(a,d,"added","deleted",e):b(d,a,"deleted","added",e)}}(),a.b("utils.compareArrays",a.a.ib),function(){function b(b,c,d,k,l){var m=[],h=a.B(function(){var h=c(d,l,a.a.za(m,b))||[];0<m.length&&(a.a.qc(m,h),k&&a.l.w(k,null,[d,h,l])),m.length=0,a.a.ra(m,h)},null,{i:b,wa:function(){return!a.a.Qb(m)}});return{ca:m,B:h.ba()?h:n}}var c=a.a.e.I(),d=a.a.e.I();a.a.Bb=function(e,f,g,k,l){function m(b,c){w=q[c],v!==c&&(D[b]=w),w.qb(v++),a.a.za(w.ca,e),u.push(w),z.push(w)}function h(b,c){if(b)for(var d=0,e=c.length;d<e;d++)c[d]&&a.a.q(c[d].ca,function(a){b(a,d,c[d].ja)})}f=f||[],k=k||{};var F,r=a.a.e.get(e,c)===n,q=a.a.e.get(e,c)||[],p=a.a.fb(q,function(a){return a.ja}),s=a.a.ib(p,f,k.dontLimitMoves),u=[],t=0,v=0,x=[],z=[];f=[];for(var w,B,E,D=[],C=(p=[],0);B=s[C];C++)switch(E=B.moved,B.status){case"deleted":E===n&&((w=q[t]).B&&(w.B.k(),w.B=n),a.a.za(w.ca,e).length&&(k.beforeRemove&&(u.push(w),z.push(w),w.ja===d?w=null:f[C]=w),w&&x.push.apply(x,w.ca))),t++;break;case"retained":m(C,t++);break;case"added":E!==n?m(C,E):(w={ja:B.value,qb:a.N(v++)},u.push(w),z.push(w),r||(p[C]=w))}for(a.a.e.set(e,c,u),h(k.beforeMove,D),a.a.q(x,k.beforeRemove?a.$:a.removeNode),C=0,r=a.f.firstChild(e);w=z[C];C++){for(w.ca||a.a.extend(w,b(e,g,w.ja,l,w.qb)),t=0;s=w.ca[t];r=s.nextSibling,F=s,t++)s!==r&&a.f.gc(e,s,F);!w.Wc&&l&&(l(w.ja,w.ca,w.qb),w.Wc=!0)}for(h(k.beforeRemove,f),C=0;C<f.length;++C)f[C]&&(f[C].ja=d);h(k.afterMove,D),h(k.afterAdd,p)}}(),a.b("utils.setDomNodeChildrenFromArrayMapping",a.a.Bb),a.W=function(){this.allowTemplateRewriting=!1},a.W.prototype=new a.O,a.W.prototype.renderTemplateSource=function(b,c,d,e){return(c=a.a.C<9||!b.nodes?null:b.nodes())?a.a.V(c.cloneNode(!0).childNodes):(b=b.text(),a.a.ma(b,e))},a.W.sb=new a.W,a.Db(a.W.sb),a.b("nativeTemplateEngine",a.W),function(){a.vb=function(){var a=this.$c=function(){if(!v||!v.tmpl)return 0;try{if(0<=v.tmpl.tag.tmpl.open.toString().indexOf("__"))return 2}catch(a){}return 1}();this.renderTemplateSource=function(b,e,f,g){if(g=g||u,f=f||{},a<2)throw Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.");var k=b.data("precompiled");return k||(k=b.text()||"",k=v.template(null,"{{ko_with $item.koBindingContext}}"+k+"{{/ko_with}}"),b.data("precompiled",k)),b=[e.$data],e=v.extend({koBindingContext:e},f.templateOptions),(e=v.tmpl(k,b,e)).appendTo(g.createElement("div")),v.fragments={},e},this.createJavaScriptEvaluatorBlock=function(a){return"{{ko_code ((function() { return "+a+" })()) }}"},this.addTemplate=function(a,b){u.write("<script type='text/html' id='"+a+"'>"+b+"<\/script>")},0<a&&(v.tmpl.tag.ko_code={open:"__.push($1 || '');"},v.tmpl.tag.ko_with={open:"with($1) {",close:"} "})},a.vb.prototype=new a.O;var b=new a.vb;0<b.$c&&a.Db(b),a.b("jqueryTmplTemplateEngine",a.vb)}()})}(),function(a,b){"use strict";function c(a,b){if(!a||"object"!=typeof a)throw new Error("When calling ko.track, you must pass an object as the first parameter.");return function(a){return!!a&&"object"==typeof a&&a.constructor===Object}(b)?(b.deep=b.deep||!1,b.fields=b.fields||Object.getOwnPropertyNames(a),b.lazy=b.lazy||!1,h(a,b.fields,b)):h(a,b||Object.getOwnPropertyNames(a),{}),a}function e(a){return a&&"object"==typeof a&&"Object"===function(a){return a.name?a.name:(a.toString().trim().match(A)||[])[1]}(a.constructor)}function f(a,c,d){var e=w.isObservable(a),f=!e&&Array.isArray(a),g=e?a:f?w.observableArray(a):w.observable(a);return d[c]=function(){return g},(f||e&&"push"in g)&&m(w,g),{configurable:!0,enumerable:!0,get:g,set:w.isWriteableObservable(g)?g:b}}function h(a,b,c){if(b.length){var d=j(a,!0),i={};b.forEach(function(b){if(!(b in d)&&!1!==Object.getOwnPropertyDescriptor(a,b).configurable){var j=a[b];i[b]=(c.lazy?function(a,b,c){function d(a,b){return e?b?e(a):e:Array.isArray(a)?(e=w.observableArray(a),m(w,e),e):e=w.observable(a)}return w.isObservable(a)?f(a,b,c):(c[b]=function(){return d(a)},{configurable:!0,enumerable:!0,get:function(){return d(a)()},set:function(a){d(a,!0)}});var e}:f)(j,b,d),c.deep&&e(j)&&h(j,Object.keys(j),c)}}),Object.defineProperties(a,i)}}function j(a,b){x||(x=z());var c=x.get(a);return!c&&b&&(c={},x.set(a,c)),c}function k(a,b){if(x)if(1===arguments.length)x.delete(a);else{var c=j(a,!1);c&&b.forEach(function(a){delete c[a]})}}function l(a,b,d){var f={owner:a,deferEvaluation:!0};if("function"==typeof d)f.read=d;else{if("value"in d)throw new Error('For ko.defineProperty, you must not specify a "value" for the property. You must provide a "get" function.');if("function"!=typeof d.get)throw new Error('For ko.defineProperty, the third parameter must be either an evaluator function, or an options object containing a function called "get".');f.read=d.get,f.write=d.set}return a[b]=this.computed(f),c.call(this,a,[b]),a}function m(a,b){var c=null;a.computed(function(){c&&(c.dispose(),c=null);var d=b();d instanceof Array&&(c=function(a,b,c){return function(a,b){y||(y=z());var c=y.get(b);if(!c){c=new a.subscribable,y.set(b,c);var d={};(function(a,b,c){["pop","push","reverse","shift","sort","splice","unshift"].forEach(function(d){var e=a[d];a[d]=function(){var a=e.apply(this,arguments);return!0!==c.pause&&b.notifySubscribers(this),a}})})(b,c,d),function(a,b,c,d){["remove","removeAll","destroy","destroyAll","replace"].forEach(function(e){Object.defineProperty(b,e,{enumerable:!1,value:function(){var f;d.pause=!0;try{f=a.observableArray.fn[e].apply(a.observableArray(b),arguments)}finally{d.pause=!1}return c.notifySubscribers(b),f}})})}(a,b,c,d)}return c}(a,c).subscribe(b)}(a,b,d))})}function r(a,b){if(!a||"object"!=typeof a)return null;var c=j(a,!1);return c&&b in c?c[b]():null}function s(a,b){if(!a||"object"!=typeof a)return!1;var c=j(a,!1);return!!c&&b in c}function t(a,b){var c=r(a,b);c&&c.valueHasMutated()}function u(a){a.track=c,a.untrack=k,a.getObservable=r,a.valueHasMutated=t,a.defineProperty=l,a.es5={getAllObservablesForObject:j,notifyWhenPresentOrFutureArrayValuesMutate:m,isTracked:s}}var w,x,y,z,A=/^function\s*([^\s(]+)/;!function(){if("object"==typeof exports&&"object"==typeof module){w=require("knockout");var b=require("../lib/weakmap");u(w),z=function(){return new b},module.exports=w}else"function"==typeof define&&define.amd?define("KnockoutES5",["knockout"],function(b){return u(w=b),z=function(){return new a.WeakMap},b}):"ko"in a&&(w=a.ko,u(a.ko),z=function(){return new a.WeakMap})}()}(this),function(a,b,c){function d(a,b,c){return"function"==typeof b&&(b=e(c=b).replace(/_$/,"")),j(a,b,{configurable:!0,writable:!0,value:c})}function e(a){return"function"!=typeof a?"":"_name"in a?a._name:"name"in a?a.name:k.call(a).match(n)[1]}function f(a,b){return b._name=a,b}function g(a){var d=new p;return a||(a=q),function(b,e){return e||2===arguments.length?d.set(b,e):(e=d.get(b))===c&&(e=a(b),d.set(b,e)),e}}var h=Object.getOwnPropertyNames,i="object"==typeof window?Object.getOwnPropertyNames(window):[],j=Object.defineProperty,k=Function.prototype.toString,l=Object.create,m=Object.prototype.hasOwnProperty,n=/^\n?function\s?(\w*)?_?\(/,o=function(){function a(){var a=g(),c={};this.unlock=function(d){var e=function(a){if(m.call(a,k))return a[k];if(!Object.isExtensible(a))throw new TypeError("Object must be extensible");var b=l(null);return j(a,k,{value:b}),b}(d);if(m.call(e,a))return e[a](c);var f=l(null,b);return j(e,a,{value:function(a){return a===c?f:void 0}}),f}}var b={value:{writable:!0,value:c}},e=l(null),g=function(){var a=Math.random().toString(36).slice(2);return a in e?g():e[a]=a},k=g();return d(Object,f("getOwnPropertyNames",function(a){var b,c=Object(a);if(c!==Window.prototype&&"toString"in c&&"[object Window]"===c.toString())try{b=h(a)}catch(d){b=i}else b=h(a);return m.call(a,k)&&b.splice(b.indexOf(k),1),b})),d(a.prototype,f("get",function(a){return this.unlock(a).value})),d(a.prototype,f("set",function(a,b){this.unlock(a).value=b})),a}(),p=function(g){function h(b){return this===a||null==this||this===h.prototype?new h(b):(p(this,new o),void r(this,b))}function i(a){n(a);var d=q(this).get(a);return d===b?c:d}function j(a,d){n(a),q(this).set(a,d===c?b:d)}function k(a){return n(a),q(this).get(a)!==c}function m(){return q(this),"[object WeakMap]"}var n=function(a){if(null==a||"object"!=typeof a&&"function"!=typeof a)throw new TypeError("Invalid WeakMap key")},p=function(a,b){var c=g.unlock(a);if(c.value)throw new TypeError("Object is already a WeakMap");c.value=b},q=function(a){var b=g.unlock(a).value;if(!b)throw new TypeError("WeakMap is not generic");return b},r=function(a,b){null!==b&&"object"==typeof b&&"function"==typeof b.forEach&&b.forEach(function(c,d){c instanceof Array&&2===c.length&&j.call(a,b[d][0],b[d][1])})};i._name="get",j._name="set",k._name="has",m._name="toString";var s=(""+Object).split("Object"),t=f("toString",function(){return s[0]+e(this)+s[1]});d(t,t);var u={__proto__:[]}instanceof Array?function(a){a.__proto__=t}:function(a){d(a,t)};return u(h),[m,i,j,k,function(a){n(a);var b=q(this),d=b.get(a)!==c;return b.set(a,c),d}].forEach(function(a){d(h.prototype,a),u(a)}),h}(new o),q=Object.create?function(){return Object.create(null)}:function(){return{}};"undefined"!=typeof module?module.exports=p:"undefined"!=typeof exports?exports.WeakMap=p:"WeakMap"in a||(a.WeakMap=p),p.createStorage=g,a.WeakMap&&(a.WeakMap.createStorage=g)}(function(){return this}()),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("markdown-it-sanitizer",[],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).markdownitSanitizer=e()}}(function(){return function e(t,n,r){function o(l,f){if(!n[l]){if(!t[l]){var a="function"==typeof require&&require;if(!f&&a)return a(l,!0);if(i)return i(l,!0);var s=new Error("Cannot find module '"+l+"'");throw s.code="MODULE_NOT_FOUND",s}var u=n[l]={exports:{}};t[l][0].call(u.exports,function(e){var n=t[l][1][e];return o(n||e)},u,u.exports,e,t,n,r)}return n[l].exports}for(var i="function"==typeof require&&require,l=0;l<r.length;l++)o(r[l]);return o}({1:[function(e,t,n){"use strict";t.exports=function(e,t){function n(e){var t=l.match(e);return t&&1===t.length&&0===t[0].index&&t[0].lastIndex===e.length?t[0].url:null}function r(e){var r=RegExp('<a\\shref="([^"<>]*)"(?:\\stitle="([^"<>]*)")?>',"i"),i=RegExp('<img\\s([^<>]*src="[^"<>]*"[^<>]*)\\s?\\/?>',"i");return e.replace(/<[^<>]*>?/gi,function(e){var t,o,l,a,u;if(/(^<->|^<-\s|^<3\s)/.test(e))return e;if(t=e.match(i)){var m=t[1];if(o=n(m.match(/src="([^"<>]*)"/i)[1]),l=(l=m.match(/alt="([^"<>]*)"/i))&&void 0!==l[1]?l[1]:"",a=(a=m.match(/title="([^"<>]*)"/i))&&void 0!==a[1]?a[1]:"",o&&/^https?:\/\//i.test(o))return""!==c?'<img src="'+o+'" alt="'+l+'" title="'+a+'" class="'+c+'">':'<img src="'+o+'" alt="'+l+'" title="'+a+'">'}return u=d.indexOf("a"),(t=e.match(r))&&(a=void 0!==t[2]?t[2]:"",(o=n(t[1]))&&/^(?:https?:\/\/|ftp:\/\/|mailto:|xmpp:)/i.test(o))?(p=!0,h[u]+=1,'<a href="'+o+'" title="'+a+'" target="_blank">'):(t=/<\/a>/i.test(e))?(p=!0,h[u]-=1,h[u]<0&&(g[u]=!0),"</a>"):(t=e.match(/<(br|hr)\s?\/?>/i))?"<"+t[1].toLowerCase()+">":(t=e.match(/<(\/?)(b|blockquote|code|em|h[1-6]|li|ol(?: start="\d+")?|p|pre|s|sub|sup|strong|ul)>/i))&&!/<\/ol start="\d+"/i.test(e)?(p=!0,u=d.indexOf(t[2].toLowerCase().split(" ")[0]),"/"===t[1]?h[u]-=1:h[u]+=1,h[u]<0&&(g[u]=!0),"<"+t[1]+t[2].toLowerCase()+">"):!0===s?"":f(e)})}var a,l=e.linkify,f=e.utils.escapeHtml,s=void 0!==(t=t||{}).removeUnknown&&t.removeUnknown,u=void 0!==t.removeUnbalanced&&t.removeUnbalanced,c=void 0!==t.imageClass?t.imageClass:"",p=!1,d=["a","b","blockquote","code","em","h1","h2","h3","h4","h5","h6","li","ol","p","pre","s","sub","sup","strong","ul"],h=new Array(d.length),g=new Array(d.length);for(a=0;a<d.length;a++)h[a]=0;for(a=0;a<d.length;a++)g[a]=!1;e.core.ruler.after("linkify","sanitize_inline",function(e){var t,n,o;for(a=0;a<d.length;a++)h[a]=0;for(a=0;a<d.length;a++)g[a]=!1;for(p=!1,n=0;n<e.tokens.length;n++)if("html_block"===e.tokens[n].type&&(e.tokens[n].content=r(e.tokens[n].content)),"inline"===e.tokens[n].type)for(o=e.tokens[n].children,t=0;t<o.length;t++)"html_inline"===o[t].type&&(o[t].content=r(o[t].content))}),e.core.ruler.after("sanitize_inline","sanitize_balance",function(e){function t(e,t){var n,r;return n="a"===t?RegExp('<a href="[^"<>]*" title="[^"<>]*" target="_blank">',"g"):"ol"===t?/<ol(?: start="\d+")?>/g:RegExp("<"+t+">","g"),r=RegExp("</"+t+">","g"),e=!0===u?(e=e.replace(n,"")).replace(r,""):(e=e.replace(n,function(e){return f(e)})).replace(r,function(e){return f(e)})}function n(e){var n;for(n=0;n<d.length;n++)!0===g[n]&&(e=t(e,d[n]));return e}if(!1!==p){var r,o;for(a=0;a<d.length;a++)0!==h[a]&&(g[a]=!0);for(r=0;r<e.tokens.length;r++)if("html_block"!==e.tokens[r].type){if("inline"===e.tokens[r].type)for(o=e.tokens[r].children,a=0;a<o.length;a++)"html_inline"===o[a].type&&(o[a].content=n(o[a].content))}else e.tokens[r].content=n(e.tokens[r].content)}})}},{}]},{},[1])(1)}),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("markdown-it",[],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).markdownit=e()}}(function(){return function r(e,t,n){function s(i,a){if(!t[i]){if(!e[i]){var c="function"==typeof require&&require;if(!a&&c)return c(i,!0);if(o)return o(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var u=t[i]={exports:{}};e[i][0].call(u.exports,function(r){var t=e[i][1][r];return s(t||r)},u,u.exports,r,e,t,n)}return t[i].exports}for(var o="function"==typeof require&&require,i=0;i<n.length;i++)s(n[i]);return s}({1:[function(e,r,t){"use strict";r.exports=e("entities/maps/entities.json")},{"entities/maps/entities.json":53}],2:[function(e,r,t){"use strict";r.exports=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","meta","nav","noframes","ol","optgroup","option","p","param","pre","section","source","title","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"]},{}],3:[function(e,r,t){"use strict";var l="<[A-Za-z][A-Za-z0-9\\-]*(?:\\s+[a-zA-Z_:][a-zA-Z0-9:._-]*(?:\\s*=\\s*(?:[^\"'=<>`\\x00-\\x20]+|'[^']*'|\"[^\"]*\"))?)*\\s*\\/?>",u="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>",m=new RegExp("^(?:"+l+"|"+u+"|\x3c!----\x3e|\x3c!--(?:-?[^>-])(?:-?[^-])*--\x3e|<[?].*?[?]>|<![A-Z]+\\s+[^>]*>|<!\\[CDATA\\[[\\s\\S]*?\\]\\]>)"),_=new RegExp("^(?:"+l+"|"+u+")");r.exports.HTML_TAG_RE=m,r.exports.HTML_OPEN_CLOSE_TAG_RE=_},{}],4:[function(e,r,t){"use strict";function o(e,r){return x.call(e,r)}function c(e){return!(55296<=e&&e<=57343||64976<=e&&e<=65007||65535==(65535&e)||65534==(65535&e)||0<=e&&e<=8||11===e||14<=e&&e<=31||127<=e&&e<=159||1114111<e)}function l(e){if(65535<e){var r=55296+((e-=65536)>>10),t=56320+(1023&e);return String.fromCharCode(r,t)}return String.fromCharCode(e)}function f(e){return S[e]}var x=Object.prototype.hasOwnProperty,y=/\\([!"#$%&'()*+,\-.\/:;<=>?@[\\\]^_`{|}~])/g,A=new RegExp(y.source+"|"+/&([a-z#][a-z0-9]{1,31});/gi.source,"gi"),w=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))/i,D=e("./entities"),q=/[&<>"]/,E=/[&<>"]/g,S={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"},F=/[.?*+^$[\]\\(){}|-]/g,z=e("uc.micro/categories/P/regex");t.lib={},t.lib.mdurl=e("mdurl"),t.lib.ucmicro=e("uc.micro"),t.assign=function(e){return Array.prototype.slice.call(arguments,1).forEach(function(r){if(r){if("object"!=typeof r)throw new TypeError(r+"must be object");Object.keys(r).forEach(function(t){e[t]=r[t]})}}),e},t.isString=function(e){return"[object String]"===function(e){return Object.prototype.toString.call(e)}(e)},t.has=o,t.unescapeMd=function(e){return e.indexOf("\\")<0?e:e.replace(y,"$1")},t.unescapeAll=function(e){return e.indexOf("\\")<0&&e.indexOf("&")<0?e:e.replace(A,function(e,r,t){return r||function(e,r){var t=0;return o(D,r)?D[r]:35===r.charCodeAt(0)&&w.test(r)&&c(t="x"===r[1].toLowerCase()?parseInt(r.slice(2),16):parseInt(r.slice(1),10))?l(t):e}(e,t)})},t.isValidEntityCode=c,t.fromCodePoint=l,t.escapeHtml=function(e){return q.test(e)?e.replace(E,f):e},t.arrayReplaceAt=function(e,r,t){return[].concat(e.slice(0,r),t,e.slice(r+1))},t.isSpace=function(e){switch(e){case 9:case 32:return!0}return!1},t.isWhiteSpace=function(e){if(8192<=e&&e<=8202)return!0;switch(e){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1},t.isMdAsciiPunct=function(e){switch(e){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 124:case 125:case 126:return!0;default:return!1}},t.isPunctChar=function(e){return z.test(e)},t.escapeRE=function(e){return e.replace(F,"\\$&")},t.normalizeReference=function(e){return e.trim().replace(/\s+/g," ").toUpperCase()}},{"./entities":1,mdurl:59,"uc.micro":65,"uc.micro/categories/P/regex":63}],5:[function(e,r,t){"use strict";t.parseLinkLabel=e("./parse_link_label"),t.parseLinkDestination=e("./parse_link_destination"),t.parseLinkTitle=e("./parse_link_title")},{"./parse_link_destination":6,"./parse_link_label":7,"./parse_link_title":8}],6:[function(e,r,t){"use strict";var n=e("../common/utils").isSpace,s=e("../common/utils").unescapeAll;r.exports=function(e,r,t){var o,i,c=r,l={ok:!1,pos:0,lines:0,str:""};if(60===e.charCodeAt(r)){for(r++;r<t;){if(10===(o=e.charCodeAt(r))||n(o))return l;if(62===o)return l.pos=r+1,l.str=s(e.slice(c+1,r)),l.ok=!0,l;92===o&&r+1<t?r+=2:r++}return l}for(i=0;r<t&&32!==(o=e.charCodeAt(r))&&!(o<32||127===o);)if(92===o&&r+1<t)r+=2;else{if(40===o&&1<++i)break;if(41===o&&--i<0)break;r++}return c===r||(l.str=s(e.slice(c,r)),l.lines=0,l.pos=r,l.ok=!0),l}},{"../common/utils":4}],7:[function(e,r,t){"use strict";r.exports=function(e,r,t){var n,s,o,i,a=-1,c=e.posMax,l=e.pos;for(e.pos=r+1,n=1;e.pos<c;){if(93===(o=e.src.charCodeAt(e.pos))&&0===--n){s=!0;break}if(i=e.pos,e.md.inline.skipToken(e),91===o)if(i===e.pos-1)n++;else if(t)return e.pos=l,-1}return s&&(a=e.pos),e.pos=l,a}},{}],8:[function(e,r,t){"use strict";var n=e("../common/utils").unescapeAll;r.exports=function(e,r,t){var s,o,i=0,a=r,c={ok:!1,pos:0,lines:0,str:""};if(t<=r)return c;if(34!==(o=e.charCodeAt(r))&&39!==o&&40!==o)return c;for(r++,40===o&&(o=41);r<t;){if((s=e.charCodeAt(r))===o)return c.pos=r+1,c.lines=i,c.str=n(e.slice(a+1,r)),c.ok=!0,c;10===s?i++:92===s&&r+1<t&&(r++,10===e.charCodeAt(r)&&i++),r++}return c}},{"../common/utils":4}],9:[function(e,r,t){"use strict";function n(e){var r=e.trim().toLowerCase();return!g.test(r)||!!k.test(r)}function s(e){var r=d.parse(e,!0);if(r.hostname&&(!r.protocol||0<=b.indexOf(r.protocol)))try{r.hostname=m.toASCII(r.hostname)}catch(t){}return d.encode(d.format(r))}function o(e){var r=d.parse(e,!0);if(r.hostname&&(!r.protocol||0<=b.indexOf(r.protocol)))try{r.hostname=m.toUnicode(r.hostname)}catch(t){}return d.decode(d.format(r))}function i(e,r){return this instanceof i?(r||a.isString(e)||(r=e||{},e="default"),this.inline=new h,this.block=new p,this.core=new u,this.renderer=new l,this.linkify=new f,this.validateLink=n,this.normalizeLink=s,this.normalizeLinkText=o,this.utils=a,this.helpers=c,this.options={},this.configure(e),void(r&&this.set(r))):new i(e,r)}var a=e("./common/utils"),c=e("./helpers"),l=e("./renderer"),u=e("./parser_core"),p=e("./parser_block"),h=e("./parser_inline"),f=e("linkify-it"),d=e("mdurl"),m=e("punycode"),_={default:e("./presets/default"),zero:e("./presets/zero"),commonmark:e("./presets/commonmark")},g=/^(vbscript|javascript|file|data):/,k=/^data:image\/(gif|png|jpeg|webp);/,b=["http:","https:","mailto:"];i.prototype.set=function(e){return a.assign(this.options,e),this},i.prototype.configure=function(e){var r,t=this;if(a.isString(e)&&!(e=_[r=e]))throw new Error('Wrong `markdown-it` preset "'+r+'", check name');if(!e)throw new Error("Wrong `markdown-it` preset, can't be empty");return e.options&&t.set(e.options),e.components&&Object.keys(e.components).forEach(function(r){e.components[r].rules&&t[r].ruler.enableOnly(e.components[r].rules),e.components[r].rules2&&t[r].ruler2.enableOnly(e.components[r].rules2)}),this},i.prototype.enable=function(e,r){var t=[];Array.isArray(e)||(e=[e]),["core","block","inline"].forEach(function(r){t=t.concat(this[r].ruler.enable(e,!0))},this),t=t.concat(this.inline.ruler2.enable(e,!0));var n=e.filter(function(e){return t.indexOf(e)<0});if(n.length&&!r)throw new Error("MarkdownIt. Failed to enable unknown rule(s): "+n);return this},i.prototype.disable=function(e,r){var t=[];Array.isArray(e)||(e=[e]),["core","block","inline"].forEach(function(r){t=t.concat(this[r].ruler.disable(e,!0))},this),t=t.concat(this.inline.ruler2.disable(e,!0));var n=e.filter(function(e){return t.indexOf(e)<0});if(n.length&&!r)throw new Error("MarkdownIt. Failed to disable unknown rule(s): "+n);return this},i.prototype.use=function(e){var r=[this].concat(Array.prototype.slice.call(arguments,1));return e.apply(e,r),this},i.prototype.parse=function(e,r){var t=new this.core.State(e,this,r);return this.core.process(t),t.tokens},i.prototype.render=function(e,r){return r=r||{},this.renderer.render(this.parse(e,r),this.options,r)},i.prototype.parseInline=function(e,r){var t=new this.core.State(e,this,r);return t.inlineMode=!0,this.core.process(t),t.tokens},i.prototype.renderInline=function(e,r){return r=r||{},this.renderer.render(this.parseInline(e,r),this.options,r)},r.exports=i},{"./common/utils":4,"./helpers":5,"./parser_block":10,"./parser_core":11,"./parser_inline":12,"./presets/commonmark":13,"./presets/default":14,"./presets/zero":15,"./renderer":16,"linkify-it":54,mdurl:59,punycode:52}],10:[function(e,r,t){"use strict";function n(){this.ruler=new s;for(var e=0;e<o.length;e++)this.ruler.push(o[e][0],o[e][1],{alt:(o[e][2]||[]).slice()})}var s=e("./ruler"),o=[["table",e("./rules_block/table"),["paragraph","reference"]],["code",e("./rules_block/code")],["fence",e("./rules_block/fence"),["paragraph","reference","blockquote","list"]],["blockquote",e("./rules_block/blockquote"),["paragraph","reference","list"]],["hr",e("./rules_block/hr"),["paragraph","reference","blockquote","list"]],["list",e("./rules_block/list"),["paragraph","reference","blockquote"]],["reference",e("./rules_block/reference")],["heading",e("./rules_block/heading"),["paragraph","reference","blockquote"]],["lheading",e("./rules_block/lheading")],["html_block",e("./rules_block/html_block"),["paragraph","reference","blockquote"]],["paragraph",e("./rules_block/paragraph")]];n.prototype.tokenize=function(e,r,t){for(var s,o=this.ruler.getRules(""),i=o.length,a=r,c=!1,l=e.md.options.maxNesting;a<t&&(e.line=a=e.skipEmptyLines(a),!(t<=a))&&!(e.sCount[a]<e.blkIndent);){if(e.level>=l){e.line=t;break}for(s=0;s<i&&!o[s](e,a,t,!1);s++);if(e.tight=!c,e.isEmpty(e.line-1)&&(c=!0),(a=e.line)<t&&e.isEmpty(a)){if(c=!0,++a<t&&"list"===e.parentType&&e.isEmpty(a))break;e.line=a}}},n.prototype.parse=function(e,r,t,n){var s;e&&(s=new this.State(e,r,t,n),this.tokenize(s,s.line,s.lineMax))},n.prototype.State=e("./rules_block/state_block"),r.exports=n},{"./ruler":17,"./rules_block/blockquote":18,"./rules_block/code":19,"./rules_block/fence":20,"./rules_block/heading":21,"./rules_block/hr":22,"./rules_block/html_block":23,"./rules_block/lheading":24,"./rules_block/list":25,"./rules_block/paragraph":26,"./rules_block/reference":27,"./rules_block/state_block":28,"./rules_block/table":29}],11:[function(e,r,t){"use strict";function n(){this.ruler=new s;for(var e=0;e<o.length;e++)this.ruler.push(o[e][0],o[e][1])}var s=e("./ruler"),o=[["normalize",e("./rules_core/normalize")],["block",e("./rules_core/block")],["inline",e("./rules_core/inline")],["linkify",e("./rules_core/linkify")],["replacements",e("./rules_core/replacements")],["smartquotes",e("./rules_core/smartquotes")]];n.prototype.process=function(e){var r,t,n;for(r=0,t=(n=this.ruler.getRules("")).length;r<t;r++)n[r](e)},n.prototype.State=e("./rules_core/state_core"),r.exports=n},{"./ruler":17,"./rules_core/block":30,"./rules_core/inline":31,"./rules_core/linkify":32,"./rules_core/normalize":33,"./rules_core/replacements":34,"./rules_core/smartquotes":35,"./rules_core/state_core":36}],12:[function(e,r,t){"use strict";function n(){var e;for(this.ruler=new s,e=0;e<o.length;e++)this.ruler.push(o[e][0],o[e][1]);for(this.ruler2=new s,e=0;e<i.length;e++)this.ruler2.push(i[e][0],i[e][1])}var s=e("./ruler"),o=[["text",e("./rules_inline/text")],["newline",e("./rules_inline/newline")],["escape",e("./rules_inline/escape")],["backticks",e("./rules_inline/backticks")],["strikethrough",e("./rules_inline/strikethrough").tokenize],["emphasis",e("./rules_inline/emphasis").tokenize],["link",e("./rules_inline/link")],["image",e("./rules_inline/image")],["autolink",e("./rules_inline/autolink")],["html_inline",e("./rules_inline/html_inline")],["entity",e("./rules_inline/entity")]],i=[["balance_pairs",e("./rules_inline/balance_pairs")],["strikethrough",e("./rules_inline/strikethrough").postProcess],["emphasis",e("./rules_inline/emphasis").postProcess],["text_collapse",e("./rules_inline/text_collapse")]];n.prototype.skipToken=function(e){var r,t,n=e.pos,s=this.ruler.getRules(""),o=s.length,i=e.md.options.maxNesting,a=e.cache;if(void 0===a[n]){if(e.level<i)for(t=0;t<o&&(e.level++,r=s[t](e,!0),e.level--,!r);t++);else e.pos=e.posMax;r||e.pos++,a[n]=e.pos}else e.pos=a[n]},n.prototype.tokenize=function(e){for(var r,t,n=this.ruler.getRules(""),s=n.length,o=e.posMax,i=e.md.options.maxNesting;e.pos<o;){if(e.level<i)for(t=0;t<s&&!(r=n[t](e,!1));t++);if(r){if(e.pos>=o)break}else e.pending+=e.src[e.pos++]}e.pending&&e.pushPending()},n.prototype.parse=function(e,r,t,n){var s,o,i,a=new this.State(e,r,t,n);for(this.tokenize(a),i=(o=this.ruler2.getRules("")).length,s=0;s<i;s++)o[s](a)},n.prototype.State=e("./rules_inline/state_inline"),r.exports=n},{"./ruler":17,"./rules_inline/autolink":37,"./rules_inline/backticks":38,"./rules_inline/balance_pairs":39,"./rules_inline/emphasis":40,"./rules_inline/entity":41,"./rules_inline/escape":42,"./rules_inline/html_inline":43,"./rules_inline/image":44,"./rules_inline/link":45,"./rules_inline/newline":46,"./rules_inline/state_inline":47,"./rules_inline/strikethrough":48,"./rules_inline/text":49,"./rules_inline/text_collapse":50}],13:[function(e,r,t){"use strict";r.exports={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline"]},block:{rules:["blockquote","code","fence","heading","hr","html_block","lheading","list","reference","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","html_inline","image","link","newline","text"],rules2:["balance_pairs","emphasis","text_collapse"]}}}},{}],14:[function(e,r,t){"use strict";r.exports={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:100},components:{core:{},block:{},inline:{}}}},{}],15:[function(e,r,t){"use strict";r.exports={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline"]},block:{rules:["paragraph"]},inline:{rules:["text"],rules2:["balance_pairs","text_collapse"]}}}},{}],16:[function(e,r,t){"use strict";function n(){this.rules=s({},a)}var s=e("./common/utils").assign,o=e("./common/utils").unescapeAll,i=e("./common/utils").escapeHtml,a={code_inline:function(e,r,t,n,s){var o=e[r],a=s.renderAttrs(o);return"<code"+(a?" "+a:"")+">"+i(e[r].content)+"</code>"},code_block:function(e,r,t,n,s){var o=e[r],a=s.renderAttrs(o);return"<pre"+(a?" "+a:"")+"><code>"+i(e[r].content)+"</code></pre>\n"},fence:function(e,r,t,n,s){var a,c,l,u,p=e[r],h=p.info?o(p.info).trim():"",f="";return h&&(f=h.split(/\s+/g)[0]),0===(a=t.highlight&&t.highlight(p.content,f)||i(p.content)).indexOf("<pre")?a+"\n":h?(c=p.attrIndex("class"),l=p.attrs?p.attrs.slice():[],c<0?l.push(["class",t.langPrefix+f]):l[c]+=" "+t.langPrefix+f,u={attrs:l},"<pre><code"+s.renderAttrs(u)+">"+a+"</code></pre>\n"):"<pre><code"+s.renderAttrs(p)+">"+a+"</code></pre>\n"},image:function(e,r,t,n,s){var o=e[r];return o.attrs[o.attrIndex("alt")][1]=s.renderInlineAsText(o.children,t,n),s.renderToken(e,r,t)},hardbreak:function(e,r,t){return t.xhtmlOut?"<br />\n":"<br>\n"},softbreak:function(e,r,t){return t.breaks?t.xhtmlOut?"<br />\n":"<br>\n":"\n"},text:function(e,r){return i(e[r].content)},html_block:function(e,r){return e[r].content},html_inline:function(e,r){return e[r].content}};n.prototype.renderAttrs=function(e){var r,t,n;if(!e.attrs)return"";for(n="",r=0,t=e.attrs.length;r<t;r++)n+=" "+i(e.attrs[r][0])+'="'+i(e.attrs[r][1])+'"';return n},n.prototype.renderToken=function(e,r,t){var n,s="",o=!1,i=e[r];return i.hidden?"":(i.block&&-1!==i.nesting&&r&&e[r-1].hidden&&(s+="\n"),s+=(-1===i.nesting?"</":"<")+i.tag,s+=this.renderAttrs(i),0===i.nesting&&t.xhtmlOut&&(s+=" /"),i.block&&(o=!0,1===i.nesting&&r+1<e.length&&("inline"===(n=e[r+1]).type||n.hidden?o=!1:-1===n.nesting&&n.tag===i.tag&&(o=!1))),s+=o?">\n":">")},n.prototype.renderInline=function(e,r,t){for(var n,s="",o=this.rules,i=0,a=e.length;i<a;i++)s+=void 0!==o[n=e[i].type]?o[n](e,i,r,t,this):this.renderToken(e,i,r);return s},n.prototype.renderInlineAsText=function(e,r,t){for(var n="",s=0,o=e.length;s<o;s++)"text"===e[s].type?n+=e[s].content:"image"===e[s].type&&(n+=this.renderInlineAsText(e[s].children,r,t));return n},n.prototype.render=function(e,r,t){var n,s,o,i="",a=this.rules;for(n=0,s=e.length;n<s;n++)i+="inline"===(o=e[n].type)?this.renderInline(e[n].children,r,t):void 0!==a[o]?a[e[n].type](e,n,r,t,this):this.renderToken(e,n,r,t);return i},r.exports=n},{"./common/utils":4}],17:[function(e,r,t){"use strict";function n(){this.__rules__=[],this.__cache__=null}n.prototype.__find__=function(e){for(var r=0;r<this.__rules__.length;r++)if(this.__rules__[r].name===e)return r;return-1},n.prototype.__compile__=function(){var e=this,r=[""];e.__rules__.forEach(function(e){e.enabled&&e.alt.forEach(function(e){r.indexOf(e)<0&&r.push(e)})}),e.__cache__={},r.forEach(function(r){e.__cache__[r]=[],e.__rules__.forEach(function(t){t.enabled&&(r&&t.alt.indexOf(r)<0||e.__cache__[r].push(t.fn))})})},n.prototype.at=function(e,r,t){var n=this.__find__(e),s=t||{};if(-1===n)throw new Error("Parser rule not found: "+e);this.__rules__[n].fn=r,this.__rules__[n].alt=s.alt||[],this.__cache__=null},n.prototype.before=function(e,r,t,n){var s=this.__find__(e),o=n||{};if(-1===s)throw new Error("Parser rule not found: "+e);this.__rules__.splice(s,0,{name:r,enabled:!0,fn:t,alt:o.alt||[]}),this.__cache__=null},n.prototype.after=function(e,r,t,n){var s=this.__find__(e),o=n||{};if(-1===s)throw new Error("Parser rule not found: "+e);this.__rules__.splice(s+1,0,{name:r,enabled:!0,fn:t,alt:o.alt||[]}),this.__cache__=null},n.prototype.push=function(e,r,t){var n=t||{};this.__rules__.push({name:e,enabled:!0,fn:r,alt:n.alt||[]}),this.__cache__=null},n.prototype.enable=function(e,r){Array.isArray(e)||(e=[e]);var t=[];return e.forEach(function(e){var n=this.__find__(e);if(n<0){if(r)return;throw new Error("Rules manager: invalid rule name "+e)}this.__rules__[n].enabled=!0,t.push(e)},this),this.__cache__=null,t},n.prototype.enableOnly=function(e,r){Array.isArray(e)||(e=[e]),this.__rules__.forEach(function(e){e.enabled=!1}),this.enable(e,r)},n.prototype.disable=function(e,r){Array.isArray(e)||(e=[e]);var t=[];return e.forEach(function(e){var n=this.__find__(e);if(n<0){if(r)return;throw new Error("Rules manager: invalid rule name "+e)}this.__rules__[n].enabled=!1,t.push(e)},this),this.__cache__=null,t},n.prototype.getRules=function(e){return null===this.__cache__&&this.__compile__(),this.__cache__[e]||[]},r.exports=n},{}],18:[function(e,r,t){"use strict";var n=e("../common/utils").isSpace;r.exports=function(e,r,t,s){var o,i,a,c,l,u,p,h,f,d,m,_,g,k,b,v,x=e.bMarks[r]+e.tShift[r],y=e.eMarks[r];if(62!==e.src.charCodeAt(x++))return!1;if(s)return!0;for(32===e.src.charCodeAt(x)&&x++,u=e.blkIndent,e.blkIndent=0,f=d=e.sCount[r]+x-(e.bMarks[r]+e.tShift[r]),l=[e.bMarks[r]],e.bMarks[r]=x;x<y&&(m=e.src.charCodeAt(x),n(m));)9===m?d+=4-d%4:d++,x++;for(i=y<=x,c=[e.sCount[r]],e.sCount[r]=d-f,a=[e.tShift[r]],e.tShift[r]=x-e.bMarks[r],_=e.md.block.ruler.getRules("blockquote"),o=r+1;o<t&&!(e.sCount[o]<u)&&(x=e.bMarks[o]+e.tShift[o],!((y=e.eMarks[o])<=x));o++)if(62!==e.src.charCodeAt(x++)){if(i)break;for(v=!1,k=0,b=_.length;k<b;k++)if(_[k](e,o,t,!0)){v=!0;break}if(v)break;l.push(e.bMarks[o]),a.push(e.tShift[o]),c.push(e.sCount[o]),e.sCount[o]=-1}else{for(32===e.src.charCodeAt(x)&&x++,f=d=e.sCount[o]+x-(e.bMarks[o]+e.tShift[o]),l.push(e.bMarks[o]),e.bMarks[o]=x;x<y&&(m=e.src.charCodeAt(x),n(m));)9===m?d+=4-d%4:d++,x++;i=y<=x,c.push(e.sCount[o]),e.sCount[o]=d-f,a.push(e.tShift[o]),e.tShift[o]=x-e.bMarks[o]}for(p=e.parentType,e.parentType="blockquote",(g=e.push("blockquote_open","blockquote",1)).markup=">",g.map=h=[r,0],e.md.block.tokenize(e,r,o),(g=e.push("blockquote_close","blockquote",-1)).markup=">",e.parentType=p,h[1]=e.line,k=0;k<a.length;k++)e.bMarks[k+r]=l[k],e.tShift[k+r]=a[k],e.sCount[k+r]=c[k];return e.blkIndent=u,!0}},{"../common/utils":4}],19:[function(e,r,t){"use strict";r.exports=function(e,r,t){var n,s,o,i=0;if(e.sCount[r]-e.blkIndent<4)return!1;for(s=n=r+1;n<t;)if(e.isEmpty(n)){if(2<=++i&&"list"===e.parentType)break;n++}else{if(i=0,!(4<=e.sCount[n]-e.blkIndent))break;s=++n}return e.line=s,(o=e.push("code_block","code",0)).content=e.getLines(r,s,4+e.blkIndent,!0),o.map=[r,e.line],!0}},{}],20:[function(e,r,t){"use strict";r.exports=function(e,r,t,n){var s,o,i,a,c,l,u,p=!1,h=e.bMarks[r]+e.tShift[r],f=e.eMarks[r];if(f<h+3)return!1;if(126!==(s=e.src.charCodeAt(h))&&96!==s)return!1;if(c=h,(o=(h=e.skipChars(h,s))-c)<3)return!1;if(u=e.src.slice(c,h),0<=(i=e.src.slice(h,f)).indexOf("`"))return!1;if(n)return!0;for(a=r;!(t<=++a||(h=c=e.bMarks[a]+e.tShift[a])<(f=e.eMarks[a])&&e.sCount[a]<e.blkIndent);)if(e.src.charCodeAt(h)===s&&!(4<=e.sCount[a]-e.blkIndent||((h=e.skipChars(h,s))-c<o||(h=e.skipSpaces(h))<f))){p=!0;break}return o=e.sCount[r],e.line=a+(p?1:0),(l=e.push("fence","code",0)).info=i,l.content=e.getLines(r+1,a,o,!0),l.markup=u,l.map=[r,e.line],!0}},{}],21:[function(e,r,t){"use strict";var n=e("../common/utils").isSpace;r.exports=function(e,r,t,s){var o,i,a,c,l=e.bMarks[r]+e.tShift[r],u=e.eMarks[r];if(35!==(o=e.src.charCodeAt(l))||u<=l)return!1;for(i=1,o=e.src.charCodeAt(++l);35===o&&l<u&&i<=6;)i++,o=e.src.charCodeAt(++l);return!(6<i||l<u&&32!==o||!s&&(u=e.skipSpacesBack(u,l),l<(a=e.skipCharsBack(u,35,l))&&n(e.src.charCodeAt(a-1))&&(u=a),e.line=r+1,(c=e.push("heading_open","h"+String(i),1)).markup="########".slice(0,i),c.map=[r,e.line],(c=e.push("inline","",0)).content=e.src.slice(l,u).trim(),c.map=[r,e.line],c.children=[],(c=e.push("heading_close","h"+String(i),-1)).markup="########".slice(0,i),0))}},{"../common/utils":4}],22:[function(e,r,t){"use strict";var n=e("../common/utils").isSpace;r.exports=function(e,r,t,s){var o,i,a,c,l=e.bMarks[r]+e.tShift[r],u=e.eMarks[r];if(42!==(o=e.src.charCodeAt(l++))&&45!==o&&95!==o)return!1;for(i=1;l<u;){if((a=e.src.charCodeAt(l++))!==o&&!n(a))return!1;a===o&&i++}return!(i<3||!s&&(e.line=r+1,(c=e.push("hr","hr",0)).map=[r,e.line],c.markup=Array(i+1).join(String.fromCharCode(o)),0))}},{"../common/utils":4}],23:[function(e,r,t){"use strict";var n=e("../common/html_blocks"),s=e("../common/html_re").HTML_OPEN_CLOSE_TAG_RE,o=[[/^<(script|pre|style)(?=(\s|>|$))/i,/<\/(script|pre|style)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+n.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(s.source+"\\s*$"),/^$/,!1]];r.exports=function(e,r,t,n){var s,i,a,c,l=e.bMarks[r]+e.tShift[r],u=e.eMarks[r];if(!e.md.options.html)return!1;if(60!==e.src.charCodeAt(l))return!1;for(c=e.src.slice(l,u),s=0;s<o.length&&!o[s][0].test(c);s++);if(s===o.length)return!1;if(n)return o[s][2];if(i=r+1,!o[s][1].test(c))for(;i<t&&!(e.sCount[i]<e.blkIndent);i++)if(l=e.bMarks[i]+e.tShift[i],u=e.eMarks[i],c=e.src.slice(l,u),o[s][1].test(c)){0!==c.length&&i++;break}return e.line=i,(a=e.push("html_block","",0)).map=[r,i],a.content=e.getLines(r,i,e.blkIndent,!0),!0}},{"../common/html_blocks":2,"../common/html_re":3}],24:[function(e,r,t){"use strict";r.exports=function(e,r,t){for(var n,s,o,i,a,c,l,u,p,h=r+1,f=e.md.block.ruler.getRules("paragraph");h<t&&!e.isEmpty(h);h++)if(!(3<e.sCount[h]-e.blkIndent)){if(e.sCount[h]>=e.blkIndent&&((c=e.bMarks[h]+e.tShift[h])<(l=e.eMarks[h])&&((45===(p=e.src.charCodeAt(c))||61===p)&&(c=e.skipChars(c,p),l<=(c=e.skipSpaces(c)))))){u=61===p?1:2;break}if(!(e.sCount[h]<0)){for(s=!1,o=0,i=f.length;o<i;o++)if(f[o](e,h,t,!0)){s=!0;break}if(s)break}}return!!u&&(n=e.getLines(r,h,e.blkIndent,!1).trim(),e.line=h+1,(a=e.push("heading_open","h"+String(u),1)).markup=String.fromCharCode(p),a.map=[r,e.line],(a=e.push("inline","",0)).content=n,a.map=[r,e.line-1],a.children=[],(a=e.push("heading_close","h"+String(u),-1)).markup=String.fromCharCode(p),!0)}},{}],25:[function(e,r,t){"use strict";function n(e,r){var t,n,s,o;return n=e.bMarks[r]+e.tShift[r],s=e.eMarks[r],42!==(t=e.src.charCodeAt(n++))&&45!==t&&43!==t?-1:n<s&&(o=e.src.charCodeAt(n),!i(o))?-1:n}function s(e,r){var t,n=e.bMarks[r]+e.tShift[r],s=n,o=e.eMarks[r];if(o<=s+1)return-1;if((t=e.src.charCodeAt(s++))<48||57<t)return-1;for(;;){if(o<=s)return-1;if(!(48<=(t=e.src.charCodeAt(s++))&&t<=57)){if(41===t||46===t)break;return-1}if(10<=s-n)return-1}return s<o&&(t=e.src.charCodeAt(s),!i(t))?-1:s}var i=e("../common/utils").isSpace;r.exports=function(e,r,t,a){var c,l,u,p,h,f,d,m,_,g,k,b,v,x,y,C,A,w,D,q,E,S,F,z,L,T,R,M,I=!0;if(0<=(k=s(e,r)))w=!0;else{if(!(0<=(k=n(e,r))))return!1;w=!1}if(A=e.src.charCodeAt(k-1),a)return!0;for(q=e.tokens.length,w?(g=e.bMarks[r]+e.tShift[r],C=Number(e.src.substr(g,k-g-1)),L=e.push("ordered_list_open","ol",1),1!==C&&(L.attrs=[["start",C]])):L=e.push("bullet_list_open","ul",1),L.map=S=[r,0],L.markup=String.fromCharCode(A),c=r,E=!1,z=e.md.block.ruler.getRules("list");c<t;){for(v=k,x=e.eMarks[c],l=u=e.sCount[c]+k-(e.bMarks[r]+e.tShift[r]);v<x&&(b=e.src.charCodeAt(v),i(b));)9===b?u+=4-u%4:u++,v++;if(4<(y=x<=(D=v)?1:u-l)&&(y=1),p=l+y,(L=e.push("list_item_open","li",1)).markup=String.fromCharCode(A),L.map=F=[r,0],f=e.blkIndent,m=e.tight,h=e.tShift[r],d=e.sCount[r],_=e.parentType,e.blkIndent=p,e.tight=!0,e.parentType="list",e.tShift[r]=D-e.bMarks[r],e.sCount[r]=u,x<=D&&e.isEmpty(r+1)?e.line=Math.min(e.line+2,t):e.md.block.tokenize(e,r,t,!0),e.tight&&!E||(I=!1),E=1<e.line-r&&e.isEmpty(e.line-1),e.blkIndent=f,e.tShift[r]=h,e.sCount[r]=d,e.tight=m,e.parentType=_,(L=e.push("list_item_close","li",-1)).markup=String.fromCharCode(A),c=r=e.line,F[1]=c,D=e.bMarks[r],t<=c)break;if(e.isEmpty(c))break;if(e.sCount[c]<e.blkIndent)break;for(M=!1,T=0,R=z.length;T<R;T++)if(z[T](e,c,t,!0)){M=!0;break}if(M)break;if(w){if((k=s(e,c))<0)break}else if((k=n(e,c))<0)break;if(A!==e.src.charCodeAt(k-1))break}return(L=w?e.push("ordered_list_close","ol",-1):e.push("bullet_list_close","ul",-1)).markup=String.fromCharCode(A),S[1]=c,e.line=c,I&&function(e,r){var t,n,s=e.level+2;for(t=r+2,n=e.tokens.length-2;t<n;t++)e.tokens[t].level===s&&"paragraph_open"===e.tokens[t].type&&(e.tokens[t+2].hidden=!0,e.tokens[t].hidden=!0,t+=2)}(e,q),!0}},{"../common/utils":4}],26:[function(e,r,t){"use strict";r.exports=function(e,r){for(var t,n,s,o,i,a=r+1,c=e.md.block.ruler.getRules("paragraph"),l=e.lineMax;a<l&&!e.isEmpty(a);a++)if(!(3<e.sCount[a]-e.blkIndent||e.sCount[a]<0)){for(n=!1,s=0,o=c.length;s<o;s++)if(c[s](e,a,l,!0)){n=!0;break}if(n)break}return t=e.getLines(r,a,e.blkIndent,!1).trim(),e.line=a,(i=e.push("paragraph_open","p",1)).map=[r,e.line],(i=e.push("inline","",0)).content=t,i.map=[r,e.line],i.children=[],i=e.push("paragraph_close","p",-1),!0}},{}],27:[function(e,r,t){"use strict";var n=e("../helpers/parse_link_destination"),s=e("../helpers/parse_link_title"),o=e("../common/utils").normalizeReference,i=e("../common/utils").isSpace;r.exports=function(e,r,t,a){var c,l,u,p,h,f,d,m,_,g,k,b,v,x,y,C=0,A=e.bMarks[r]+e.tShift[r],w=e.eMarks[r],D=r+1;if(91!==e.src.charCodeAt(A))return!1;for(;++A<w;)if(93===e.src.charCodeAt(A)&&92!==e.src.charCodeAt(A-1)){if(A+1===w)return!1;if(58!==e.src.charCodeAt(A+1))return!1;break}for(p=e.lineMax,x=e.md.block.ruler.getRules("reference");D<p&&!e.isEmpty(D);D++)if(!(3<e.sCount[D]-e.blkIndent||e.sCount[D]<0)){for(v=!1,f=0,d=x.length;f<d;f++)if(x[f](e,D,p,!0)){v=!0;break}if(v)break}for(w=(b=e.getLines(r,D,e.blkIndent,!1).trim()).length,A=1;A<w;A++){if(91===(c=b.charCodeAt(A)))return!1;if(93===c){_=A;break}10===c?C++:92===c&&(++A<w&&10===b.charCodeAt(A)&&C++)}if(_<0||58!==b.charCodeAt(_+1))return!1;for(A=_+2;A<w;A++)if(10===(c=b.charCodeAt(A)))C++;else if(!i(c))break;if(!(g=n(b,A,w)).ok)return!1;if(h=e.md.normalizeLink(g.str),!e.md.validateLink(h))return!1;for(A=g.pos,u=C+=g.lines,k=l=A;A<w;A++)if(10===(c=b.charCodeAt(A)))C++;else if(!i(c))break;for(g=s(b,A,w),A<w&&k!==A&&g.ok?(y=g.str,A=g.pos,C+=g.lines):(y="",A=l,C=u);A<w&&(c=b.charCodeAt(A),i(c));)A++;if(A<w&&10!==b.charCodeAt(A)&&y)for(y="",A=l,C=u;A<w&&(c=b.charCodeAt(A),i(c));)A++;return!(A<w&&10!==b.charCodeAt(A)||!(m=o(b.slice(1,_)))||!a&&(void 0===e.env.references&&(e.env.references={}),void 0===e.env.references[m]&&(e.env.references[m]={title:y,href:h}),e.line=r+C+1,0))}},{"../common/utils":4,"../helpers/parse_link_destination":6,"../helpers/parse_link_title":8}],28:[function(e,r,t){"use strict";function n(e,r,t,n){var s,i,a,c,l,u,p,h;for(this.src=e,this.md=r,this.env=t,this.tokens=n,this.bMarks=[],this.eMarks=[],this.tShift=[],this.sCount=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.parentType="root",this.ddIndent=-1,this.level=0,this.result="",h=!1,a=c=u=p=0,l=(i=this.src).length;c<l;c++){if(s=i.charCodeAt(c),!h){if(o(s)){u++,9===s?p+=4-p%4:p++;continue}h=!0}10!==s&&c!==l-1||(10!==s&&c++,this.bMarks.push(a),this.eMarks.push(c),this.tShift.push(u),this.sCount.push(p),h=!1,p=u=0,a=c+1)}this.bMarks.push(i.length),this.eMarks.push(i.length),this.tShift.push(0),this.sCount.push(0),this.lineMax=this.bMarks.length-1}var s=e("../token"),o=e("../common/utils").isSpace;n.prototype.push=function(e,r,t){var n=new s(e,r,t);return n.block=!0,t<0&&this.level--,n.level=this.level,0<t&&this.level++,this.tokens.push(n),n},n.prototype.isEmpty=function(e){return this.bMarks[e]+this.tShift[e]>=this.eMarks[e]},n.prototype.skipEmptyLines=function(e){for(var r=this.lineMax;e<r&&!(this.bMarks[e]+this.tShift[e]<this.eMarks[e]);e++);return e},n.prototype.skipSpaces=function(e){for(var r,t=this.src.length;e<t&&(r=this.src.charCodeAt(e),o(r));e++);return e},n.prototype.skipSpacesBack=function(e,r){if(e<=r)return e;for(;r<e;)if(!o(this.src.charCodeAt(--e)))return e+1;return e},n.prototype.skipChars=function(e,r){for(var t=this.src.length;e<t&&this.src.charCodeAt(e)===r;e++);return e},n.prototype.skipCharsBack=function(e,r,t){if(e<=t)return e;for(;t<e;)if(r!==this.src.charCodeAt(--e))return e+1;return e},n.prototype.getLines=function(e,r,t,n){var s,i,a,c,l,u,p,h=e;if(r<=e)return"";for(u=new Array(r-e),s=0;h<r;h++,s++){for(i=0,p=c=this.bMarks[h],l=h+1<r||n?this.eMarks[h]+1:this.eMarks[h];c<l&&i<t;){if(a=this.src.charCodeAt(c),o(a))9===a?i+=4-i%4:i++;else{if(!(c-p<this.tShift[h]))break;i++}c++}u[s]=this.src.slice(c,l)}return u.join("")},n.prototype.Token=s,r.exports=n},{"../common/utils":4,"../token":51}],29:[function(e,r,t){"use strict";function n(e,r){var t=e.bMarks[r]+e.blkIndent,n=e.eMarks[r];return e.src.substr(t,n-t)}function s(e){var r,t=[],n=0,s=e.length,o=0,i=0,a=!1,c=0;for(r=e.charCodeAt(n);n<s;)96===r&&o%2==0?(a=!a,c=n):124!==r||o%2!=0||a?92===r?o++:o=0:(t.push(e.substring(i,n)),i=n+1),++n===s&&a&&(a=!1,n=c+1),r=e.charCodeAt(n);return t.push(e.substring(i)),t}r.exports=function(e,r,t,o){var i,a,c,l,u,p,h,f,d,m,_,g;if(t<r+2)return!1;if(u=r+1,e.sCount[u]<e.blkIndent)return!1;if((c=e.bMarks[u]+e.tShift[u])>=e.eMarks[u])return!1;if(124!==(i=e.src.charCodeAt(c))&&45!==i&&58!==i)return!1;if(a=n(e,r+1),!/^[-:| ]+$/.test(a))return!1;for(p=a.split("|"),d=[],l=0;l<p.length;l++){if(!(m=p[l].trim())){if(0===l||l===p.length-1)continue;return!1}if(!/^:?-+:?$/.test(m))return!1;58===m.charCodeAt(m.length-1)?d.push(58===m.charCodeAt(0)?"center":"right"):58===m.charCodeAt(0)?d.push("left"):d.push("")}if(-1===(a=n(e,r).trim()).indexOf("|"))return!1;if((h=(p=s(a.replace(/^\||\|$/g,""))).length)>d.length)return!1;if(o)return!0;for((f=e.push("table_open","table",1)).map=_=[r,0],(f=e.push("thead_open","thead",1)).map=[r,r+1],(f=e.push("tr_open","tr",1)).map=[r,r+1],l=0;l<p.length;l++)(f=e.push("th_open","th",1)).map=[r,r+1],d[l]&&(f.attrs=[["style","text-align:"+d[l]]]),(f=e.push("inline","",0)).content=p[l].trim(),f.map=[r,r+1],f.children=[],f=e.push("th_close","th",-1);for(f=e.push("tr_close","tr",-1),f=e.push("thead_close","thead",-1),(f=e.push("tbody_open","tbody",1)).map=g=[r+2,0],u=r+2;u<t&&!(e.sCount[u]<e.blkIndent)&&-1!==(a=n(e,u)).indexOf("|");u++){for(p=s(a.replace(/^\||\|\s*$/g,"")),f=e.push("tr_open","tr",1),l=0;l<h;l++)f=e.push("td_open","td",1),d[l]&&(f.attrs=[["style","text-align:"+d[l]]]),(f=e.push("inline","",0)).content=p[l]?p[l].trim():"",f.children=[],f=e.push("td_close","td",-1);f=e.push("tr_close","tr",-1)}return f=e.push("tbody_close","tbody",-1),f=e.push("table_close","table",-1),_[1]=g[1]=u,e.line=u,!0}},{}],30:[function(e,r,t){"use strict";r.exports=function(e){var r;e.inlineMode?((r=new e.Token("inline","",0)).content=e.src,r.map=[0,1],r.children=[],e.tokens.push(r)):e.md.block.parse(e.src,e.md,e.env,e.tokens)}},{}],31:[function(e,r,t){"use strict";r.exports=function(e){var r,t,n,s=e.tokens;for(t=0,n=s.length;t<n;t++)"inline"===(r=s[t]).type&&e.md.inline.parse(r.content,e.md,e.env,r.children)}},{}],32:[function(e,r,t){"use strict";function n(e){return/^<a[>\s]/i.test(e)}function s(e){return/^<\/a\s*>/i.test(e)}var o=e("../common/utils").arrayReplaceAt;r.exports=function(e){var r,t,i,a,c,l,u,p,h,f,d,m,_,g,k,b,v,x=e.tokens;if(e.md.options.linkify)for(t=0,i=x.length;t<i;t++)if("inline"===x[t].type&&e.md.linkify.pretest(x[t].content))for(_=0,r=(a=x[t].children).length-1;0<=r;r--)if("link_close"!==(l=a[r]).type){if("html_inline"===l.type&&(n(l.content)&&0<_&&_--,s(l.content)&&_++),!(0<_)&&"text"===l.type&&e.md.linkify.test(l.content)){for(h=l.content,v=e.md.linkify.match(h),u=[],m=l.level,p=d=0;p<v.length;p++)g=v[p].url,k=e.md.normalizeLink(g),e.md.validateLink(k)&&(b=v[p].text,b=v[p].schema?"mailto:"!==v[p].schema||/^mailto:/i.test(b)?e.md.normalizeLinkText(b):e.md.normalizeLinkText("mailto:"+b).replace(/^mailto:/,""):e.md.normalizeLinkText("http://"+b).replace(/^http:\/\//,""),d<(f=v[p].index)&&((c=new e.Token("text","",0)).content=h.slice(d,f),c.level=m,u.push(c)),(c=new e.Token("link_open","a",1)).attrs=[["href",k]],c.level=m++,c.markup="linkify",c.info="auto",u.push(c),(c=new e.Token("text","",0)).content=b,c.level=m,u.push(c),(c=new e.Token("link_close","a",-1)).level=--m,c.markup="linkify",c.info="auto",u.push(c),d=v[p].lastIndex);d<h.length&&((c=new e.Token("text","",0)).content=h.slice(d),c.level=m,u.push(c)),x[t].children=a=o(a,r,u)}}else for(r--;a[r].level!==l.level&&"link_open"!==a[r].type;)r--}},{"../common/utils":4}],33:[function(e,r,t){"use strict";var n=/\r[\n\u0085]?|[\u2424\u2028\u0085]/g,s=/\u0000/g;r.exports=function(e){var r;r=(r=e.src.replace(n,"\n")).replace(s,"?"),e.src=r}},{}],34:[function(e,r,t){"use strict";function n(e,r){return l[r.toLowerCase()]}function s(e){var r,t;for(r=e.length-1;0<=r;r--)"text"===(t=e[r]).type&&(t.content=t.content.replace(c,n))}function o(e){var r,t;for(r=e.length-1;0<=r;r--)"text"===(t=e[r]).type&&i.test(t.content)&&(t.content=t.content.replace(/\+-/g,"±").replace(/\.{2,}/g,"…").replace(/([?!])\u2026/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---([^-]|$)/gm,"$1—$2").replace(/(^|\s)--(\s|$)/gm,"$1–$2").replace(/(^|[^-\s])--([^-\s]|$)/gm,"$1–$2"))}var i=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,a=/\((c|tm|r|p)\)/i,c=/\((c|tm|r|p)\)/gi,l={c:"?",r:"?",p:"§",tm:"?"};r.exports=function(e){var r;if(e.md.options.typographer)for(r=e.tokens.length-1;0<=r;r--)"inline"===e.tokens[r].type&&(a.test(e.tokens[r].content)&&s(e.tokens[r].children),i.test(e.tokens[r].content)&&o(e.tokens[r].children))}},{}],35:[function(e,r,t){"use strict";function n(e,r,t){return e.substr(0,r)+t+e.substr(r+1)}function s(e,r){var t,s,c,p,h,f,d,m,_,g,k,b,v,x,y,C,A,w,D,q,E;for(D=[],t=0;t<e.length;t++){for(s=e[t],d=e[t].level,A=D.length-1;0<=A&&!(D[A].level<=d);A--);if(D.length=A+1,"text"===s.type){h=0,f=(c=s.content).length;e:for(;h<f&&(l.lastIndex=h,p=l.exec(c));){if(y=C=!0,h=p.index+1,w="'"===p[0],_=32,0<=p.index-1)_=c.charCodeAt(p.index-1);else for(A=t-1;0<=A;A--)if("text"===e[A].type){_=e[A].content.charCodeAt(e[A].content.length-1);break}if(g=32,h<f)g=c.charCodeAt(h);else for(A=t+1;A<e.length;A++)if("text"===e[A].type){g=e[A].content.charCodeAt(0);break}if(k=a(_)||i(String.fromCharCode(_)),b=a(g)||i(String.fromCharCode(g)),v=o(_),(x=o(g))?y=!1:b&&(v||k||(y=!1)),v?C=!1:k&&(x||b||(C=!1)),34===g&&'"'===p[0]&&48<=_&&_<=57&&(C=y=!1),y&&C&&(y=!1,C=b),y||C){if(C)for(A=D.length-1;0<=A&&(m=D[A],!(D[A].level<d));A--)if(m.single===w&&D[A].level===d){m=D[A],E=w?(q=r.md.options.quotes[2],r.md.options.quotes[3]):(q=r.md.options.quotes[0],r.md.options.quotes[1]),s.content=n(s.content,p.index,E),e[m.token].content=n(e[m.token].content,m.pos,q),h+=E.length-1,m.token===t&&(h+=q.length-1),f=(c=s.content).length,D.length=A;continue e}y?D.push({token:t,pos:p.index,single:w,level:d}):C&&w&&(s.content=n(s.content,p.index,u))}else w&&(s.content=n(s.content,p.index,u))}}}}var o=e("../common/utils").isWhiteSpace,i=e("../common/utils").isPunctChar,a=e("../common/utils").isMdAsciiPunct,c=/['"]/,l=/['"]/g,u="’";r.exports=function(e){var r;if(e.md.options.typographer)for(r=e.tokens.length-1;0<=r;r--)"inline"===e.tokens[r].type&&c.test(e.tokens[r].content)&&s(e.tokens[r].children,e)}},{"../common/utils":4}],36:[function(e,r,t){"use strict";function n(e,r,t){this.src=e,this.env=t,this.tokens=[],this.inlineMode=!1,this.md=r}var s=e("../token");n.prototype.Token=s,r.exports=n},{"../token":51}],37:[function(e,r,t){"use strict";var n=/^<([a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)>/,s=/^<([a-zA-Z][a-zA-Z0-9+.\-]{1,31}):([^<>\x00-\x20]*)>/;r.exports=function(e,r){var t,o,i,a,c,l,u=e.pos;return 60===e.src.charCodeAt(u)&&!((t=e.src.slice(u)).indexOf(">")<0||(s.test(t)?(a=(o=t.match(s))[0].slice(1,-1),c=e.md.normalizeLink(a),!e.md.validateLink(c)||(r||((l=e.push("link_open","a",1)).attrs=[["href",c]],l.markup="autolink",l.info="auto",(l=e.push("text","",0)).content=e.md.normalizeLinkText(a),(l=e.push("link_close","a",-1)).markup="autolink",l.info="auto"),e.pos+=o[0].length,0)):!n.test(t)||(a=(i=t.match(n))[0].slice(1,-1),c=e.md.normalizeLink("mailto:"+a),!e.md.validateLink(c)||(r||((l=e.push("link_open","a",1)).attrs=[["href",c]],l.markup="autolink",l.info="auto",(l=e.push("text","",0)).content=e.md.normalizeLinkText(a),(l=e.push("link_close","a",-1)).markup="autolink",l.info="auto"),e.pos+=i[0].length,0))))}},{}],38:[function(e,r,t){"use strict";r.exports=function(e,r){var t,n,s,o,i,a,c=e.pos;if(96!==e.src.charCodeAt(c))return!1;for(t=c,c++,n=e.posMax;c<n&&96===e.src.charCodeAt(c);)c++;for(s=e.src.slice(t,c),o=i=c;-1!==(o=e.src.indexOf("`",i));){for(i=o+1;i<n&&96===e.src.charCodeAt(i);)i++;if(i-o===s.length)return r||((a=e.push("code_inline","code",0)).markup=s,a.content=e.src.slice(c,o).replace(/[ \n]+/g," ").trim()),e.pos=i,!0}return r||(e.pending+=s),e.pos+=s.length,!0}},{}],39:[function(e,r,t){"use strict";r.exports=function(e){var r,t,n,s,o=e.delimiters,i=e.delimiters.length;for(r=0;r<i;r++)if((n=o[r]).close)for(t=r-n.jump-1;0<=t;){if((s=o[t]).open&&s.marker===n.marker&&s.end<0&&s.level===n.level){n.jump=r-t,n.open=!1,s.end=r,s.jump=0;break}t-=s.jump+1}}},{}],40:[function(e,r,t){"use strict";r.exports.tokenize=function(e,r){var t,n,o=e.pos,i=e.src.charCodeAt(o);if(r)return!1;if(95!==i&&42!==i)return!1;for(n=e.scanDelims(e.pos,42===i),t=0;t<n.length;t++)e.push("text","",0).content=String.fromCharCode(i),e.delimiters.push({marker:i,jump:t,token:e.tokens.length-1,level:e.level,end:-1,open:n.can_open,close:n.can_close});return e.pos+=n.length,!0},r.exports.postProcess=function(e){var r,t,n,s,o,i,a=e.delimiters,c=e.delimiters.length;for(r=0;r<c;r++)95!==(t=a[r]).marker&&42!==t.marker||-1!==t.end&&(n=a[t.end],i=r+1<c&&a[r+1].end===t.end-1&&a[r+1].token===t.token+1&&a[t.end-1].token===n.token-1&&a[r+1].marker===t.marker,o=String.fromCharCode(t.marker),(s=e.tokens[t.token]).type=i?"strong_open":"em_open",s.tag=i?"strong":"em",s.nesting=1,s.markup=i?o+o:o,s.content="",(s=e.tokens[n.token]).type=i?"strong_close":"em_close",s.tag=i?"strong":"em",s.nesting=-1,s.markup=i?o+o:o,s.content="",i&&(e.tokens[a[r+1].token].content="",e.tokens[a[t.end-1].token].content="",r++))}},{}],41:[function(e,r,t){"use strict";var n=e("../common/entities"),s=e("../common/utils").has,o=e("../common/utils").isValidEntityCode,i=e("../common/utils").fromCodePoint,a=/^&#((?:x[a-f0-9]{1,8}|[0-9]{1,8}));/i,c=/^&([a-z][a-z0-9]{1,31});/i;r.exports=function(e,r){var l,u,p=e.pos,h=e.posMax;if(38!==e.src.charCodeAt(p))return!1;if(p+1<h)if(35===e.src.charCodeAt(p+1)){if(u=e.src.slice(p).match(a))return r||(l="x"===u[1][0].toLowerCase()?parseInt(u[1].slice(1),16):parseInt(u[1],10),e.pending+=i(o(l)?l:65533)),e.pos+=u[0].length,!0}else if((u=e.src.slice(p).match(c))&&s(n,u[1]))return r||(e.pending+=n[u[1]]),e.pos+=u[0].length,!0;return r||(e.pending+="&"),e.pos++,!0}},{"../common/entities":1,"../common/utils":4}],42:[function(e,r,t){"use strict";for(var n=e("../common/utils").isSpace,s=[],o=0;o<256;o++)s.push(0);"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach(function(e){s[e.charCodeAt(0)]=1}),r.exports=function(e,r){var t,o=e.pos,i=e.posMax;if(92!==e.src.charCodeAt(o))return!1;if(++o<i){if((t=e.src.charCodeAt(o))<256&&0!==s[t])return r||(e.pending+=e.src[o]),e.pos+=2,!0;if(10===t){for(r||e.push("hardbreak","br",0),o++;o<i&&(t=e.src.charCodeAt(o),n(t));)o++;return e.pos=o,!0}}return r||(e.pending+="\\"),e.pos++,!0}},{"../common/utils":4}],43:[function(e,r,t){"use strict";var s=e("../common/html_re").HTML_TAG_RE;r.exports=function(e,r){var t,o,i,c=e.pos;return!(!e.md.options.html||(i=e.posMax,60!==e.src.charCodeAt(c)||i<=c+2||(33!==(t=e.src.charCodeAt(c+1))&&63!==t&&47!==t&&!function(e){var r=32|e;return 97<=r&&r<=122}(t)||!(o=e.src.slice(c).match(s))||(r||(e.push("html_inline","",0).content=e.src.slice(c,c+o[0].length)),e.pos+=o[0].length,0))))}},{"../common/html_re":3}],44:[function(e,r,t){"use strict";var n=e("../helpers/parse_link_label"),s=e("../helpers/parse_link_destination"),o=e("../helpers/parse_link_title"),i=e("../common/utils").normalizeReference,a=e("../common/utils").isSpace;r.exports=function(e,r){var t,c,l,u,p,h,f,d,m,_,g,k,b,v="",x=e.pos,y=e.posMax;if(33!==e.src.charCodeAt(e.pos))return!1;if(91!==e.src.charCodeAt(e.pos+1))return!1;if(h=e.pos+2,(p=n(e,e.pos+1,!1))<0)return!1;if((f=p+1)<y&&40===e.src.charCodeAt(f)){for(f++;f<y&&(c=e.src.charCodeAt(f),a(c)||10===c);f++);if(y<=f)return!1;for(b=f,(m=s(e.src,f,e.posMax)).ok&&(v=e.md.normalizeLink(m.str),e.md.validateLink(v)?f=m.pos:v=""),b=f;f<y&&(c=e.src.charCodeAt(f),a(c)||10===c);f++);if(m=o(e.src,f,e.posMax),f<y&&b!==f&&m.ok)for(_=m.str,f=m.pos;f<y&&(c=e.src.charCodeAt(f),a(c)||10===c);f++);else _="";if(y<=f||41!==e.src.charCodeAt(f))return e.pos=x,!1;f++}else{if(void 0===e.env.references)return!1;if(f<y&&91===e.src.charCodeAt(f)?(b=f+1,0<=(f=n(e,f))?u=e.src.slice(b,f++):f=p+1):f=p+1,u||(u=e.src.slice(h,p)),!(d=e.env.references[i(u)]))return e.pos=x,!1;v=d.href,_=d.title}return r||(l=e.src.slice(h,p),e.md.inline.parse(l,e.md,e.env,k=[]),(g=e.push("image","img",0)).attrs=t=[["src",v],["alt",""]],g.children=k,g.content=l,_&&t.push(["title",_])),e.pos=f,e.posMax=y,!0}},{"../common/utils":4,"../helpers/parse_link_destination":6,"../helpers/parse_link_label":7,"../helpers/parse_link_title":8}],45:[function(e,r,t){"use strict";var n=e("../helpers/parse_link_label"),s=e("../helpers/parse_link_destination"),o=e("../helpers/parse_link_title"),i=e("../common/utils").normalizeReference,a=e("../common/utils").isSpace;r.exports=function(e,r){var t,c,l,u,p,h,f,d,m,g="",k=e.pos,b=e.posMax,v=e.pos;if(91!==e.src.charCodeAt(e.pos))return!1;if(p=e.pos+1,(u=n(e,e.pos,!0))<0)return!1;if((h=u+1)<b&&40===e.src.charCodeAt(h)){for(h++;h<b&&(c=e.src.charCodeAt(h),a(c)||10===c);h++);if(b<=h)return!1;for(v=h,(f=s(e.src,h,e.posMax)).ok&&(g=e.md.normalizeLink(f.str),e.md.validateLink(g)?h=f.pos:g=""),v=h;h<b&&(c=e.src.charCodeAt(h),a(c)||10===c);h++);if(f=o(e.src,h,e.posMax),h<b&&v!==h&&f.ok)for(m=f.str,h=f.pos;h<b&&(c=e.src.charCodeAt(h),a(c)||10===c);h++);else m="";if(b<=h||41!==e.src.charCodeAt(h))return e.pos=k,!1;h++}else{if(void 0===e.env.references)return!1;if(h<b&&91===e.src.charCodeAt(h)?(v=h+1,0<=(h=n(e,h))?l=e.src.slice(v,h++):h=u+1):h=u+1,l||(l=e.src.slice(p,u)),!(d=e.env.references[i(l)]))return e.pos=k,!1;g=d.href,m=d.title}return r||(e.pos=p,e.posMax=u,e.push("link_open","a",1).attrs=t=[["href",g]],m&&t.push(["title",m]),e.md.inline.tokenize(e),e.push("link_close","a",-1)),e.pos=h,e.posMax=b,!0}},{"../common/utils":4,"../helpers/parse_link_destination":6,"../helpers/parse_link_label":7,"../helpers/parse_link_title":8}],46:[function(e,r,t){"use strict";r.exports=function(e,r){var t,n,s=e.pos;if(10!==e.src.charCodeAt(s))return!1;for(t=e.pending.length-1,n=e.posMax,r||(0<=t&&32===e.pending.charCodeAt(t)?1<=t&&32===e.pending.charCodeAt(t-1)?(e.pending=e.pending.replace(/ +$/,""),e.push("hardbreak","br",0)):(e.pending=e.pending.slice(0,-1),e.push("softbreak","br",0)):e.push("softbreak","br",0)),s++;s<n&&32===e.src.charCodeAt(s);)s++;return e.pos=s,!0}},{}],47:[function(e,r,t){"use strict";function n(e,r,t,n){this.src=e,this.env=t,this.md=r,this.tokens=n,this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache={},this.delimiters=[]}var s=e("../token"),o=e("../common/utils").isWhiteSpace,i=e("../common/utils").isPunctChar,a=e("../common/utils").isMdAsciiPunct;n.prototype.pushPending=function(){var e=new s("text","",0);return e.content=this.pending,e.level=this.pendingLevel,this.tokens.push(e),this.pending="",e},n.prototype.push=function(e,r,t){this.pending&&this.pushPending();var n=new s(e,r,t);return t<0&&this.level--,n.level=this.level,0<t&&this.level++,this.pendingLevel=this.level,this.tokens.push(n),n},n.prototype.scanDelims=function(e,r){var t,n,s,c,l,u,p,h,f,d=e,m=!0,_=!0,g=this.posMax,k=this.src.charCodeAt(e);for(t=0<e?this.src.charCodeAt(e-1):32;d<g&&this.src.charCodeAt(d)===k;)d++;return s=d-e,n=d<g?this.src.charCodeAt(d):32,p=a(t)||i(String.fromCharCode(t)),f=a(n)||i(String.fromCharCode(n)),u=o(t),(h=o(n))?m=!1:f&&(u||p||(m=!1)),u?_=!1:p&&(h||f||(_=!1)),l=r?(c=m,_):(c=m&&(!_||p),_&&(!m||f)),{can_open:c,can_close:l,length:s}},n.prototype.Token=s,r.exports=n},{"../common/utils":4,"../token":51}],48:[function(e,r,t){"use strict";r.exports.tokenize=function(e,r){var t,n,o,i,a=e.pos,c=e.src.charCodeAt(a);if(r)return!1;if(126!==c)return!1;if(o=(n=e.scanDelims(e.pos,!0)).length,i=String.fromCharCode(c),o<2)return!1;for(o%2&&(e.push("text","",0).content=i,o--),t=0;t<o;t+=2)e.push("text","",0).content=i+i,e.delimiters.push({marker:c,jump:t,token:e.tokens.length-1,level:e.level,end:-1,open:n.can_open,close:n.can_close});return e.pos+=n.length,!0},r.exports.postProcess=function(e){var r,t,n,s,o,i=[],a=e.delimiters,c=e.delimiters.length;for(r=0;r<c;r++)126===(n=a[r]).marker&&-1!==n.end&&(s=a[n.end],(o=e.tokens[n.token]).type="s_open",o.tag="s",o.nesting=1,o.markup="~~",o.content="",(o=e.tokens[s.token]).type="s_close",o.tag="s",o.nesting=-1,o.markup="~~",o.content="","text"===e.tokens[s.token-1].type&&"~"===e.tokens[s.token-1].content&&i.push(s.token-1));for(;i.length;){for(t=(r=i.pop())+1;t<e.tokens.length&&"s_close"===e.tokens[t].type;)t++;r!==--t&&(o=e.tokens[t],e.tokens[t]=e.tokens[r],e.tokens[r]=o)}}},{}],49:[function(e,r,t){"use strict";function n(e){switch(e){case 10:case 33:case 35:case 36:case 37:case 38:case 42:case 43:case 45:case 58:case 60:case 61:case 62:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 125:case 126:return!0;default:return!1}}r.exports=function(e,r){for(var t=e.pos;t<e.posMax&&!n(e.src.charCodeAt(t));)t++;return t!==e.pos&&(r||(e.pending+=e.src.slice(e.pos,t)),e.pos=t,!0)}},{}],50:[function(e,r,t){"use strict";r.exports=function(e){var r,t,n=0,s=e.tokens,o=e.tokens.length;for(r=t=0;r<o;r++)n+=s[r].nesting,s[r].level=n,"text"===s[r].type&&r+1<o&&"text"===s[r+1].type?s[r+1].content=s[r].content+s[r+1].content:(r!==t&&(s[t]=s[r]),t++);r!==t&&(s.length=t)}},{}],51:[function(e,r,t){"use strict";function n(e,r,t){this.type=e,this.tag=r,this.attrs=null,this.map=null,this.nesting=t,this.level=0,this.children=null,this.content="",this.markup="",this.info="",this.meta=null,this.block=!1,this.hidden=!1}n.prototype.attrIndex=function(e){var r,t,n;if(!this.attrs)return-1;for(t=0,n=(r=this.attrs).length;t<n;t++)if(r[t][0]===e)return t;return-1},n.prototype.attrPush=function(e){this.attrs?this.attrs.push(e):this.attrs=[e]},n.prototype.attrSet=function(e,r){var t=this.attrIndex(e),n=[e,r];t<0?this.attrPush(n):this.attrs[t]=n},n.prototype.attrGet=function(e){var r=this.attrIndex(e),t=null;return 0<=r&&(t=this.attrs[r][1]),t},n.prototype.attrJoin=function(e,r){var t=this.attrIndex(e);t<0?this.attrPush([e,r]):this.attrs[t][1]=this.attrs[t][1]+" "+r},r.exports=n},{}],52:[function(r,t,n){(function(r){!function(s){function o(e){throw new RangeError(R[e])}function i(e,r){for(var t=e.length,n=[];t--;)n[t]=r(e[t]);return n}function a(e,r){var t=e.split("@"),n="";return 1<t.length&&(n=t[0]+"@",e=t[1]),n+i((e=e.replace(T,".")).split("."),r).join(".")}function c(e){for(var r,t,n=[],s=0,o=e.length;s<o;)55296<=(r=e.charCodeAt(s++))&&r<=56319&&s<o?56320==(64512&(t=e.charCodeAt(s++)))?n.push(((1023&r)<<10)+(1023&t)+65536):(n.push(r),s--):n.push(r);return n}function l(e){return i(e,function(e){var r="";return 65535<e&&(r+=B((e-=65536)>>>10&1023|55296),e=56320|1023&e),r+B(e)}).join("")}function u(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:C}function p(e,r){return e+22+75*(e<26)-((0!=r)<<5)}function h(e,r,t){var n=0;for(e=t?I(e/q):e>>1,e+=I(e/r);M*w>>1<e;n+=C)e=I(e/M);return I(n+(M+1)*e/(e+D))}function f(e){var r,t,n,s,i,a,c,p,f,d,m=[],_=e.length,g=0,k=S,b=E;for((t=e.lastIndexOf(F))<0&&(t=0),n=0;n<t;++n)128<=e.charCodeAt(n)&&o("not-basic"),m.push(e.charCodeAt(n));for(s=0<t?t+1:0;s<_;){for(i=g,a=1,c=C;_<=s&&o("invalid-input"),p=u(e.charCodeAt(s++)),(C<=p||p>I((y-g)/a))&&o("overflow"),g+=p*a,!(p<(f=c<=b?A:b+w<=c?w:c-b));c+=C)a>I(y/(d=C-f))&&o("overflow"),a*=d;b=h(g-i,r=m.length+1,0==i),I(g/r)>y-k&&o("overflow"),k+=I(g/r),g%=r,m.splice(g++,0,k)}return l(m)}function d(e){var r,t,n,s,i,a,l,u,f,d,m,_,g,k,b,v=[];for(_=(e=c(e)).length,r=S,i=E,a=t=0;a<_;++a)(m=e[a])<128&&v.push(B(m));for(n=s=v.length,s&&v.push(F);n<_;){for(l=y,a=0;a<_;++a)r<=(m=e[a])&&m<l&&(l=m);for(l-r>I((y-t)/(g=n+1))&&o("overflow"),t+=(l-r)*g,r=l,a=0;a<_;++a)if((m=e[a])<r&&++t>y&&o("overflow"),m==r){for(u=t,f=C;!(u<(d=f<=i?A:i+w<=f?w:f-i));f+=C)b=u-d,k=C-d,v.push(B(p(d+b%k,0))),u=I(b/k);v.push(B(p(u,0))),i=h(t,g,n==s),t=0,++n}++t,++r}return v.join("")}var g="object"==typeof n&&n&&!n.nodeType&&n,k="object"==typeof t&&t&&!t.nodeType&&t,b="object"==typeof r&&r;b.global!==b&&b.window!==b&&b.self!==b||(s=b);var v,x,y=2147483647,C=36,A=1,w=26,D=38,q=700,E=72,S=128,F="-",z=/^xn--/,L=/[^\x20-\x7E]/,T=/[\x2E\u3002\uFF0E\uFF61]/g,R={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},M=C-A,I=Math.floor,B=String.fromCharCode;if(v={version:"1.4.1",ucs2:{decode:c,encode:l},decode:f,encode:d,toASCII:function(e){return a(e,function(e){return L.test(e)?"xn--"+d(e):e})},toUnicode:function(e){return a(e,function(e){return z.test(e)?f(e.slice(4).toLowerCase()):e})}},g&&k)if(t.exports==g)k.exports=v;else for(x in v)v.hasOwnProperty(x)&&(g[x]=v[x]);else s.punycode=v}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],53:[function(e,r,t){r.exports={Aacute:"á",aacute:"á",Abreve:"?",abreve:"?",ac:"?",acd:"?",acE:"??",Acirc:"?",acirc:"a",acute:"′",Acy:"А",acy:"а",AElig:"?",aelig:"?",af:"?",Afr:"??",afr:"??",Agrave:"à",agrave:"à",alefsym:"?",aleph:"?",Alpha:"Α",alpha:"α",Amacr:"ā",amacr:"ā",amalg:"?",amp:"&",AMP:"&",andand:"?",And:"?",and:"∧",andd:"?",andslope:"?",andv:"?",ang:"∠",ange:"?",angle:"∠",angmsdaa:"?",angmsdab:"?",angmsdac:"?",angmsdad:"?",angmsdae:"?",angmsdaf:"?",angmsdag:"?",angmsdah:"?",angmsd:"?",angrt:"∟",angrtvb:"?",angrtvbd:"?",angsph:"?",angst:"?",angzarr:"?",Aogon:"?",aogon:"?",Aopf:"??",aopf:"??",apacir:"?",ap:"≈",apE:"?",ape:"?",apid:"?",apos:"'",ApplyFunction:"?",approx:"≈",approxeq:"?",Aring:"?",aring:"?",Ascr:"??",ascr:"??",Assign:"?",ast:"*",asymp:"≈",asympeq:"?",Atilde:"?",atilde:"?",Auml:"?",auml:"?",awconint:"?",awint:"?",backcong:"≌",backepsilon:"?",backprime:"‵",backsim:"∽",backsimeq:"?",Backslash:"?",Barv:"?",barvee:"?",barwed:"?",Barwed:"?",barwedge:"?",bbrk:"?",bbrktbrk:"?",bcong:"≌",Bcy:"Б",bcy:"б",bdquo:"?",becaus:"∵",because:"∵",Because:"∵",bemptyv:"?",bepsi:"?",bernou:"?",Bernoullis:"?",Beta:"Β",beta:"β",beth:"?",between:"?",Bfr:"??",bfr:"??",bigcap:"?",bigcirc:"?",bigcup:"?",bigodot:"?",bigoplus:"?",bigotimes:"?",bigsqcup:"?",bigstar:"★",bigtriangledown:"▽",bigtriangleup:"△",biguplus:"?",bigvee:"?",bigwedge:"?",bkarow:"?",blacklozenge:"?",blacksquare:"?",blacktriangle:"?",blacktriangledown:"?",blacktriangleleft:"?",blacktriangleright:"?",blank:"?",blk12:"?",blk14:"?",blk34:"▓",block:"█",bne:"=?",bnequiv:"≡?",bNot:"?",bnot:"?",Bopf:"??",bopf:"??",bot:"⊥",bottom:"⊥",bowtie:"?",boxbox:"?",boxdl:"┐",boxdL:"╕",boxDl:"╖",boxDL:"╗",boxdr:"┌",boxdR:"╒",boxDr:"╓",boxDR:"╔",boxh:"─",boxH:"═",boxhd:"┬",boxHd:"╤",boxhD:"╥",boxHD:"╦",boxhu:"┴",boxHu:"╧",boxhU:"╨",boxHU:"╩",boxminus:"?",boxplus:"?",boxtimes:"?",boxul:"┘",boxuL:"╛",boxUl:"╜",boxUL:"╝",boxur:"└",boxuR:"╘",boxUr:"╙",boxUR:"╚",boxv:"│",boxV:"║",boxvh:"┼",boxvH:"╪",boxVh:"╫",boxVH:"╬",boxvl:"┤",boxvL:"╡",boxVl:"╢",boxVL:"╣",boxvr:"├",boxvR:"╞",boxVr:"╟",boxVR:"╠",bprime:"‵",breve:"?",Breve:"?",brvbar:"|",bscr:"??",Bscr:"?",bsemi:"?",bsim:"∽",bsime:"?",bsolb:"?",bsol:"\\",bsolhsub:"?",bull:"?",bullet:"?",bump:"?",bumpE:"?",bumpe:"?",Bumpeq:"?",bumpeq:"?",Cacute:"?",cacute:"?",capand:"?",capbrcup:"?",capcap:"?",cap:"∩",Cap:"?",capcup:"?",capdot:"?",CapitalDifferentialD:"?",caps:"∩?",caret:"?",caron:"ˇ",Cayleys:"?",ccaps:"?",Ccaron:"?",ccaron:"?",Ccedil:"?",ccedil:"?",Ccirc:"?",ccirc:"?",Cconint:"?",ccups:"?",ccupssm:"?",Cdot:"?",cdot:"?",cedil:"?",Cedilla:"?",cemptyv:"?",cent:"￠",centerdot:"·",CenterDot:"·",cfr:"??",Cfr:"?",CHcy:"Ч",chcy:"ч",check:"?",checkmark:"?",Chi:"Χ",chi:"χ",circ:"?",circeq:"?",circlearrowleft:"?",circlearrowright:"?",circledast:"?",circledcirc:"?",circleddash:"?",CircleDot:"⊙",circledR:"?",circledS:"?",CircleMinus:"?",CirclePlus:"⊕",CircleTimes:"?",cir:"○",cirE:"?",cire:"?",cirfnint:"?",cirmid:"?",cirscir:"?",ClockwiseContourIntegral:"?",CloseCurlyDoubleQuote:"”",CloseCurlyQuote:"’",clubs:"?",clubsuit:"?",colon:":",Colon:"∷",Colone:"?",colone:"?",coloneq:"?",comma:",",commat:"@",comp:"?",compfn:"°",complement:"?",complexes:"?",cong:"?",congdot:"?",Congruent:"≡",conint:"∮",Conint:"?",ContourIntegral:"∮",copf:"??",Copf:"?",coprod:"?",Coproduct:"?",copy:"?",COPY:"?",copysr:"?",CounterClockwiseContourIntegral:"?",crarr:"?",cross:"?",Cross:"?",Cscr:"??",cscr:"??",csub:"?",csube:"?",csup:"?",csupe:"?",ctdot:"?",cudarrl:"?",cudarrr:"?",cuepr:"?",cuesc:"?",cularr:"?",cularrp:"?",cupbrcap:"?",cupcap:"?",CupCap:"?",cup:"∪",Cup:"?",cupcup:"?",cupdot:"?",cupor:"?",cups:"∪?",curarr:"?",curarrm:"?",curlyeqprec:"?",curlyeqsucc:"?",curlyvee:"?",curlywedge:"?",curren:"¤",curvearrowleft:"?",curvearrowright:"?",cuvee:"?",cuwed:"?",cwconint:"?",cwint:"?",cylcty:"?",dagger:"?",Dagger:"?",daleth:"?",darr:"↓",Darr:"?",dArr:"?",dash:"‐",Dashv:"?",dashv:"?",dbkarow:"?",dblac:"?",Dcaron:"?",dcaron:"?",Dcy:"Д",dcy:"д",ddagger:"?",ddarr:"?",DD:"?",dd:"?",DDotrahd:"?",ddotseq:"?",deg:"°",Del:"?",Delta:"Δ",delta:"δ",demptyv:"?",dfisht:"?",Dfr:"??",dfr:"??",dHar:"?",dharl:"?",dharr:"?",DiacriticalAcute:"′",DiacriticalDot:"˙",DiacriticalDoubleAcute:"?",DiacriticalGrave:"`",DiacriticalTilde:"?",diam:"?",diamond:"?",Diamond:"?",diamondsuit:"?",diams:"?",die:"¨",DifferentialD:"?",digamma:"?",disin:"?",div:"÷",divide:"÷",divideontimes:"?",divonx:"?",DJcy:"?",djcy:"?",dlcorn:"?",dlcrop:"?",dollar:"$",Dopf:"??",dopf:"??",Dot:"¨",dot:"˙",DotDot:"?",doteq:"?",doteqdot:"?",DotEqual:"?",dotminus:"?",dotplus:"?",dotsquare:"?",doublebarwedge:"?",DoubleContourIntegral:"?",DoubleDot:"¨",DoubleDownArrow:"?",DoubleLeftArrow:"?",DoubleLeftRightArrow:"?",DoubleLeftTee:"?",DoubleLongLeftArrow:"?",DoubleLongLeftRightArrow:"?",DoubleLongRightArrow:"?",DoubleRightArrow:"?",DoubleRightTee:"?",DoubleUpArrow:"?",DoubleUpDownArrow:"?",DoubleVerticalBar:"∥",DownArrowBar:"?",downarrow:"↓",DownArrow:"↓",Downarrow:"?",DownArrowUpArrow:"?",DownBreve:"?",downdownarrows:"?",downharpoonleft:"?",downharpoonright:"?",DownLeftRightVector:"?",DownLeftTeeVector:"?",DownLeftVectorBar:"?",DownLeftVector:"?",DownRightTeeVector:"?",DownRightVectorBar:"?",DownRightVector:"?",DownTeeArrow:"?",DownTee:"?",drbkarow:"?",drcorn:"?",drcrop:"?",Dscr:"??",dscr:"??",DScy:"?",dscy:"?",dsol:"?",Dstrok:"?",dstrok:"?",dtdot:"?",dtri:"?",dtrif:"?",duarr:"?",duhar:"?",dwangle:"?",DZcy:"?",dzcy:"?",dzigrarr:"?",Eacute:"é",eacute:"é",easter:"?",Ecaron:"ě",ecaron:"ě",Ecirc:"ê",ecirc:"ê",ecir:"?",ecolon:"?",Ecy:"Э",ecy:"э",eDDot:"?",Edot:"?",edot:"?",eDot:"?",ee:"?",efDot:"≒",Efr:"??",efr:"??",eg:"?",Egrave:"è",egrave:"è",egs:"?",egsdot:"?",el:"?",Element:"∈",elinters:"?",ell:"?",els:"?",elsdot:"?",Emacr:"ē",emacr:"ē",empty:"?",emptyset:"?",EmptySmallSquare:"?",emptyv:"?",EmptyVerySmallSquare:"?",emsp13:"?",emsp14:"?",emsp:"?",ENG:"?",eng:"?",ensp:"?",Eogon:"?",eogon:"?",Eopf:"??",eopf:"??",epar:"?",eparsl:"?",eplus:"?",epsi:"ε",Epsilon:"Ε",epsilon:"ε",epsiv:"?",eqcirc:"?",eqcolon:"?",eqsim:"?",eqslantgtr:"?",eqslantless:"?",Equal:"?",equals:"=",EqualTilde:"?",equest:"?",Equilibrium:"?",equiv:"≡",equivDD:"?",eqvparsl:"?",erarr:"?",erDot:"?",escr:"?",Escr:"?",esdot:"?",Esim:"?",esim:"?",Eta:"Η",eta:"η",ETH:"D",eth:"e",Euml:"?",euml:"?",euro:"€",excl:"!",exist:"?",Exists:"?",expectation:"?",exponentiale:"?",ExponentialE:"?",fallingdotseq:"≒",Fcy:"Ф",fcy:"ф",female:"♀",ffilig:"?",fflig:"?",ffllig:"?",Ffr:"??",ffr:"??",filig:"?",FilledSmallSquare:"?",FilledVerySmallSquare:"?",fjlig:"fj",flat:"?",fllig:"?",fltns:"?",fnof:"?",Fopf:"??",fopf:"??",forall:"?",ForAll:"?",fork:"?",forkv:"?",Fouriertrf:"?",fpartint:"?",frac12:"?",frac13:"?",frac14:"?",frac15:"?",frac16:"?",frac18:"?",frac23:"?",frac25:"?",frac34:"?",frac35:"?",frac38:"?",frac45:"?",frac56:"?",frac58:"?",frac78:"?",frasl:"?",frown:"?",fscr:"??",Fscr:"?",gacute:"?",Gamma:"Γ",gamma:"γ",Gammad:"?",gammad:"?",gap:"?",Gbreve:"?",gbreve:"?",Gcedil:"?",Gcirc:"?",gcirc:"?",Gcy:"Г",gcy:"г",Gdot:"?",gdot:"?",ge:"≥",gE:"≧",gEl:"?",gel:"?",geq:"≥",geqq:"≧",geqslant:"?",gescc:"?",ges:"?",gesdot:"?",gesdoto:"?",gesdotol:"?",gesl:"??",gesles:"?",Gfr:"??",gfr:"??",gg:"?",Gg:"?",ggg:"?",gimel:"?",GJcy:"?",gjcy:"?",gla:"?",gl:"?",glE:"?",glj:"?",gnap:"?",gnapprox:"?",gne:"?",gnE:"?",gneq:"?",gneqq:"?",gnsim:"?",Gopf:"??",gopf:"??",grave:"`",GreaterEqual:"≥",GreaterEqualLess:"?",GreaterFullEqual:"≧",GreaterGreater:"?",GreaterLess:"?",GreaterSlantEqual:"?",GreaterTilde:"?",Gscr:"??",gscr:"?",gsim:"?",gsime:"?",gsiml:"?",gtcc:"?",gtcir:"?",gt:">",GT:">",Gt:"?",gtdot:"?",gtlPar:"?",gtquest:"?",gtrapprox:"?",gtrarr:"?",gtrdot:"?",gtreqless:"?",gtreqqless:"?",gtrless:"?",gtrsim:"?",gvertneqq:"??",gvnE:"??",Hacek:"ˇ",hairsp:"?",half:"?",hamilt:"?",HARDcy:"Ъ",hardcy:"ъ",harrcir:"?",harr:"?",hArr:"?",harrw:"?",Hat:"^",hbar:"?",Hcirc:"?",hcirc:"?",hearts:"?",heartsuit:"?",hellip:"…",hercon:"?",hfr:"??",Hfr:"?",HilbertSpace:"?",hksearow:"?",hkswarow:"?",hoarr:"?",homtht:"?",hookleftarrow:"?",hookrightarrow:"?",hopf:"??",Hopf:"?",horbar:"―",HorizontalLine:"─",hscr:"??",Hscr:"?",hslash:"?",Hstrok:"?",hstrok:"?",HumpDownHump:"?",HumpEqual:"?",hybull:"?",hyphen:"‐",Iacute:"í",iacute:"í",ic:"?",Icirc:"?",icirc:"?",Icy:"И",icy:"и",Idot:"?",IEcy:"Е",iecy:"е",iexcl:"?",iff:"?",ifr:"??",Ifr:"?",Igrave:"ì",igrave:"ì",ii:"?",iiiint:"?",iiint:"?",iinfin:"?",iiota:"?",IJlig:"?",ijlig:"?",Imacr:"ī",imacr:"ī",image:"?",ImaginaryI:"?",imagline:"?",imagpart:"?",imath:"?",Im:"?",imof:"?",imped:"?",Implies:"?",incare:"℅",in:"∈",infin:"∞",infintie:"?",inodot:"?",intcal:"?",int:"∫",Int:"?",integers:"?",Integral:"∫",intercal:"?",Intersection:"?",intlarhk:"?",intprod:"?",InvisibleComma:"?",InvisibleTimes:"?",IOcy:"Ё",iocy:"ё",Iogon:"?",iogon:"?",Iopf:"??",iopf:"??",Iota:"Ι",iota:"ι",iprod:"?",iquest:"?",iscr:"??",Iscr:"?",isin:"∈",isindot:"?",isinE:"?",isins:"?",isinsv:"?",isinv:"∈",it:"?",Itilde:"?",itilde:"?",Iukcy:"?",iukcy:"?",Iuml:"?",iuml:"?",Jcirc:"?",jcirc:"?",Jcy:"Й",jcy:"й",Jfr:"??",jfr:"??",jmath:"?",Jopf:"??",jopf:"??",Jscr:"??",jscr:"??",Jsercy:"?",jsercy:"?",Jukcy:"?",jukcy:"?",Kappa:"Κ",kappa:"κ",kappav:"?",Kcedil:"?",kcedil:"?",Kcy:"К",kcy:"к",Kfr:"??",kfr:"??",kgreen:"?",KHcy:"Х",khcy:"х",KJcy:"?",kjcy:"?",Kopf:"??",kopf:"??",Kscr:"??",kscr:"??",lAarr:"?",Lacute:"?",lacute:"?",laemptyv:"?",lagran:"?",Lambda:"Λ",lambda:"λ",lang:"?",Lang:"?",langd:"?",langle:"?",lap:"?",Laplacetrf:"?",laquo:"?",larrb:"?",larrbfs:"?",larr:"←",Larr:"?",lArr:"?",larrfs:"?",larrhk:"?",larrlp:"?",larrpl:"?",larrsim:"?",larrtl:"?",latail:"?",lAtail:"?",lat:"?",late:"?",lates:"??",lbarr:"?",lBarr:"?",lbbrk:"?",lbrace:"{",lbrack:"[",lbrke:"?",lbrksld:"?",lbrkslu:"?",Lcaron:"?",lcaron:"?",Lcedil:"?",lcedil:"?",lceil:"?",lcub:"{",Lcy:"Л",lcy:"л",ldca:"?",ldquo:"“",ldquor:"?",ldrdhar:"?",ldrushar:"?",ldsh:"?",le:"≤",lE:"≦",LeftAngleBracket:"?",LeftArrowBar:"?",leftarrow:"←",LeftArrow:"←",Leftarrow:"?",LeftArrowRightArrow:"?",leftarrowtail:"?",LeftCeiling:"?",LeftDoubleBracket:"?",LeftDownTeeVector:"?",LeftDownVectorBar:"?",LeftDownVector:"?",LeftFloor:"?",leftharpoondown:"?",leftharpoonup:"?",leftleftarrows:"?",leftrightarrow:"?",LeftRightArrow:"?",Leftrightarrow:"?",leftrightarrows:"?",leftrightharpoons:"?",leftrightsquigarrow:"?",LeftRightVector:"?",LeftTeeArrow:"?",LeftTee:"?",LeftTeeVector:"?",leftthreetimes:"?",LeftTriangleBar:"?",LeftTriangle:"?",LeftTriangleEqual:"?",LeftUpDownVector:"?",LeftUpTeeVector:"?",LeftUpVectorBar:"?",LeftUpVector:"?",LeftVectorBar:"?",LeftVector:"?",lEg:"?",leg:"?",leq:"≤",leqq:"≦",leqslant:"?",lescc:"?",les:"?",lesdot:"?",lesdoto:"?",lesdotor:"?",lesg:"??",lesges:"?",lessapprox:"?",lessdot:"?",lesseqgtr:"?",lesseqqgtr:"?",LessEqualGreater:"?",LessFullEqual:"≦",LessGreater:"?",lessgtr:"?",LessLess:"?",lesssim:"?",LessSlantEqual:"?",LessTilde:"?",lfisht:"?",lfloor:"?",Lfr:"??",lfr:"??",lg:"?",lgE:"?",lHar:"?",lhard:"?",lharu:"?",lharul:"?",lhblk:"▄",LJcy:"?",ljcy:"?",llarr:"?",ll:"?",Ll:"?",llcorner:"?",Lleftarrow:"?",llhard:"?",lltri:"?",Lmidot:"?",lmidot:"?",lmoustache:"?",lmoust:"?",lnap:"?",lnapprox:"?",lne:"?",lnE:"?",lneq:"?",lneqq:"?",lnsim:"?",loang:"?",loarr:"?",lobrk:"?",longleftarrow:"?",LongLeftArrow:"?",Longleftarrow:"?",longleftrightarrow:"?",LongLeftRightArrow:"?",Longleftrightarrow:"?",longmapsto:"?",longrightarrow:"?",LongRightArrow:"?",Longrightarrow:"?",looparrowleft:"?",looparrowright:"?",lopar:"?",Lopf:"??",lopf:"??",loplus:"?",lotimes:"?",lowast:"?",lowbar:"_",LowerLeftArrow:"↙",LowerRightArrow:"↘",loz:"?",lozenge:"?",lozf:"?",lpar:"(",lparlt:"?",lrarr:"?",lrcorner:"?",lrhar:"?",lrhard:"?",lrm:"?",lrtri:"⊿",lsaquo:"?",lscr:"??",Lscr:"?",lsh:"?",Lsh:"?",lsim:"?",lsime:"?",lsimg:"?",lsqb:"[",lsquo:"‘",lsquor:"?",Lstrok:"?",lstrok:"?",ltcc:"?",ltcir:"?",lt:"<",LT:"<",Lt:"?",ltdot:"?",lthree:"?",ltimes:"?",ltlarr:"?",ltquest:"?",ltri:"?",ltrie:"?",ltrif:"?",ltrPar:"?",lurdshar:"?",luruhar:"?",lvertneqq:"??",lvnE:"??",macr:"ˉ",male:"♂",malt:"?",maltese:"?",Map:"?",map:"?",mapsto:"?",mapstodown:"?",mapstoleft:"?",mapstoup:"?",marker:"?",mcomma:"?",Mcy:"М",mcy:"м",mdash:"—",mDDot:"?",measuredangle:"?",MediumSpace:"?",Mellintrf:"?",Mfr:"??",mfr:"??",mho:"?",micro:"μ",midast:"*",midcir:"?",mid:"∣",middot:"·",minusb:"?",minus:"?",minusd:"?",minusdu:"?",MinusPlus:"?",mlcp:"?",mldr:"…",mnplus:"?",models:"?",Mopf:"??",mopf:"??",mp:"?",mscr:"??",Mscr:"?",mstpos:"?",Mu:"Μ",mu:"μ",multimap:"?",mumap:"?",nabla:"?",Nacute:"?",nacute:"ń",nang:"∠?",nap:"?",napE:"??",napid:"??",napos:"?",napprox:"?",natural:"?",naturals:"?",natur:"?",nbsp:"?",nbump:"??",nbumpe:"??",ncap:"?",Ncaron:"?",ncaron:"ň",Ncedil:"?",ncedil:"?",ncong:"?",ncongdot:"??",ncup:"?",Ncy:"Н",ncy:"н",ndash:"–",nearhk:"?",nearr:"↗",neArr:"?",nearrow:"↗",ne:"≠",nedot:"??",NegativeMediumSpace:"?",NegativeThickSpace:"?",NegativeThinSpace:"?",NegativeVeryThinSpace:"?",nequiv:"?",nesear:"?",nesim:"??",NestedGreaterGreater:"?",NestedLessLess:"?",NewLine:"\n",nexist:"?",nexists:"?",Nfr:"??",nfr:"??",ngE:"≧?",nge:"?",ngeq:"?",ngeqq:"≧?",ngeqslant:"??",nges:"??",nGg:"??",ngsim:"?",nGt:"??",ngt:"≯",ngtr:"≯",nGtv:"??",nharr:"?",nhArr:"?",nhpar:"?",ni:"?",nis:"?",nisd:"?",niv:"?",NJcy:"?",njcy:"?",nlarr:"?",nlArr:"?",nldr:"‥",nlE:"≦?",nle:"?",nleftarrow:"?",nLeftarrow:"?",nleftrightarrow:"?",nLeftrightarrow:"?",nleq:"?",nleqq:"≦?",nleqslant:"??",nles:"??",nless:"≮",nLl:"??",nlsim:"?",nLt:"??",nlt:"≮",nltri:"?",nltrie:"?",nLtv:"??",nmid:"?",NoBreak:"?",NonBreakingSpace:"?",nopf:"??",Nopf:"?",Not:"?",not:"?",NotCongruent:"?",NotCupCap:"?",NotDoubleVerticalBar:"?",NotElement:"?",NotEqual:"≠",NotEqualTilde:"??",NotExists:"?",NotGreater:"≯",NotGreaterEqual:"?",NotGreaterFullEqual:"≧?",NotGreaterGreater:"??",NotGreaterLess:"?",NotGreaterSlantEqual:"??",NotGreaterTilde:"?",NotHumpDownHump:"??",NotHumpEqual:"??",notin:"?",notindot:"??",notinE:"??",notinva:"?",notinvb:"?",notinvc:"?",NotLeftTriangleBar:"??",NotLeftTriangle:"?",NotLeftTriangleEqual:"?",NotLess:"≮",NotLessEqual:"?",NotLessGreater:"?",NotLessLess:"??",NotLessSlantEqual:"??",NotLessTilde:"?",NotNestedGreaterGreater:"??",NotNestedLessLess:"??",notni:"?",notniva:"?",notnivb:"?",notnivc:"?",NotPrecedes:"?",NotPrecedesEqual:"??",NotPrecedesSlantEqual:"?",NotReverseElement:"?",NotRightTriangleBar:"??",NotRightTriangle:"?",NotRightTriangleEqual:"?",NotSquareSubset:"??",NotSquareSubsetEqual:"?",NotSquareSuperset:"??",NotSquareSupersetEqual:"?",NotSubset:"??",NotSubsetEqual:"?",NotSucceeds:"?",NotSucceedsEqual:"??",NotSucceedsSlantEqual:"?",NotSucceedsTilde:"??",NotSuperset:"??",NotSupersetEqual:"?",NotTilde:"?",NotTildeEqual:"?",NotTildeFullEqual:"?",NotTildeTilde:"?",NotVerticalBar:"?",nparallel:"?",npar:"?",nparsl:"??",npart:"??",npolint:"?",npr:"?",nprcue:"?",nprec:"?",npreceq:"??",npre:"??",nrarrc:"??",nrarr:"?",nrArr:"?",nrarrw:"??",nrightarrow:"?",nRightarrow:"?",nrtri:"?",nrtrie:"?",nsc:"?",nsccue:"?",nsce:"??",Nscr:"??",nscr:"??",nshortmid:"?",nshortparallel:"?",nsim:"?",nsime:"?",nsimeq:"?",nsmid:"?",nspar:"?",nsqsube:"?",nsqsupe:"?",nsub:"?",nsubE:"??",nsube:"?",nsubset:"??",nsubseteq:"?",nsubseteqq:"??",nsucc:"?",nsucceq:"??",nsup:"?",nsupE:"??",nsupe:"?",nsupset:"??",nsupseteq:"?",nsupseteqq:"??",ntgl:"?",Ntilde:"?",ntilde:"?",ntlg:"?",ntriangleleft:"?",ntrianglelefteq:"?",ntriangleright:"?",ntrianglerighteq:"?",Nu:"Ν",nu:"ν",num:"#",numero:"№",numsp:"?",nvap:"??",nvdash:"?",nvDash:"?",nVdash:"?",nVDash:"?",nvge:"≥?",nvgt:">?",nvHarr:"?",nvinfin:"?",nvlArr:"?",nvle:"≤?",nvlt:"<?",nvltrie:"??",nvrArr:"?",nvrtrie:"??",nvsim:"～?",nwarhk:"?",nwarr:"↖",nwArr:"?",nwarrow:"↖",nwnear:"?",Oacute:"ó",oacute:"ó",oast:"?",Ocirc:"?",ocirc:"?",ocir:"?",Ocy:"О",ocy:"о",odash:"?",Odblac:"?",odblac:"?",odiv:"?",odot:"⊙",odsold:"?",OElig:"?",oelig:"?",ofcir:"?",Ofr:"??",ofr:"??",ogon:"?",Ograve:"ò",ograve:"ò",ogt:"?",ohbar:"?",ohm:"Ω",oint:"∮",olarr:"?",olcir:"?",olcross:"?",oline:"￣",olt:"?",Omacr:"ō",omacr:"ō",Omega:"Ω",omega:"ω",Omicron:"Ο",omicron:"ο",omid:"?",ominus:"?",Oopf:"??",oopf:"??",opar:"?",OpenCurlyDoubleQuote:"“",OpenCurlyQuote:"‘",operp:"?",oplus:"⊕",orarr:"?",Or:"?",or:"∨",ord:"?",order:"?",orderof:"?",ordf:"a",ordm:"o",origof:"?",oror:"?",orslope:"?",orv:"?",oS:"?",Oscr:"??",oscr:"?",Oslash:"?",oslash:"?",osol:"?",Otilde:"?",otilde:"?",otimesas:"?",Otimes:"?",otimes:"?",Ouml:"?",ouml:"?",ovbar:"?",OverBar:"￣",OverBrace:"?",OverBracket:"?",OverParenthesis:"?",para:"?",parallel:"∥",par:"∥",parsim:"?",parsl:"?",part:"?",PartialD:"?",Pcy:"П",pcy:"п",percnt:"%",period:".",permil:"‰",perp:"⊥",pertenk:"?",Pfr:"??",pfr:"??",Phi:"Φ",phi:"φ",phiv:"?",phmmat:"?",phone:"?",Pi:"Π",pi:"π",pitchfork:"?",piv:"?",planck:"?",planckh:"?",plankv:"?",plusacir:"?",plusb:"?",pluscir:"?",plus:"+",plusdo:"?",plusdu:"?",pluse:"?",PlusMinus:"±",plusmn:"±",plussim:"?",plustwo:"?",pm:"±",Poincareplane:"?",pointint:"?",popf:"??",Popf:"?",pound:"￡",prap:"?",Pr:"?",pr:"?",prcue:"?",precapprox:"?",prec:"?",preccurlyeq:"?",Precedes:"?",PrecedesEqual:"?",PrecedesSlantEqual:"?",PrecedesTilde:"?",preceq:"?",precnapprox:"?",precneqq:"?",precnsim:"?",pre:"?",prE:"?",precsim:"?",prime:"′",Prime:"″",primes:"?",prnap:"?",prnE:"?",prnsim:"?",prod:"∏",Product:"∏",profalar:"?",profline:"⌒",profsurf:"?",prop:"∝",Proportional:"∝",Proportion:"∷",propto:"∝",prsim:"?",prurel:"?",Pscr:"??",pscr:"??",Psi:"Ψ",psi:"ψ",puncsp:"?",Qfr:"??",qfr:"??",qint:"?",qopf:"??",Qopf:"?",qprime:"?",Qscr:"??",qscr:"??",quaternions:"?",quatint:"?",quest:"?",questeq:"?",quot:'"',QUOT:'"',rAarr:"?",race:"∽?",Racute:"?",racute:"?",radic:"√",raemptyv:"?",rang:"?",Rang:"?",rangd:"?",range:"?",rangle:"?",raquo:"?",rarrap:"?",rarrb:"?",rarrbfs:"?",rarrc:"?",rarr:"→",Rarr:"?",rArr:"?",rarrfs:"?",rarrhk:"?",rarrlp:"?",rarrpl:"?",rarrsim:"?",Rarrtl:"?",rarrtl:"?",rarrw:"?",ratail:"?",rAtail:"?",ratio:"∶",rationals:"?",rbarr:"?",rBarr:"?",RBarr:"?",rbbrk:"?",rbrace:"}",rbrack:"]",rbrke:"?",rbrksld:"?",rbrkslu:"?",Rcaron:"?",rcaron:"?",Rcedil:"?",rcedil:"?",rceil:"?",rcub:"}",Rcy:"Р",rcy:"р",rdca:"?",rdldhar:"?",rdquo:"”",rdquor:"”",rdsh:"?",real:"?",realine:"?",realpart:"?",reals:"?",Re:"?",rect:"?",reg:"?",REG:"?",ReverseElement:"?",ReverseEquilibrium:"?",ReverseUpEquilibrium:"?",rfisht:"?",rfloor:"?",rfr:"??",Rfr:"?",rHar:"?",rhard:"?",rharu:"?",rharul:"?",Rho:"Ρ",rho:"ρ",rhov:"?",RightAngleBracket:"?",RightArrowBar:"?",rightarrow:"→",RightArrow:"→",Rightarrow:"?",RightArrowLeftArrow:"?",rightarrowtail:"?",RightCeiling:"?",RightDoubleBracket:"?",RightDownTeeVector:"?",RightDownVectorBar:"?",RightDownVector:"?",RightFloor:"?",rightharpoondown:"?",rightharpoonup:"?",rightleftarrows:"?",rightleftharpoons:"?",rightrightarrows:"?",rightsquigarrow:"?",RightTeeArrow:"?",RightTee:"?",RightTeeVector:"?",rightthreetimes:"?",RightTriangleBar:"?",RightTriangle:"?",RightTriangleEqual:"?",RightUpDownVector:"?",RightUpTeeVector:"?",RightUpVectorBar:"?",RightUpVector:"?",RightVectorBar:"?",RightVector:"?",ring:"?",risingdotseq:"?",rlarr:"?",rlhar:"?",rlm:"?",rmoustache:"?",rmoust:"?",rnmid:"?",roang:"?",roarr:"?",robrk:"?",ropar:"?",ropf:"??",Ropf:"?",roplus:"?",rotimes:"?",RoundImplies:"?",rpar:")",rpargt:"?",rppolint:"?",rrarr:"?",Rrightarrow:"?",rsaquo:"?",rscr:"??",Rscr:"?",rsh:"?",Rsh:"?",rsqb:"]",rsquo:"’",rsquor:"’",rthree:"?",rtimes:"?",rtri:"?",rtrie:"?",rtrif:"?",rtriltri:"?",RuleDelayed:"?",ruluhar:"?",rx:"?",Sacute:"?",sacute:"?",sbquo:"?",scap:"?",Scaron:"?",scaron:"?",Sc:"?",sc:"?",sccue:"?",sce:"?",scE:"?",Scedil:"?",scedil:"?",Scirc:"?",scirc:"?",scnap:"?",scnE:"?",scnsim:"?",scpolint:"?",scsim:"?",Scy:"С",scy:"с",sdotb:"?",sdot:"?",sdote:"?",searhk:"?",searr:"↘",seArr:"?",searrow:"↘",sect:"§",semi:";",seswar:"?",setminus:"?",setmn:"?",sext:"?",Sfr:"??",sfr:"??",sfrown:"?",sharp:"?",SHCHcy:"Щ",shchcy:"щ",SHcy:"Ш",shcy:"ш",ShortDownArrow:"↓",ShortLeftArrow:"←",shortmid:"∣",shortparallel:"∥",ShortRightArrow:"→",ShortUpArrow:"↑",shy:"-",Sigma:"Σ",sigma:"σ",sigmaf:"?",sigmav:"?",sim:"～",simdot:"?",sime:"?",simeq:"?",simg:"?",simgE:"?",siml:"?",simlE:"?",simne:"?",simplus:"?",simrarr:"?",slarr:"←",SmallCircle:"°",smallsetminus:"?",smashp:"?",smeparsl:"?",smid:"∣",smile:"?",smt:"?",smte:"?",smtes:"??",SOFTcy:"Ь",softcy:"ь",solbar:"?",solb:"?",sol:"/",Sopf:"??",sopf:"??",spades:"?",spadesuit:"?",spar:"∥",sqcap:"?",sqcaps:"??",sqcup:"?",sqcups:"??",Sqrt:"√",sqsub:"?",sqsube:"?",sqsubset:"?",sqsubseteq:"?",sqsup:"?",sqsupe:"?",sqsupset:"?",sqsupseteq:"?",square:"□",Square:"□",SquareIntersection:"?",SquareSubset:"?",SquareSubsetEqual:"?",SquareSuperset:"?",SquareSupersetEqual:"?",SquareUnion:"?",squarf:"?",squ:"□",squf:"?",srarr:"→",Sscr:"??",sscr:"??",ssetmn:"?",ssmile:"?",sstarf:"?",Star:"?",star:"☆",starf:"★",straightepsilon:"?",straightphi:"?",strns:"ˉ",sub:"?",Sub:"?",subdot:"?",subE:"?",sube:"?",subedot:"?",submult:"?",subnE:"?",subne:"?",subplus:"?",subrarr:"?",subset:"?",Subset:"?",subseteq:"?",subseteqq:"?",SubsetEqual:"?",subsetneq:"?",subsetneqq:"?",subsim:"?",subsub:"?",subsup:"?",succapprox:"?",succ:"?",succcurlyeq:"?",Succeeds:"?",SucceedsEqual:"?",SucceedsSlantEqual:"?",SucceedsTilde:"?",succeq:"?",succnapprox:"?",succneqq:"?",succnsim:"?",succsim:"?",SuchThat:"?",sum:"∑",Sum:"∑",sung:"?",sup1:"1",sup2:"2",sup3:"3",sup:"?",Sup:"?",supdot:"?",supdsub:"?",supE:"?",supe:"?",supedot:"?",Superset:"?",SupersetEqual:"?",suphsol:"?",suphsub:"?",suplarr:"?",supmult:"?",supnE:"?",supne:"?",supplus:"?",supset:"?",Supset:"?",supseteq:"?",supseteqq:"?",supsetneq:"?",supsetneqq:"?",supsim:"?",supsub:"?",supsup:"?",swarhk:"?",swarr:"↙",swArr:"?",swarrow:"↙",swnwar:"?",szlig:"?",Tab:"\t",target:"?",Tau:"Τ",tau:"τ",tbrk:"?",Tcaron:"?",tcaron:"?",Tcedil:"?",tcedil:"?",Tcy:"Т",tcy:"т",tdot:"?",telrec:"?",Tfr:"??",tfr:"??",there4:"∴",therefore:"∴",Therefore:"∴",Theta:"Θ",theta:"θ",thetasym:"?",thetav:"?",thickapprox:"≈",thicksim:"～",ThickSpace:"??",ThinSpace:"?",thinsp:"?",thkap:"≈",thksim:"～",THORN:"T",thorn:"t",tilde:"?",Tilde:"～",TildeEqual:"?",TildeFullEqual:"?",TildeTilde:"≈",timesbar:"?",timesb:"?",times:"×",timesd:"?",tint:"?",toea:"?",topbot:"?",topcir:"?",top:"?",Topf:"??",topf:"??",topfork:"?",tosa:"?",tprime:"?",trade:"?",TRADE:"?",triangle:"?",triangledown:"?",triangleleft:"?",trianglelefteq:"?",triangleq:"?",triangleright:"?",trianglerighteq:"?",tridot:"?",trie:"?",triminus:"?",TripleDot:"?",triplus:"?",trisb:"?",tritime:"?",trpezium:"?",Tscr:"??",tscr:"??",TScy:"Ц",tscy:"ц",TSHcy:"?",tshcy:"?",Tstrok:"?",tstrok:"?",twixt:"?",twoheadleftarrow:"?",twoheadrightarrow:"?",Uacute:"ú",uacute:"ú",uarr:"↑",Uarr:"?",uArr:"?",Uarrocir:"?",Ubrcy:"?",ubrcy:"?",Ubreve:"?",ubreve:"?",Ucirc:"?",ucirc:"?",Ucy:"У",ucy:"у",udarr:"?",Udblac:"?",udblac:"?",udhar:"?",ufisht:"?",Ufr:"??",ufr:"??",Ugrave:"ù",ugrave:"ù",uHar:"?",uharl:"?",uharr:"?",uhblk:"?",ulcorn:"?",ulcorner:"?",ulcrop:"?",ultri:"?",Umacr:"ū",umacr:"ū",uml:"¨",UnderBar:"_",UnderBrace:"?",UnderBracket:"?",UnderParenthesis:"?",Union:"?",UnionPlus:"?",Uogon:"?",uogon:"?",Uopf:"??",uopf:"??",UpArrowBar:"?",uparrow:"↑",UpArrow:"↑",Uparrow:"?",UpArrowDownArrow:"?",updownarrow:"?",UpDownArrow:"?",Updownarrow:"?",UpEquilibrium:"?",upharpoonleft:"?",upharpoonright:"?",uplus:"?",UpperLeftArrow:"↖",UpperRightArrow:"↗",upsi:"υ",Upsi:"?",upsih:"?",Upsilon:"Υ",upsilon:"υ",UpTeeArrow:"?",UpTee:"⊥",upuparrows:"?",urcorn:"?",urcorner:"?",urcrop:"?",Uring:"?",uring:"?",urtri:"?",Uscr:"??",uscr:"??",utdot:"?",Utilde:"?",utilde:"?",utri:"?",utrif:"?",uuarr:"?",Uuml:"ü",uuml:"ü",uwangle:"?",vangrt:"?",varepsilon:"?",varkappa:"?",varnothing:"?",varphi:"?",varpi:"?",varpropto:"∝",varr:"?",vArr:"?",varrho:"?",varsigma:"?",varsubsetneq:"??",varsubsetneqq:"??",varsupsetneq:"??",varsupsetneqq:"??",vartheta:"?",vartriangleleft:"?",vartriangleright:"?",vBar:"?",Vbar:"?",vBarv:"?",Vcy:"В",vcy:"в",vdash:"?",vDash:"?",Vdash:"?",VDash:"?",Vdashl:"?",veebar:"?",vee:"∨",Vee:"?",veeeq:"?",vellip:"?",verbar:"|",Verbar:"‖",vert:"|",Vert:"‖",VerticalBar:"∣",VerticalLine:"|",VerticalSeparator:"?",VerticalTilde:"?",VeryThinSpace:"?",Vfr:"??",vfr:"??",vltri:"?",vnsub:"??",vnsup:"??",Vopf:"??",vopf:"??",vprop:"∝",vrtri:"?",Vscr:"??",vscr:"??",vsubnE:"??",vsubne:"??",vsupnE:"??",vsupne:"??",Vvdash:"?",vzigzag:"?",Wcirc:"?",wcirc:"?",wedbar:"?",wedge:"∧",Wedge:"?",wedgeq:"?",weierp:"?",Wfr:"??",wfr:"??",Wopf:"??",wopf:"??",wp:"?",wr:"?",wreath:"?",Wscr:"??",wscr:"??",xcap:"?",xcirc:"?",xcup:"?",xdtri:"▽",Xfr:"??",xfr:"??",xharr:"?",xhArr:"?",Xi:"Ξ",xi:"ξ",xlarr:"?",xlArr:"?",xmap:"?",xnis:"?",xodot:"?",Xopf:"??",xopf:"??",xoplus:"?",xotime:"?",xrarr:"?",xrArr:"?",Xscr:"??",xscr:"??",xsqcup:"?",xuplus:"?",xutri:"△",xvee:"?",xwedge:"?",Yacute:"Y",yacute:"y",YAcy:"Я",yacy:"я",Ycirc:"?",ycirc:"?",Ycy:"Ы",ycy:"ы",yen:"￥",Yfr:"??",yfr:"??",YIcy:"?",yicy:"?",Yopf:"??",yopf:"??",Yscr:"??",yscr:"??",YUcy:"Ю",yucy:"ю",yuml:"?",Yuml:"?",Zacute:"?",zacute:"?",Zcaron:"?",zcaron:"?",Zcy:"З",zcy:"з",Zdot:"?",zdot:"?",zeetrf:"?",ZeroWidthSpace:"?",Zeta:"Ζ",zeta:"ζ",zfr:"??",Zfr:"?",ZHcy:"Ж",zhcy:"ж",zigrarr:"?",zopf:"??",Zopf:"?",Zscr:"??",zscr:"??",zwj:"?",zwnj:"?"}},{}],54:[function(e,r,t){"use strict";function n(e){return Array.prototype.slice.call(arguments,1).forEach(function(r){r&&Object.keys(r).forEach(function(t){e[t]=r[t]})}),e}function s(e){return Object.prototype.toString.call(e)}function o(e){return"[object String]"===s(e)}function i(e){return"[object Object]"===s(e)}function a(e){return"[object RegExp]"===s(e)}function c(e){return"[object Function]"===s(e)}function l(e){return e.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function d(r){function t(e){return e.replace("%TLDS%",s.src_tlds)}function n(e,r){throw new Error('(LinkifyIt) Invalid schema "'+e+'": '+r)}var s=r.re=e("./lib/re")(r.__opts__),u=r.__tlds__.slice();r.onCompile(),r.__tlds_replaced__||u.push(v),u.push(s.src_xn),s.src_tlds=u.join("|"),s.email_fuzzy=RegExp(t(s.tpl_email_fuzzy),"i"),s.link_fuzzy=RegExp(t(s.tpl_link_fuzzy),"i"),s.link_no_ip_fuzzy=RegExp(t(s.tpl_link_no_ip_fuzzy),"i"),s.host_fuzzy_test=RegExp(t(s.tpl_host_fuzzy_test),"i");var d=[];r.__compiled__={},Object.keys(r.__schemas__).forEach(function(e){var t=r.__schemas__[e];if(null!==t){var s={validate:null,link:null};return r.__compiled__[e]=s,i(t)?(a(t.validate)?s.validate=function(e){return function(r,t){var n=r.slice(t);return e.test(n)?n.match(e)[0].length:0}}(t.validate):c(t.validate)?s.validate=t.validate:n(e,t),void(c(t.normalize)?s.normalize=t.normalize:t.normalize?n(e,t):s.normalize=function(e,r){r.normalize(e)})):o(t)?void d.push(e):void n(e,t)}}),d.forEach(function(e){r.__compiled__[r.__schemas__[e]]&&(r.__compiled__[e].validate=r.__compiled__[r.__schemas__[e]].validate,r.__compiled__[e].normalize=r.__compiled__[r.__schemas__[e]].normalize)}),r.__compiled__[""]={validate:null,normalize:function(e,r){r.normalize(e)}};var m=Object.keys(r.__compiled__).filter(function(e){return 0<e.length&&r.__compiled__[e]}).map(l).join("|");r.re.schema_test=RegExp("(^|(?!_)(?:[><]|"+s.src_ZPCc+"))("+m+")","i"),r.re.schema_search=RegExp("(^|(?!_)(?:[><]|"+s.src_ZPCc+"))("+m+")","ig"),r.re.pretest=RegExp("("+r.re.schema_test.source+")|("+r.re.host_fuzzy_test.source+")|@","i"),function(e){e.__index__=-1,e.__text_cache__=""}(r)}function m(e,r){var t=e.__index__,n=e.__last_index__,s=e.__text_cache__.slice(t,n);this.schema=e.__schema__.toLowerCase(),this.index=t+r,this.lastIndex=n+r,this.raw=s,this.text=s,this.url=s}function _(e,r){var t=new m(e,r);return e.__compiled__[t.schema].normalize(t,e),t}function g(e,r){return this instanceof g?(r||function(e){return Object.keys(e||{}).reduce(function(e,r){return e||k.hasOwnProperty(r)},!1)}(e)&&(r=e,e={}),this.__opts__=n({},k,r),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=n({},b,e),this.__compiled__={},this.__tlds__=x,this.__tlds_replaced__=!1,this.re={},void d(this)):new g(e,r)}var k={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1},b={"http:":{validate:function(e,r,t){var n=e.slice(r);return t.re.http||(t.re.http=new RegExp("^\\/\\/"+t.re.src_auth+t.re.src_host_port_strict+t.re.src_path,"i")),t.re.http.test(n)?n.match(t.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(e,r,t){var n=e.slice(r);return t.re.no_http||(t.re.no_http=new RegExp("^"+t.re.src_auth+"(?:localhost|(?:(?:"+t.re.src_domain+")\\.)+"+t.re.src_domain_root+")"+t.re.src_port+t.re.src_host_terminator+t.re.src_path,"i")),t.re.no_http.test(n)?3<=r&&":"===e[r-3]?0:3<=r&&"/"===e[r-3]?0:n.match(t.re.no_http)[0].length:0}},"mailto:":{validate:function(e,r,t){var n=e.slice(r);return t.re.mailto||(t.re.mailto=new RegExp("^"+t.re.src_email_name+"@"+t.re.src_host_strict,"i")),t.re.mailto.test(n)?n.match(t.re.mailto)[0].length:0}}},v="a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]",x="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|рф".split("|");g.prototype.add=function(e,r){return this.__schemas__[e]=r,d(this),this},g.prototype.set=function(e){return this.__opts__=n(this.__opts__,e),this},g.prototype.test=function(e){if(this.__text_cache__=e,this.__index__=-1,!e.length)return!1;var r,t,n,s,o,i,a,c;if(this.re.schema_test.test(e))for((a=this.re.schema_search).lastIndex=0;null!==(r=a.exec(e));)if(s=this.testSchemaAt(e,r[2],a.lastIndex)){this.__schema__=r[2],this.__index__=r.index+r[1].length,this.__last_index__=r.index+r[0].length+s;break}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(0<=(c=e.search(this.re.host_fuzzy_test))&&(this.__index__<0||c<this.__index__)&&null!==(t=e.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))&&(o=t.index+t[1].length,(this.__index__<0||o<this.__index__)&&(this.__schema__="",this.__index__=o,this.__last_index__=t.index+t[0].length))),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&(0<=e.indexOf("@")&&null!==(n=e.match(this.re.email_fuzzy))&&(o=n.index+n[1].length,i=n.index+n[0].length,(this.__index__<0||o<this.__index__||o===this.__index__&&i>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=o,this.__last_index__=i))),0<=this.__index__},g.prototype.pretest=function(e){return this.re.pretest.test(e)},g.prototype.testSchemaAt=function(e,r,t){return this.__compiled__[r.toLowerCase()]?this.__compiled__[r.toLowerCase()].validate(e,t,this):0},g.prototype.match=function(e){var r=0,t=[];0<=this.__index__&&this.__text_cache__===e&&(t.push(_(this,r)),r=this.__last_index__);for(var n=r?e.slice(r):e;this.test(n);)t.push(_(this,r)),n=n.slice(this.__last_index__),r+=this.__last_index__;return t.length?t:null},g.prototype.tlds=function(e,r){return e=Array.isArray(e)?e:[e],r?this.__tlds__=this.__tlds__.concat(e).sort().filter(function(e,r,t){return e!==t[r-1]}).reverse():(this.__tlds__=e.slice(),this.__tlds_replaced__=!0),d(this),this},g.prototype.normalize=function(e){e.schema||(e.url="http://"+e.url),"mailto:"!==e.schema||/^mailto:/i.test(e.url)||(e.url="mailto:"+e.url)},g.prototype.onCompile=function(){},r.exports=g},{"./lib/re":55}],55:[function(e,r,t){"use strict";r.exports=function(r){var t={};return t.src_Any=e("uc.micro/properties/Any/regex").source,t.src_Cc=e("uc.micro/categories/Cc/regex").source,t.src_Z=e("uc.micro/categories/Z/regex").source,t.src_P=e("uc.micro/categories/P/regex").source,t.src_ZPCc=[t.src_Z,t.src_P,t.src_Cc].join("|"),t.src_ZCc=[t.src_Z,t.src_Cc].join("|"),t.src_pseudo_letter="(?:(?!>|<|"+t.src_ZPCc+")"+t.src_Any+")",t.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",t.src_auth="(?:(?:(?!"+t.src_ZCc+"|[@/]).)+@)?",t.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",t.src_host_terminator="(?=$|>|<|"+t.src_ZPCc+")(?!-|_|:\\d|\\.-|\\.(?!$|"+t.src_ZPCc+"))",t.src_path="(?:[/?#](?:(?!"+t.src_ZCc+"|[()[\\]{}.,\"'?!\\-<>]).|\\[(?:(?!"+t.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+t.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+t.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+t.src_ZCc+'|["]).)+\\"|\\\'(?:(?!'+t.src_ZCc+"|[']).)+\\'|\\'(?="+t.src_pseudo_letter+"|[-]).|\\.{2,3}[a-zA-Z0-9%/]|\\.(?!"+t.src_ZCc+"|[.]).|"+(r&&r["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+"\\,(?!"+t.src_ZCc+").|\\!(?!"+t.src_ZCc+"|[!]).|\\?(?!"+t.src_ZCc+"|[?]).)+|\\/)?",t.src_email_name='[\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]+',t.src_xn="xn--[a-z0-9\\-]{1,59}",t.src_domain_root="(?:"+t.src_xn+"|"+t.src_pseudo_letter+"{1,63})",t.src_domain="(?:"+t.src_xn+"|(?:"+t.src_pseudo_letter+")|(?:"+t.src_pseudo_letter+"(?:-(?!-)|"+t.src_pseudo_letter+"){0,61}"+t.src_pseudo_letter+"))",t.src_host="(?:(?:(?:(?:"+t.src_domain+")\\.)*"+t.src_domain_root+"))",t.tpl_host_fuzzy="(?:"+t.src_ip4+"|(?:(?:(?:"+t.src_domain+")\\.)+(?:%TLDS%)))",t.tpl_host_no_ip_fuzzy="(?:(?:(?:"+t.src_domain+")\\.)+(?:%TLDS%))",t.src_host_strict=t.src_host+t.src_host_terminator,t.tpl_host_fuzzy_strict=t.tpl_host_fuzzy+t.src_host_terminator,t.src_host_port_strict=t.src_host+t.src_port+t.src_host_terminator,t.tpl_host_port_fuzzy_strict=t.tpl_host_fuzzy+t.src_port+t.src_host_terminator,t.tpl_host_port_no_ip_fuzzy_strict=t.tpl_host_no_ip_fuzzy+t.src_port+t.src_host_terminator,t.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+t.src_ZPCc+"|>|$))",t.tpl_email_fuzzy="(^|<|>|\\(|"+t.src_ZCc+")("+t.src_email_name+"@"+t.tpl_host_fuzzy_strict+")",t.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+t.src_ZPCc+"))((?![$+<=>^`|])"+t.tpl_host_port_fuzzy_strict+t.src_path+")",t.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+t.src_ZPCc+"))((?![$+<=>^`|])"+t.tpl_host_port_no_ip_fuzzy_strict+t.src_path+")",t}},{"uc.micro/categories/Cc/regex":61,"uc.micro/categories/P/regex":63,"uc.micro/categories/Z/regex":64,"uc.micro/properties/Any/regex":66}],56:[function(e,r,t){"use strict";function s(e,r){var t;return"string"!=typeof r&&(r=s.defaultChars),t=function(e){var r,t,n=o[e];if(n)return n;for(n=o[e]=[],r=0;r<128;r++)t=String.fromCharCode(r),n.push(t);for(r=0;r<e.length;r++)n[t=e.charCodeAt(r)]="%"+("0"+t.toString(16).toUpperCase()).slice(-2);return n}(r),e.replace(/(%[a-f0-9]{2})+/gi,function(e){var r,n,s,o,i,a,c,l="";for(r=0,n=e.length;r<n;r+=3)(s=parseInt(e.slice(r+1,r+3),16))<128?l+=t[s]:192==(224&s)&&r+3<n&&128==(192&(o=parseInt(e.slice(r+4,r+6),16)))?(l+=(c=s<<6&1984|63&o)<128?"??":String.fromCharCode(c),r+=3):224==(240&s)&&r+6<n&&(o=parseInt(e.slice(r+4,r+6),16),i=parseInt(e.slice(r+7,r+9),16),128==(192&o)&&128==(192&i))?(l+=(c=s<<12&61440|o<<6&4032|63&i)<2048||55296<=c&&c<=57343?"???":String.fromCharCode(c),r+=6):240==(248&s)&&r+9<n&&(o=parseInt(e.slice(r+4,r+6),16),i=parseInt(e.slice(r+7,r+9),16),a=parseInt(e.slice(r+10,r+12),16),128==(192&o)&&128==(192&i)&&128==(192&a))?((c=s<<18&1835008|o<<12&258048|i<<6&4032|63&a)<65536||1114111<c?l+="????":(c-=65536,l+=String.fromCharCode(55296+(c>>10),56320+(1023&c))),r+=9):l+="?";return l})}var o={};s.defaultChars=";/?:@&=+$,#",s.componentChars="",r.exports=s},{}],57:[function(e,r,t){"use strict";function n(e){var r,t,n=o[e];if(n)return n;for(n=o[e]=[],r=0;r<128;r++)t=String.fromCharCode(r),/^[0-9a-z]$/i.test(t)?n.push(t):n.push("%"+("0"+r.toString(16).toUpperCase()).slice(-2));for(r=0;r<e.length;r++)n[e.charCodeAt(r)]=e[r];return n}function s(e,r,t){var o,i,a,c,l,u="";for("string"!=typeof r&&(t=r,r=s.defaultChars),void 0===t&&(t=!0),l=n(r),o=0,i=e.length;o<i;o++)if(a=e.charCodeAt(o),t&&37===a&&o+2<i&&/^[0-9a-f]{2}$/i.test(e.slice(o+1,o+3)))u+=e.slice(o,o+3),o+=2;else if(a<128)u+=l[a];else if(55296<=a&&a<=57343){if(55296<=a&&a<=56319&&o+1<i&&(56320<=(c=e.charCodeAt(o+1))&&c<=57343)){u+=encodeURIComponent(e[o]+e[o+1]),o++;continue}u+="%EF%BF%BD"}else u+=encodeURIComponent(e[o]);return u}var o={};s.defaultChars=";/?:@&=+$,-_.!~*'()#",s.componentChars="-_.!~*'()",r.exports=s},{}],58:[function(e,r,t){"use strict";r.exports=function(e){var r="";return r+=e.protocol||"",r+=e.slashes?"//":"",r+=e.auth?e.auth+"@":"",r+=e.hostname&&-1!==e.hostname.indexOf(":")?"["+e.hostname+"]":e.hostname||"",r+=e.port?":"+e.port:"",r+=e.pathname||"",(r+=e.search||"")+(e.hash||"")}},{}],59:[function(e,r,t){"use strict";r.exports.encode=e("./encode"),r.exports.decode=e("./decode"),r.exports.format=e("./format"),r.exports.parse=e("./parse")},{"./decode":56,"./encode":57,"./format":58,"./parse":60}],60:[function(e,r,t){"use strict";function n(){this.protocol=null,this.slashes=null,this.auth=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.pathname=null}var o=/^([a-z0-9.+-]+:)/i,i=/:[0-9]*$/,a=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,l=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),u=["'"].concat(l),p=["%","/","?",";","#"].concat(u),h=["/","?","#"],d=/^[+a-z0-9A-Z_-]{0,63}$/,m=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,_={javascript:!0,"javascript:":!0},g={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};n.prototype.parse=function(e,r){var t,n,s,i,c,l=e;if(l=l.trim(),!r&&1===e.split("#").length){var u=a.exec(l);if(u)return this.pathname=u[1],u[2]&&(this.search=u[2]),this}var k=o.exec(l);if(k&&(s=(k=k[0]).toLowerCase(),this.protocol=k,l=l.substr(k.length)),(r||k||l.match(/^\/\/[^@\/]+@[^@\/]+/))&&(!(c="//"===l.substr(0,2))||k&&_[k]||(l=l.substr(2),this.slashes=!0)),!_[k]&&(c||k&&!g[k])){var v,x,b=-1;for(t=0;t<h.length;t++)-1!==(i=l.indexOf(h[t]))&&(-1===b||i<b)&&(b=i);for(-1!==(x=-1===b?l.lastIndexOf("@"):l.lastIndexOf("@",b))&&(v=l.slice(0,x),l=l.slice(x+1),this.auth=v),b=-1,t=0;t<p.length;t++)-1!==(i=l.indexOf(p[t]))&&(-1===b||i<b)&&(b=i);-1===b&&(b=l.length),":"===l[b-1]&&b--;var y=l.slice(0,b);l=l.slice(b),this.parseHost(y),this.hostname=this.hostname||"";var C="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!C){var A=this.hostname.split(/\./);for(t=0,n=A.length;t<n;t++){var w=A[t];if(w&&!w.match(d)){for(var D="",q=0,E=w.length;q<E;q++)D+=127<w.charCodeAt(q)?"x":w[q];if(!D.match(d)){var S=A.slice(0,t),F=A.slice(t+1),z=w.match(m);z&&(S.push(z[1]),F.unshift(z[2])),F.length&&(l=F.join(".")+l),this.hostname=S.join(".");break}}}}255<this.hostname.length&&(this.hostname=""),C&&(this.hostname=this.hostname.substr(1,this.hostname.length-2))}var L=l.indexOf("#");-1!==L&&(this.hash=l.substr(L),l=l.slice(0,L));var T=l.indexOf("?");return-1!==T&&(this.search=l.substr(T),l=l.slice(0,T)),l&&(this.pathname=l),g[s]&&this.hostname&&!this.pathname&&(this.pathname=""),this},n.prototype.parseHost=function(e){var r=i.exec(e);r&&(":"!==(r=r[0])&&(this.port=r.substr(1)),e=e.substr(0,e.length-r.length)),e&&(this.hostname=e)},r.exports=function(e,r){if(e&&e instanceof n)return e;var t=new n;return t.parse(e,r),t}},{}],61:[function(e,r,t){r.exports=/[\0-\x1F\x7F-\x9F]/},{}],62:[function(e,r,t){r.exports=/[\xAD\u0600-\u0605\u061C\u06DD\u070F\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804\uDCBD|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F]/},{}],63:[function(e,r,t){r.exports=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u0AF0\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E42\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC9\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDF3C-\uDF3E]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]/},{}],64:[function(e,r,t){r.exports=/[ \xA0\u1680\u2000-\u200A\u202F\u205F\u3000]/},{}],65:[function(e,r,t){r.exports.Any=e("./properties/Any/regex"),r.exports.Cc=e("./categories/Cc/regex"),r.exports.Cf=e("./categories/Cf/regex"),r.exports.P=e("./categories/P/regex"),r.exports.Z=e("./categories/Z/regex")},{"./categories/Cc/regex":61,"./categories/Cf/regex":62,"./categories/P/regex":63,"./categories/Z/regex":64,"./properties/Any/regex":66}],66:[function(e,r,t){r.exports=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/},{}],67:[function(e,r,t){"use strict";r.exports=e("./lib/")},{"./lib/":9}]},{},[67])(67)}),define("Core/KnockoutMarkdownBinding",["markdown-it-sanitizer","markdown-it"],function(MarkdownItSanitizer,MarkdownIt){"use strict";var htmlTagRegex=/<html(.|\s)*>(.|\s)*<\/html>/im,md=new MarkdownIt({html:!0,linkify:!0});function setAnchorTargets(element){if(element instanceof HTMLAnchorElement&&(element.target="_blank"),element.childNodes&&0<element.childNodes.length)for(var i=0;i<element.childNodes.length;++i)setAnchorTargets(element.childNodes[i])}return md.use(MarkdownItSanitizer,{imageClass:"",removeUnbalanced:!1,removeUnknown:!1}),{register:function(Knockout){Knockout.bindingHandlers.markdown={init:function(){return{controlsDescendantBindings:!0}},update:function(element,valueAccessor){for(;element.firstChild;)Knockout.removeNode(element.firstChild);var html,rawText=Knockout.unwrap(valueAccessor());html=htmlTagRegex.test(rawText)?rawText:md.render(rawText);var nodes=Knockout.utils.parseHtmlFragment(html,element);element.className=element.className+" markdown";for(var i=0;i<nodes.length;++i){var node=nodes[i];setAnchorTargets(node),element.appendChild(node)}}}}}}),function(a,b,c,d){"use strict";function e(a,b,c){return setTimeout(j(a,c),b)}function f(a,b,c){return!!Array.isArray(a)&&(g(a,c[b],c),!0)}function g(a,b,c){var e;if(a)if(a.forEach)a.forEach(b,c);else if(a.length!==d)for(e=0;e<a.length;)b.call(c,a[e],e,a),e++;else for(e in a)a.hasOwnProperty(e)&&b.call(c,a[e],e,a)}function h(b,c,d){var e="DEPRECATED METHOD: "+c+"\n"+d+" AT \n";return function(){var c=new Error("get-stack-trace"),d=c&&c.stack?c.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",f=a.console&&(a.console.warn||a.console.log);return f&&f.call(a.console,e,d),b.apply(this,arguments)}}function i(a,b,c){var d,e=b.prototype;(d=a.prototype=Object.create(e)).constructor=a,d._super=e,c&&la(d,c)}function j(a,b){return function(){return a.apply(b,arguments)}}function k(a,b){return typeof a==oa?a.apply(b&&b[0]||d,b):a}function l(a,b){return a===d?b:a}function m(a,b,c){g(q(b),function(b){a.addEventListener(b,c,!1)})}function n(a,b,c){g(q(b),function(b){a.removeEventListener(b,c,!1)})}function o(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1}function p(a,b){return-1<a.indexOf(b)}function q(a){return a.trim().split(/\s+/g)}function r(a,b,c){if(a.indexOf&&!c)return a.indexOf(b);for(var d=0;d<a.length;){if(c&&a[d][c]==b||!c&&a[d]===b)return d;d++}return-1}function s(a){return Array.prototype.slice.call(a,0)}function t(a,b,c){for(var d=[],e=[],f=0;f<a.length;){var g=b?a[f][b]:a[f];r(e,g)<0&&d.push(a[f]),e[f]=g,f++}return c&&(d=b?d.sort(function(a,c){return a[b]>c[b]}):d.sort()),d}function u(a,b){for(var c,e,f=b[0].toUpperCase()+b.slice(1),g=0;g<ma.length;){if((e=(c=ma[g])?c+f:b)in a)return e;g++}return d}function w(b){var c=b.ownerDocument||b;return c.defaultView||c.parentWindow||a}function x(a,b){var c=this;this.manager=a,this.callback=b,this.element=a.element,this.target=a.options.inputTarget,this.domHandler=function(b){k(a.options.enable,[a])&&c.handler(b)},this.init()}function z(a,b,c){var d=c.pointers.length,e=c.changedPointers.length,f=b&Ea&&d-e==0,g=b&(Ga|Ha)&&d-e==0;c.isFirst=!!f,c.isFinal=!!g,f&&(a.session={}),c.eventType=b,function(a,b){var c=a.session,d=b.pointers,e=d.length;c.firstInput||(c.firstInput=D(b)),1<e&&!c.firstMultiple?c.firstMultiple=D(b):1===e&&(c.firstMultiple=!1);var f=c.firstInput,g=c.firstMultiple,h=g?g.center:f.center,i=b.center=E(d);b.timeStamp=ra(),b.deltaTime=b.timeStamp-f.timeStamp,b.angle=I(h,i),b.distance=H(h,i),function(a,b){var c=b.center,d=a.offsetDelta||{},e=a.prevDelta||{},f=a.prevInput||{};b.eventType!==Ea&&f.eventType!==Ga||(e=a.prevDelta={x:f.deltaX||0,y:f.deltaY||0},d=a.offsetDelta={x:c.x,y:c.y}),b.deltaX=e.x+(c.x-d.x),b.deltaY=e.y+(c.y-d.y)}(c,b),b.offsetDirection=G(b.deltaX,b.deltaY);var j=F(b.deltaTime,b.deltaX,b.deltaY);b.overallVelocityX=j.x,b.overallVelocityY=j.y,b.overallVelocity=qa(j.x)>qa(j.y)?j.x:j.y,b.scale=g?function(a,b){return H(b[0],b[1],Ra)/H(a[0],a[1],Ra)}(g.pointers,d):1,b.rotation=g?function(a,b){return I(b[1],b[0],Ra)+I(a[1],a[0],Ra)}(g.pointers,d):0,b.maxPointers=c.prevInput?b.pointers.length>c.prevInput.maxPointers?b.pointers.length:c.prevInput.maxPointers:b.pointers.length,C(c,b);var k=a.element;o(b.srcEvent.target,k)&&(k=b.srcEvent.target),b.target=k}(a,c),a.emit("hammer.input",c),a.recognize(c),a.session.prevInput=c}function C(a,b){var c,e,f,g,h=a.lastInterval||b,i=b.timeStamp-h.timeStamp;if(b.eventType!=Ha&&(Da<i||h.velocity===d)){var j=b.deltaX-h.deltaX,k=b.deltaY-h.deltaY,l=F(i,j,k);e=l.x,f=l.y,c=qa(l.x)>qa(l.y)?l.x:l.y,g=G(j,k),a.lastInterval=b}else c=h.velocity,e=h.velocityX,f=h.velocityY,g=h.direction;b.velocity=c,b.velocityX=e,b.velocityY=f,b.direction=g}function D(a){for(var b=[],c=0;c<a.pointers.length;)b[c]={clientX:pa(a.pointers[c].clientX),clientY:pa(a.pointers[c].clientY)},c++;return{timeStamp:ra(),pointers:b,center:E(b),deltaX:a.deltaX,deltaY:a.deltaY}}function E(a){var b=a.length;if(1===b)return{x:pa(a[0].clientX),y:pa(a[0].clientY)};for(var c=0,d=0,e=0;e<b;)c+=a[e].clientX,d+=a[e].clientY,e++;return{x:pa(c/b),y:pa(d/b)}}function F(a,b,c){return{x:b/a||0,y:c/a||0}}function G(a,b){return a===b?Ia:qa(a)>=qa(b)?a<0?Ja:Ka:b<0?La:Ma}function H(a,b,c){c||(c=Qa);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return Math.sqrt(d*d+e*e)}function I(a,b,c){c||(c=Qa);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return 180*Math.atan2(e,d)/Math.PI}function L(){this.evEl=Ta,this.evWin=Ua,this.pressed=!1,x.apply(this,arguments)}function M(){this.evEl=Xa,this.evWin=Ya,x.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function N(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,x.apply(this,arguments)}function P(){this.evTarget=bb,this.targetIds={},x.apply(this,arguments)}function R(){x.apply(this,arguments);var a=j(this.handler,this);this.touch=new P(this.manager,a),this.mouse=new L(this.manager,a),this.primaryTouch=null,this.lastTouches=[]}function T(a){var b=a.changedPointers[0];if(b.identifier===this.primaryTouch){var c={x:b.clientX,y:b.clientY};this.lastTouches.push(c);var d=this.lastTouches;setTimeout(function(){var a=d.indexOf(c);-1<a&&d.splice(a,1)},cb)}}function V(a,b){this.manager=a,this.set(b)}function Y(a){this.options=la({},this.defaults,a||{}),this.id=ua++,this.manager=null,this.options.enable=l(this.options.enable,!0),this.state=nb,this.simultaneous={},this.requireFail=[]}function Z(a){return 16&a?"cancel":8&a?"end":4&a?"move":2&a?"start":""}function $(a){return a==Ma?"down":a==La?"up":a==Ja?"left":a==Ka?"right":""}function _(a,b){var c=b.manager;return c?c.get(a):a}function aa(){Y.apply(this,arguments)}function ba(){aa.apply(this,arguments),this.pX=null,this.pY=null}function ca(){aa.apply(this,arguments)}function da(){Y.apply(this,arguments),this._timer=null,this._input=null}function ea(){aa.apply(this,arguments)}function fa(){aa.apply(this,arguments)}function ga(){Y.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ha(a,b){return(b=b||{}).recognizers=l(b.recognizers,ha.defaults.preset),new ia(a,b)}function ia(a,b){this.options=la({},ha.defaults,b||{}),this.options.inputTarget=this.options.inputTarget||a,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=a,this.input=function(a){var c=a.options.inputClass;return new(c||(xa?M:ya?P:wa?R:L))(a,z)}(this),this.touchAction=new V(this,this.options.touchAction),ja(this,!0),g(this.options.recognizers,function(a){var b=this.add(new a[0](a[1]));a[2]&&b.recognizeWith(a[2]),a[3]&&b.requireFailure(a[3])},this)}function ja(a,b){var d,c=a.element;c.style&&(g(a.options.cssProps,function(e,f){d=u(c.style,f),c.style[d]=b?(a.oldCssProps[d]=c.style[d],e):a.oldCssProps[d]||""}),b||(a.oldCssProps={}))}function ka(a,c){var d=b.createEvent("Event");d.initEvent(a,!0,!0),(d.gesture=c).target.dispatchEvent(d)}var la,ma=["","webkit","Moz","MS","ms","o"],na=b.createElement("div"),oa="function",pa=Math.round,qa=Math.abs,ra=Date.now;la="function"!=typeof Object.assign?function(a){if(a===d||null===a)throw new TypeError("Cannot convert undefined or null to object");for(var b=Object(a),c=1;c<arguments.length;c++){var e=arguments[c];if(e!==d&&null!==e)for(var f in e)e.hasOwnProperty(f)&&(b[f]=e[f])}return b}:Object.assign;var sa=h(function(a,b,c){for(var e=Object.keys(b),f=0;f<e.length;)(!c||c&&a[e[f]]===d)&&(a[e[f]]=b[e[f]]),f++;return a},"extend","Use `assign`."),ta=h(function(a,b){return sa(a,b,!0)},"merge","Use `assign`."),ua=1,wa="ontouchstart"in a,xa=u(a,"PointerEvent")!==d,ya=wa&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),za="touch",Ba="mouse",Da=25,Ea=1,Ga=4,Ha=8,Ia=1,Ja=2,Ka=4,La=8,Ma=16,Na=Ja|Ka,Oa=La|Ma,Pa=Na|Oa,Qa=["x","y"],Ra=["clientX","clientY"];x.prototype={handler:function(){},init:function(){this.evEl&&m(this.element,this.evEl,this.domHandler),this.evTarget&&m(this.target,this.evTarget,this.domHandler),this.evWin&&m(w(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&n(this.element,this.evEl,this.domHandler),this.evTarget&&n(this.target,this.evTarget,this.domHandler),this.evWin&&n(w(this.element),this.evWin,this.domHandler)}};var Sa={mousedown:Ea,mousemove:2,mouseup:Ga},Ta="mousedown",Ua="mousemove mouseup";i(L,x,{handler:function(a){var b=Sa[a.type];b&Ea&&0===a.button&&(this.pressed=!0),2&b&&1!==a.which&&(b=Ga),this.pressed&&(b&Ga&&(this.pressed=!1),this.callback(this.manager,b,{pointers:[a],changedPointers:[a],pointerType:Ba,srcEvent:a}))}});var Va={pointerdown:Ea,pointermove:2,pointerup:Ga,pointercancel:Ha,pointerout:Ha},Wa={2:za,3:"pen",4:Ba,5:"kinect"},Xa="pointerdown",Ya="pointermove pointerup pointercancel";a.MSPointerEvent&&!a.PointerEvent&&(Xa="MSPointerDown",Ya="MSPointerMove MSPointerUp MSPointerCancel"),i(M,x,{handler:function(a){var b=this.store,c=!1,d=a.type.toLowerCase().replace("ms",""),e=Va[d],f=Wa[a.pointerType]||a.pointerType,g=f==za,h=r(b,a.pointerId,"pointerId");e&Ea&&(0===a.button||g)?h<0&&(b.push(a),h=b.length-1):e&(Ga|Ha)&&(c=!0),h<0||(b[h]=a,this.callback(this.manager,e,{pointers:b,changedPointers:[a],pointerType:f,srcEvent:a}),c&&b.splice(h,1))}});var Za={touchstart:Ea,touchmove:2,touchend:Ga,touchcancel:Ha};i(N,x,{handler:function(a){var b=Za[a.type];if(b===Ea&&(this.started=!0),this.started){var c=function(a,b){var c=s(a.touches),d=s(a.changedTouches);return b&(Ga|Ha)&&(c=t(c.concat(d),"identifier",!0)),[c,d]}.call(this,a,b);b&(Ga|Ha)&&c[0].length-c[1].length==0&&(this.started=!1),this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:za,srcEvent:a})}}});var ab={touchstart:Ea,touchmove:2,touchend:Ga,touchcancel:Ha},bb="touchstart touchmove touchend touchcancel";i(P,x,{handler:function(a){var b=ab[a.type],c=function(a,b){var c=s(a.touches),d=this.targetIds;if(b&(2|Ea)&&1===c.length)return d[c[0].identifier]=!0,[c,c];var e,f,g=s(a.changedTouches),h=[],i=this.target;if(f=c.filter(function(a){return o(a.target,i)}),b===Ea)for(e=0;e<f.length;)d[f[e].identifier]=!0,e++;for(e=0;e<g.length;)d[g[e].identifier]&&h.push(g[e]),b&(Ga|Ha)&&delete d[g[e].identifier],e++;return h.length?[t(f.concat(h),"identifier",!0),h]:void 0}.call(this,a,b);c&&this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:za,srcEvent:a})}});var cb=2500;i(R,x,{handler:function(a,b,c){var d=c.pointerType==za,e=c.pointerType==Ba;if(!(e&&c.sourceCapabilities&&c.sourceCapabilities.firesTouchEvents)){if(d)(function(a,b){a&Ea?(this.primaryTouch=b.changedPointers[0].identifier,T.call(this,b)):a&(Ga|Ha)&&T.call(this,b)}).call(this,b,c);else if(e&&function(a){for(var b=a.srcEvent.clientX,c=a.srcEvent.clientY,d=0;d<this.lastTouches.length;d++){var e=this.lastTouches[d],f=Math.abs(b-e.x),g=Math.abs(c-e.y);if(f<=25&&g<=25)return!0}return!1}.call(this,c))return;this.callback(a,b,c)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var eb=u(na.style,"touchAction"),fb=eb!==d,gb="compute",ib="manipulation",jb="none",kb="pan-x",lb="pan-y",mb=function(){if(!fb)return!1;var b={},c=a.CSS&&a.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(d){b[d]=!c||a.CSS.supports("touch-action",d)}),b}();V.prototype={set:function(a){a==gb&&(a=this.compute()),fb&&this.manager.element.style&&mb[a]&&(this.manager.element.style[eb]=a),this.actions=a.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var a=[];return g(this.manager.recognizers,function(b){k(b.options.enable,[b])&&(a=a.concat(b.getTouchAction()))}),function(a){if(p(a,jb))return jb;var b=p(a,kb),c=p(a,lb);return b&&c?jb:b||c?b?kb:lb:p(a,ib)?ib:"auto"}(a.join(" "))},preventDefaults:function(a){var b=a.srcEvent,c=a.offsetDirection;if(!this.manager.session.prevented){var d=this.actions,e=p(d,jb)&&!mb[jb],f=p(d,lb)&&!mb[lb],g=p(d,kb)&&!mb[kb];if(e){var h=1===a.pointers.length,i=a.distance<2,j=a.deltaTime<250;if(h&&i&&j)return}return g&&f?void 0:e||f&&c&Na||g&&c&Oa?this.preventSrc(b):void 0}b.preventDefault()},preventSrc:function(a){this.manager.session.prevented=!0,a.preventDefault()}};var nb=1;Y.prototype={defaults:{},set:function(a){return la(this.options,a),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(a){if(f(a,"recognizeWith",this))return this;var b=this.simultaneous;return b[(a=_(a,this)).id]||(b[a.id]=a).recognizeWith(this),this},dropRecognizeWith:function(a){return f(a,"dropRecognizeWith",this)||(a=_(a,this),delete this.simultaneous[a.id]),this},requireFailure:function(a){if(f(a,"requireFailure",this))return this;var b=this.requireFail;return-1===r(b,a=_(a,this))&&(b.push(a),a.requireFailure(this)),this},dropRequireFailure:function(a){if(f(a,"dropRequireFailure",this))return this;a=_(a,this);var b=r(this.requireFail,a);return-1<b&&this.requireFail.splice(b,1),this},hasRequireFailures:function(){return 0<this.requireFail.length},canRecognizeWith:function(a){return!!this.simultaneous[a.id]},emit:function(a){function b(b){c.manager.emit(b,a)}var c=this,d=this.state;d<8&&b(c.options.event+Z(d)),b(c.options.event),a.additionalEvent&&b(a.additionalEvent),8<=d&&b(c.options.event+Z(d))},tryEmit:function(a){return this.canEmit()?this.emit(a):void(this.state=32)},canEmit:function(){for(var a=0;a<this.requireFail.length;){if(!(this.requireFail[a].state&(32|nb)))return!1;a++}return!0},recognize:function(a){var b=la({},a);return k(this.options.enable,[this,b])?(56&this.state&&(this.state=nb),this.state=this.process(b),void(30&this.state&&this.tryEmit(b))):(this.reset(),void(this.state=32))},process:function(a){},getTouchAction:function(){},reset:function(){}},i(aa,Y,{defaults:{pointers:1},attrTest:function(a){var b=this.options.pointers;return 0===b||a.pointers.length===b},process:function(a){var b=this.state,c=a.eventType,d=6&b,e=this.attrTest(a);return d&&(c&Ha||!e)?16|b:d||e?c&Ga?8|b:2&b?4|b:2:32}}),i(ba,aa,{defaults:{event:"pan",threshold:10,pointers:1,direction:Pa},getTouchAction:function(){var a=this.options.direction,b=[];return a&Na&&b.push(lb),a&Oa&&b.push(kb),b},directionTest:function(a){var b=this.options,c=!0,d=a.distance,e=a.direction,f=a.deltaX,g=a.deltaY;return e&b.direction||(d=b.direction&Na?(e=0===f?Ia:f<0?Ja:Ka,c=f!=this.pX,Math.abs(a.deltaX)):(e=0===g?Ia:g<0?La:Ma,c=g!=this.pY,Math.abs(a.deltaY))),a.direction=e,c&&d>b.threshold&&e&b.direction},attrTest:function(a){return aa.prototype.attrTest.call(this,a)&&(2&this.state||!(2&this.state)&&this.directionTest(a))},emit:function(a){this.pX=a.deltaX,this.pY=a.deltaY;var b=$(a.direction);b&&(a.additionalEvent=this.options.event+b),this._super.emit.call(this,a)}}),i(ca,aa,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[jb]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.scale-1)>this.options.threshold||2&this.state)},emit:function(a){if(1!==a.scale){var b=a.scale<1?"in":"out";a.additionalEvent=this.options.event+b}this._super.emit.call(this,a)}}),i(da,Y,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime>b.time;if(this._input=a,!d||!c||a.eventType&(Ga|Ha)&&!f)this.reset();else if(a.eventType&Ea)this.reset(),this._timer=e(function(){this.state=8,this.tryEmit()},b.time,this);else if(a.eventType&Ga)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(a){8===this.state&&(a&&a.eventType&Ga?this.manager.emit(this.options.event+"up",a):(this._input.timeStamp=ra(),this.manager.emit(this.options.event,this._input)))}}),i(ea,aa,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[jb]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.rotation)>this.options.threshold||2&this.state)}}),i(fa,aa,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Na|Oa,pointers:1},getTouchAction:function(){return ba.prototype.getTouchAction.call(this)},attrTest:function(a){var b,c=this.options.direction;return c&(Na|Oa)?b=a.overallVelocity:c&Na?b=a.overallVelocityX:c&Oa&&(b=a.overallVelocityY),this._super.attrTest.call(this,a)&&c&a.offsetDirection&&a.distance>this.options.threshold&&a.maxPointers==this.options.pointers&&qa(b)>this.options.velocity&&a.eventType&Ga},emit:function(a){var b=$(a.offsetDirection);b&&this.manager.emit(this.options.event+b,a),this.manager.emit(this.options.event,a)}}),i(ga,Y,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[ib]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime<b.time;if(this.reset(),a.eventType&Ea&&0===this.count)return this.failTimeout();if(d&&f&&c){if(a.eventType!=Ga)return this.failTimeout();var g=!this.pTime||a.timeStamp-this.pTime<b.interval,h=!this.pCenter||H(this.pCenter,a.center)<b.posThreshold;if(this.pTime=a.timeStamp,this.pCenter=a.center,h&&g?this.count+=1:this.count=1,this._input=a,0===this.count%b.taps)return this.hasRequireFailures()?(this._timer=e(function(){this.state=8,this.tryEmit()},b.interval,this),2):8}return 32},failTimeout:function(){return this._timer=e(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),ha.VERSION="2.0.7",ha.defaults={domEvents:!1,touchAction:gb,enable:!0,inputTarget:null,inputClass:null,preset:[[ea,{enable:!1}],[ca,{enable:!1},["rotate"]],[fa,{direction:Na}],[ba,{direction:Na},["swipe"]],[ga],[ga,{event:"doubletap",taps:2},["tap"]],[da]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};ia.prototype={set:function(a){return la(this.options,a),a.touchAction&&this.touchAction.update(),a.inputTarget&&(this.input.destroy(),this.input.target=a.inputTarget,this.input.init()),this},stop:function(a){this.session.stopped=a?2:1},recognize:function(a){var b=this.session;if(!b.stopped){this.touchAction.preventDefaults(a);var c,d=this.recognizers,e=b.curRecognizer;(!e||e&&8&e.state)&&(e=b.curRecognizer=null);for(var f=0;f<d.length;)c=d[f],2===b.stopped||e&&c!=e&&!c.canRecognizeWith(e)?c.reset():c.recognize(a),!e&&14&c.state&&(e=b.curRecognizer=c),f++}},get:function(a){if(a instanceof Y)return a;for(var b=this.recognizers,c=0;c<b.length;c++)if(b[c].options.event==a)return b[c];return null},add:function(a){if(f(a,"add",this))return this;var b=this.get(a.options.event);return b&&this.remove(b),this.recognizers.push(a),(a.manager=this).touchAction.update(),a},remove:function(a){if(f(a,"remove",this))return this;if(a=this.get(a)){var b=this.recognizers,c=r(b,a);-1!==c&&(b.splice(c,1),this.touchAction.update())}return this},on:function(a,b){if(a!==d&&b!==d){var c=this.handlers;return g(q(a),function(a){c[a]=c[a]||[],c[a].push(b)}),this}},off:function(a,b){if(a!==d){var c=this.handlers;return g(q(a),function(a){b?c[a]&&c[a].splice(r(c[a],b),1):delete c[a]}),this}},emit:function(a,b){this.options.domEvents&&ka(a,b);var c=this.handlers[a]&&this.handlers[a].slice();if(c&&c.length){b.type=a,b.preventDefault=function(){b.srcEvent.preventDefault()};for(var d=0;d<c.length;)c[d](b),d++}},destroy:function(){this.element&&ja(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},la(ha,{INPUT_START:Ea,INPUT_MOVE:2,INPUT_END:Ga,INPUT_CANCEL:Ha,STATE_POSSIBLE:nb,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:Ia,DIRECTION_LEFT:Ja,DIRECTION_RIGHT:Ka,DIRECTION_UP:La,DIRECTION_DOWN:Ma,DIRECTION_HORIZONTAL:Na,DIRECTION_VERTICAL:Oa,DIRECTION_ALL:Pa,Manager:ia,Input:x,TouchAction:V,TouchInput:P,MouseInput:L,PointerEventInput:M,TouchMouseInput:R,SingleTouchInput:N,Recognizer:Y,AttrRecognizer:aa,Tap:ga,Pan:ba,Swipe:fa,Pinch:ca,Rotate:ea,Press:da,on:m,off:n,each:g,merge:ta,extend:sa,assign:la,inherit:i,bindFn:j,prefixed:u}),(void 0!==a?a:"undefined"!=typeof self?self:{}).Hammer=ha,"function"==typeof define&&define.amd?define("Hammer",[],function(){return ha}):"undefined"!=typeof module&&module.exports?module.exports=ha:a.Hammer=ha}(window,document),define("Core/KnockoutHammerBinding",["KnockoutES5","Hammer"],function(Knockout,Hammer){"use strict";return{register:function(Knockout){Knockout.bindingHandlers.swipeLeft={init:function(element,valueAccessor,allBindings,viewModel,bindingContext){var f=Knockout.unwrap(valueAccessor());new Hammer(element).on("swipeleft",function(e){var viewModel=bindingContext.$data;f.apply(viewModel,arguments)})}},Knockout.bindingHandlers.swipeRight={init:function(element,valueAccessor,allBindings,viewModel,bindingContext){var f=Knockout.unwrap(valueAccessor());new Hammer(element).on("swiperight",function(e){var viewModel=bindingContext.$data;f.apply(viewModel,arguments)})}}}}}),define("Core/registerKnockoutBindings",["Cesium/Widgets/SvgPathBindingHandler","KnockoutES5","Core/KnockoutMarkdownBinding","Core/KnockoutHammerBinding"],function(SvgPathBindingHandler,Knockout,KnockoutMarkdownBinding,KnockoutHammerBinding){"use strict";return function(){SvgPathBindingHandler.register(Knockout),KnockoutMarkdownBinding.register(Knockout),KnockoutHammerBinding.register(Knockout),Knockout.bindingHandlers.embeddedComponent={init:function(element,valueAccessor,allBindings,viewModel,bindingContext){return Knockout.unwrap(valueAccessor()).show(element),{controlsDescendantBindings:!0}},update:function(element,valueAccessor,allBindings,viewModel,bindingContext){}}}}),define("Core/createFragmentFromTemplate",[],function(){"use strict";return function(htmlString){var holder=document.createElement("div");holder.innerHTML=htmlString;for(var fragment=document.createDocumentFragment();holder.firstChild;)fragment.appendChild(holder.firstChild);return fragment}}),define("Core/loadView",["Cesium/Widgets/getElement","KnockoutES5","Core/createFragmentFromTemplate"],function(getElement,Knockout,createFragmentFromTemplate){"use strict";return function(htmlString,container,viewModel){container=getElement(container);var i,fragment=createFragmentFromTemplate(htmlString),nodes=[];for(i=0;i<fragment.childNodes.length;++i)nodes.push(fragment.childNodes[i]);for(container.appendChild(fragment),i=0;i<nodes.length;++i){var node=nodes[i];1!==node.nodeType&&8!==node.nodeType||Knockout.applyBindings(viewModel,node)}return nodes}}),function(t,e,i){var n=t.L,o={version:"0.7.7"};"object"==typeof module&&"object"==typeof module.exports?module.exports=o:"function"==typeof define&&define.amd&&define("leaflet",o),o.noConflict=function(){return t.L=n,this},(t.L=o).Util={extend:function(t){var e,i,n,o,s=Array.prototype.slice.call(arguments,1);for(i=0,n=s.length;i<n;i++)for(e in o=s[i]||{})o.hasOwnProperty(e)&&(t[e]=o[e]);return t},bind:function(t,e){var i=2<arguments.length?Array.prototype.slice.call(arguments,2):null;return function(){return t.apply(e,i||arguments)}},stamp:function(){var t=0,e="_leaflet_id";return function(i){return i[e]=i[e]||++t,i[e]}}(),invokeEach:function(t,e,i){var n,o;if("object"!=typeof t)return!1;for(n in o=Array.prototype.slice.call(arguments,3),t)e.apply(i,[n,t[n]].concat(o));return!0},limitExecByInterval:function(t,e,i){var n,o;return function s(){var a=arguments;return n?void(o=!0):(n=!0,setTimeout(function(){n=!1,o&&(s.apply(i,a),o=!1)},e),void t.apply(i,a))}},falseFn:function(){return!1},formatNum:function(t,e){var i=Math.pow(10,e||5);return Math.round(t*i)/i},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},splitWords:function(t){return o.Util.trim(t).split(/\s+/)},setOptions:function(t,e){return t.options=o.extend({},t.options,e),t.options},getParamString:function(t,e,i){var n=[];for(var o in t)n.push(encodeURIComponent(i?o.toUpperCase():o)+"="+encodeURIComponent(t[o]));return(e&&-1!==e.indexOf("?")?"&":"?")+n.join("&")},template:function(t,e){return t.replace(/\{ *([\w_]+) *\}/g,function(t,n){var o=e[n];if(o===i)throw new Error("No value provided for variable "+t);return"function"==typeof o&&(o=o(e)),o})},isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},function(){function e(e){var i,n,o=["webkit","moz","o","ms"];for(i=0;i<o.length&&!n;i++)n=t[o[i]+e];return n}function i(e){var i=+new Date,o=Math.max(0,16-(i-n));return n=i+o,t.setTimeout(e,o)}var n=0,s=t.requestAnimationFrame||e("RequestAnimationFrame")||i,a=t.cancelAnimationFrame||e("CancelAnimationFrame")||e("CancelRequestAnimationFrame")||function(e){t.clearTimeout(e)};o.Util.requestAnimFrame=function(e,n,a,r){return e=o.bind(e,n),a&&s===i?void e():s.call(t,e,r)},o.Util.cancelAnimFrame=function(e){e&&a.call(t,e)}}(),o.extend=o.Util.extend,o.bind=o.Util.bind,o.stamp=o.Util.stamp,o.setOptions=o.Util.setOptions,o.Class=function(){},o.Class.extend=function(t){var e=function(){this.initialize&&this.initialize.apply(this,arguments),this._initHooks&&this.callInitHooks()},i=function(){};i.prototype=this.prototype;var n=new i;for(var s in(n.constructor=e).prototype=n,this)this.hasOwnProperty(s)&&"prototype"!==s&&(e[s]=this[s]);t.statics&&(o.extend(e,t.statics),delete t.statics),t.includes&&(o.Util.extend.apply(null,[n].concat(t.includes)),delete t.includes),t.options&&n.options&&(t.options=o.extend({},n.options,t.options)),o.extend(n,t),n._initHooks=[];var a=this;return e.__super__=a.prototype,n.callInitHooks=function(){if(!this._initHooksCalled){a.prototype.callInitHooks&&a.prototype.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=n._initHooks.length;t<e;t++)n._initHooks[t].call(this)}},e},o.Class.include=function(t){o.extend(this.prototype,t)},o.Class.mergeOptions=function(t){o.extend(this.prototype.options,t)},o.Class.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),i="function"==typeof t?t:function(){this[t].apply(this,e)};this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(i)};var s="_leaflet_events";o.Mixin={},o.Mixin.Events={addEventListener:function(t,e,i){if(o.Util.invokeEach(t,this.addEventListener,this,e,i))return this;var n,a,r,h,l,u,c,d=this[s]=this[s]||{},p=i&&i!==this&&o.stamp(i);for(n=0,a=(t=o.Util.splitWords(t)).length;n<a;n++)r={action:e,context:i||this},h=t[n],p?(u=(l=h+"_idx")+"_len",(c=d[l]=d[l]||{})[p]||(c[p]=[],d[u]=(d[u]||0)+1),c[p].push(r)):(d[h]=d[h]||[],d[h].push(r));return this},hasEventListeners:function(t){var e=this[s];return!!e&&(t in e&&0<e[t].length||t+"_idx"in e&&0<e[t+"_idx_len"])},removeEventListener:function(t,e,i){if(!this[s])return this;if(!t)return this.clearAllEventListeners();if(o.Util.invokeEach(t,this.removeEventListener,this,e,i))return this;var n,a,r,h,l,u,c,d,_=this[s],m=i&&i!==this&&o.stamp(i);for(n=0,a=(t=o.Util.splitWords(t)).length;n<a;n++)if(c=(u=(r=t[n])+"_idx")+"_len",d=_[u],e){if(h=m&&d?d[m]:_[r]){for(l=h.length-1;0<=l;l--)h[l].action!==e||i&&h[l].context!==i||(h.splice(l,1)[0].action=o.Util.falseFn);i&&d&&0===h.length&&(delete d[m],_[c]--)}}else delete _[r],delete _[u],delete _[c];return this},clearAllEventListeners:function(){return delete this[s],this},fireEvent:function(t,e){if(!this.hasEventListeners(t))return this;var i,n,a,r,h,l=o.Util.extend({},e,{type:t,target:this}),u=this[s];if(u[t])for(n=0,a=(i=u[t].slice()).length;n<a;n++)i[n].action.call(i[n].context,l);for(h in r=u[t+"_idx"])if(i=r[h].slice())for(n=0,a=i.length;n<a;n++)i[n].action.call(i[n].context,l);return this},addOneTimeEventListener:function(t,e,i){if(o.Util.invokeEach(t,this.addOneTimeEventListener,this,e,i))return this;var n=o.bind(function(){this.removeEventListener(t,e,i).removeEventListener(t,n,i)},this);return this.addEventListener(t,e,i).addEventListener(t,n,i)}},o.Mixin.Events.on=o.Mixin.Events.addEventListener,o.Mixin.Events.off=o.Mixin.Events.removeEventListener,o.Mixin.Events.once=o.Mixin.Events.addOneTimeEventListener,o.Mixin.Events.fire=o.Mixin.Events.fireEvent,function(){var n="ActiveXObject"in t,s=n&&!e.addEventListener,a=navigator.userAgent.toLowerCase(),r=-1!==a.indexOf("webkit"),h=-1!==a.indexOf("chrome"),l=-1!==a.indexOf("phantom"),u=-1!==a.indexOf("android"),c=-1!==a.search("android [23]"),d=-1!==a.indexOf("gecko"),p=typeof orientation!=i+"",_=!t.PointerEvent&&t.MSPointerEvent,m=t.PointerEvent&&t.navigator.pointerEnabled||_,f="devicePixelRatio"in t&&1<t.devicePixelRatio||"matchMedia"in t&&t.matchMedia("(min-resolution:144dpi)")&&t.matchMedia("(min-resolution:144dpi)").matches,g=e.documentElement,v=n&&"transition"in g.style,y="WebKitCSSMatrix"in t&&"m11"in new t.WebKitCSSMatrix&&!c,P="MozPerspective"in g.style,L="OTransition"in g.style,x=!t.L_DISABLE_3D&&(v||y||P||L)&&!l,w=!t.L_NO_TOUCH&&!l&&(m||"ontouchstart"in t||t.DocumentTouch&&e instanceof t.DocumentTouch);o.Browser={ie:n,ielt9:s,webkit:r,gecko:d&&!r&&!t.opera&&!n,android:u,android23:c,chrome:h,ie3d:v,webkit3d:y,gecko3d:P,opera3d:L,any3d:x,mobile:p,mobileWebkit:p&&r,mobileWebkit3d:p&&y,mobileOpera:p&&t.opera,touch:w,msPointer:_,pointer:m,retina:f}}(),o.Point=function(t,e,i){this.x=i?Math.round(t):t,this.y=i?Math.round(e):e},o.Point.prototype={clone:function(){return new o.Point(this.x,this.y)},add:function(t){return this.clone()._add(o.point(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(o.point(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},distanceTo:function(t){var e=(t=o.point(t)).x-this.x,i=t.y-this.y;return Math.sqrt(e*e+i*i)},equals:function(t){return(t=o.point(t)).x===this.x&&t.y===this.y},contains:function(t){return t=o.point(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+o.Util.formatNum(this.x)+", "+o.Util.formatNum(this.y)+")"}},o.point=function(t,e,n){return t instanceof o.Point?t:o.Util.isArray(t)?new o.Point(t[0],t[1]):t===i||null===t?t:new o.Point(t,e,n)},o.Bounds=function(t,e){if(t)for(var i=e?[t,e]:t,n=0,o=i.length;n<o;n++)this.extend(i[n])},o.Bounds.prototype={extend:function(t){return t=o.point(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new o.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new o.Point(this.min.x,this.max.y)},getTopRight:function(){return new o.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,i;return(t="number"==typeof t[0]||t instanceof o.Point?o.point(t):o.bounds(t))instanceof o.Bounds?(e=t.min,i=t.max):e=i=t,e.x>=this.min.x&&i.x<=this.max.x&&e.y>=this.min.y&&i.y<=this.max.y},intersects:function(t){t=o.bounds(t);var e=this.min,i=this.max,n=t.min,s=t.max,a=s.x>=e.x&&n.x<=i.x,r=s.y>=e.y&&n.y<=i.y;return a&&r},isValid:function(){return!(!this.min||!this.max)}},o.bounds=function(t,e){return!t||t instanceof o.Bounds?t:new o.Bounds(t,e)},o.Transformation=function(t,e,i,n){this._a=t,this._b=e,this._c=i,this._d=n},o.Transformation.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new o.Point((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}},o.DomUtil={get:function(t){return"string"==typeof t?e.getElementById(t):t},getStyle:function(t,i){var n=t.style[i];if(!n&&t.currentStyle&&(n=t.currentStyle[i]),(!n||"auto"===n)&&e.defaultView){var o=e.defaultView.getComputedStyle(t,null);n=o?o[i]:null}return"auto"===n?null:n},getViewportOffset:function(t){var i,n=0,s=0,a=t,r=e.body,h=e.documentElement;do{if(n+=a.offsetTop||0,s+=a.offsetLeft||0,n+=parseInt(o.DomUtil.getStyle(a,"borderTopWidth"),10)||0,s+=parseInt(o.DomUtil.getStyle(a,"borderLeftWidth"),10)||0,i=o.DomUtil.getStyle(a,"position"),a.offsetParent===r&&"absolute"===i)break;if("fixed"===i){n+=r.scrollTop||h.scrollTop||0,s+=r.scrollLeft||h.scrollLeft||0;break}if("relative"===i&&!a.offsetLeft){var l=o.DomUtil.getStyle(a,"width"),u=o.DomUtil.getStyle(a,"max-width"),c=a.getBoundingClientRect();("none"!==l||"none"!==u)&&(s+=c.left+a.clientLeft),n+=c.top+(r.scrollTop||h.scrollTop||0);break}a=a.offsetParent}while(a);a=t;do{if(a===r)break;n-=a.scrollTop||0,s-=a.scrollLeft||0,a=a.parentNode}while(a);return new o.Point(s,n)},documentIsLtr:function(){return o.DomUtil._docIsLtrCached||(o.DomUtil._docIsLtrCached=!0,o.DomUtil._docIsLtr="ltr"===o.DomUtil.getStyle(e.body,"direction")),o.DomUtil._docIsLtr},create:function(t,i,n){var o=e.createElement(t);return o.className=i,n&&n.appendChild(o),o},hasClass:function(t,e){if(t.classList!==i)return t.classList.contains(e);var n=o.DomUtil._getClass(t);return 0<n.length&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(n)},addClass:function(t,e){if(t.classList!==i)for(var n=o.Util.splitWords(e),s=0,a=n.length;s<a;s++)t.classList.add(n[s]);else if(!o.DomUtil.hasClass(t,e)){var r=o.DomUtil._getClass(t);o.DomUtil._setClass(t,(r?r+" ":"")+e)}},removeClass:function(t,e){t.classList!==i?t.classList.remove(e):o.DomUtil._setClass(t,o.Util.trim((" "+o.DomUtil._getClass(t)+" ").replace(" "+e+" "," ")))},_setClass:function(t,e){t.className.baseVal===i?t.className=e:t.className.baseVal=e},_getClass:function(t){return t.className.baseVal===i?t.className:t.className.baseVal},setOpacity:function(t,e){if("opacity"in t.style)t.style.opacity=e;else if("filter"in t.style){var i=!1,n="DXImageTransform.Microsoft.Alpha";try{i=t.filters.item(n)}catch(o){if(1===e)return}e=Math.round(100*e),i?(i.Enabled=100!==e,i.Opacity=e):t.style.filter+=" progid:"+n+"(opacity="+e+")"}},testProp:function(t){for(var i=e.documentElement.style,n=0;n<t.length;n++)if(t[n]in i)return t[n];return!1},getTranslateString:function(t){var e=o.Browser.webkit3d,n=(e?",0":"")+")";return"translate"+(e?"3d":"")+"("+t.x+"px,"+t.y+"px"+n},getScaleString:function(t,e){return o.DomUtil.getTranslateString(e.add(e.multiplyBy(-1*t)))+(" scale("+t+") ")},setPosition:function(t,e,i){t._leaflet_pos=e,!i&&o.Browser.any3d?t.style[o.DomUtil.TRANSFORM]=o.DomUtil.getTranslateString(e):(t.style.left=e.x+"px",t.style.top=e.y+"px")},getPosition:function(t){return t._leaflet_pos}},o.DomUtil.TRANSFORM=o.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]),o.DomUtil.TRANSITION=o.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),o.DomUtil.TRANSITION_END="webkitTransition"===o.DomUtil.TRANSITION||"OTransition"===o.DomUtil.TRANSITION?o.DomUtil.TRANSITION+"End":"transitionend",function(){if("onselectstart"in e)o.extend(o.DomUtil,{disableTextSelection:function(){o.DomEvent.on(t,"selectstart",o.DomEvent.preventDefault)},enableTextSelection:function(){o.DomEvent.off(t,"selectstart",o.DomEvent.preventDefault)}});else{var i=o.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);o.extend(o.DomUtil,{disableTextSelection:function(){if(i){var t=e.documentElement.style;this._userSelect=t[i],t[i]="none"}},enableTextSelection:function(){i&&(e.documentElement.style[i]=this._userSelect,delete this._userSelect)}})}o.extend(o.DomUtil,{disableImageDrag:function(){o.DomEvent.on(t,"dragstart",o.DomEvent.preventDefault)},enableImageDrag:function(){o.DomEvent.off(t,"dragstart",o.DomEvent.preventDefault)}})}(),o.LatLng=function(t,e,n){if(t=parseFloat(t),e=parseFloat(e),isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=t,this.lng=e,n!==i&&(this.alt=parseFloat(n))},o.extend(o.LatLng,{DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MAX_MARGIN:1e-9}),o.LatLng.prototype={equals:function(t){return!!t&&(t=o.latLng(t),Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng))<=o.LatLng.MAX_MARGIN)},toString:function(t){return"LatLng("+o.Util.formatNum(this.lat,t)+", "+o.Util.formatNum(this.lng,t)+")"},distanceTo:function(t){t=o.latLng(t);var i=o.LatLng.DEG_TO_RAD,n=(t.lat-this.lat)*i,s=(t.lng-this.lng)*i,a=this.lat*i,r=t.lat*i,h=Math.sin(n/2),l=Math.sin(s/2),u=h*h+l*l*Math.cos(a)*Math.cos(r);return 12756274*Math.atan2(Math.sqrt(u),Math.sqrt(1-u))},wrap:function(t,e){var i=this.lng;return i=(i+(e=e||180))%(e-(t=t||-180))+(i<t||i===e?e:t),new o.LatLng(this.lat,i)}},o.latLng=function(t,e){return t instanceof o.LatLng?t:o.Util.isArray(t)?"number"==typeof t[0]||"string"==typeof t[0]?new o.LatLng(t[0],t[1],t[2]):null:t===i||null===t?t:"object"==typeof t&&"lat"in t?new o.LatLng(t.lat,"lng"in t?t.lng:t.lon):e===i?null:new o.LatLng(t,e)},o.LatLngBounds=function(t,e){if(t)for(var i=e?[t,e]:t,n=0,o=i.length;n<o;n++)this.extend(i[n])},o.LatLngBounds.prototype={extend:function(t){if(!t)return this;var e=o.latLng(t);return(t=null!==e?e:o.latLngBounds(t))instanceof o.LatLng?this._southWest||this._northEast?(this._southWest.lat=Math.min(t.lat,this._southWest.lat),this._southWest.lng=Math.min(t.lng,this._southWest.lng),this._northEast.lat=Math.max(t.lat,this._northEast.lat),this._northEast.lng=Math.max(t.lng,this._northEast.lng)):(this._southWest=new o.LatLng(t.lat,t.lng),this._northEast=new o.LatLng(t.lat,t.lng)):t instanceof o.LatLngBounds&&(this.extend(t._southWest),this.extend(t._northEast)),this},pad:function(t){var e=this._southWest,i=this._northEast,n=Math.abs(e.lat-i.lat)*t,s=Math.abs(e.lng-i.lng)*t;return new o.LatLngBounds(new o.LatLng(e.lat-n,e.lng-s),new o.LatLng(i.lat+n,i.lng+s))},getCenter:function(){return new o.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new o.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new o.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof o.LatLng?o.latLng(t):o.latLngBounds(t);var e,i,n=this._southWest,s=this._northEast;return t instanceof o.LatLngBounds?(e=t.getSouthWest(),i=t.getNorthEast()):e=i=t,e.lat>=n.lat&&i.lat<=s.lat&&e.lng>=n.lng&&i.lng<=s.lng},intersects:function(t){t=o.latLngBounds(t);var e=this._southWest,i=this._northEast,n=t.getSouthWest(),s=t.getNorthEast(),a=s.lat>=e.lat&&n.lat<=i.lat,r=s.lng>=e.lng&&n.lng<=i.lng;return a&&r},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t){return!!t&&(t=o.latLngBounds(t),this._southWest.equals(t.getSouthWest())&&this._northEast.equals(t.getNorthEast()))},isValid:function(){return!(!this._southWest||!this._northEast)}},o.latLngBounds=function(t,e){return!t||t instanceof o.LatLngBounds?t:new o.LatLngBounds(t,e)},o.Projection={},o.Projection.SphericalMercator={MAX_LATITUDE:85.0511287798,project:function(t){var e=o.LatLng.DEG_TO_RAD,i=this.MAX_LATITUDE,n=Math.max(Math.min(i,t.lat),-i),s=t.lng*e,a=n*e;return a=Math.log(Math.tan(Math.PI/4+a/2)),new o.Point(s,a)},unproject:function(t){var e=o.LatLng.RAD_TO_DEG,i=t.x*e,n=(2*Math.atan(Math.exp(t.y))-Math.PI/2)*e;return new o.LatLng(n,i)}},o.Projection.LonLat={project:function(t){return new o.Point(t.lng,t.lat)},unproject:function(t){return new o.LatLng(t.y,t.x)}},o.CRS={latLngToPoint:function(t,e){var i=this.projection.project(t),n=this.scale(e);return this.transformation._transform(i,n)},pointToLatLng:function(t,e){var i=this.scale(e),n=this.transformation.untransform(t,i);return this.projection.unproject(n)},project:function(t){return this.projection.project(t)},scale:function(t){return 256*Math.pow(2,t)},getSize:function(t){var e=this.scale(t);return o.point(e,e)}},o.CRS.Simple=o.extend({},o.CRS,{projection:o.Projection.LonLat,transformation:new o.Transformation(1,0,-1,0),scale:function(t){return Math.pow(2,t)}}),o.CRS.EPSG3857=o.extend({},o.CRS,{code:"EPSG:3857",projection:o.Projection.SphericalMercator,transformation:new o.Transformation(.5/Math.PI,.5,-.5/Math.PI,.5),project:function(t){return this.projection.project(t).multiplyBy(6378137)}}),o.CRS.EPSG900913=o.extend({},o.CRS.EPSG3857,{code:"EPSG:900913"}),o.CRS.EPSG4326=o.extend({},o.CRS,{code:"EPSG:4326",projection:o.Projection.LonLat,transformation:new o.Transformation(1/360,.5,-1/360,.5)}),o.Map=o.Class.extend({includes:o.Mixin.Events,options:{crs:o.CRS.EPSG3857,fadeAnimation:o.DomUtil.TRANSITION&&!o.Browser.android23,trackResize:!0,markerZoomAnimation:o.DomUtil.TRANSITION&&o.Browser.any3d},initialize:function(t,e){e=o.setOptions(this,e),this._initContainer(t),this._initLayout(),this._onResize=o.bind(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),e.center&&e.zoom!==i&&this.setView(o.latLng(e.center),e.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._tileLayersNum=0,this.callInitHooks(),this._addLayers(e.layers)},setView:function(t,e){return e=e===i?this.getZoom():e,this._resetView(o.latLng(t),this._limitZoom(e)),this},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=this._limitZoom(t),this)},zoomIn:function(t,e){return this.setZoom(this._zoom+(t||1),e)},zoomOut:function(t,e){return this.setZoom(this._zoom-(t||1),e)},setZoomAround:function(t,e,i){var n=this.getZoomScale(e),s=this.getSize().divideBy(2),r=(t instanceof o.Point?t:this.latLngToContainerPoint(t)).subtract(s).multiplyBy(1-1/n),h=this.containerPointToLatLng(s.add(r));return this.setView(h,e,{zoom:i})},fitBounds:function(t,e){e=e||{},t=t.getBounds?t.getBounds():o.latLngBounds(t);var i=o.point(e.paddingTopLeft||e.padding||[0,0]),n=o.point(e.paddingBottomRight||e.padding||[0,0]),s=this.getBoundsZoom(t,!1,i.add(n));s=e.maxZoom?Math.min(e.maxZoom,s):s;var a=n.subtract(i).divideBy(2),r=this.project(t.getSouthWest(),s),h=this.project(t.getNorthEast(),s),l=this.unproject(r.add(h).divideBy(2).add(a),s);return this.setView(l,s,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t){return this.fire("movestart"),this._rawPanBy(o.point(t)),this.fire("move"),this.fire("moveend")},setMaxBounds:function(t){return t=o.latLngBounds(t),(this.options.maxBounds=t)?(this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds,this)):this.off("moveend",this._panInsideMaxBounds,this)},panInsideBounds:function(t,e){var i=this.getCenter(),n=this._limitCenter(i,this._zoom,t);return i.equals(n)?this:this.panTo(n,e)},addLayer:function(t){var e=o.stamp(t);return this._layers[e]||(!(this._layers[e]=t).options||isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[e]=t,this._updateZoomLevels()),this.options.zoomAnimation&&o.TileLayer&&t instanceof o.TileLayer&&(this._tileLayersNum++,this._tileLayersToLoad++,t.on("load",this._onTileLayerLoad,this)),this._loaded&&this._layerAdd(t)),this},removeLayer:function(t){var e=o.stamp(t);return this._layers[e]&&(this._loaded&&t.onRemove(this),delete this._layers[e],this._loaded&&this.fire("layerremove",{layer:t}),this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels()),this.options.zoomAnimation&&o.TileLayer&&t instanceof o.TileLayer&&(this._tileLayersNum--,this._tileLayersToLoad--,t.off("load",this._onTileLayerLoad,this))),this},hasLayer:function(t){return!!t&&o.stamp(t)in this._layers},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},invalidateSize:function(t){if(!this._loaded)return this;t=o.extend({animate:!1,pan:!0},!0===t?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._initialCenter=null;var i=this.getSize(),n=e.divideBy(2).round(),s=i.divideBy(2).round(),a=n.subtract(s);return a.x||a.y?(t.animate&&t.pan?this.panBy(a):(t.pan&&this._rawPanBy(a),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o.bind(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:i})):this},addHandler:function(t,e){if(!e)return this;var i=this[t]=new e(this);return this._handlers.push(i),this.options[t]&&i.enable(),this},remove:function(){this._loaded&&this.fire("unload"),this._initEvents("off");try{delete this._container._leaflet}catch(t){this._container._leaflet=i}return this._clearPanes(),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this},getCenter:function(){return this._checkIfLoaded(),this._initialCenter&&!this._moved()?this._initialCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),e=this.unproject(t.getBottomLeft()),i=this.unproject(t.getTopRight());return new o.LatLngBounds(e,i)},getMinZoom:function(){return this.options.minZoom===i?this._layersMinZoom===i?0:this._layersMinZoom:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===i?this._layersMaxZoom===i?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,i){t=o.latLngBounds(t);var n,s=this.getMinZoom()-(e?1:0),a=this.getMaxZoom(),r=this.getSize(),h=t.getNorthWest(),l=t.getSouthEast(),u=!0;for(i=o.point(i||[0,0]);s++,n=this.project(l,s).subtract(this.project(h,s)).add(i),(u=e?n.x<r.x||n.y<r.y:r.contains(n))&&s<=a;);return u&&e?null:e?s:s-1},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new o.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(){var t=this._getTopLeftPoint();return new o.Bounds(t,t.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._initialTopLeftPoint},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t){var e=this.options.crs;return e.scale(t)/e.scale(this._zoom)},getScaleZoom:function(t){return this._zoom+Math.log(t)/Math.LN2},project:function(t,e){return e=e===i?this._zoom:e,this.options.crs.latLngToPoint(o.latLng(t),e)},unproject:function(t,e){return e=e===i?this._zoom:e,this.options.crs.pointToLatLng(o.point(t),e)},layerPointToLatLng:function(t){var e=o.point(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){return this.project(o.latLng(t))._round()._subtract(this.getPixelOrigin())},containerPointToLayerPoint:function(t){return o.point(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return o.point(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(o.point(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(o.latLng(t)))},mouseEventToContainerPoint:function(t){return o.DomEvent.getMousePosition(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=o.DomUtil.get(t);if(!e)throw new Error("Map container not found.");if(e._leaflet)throw new Error("Map container is already initialized.");e._leaflet=!0},_initLayout:function(){var t=this._container;o.DomUtil.addClass(t,"leaflet-container"+(o.Browser.touch?" leaflet-touch":"")+(o.Browser.retina?" leaflet-retina":"")+(o.Browser.ielt9?" leaflet-oldie":"")+(this.options.fadeAnimation?" leaflet-fade-anim":""));var e=o.DomUtil.getStyle(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._mapPane=t.mapPane=this._createPane("leaflet-map-pane",this._container),this._tilePane=t.tilePane=this._createPane("leaflet-tile-pane",this._mapPane),t.objectsPane=this._createPane("leaflet-objects-pane",this._mapPane),t.shadowPane=this._createPane("leaflet-shadow-pane"),t.overlayPane=this._createPane("leaflet-overlay-pane"),t.markerPane=this._createPane("leaflet-marker-pane"),t.popupPane=this._createPane("leaflet-popup-pane");var e=" leaflet-zoom-hide";this.options.markerZoomAnimation||(o.DomUtil.addClass(t.markerPane,e),o.DomUtil.addClass(t.shadowPane,e),o.DomUtil.addClass(t.popupPane,e))},_createPane:function(t,e){return o.DomUtil.create("div",t,e||this._panes.objectsPane)},_clearPanes:function(){this._container.removeChild(this._mapPane)},_addLayers:function(t){for(var e=0,i=(t=t?o.Util.isArray(t)?t:[t]:[]).length;e<i;e++)this.addLayer(t[e])},_resetView:function(t,e,i,n){var s=this._zoom!==e;n||(this.fire("movestart"),s&&this.fire("zoomstart")),this._zoom=e,this._initialCenter=t,this._initialTopLeftPoint=this._getNewTopLeftPoint(t),i?this._initialTopLeftPoint._add(this._getMapPanePos()):o.DomUtil.setPosition(this._mapPane,new o.Point(0,0)),this._tileLayersToLoad=this._tileLayersNum;var a=!this._loaded;this._loaded=!0,this.fire("viewreset",{hard:!i}),a&&(this.fire("load"),this.eachLayer(this._layerAdd,this)),this.fire("move"),(s||n)&&this.fire("zoomend"),this.fire("moveend",{hard:!i})},_rawPanBy:function(t){o.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_updateZoomLevels:function(){var t,e=1/0,n=-1/0,o=this._getZoomSpan();for(t in this._zoomBoundLayers){var s=this._zoomBoundLayers[t];isNaN(s.options.minZoom)||(e=Math.min(e,s.options.minZoom)),isNaN(s.options.maxZoom)||(n=Math.max(n,s.options.maxZoom))}t===i?this._layersMaxZoom=this._layersMinZoom=i:(this._layersMaxZoom=n,this._layersMinZoom=e),o!==this._getZoomSpan()&&this.fire("zoomlevelschange")},_panInsideMaxBounds:function(){this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(e){if(o.DomEvent){e=e||"on",o.DomEvent[e](this._container,"click",this._onMouseClick,this);var i,n,s=["dblclick","mousedown","mouseup","mouseenter","mouseleave","mousemove","contextmenu"];for(i=0,n=s.length;i<n;i++)o.DomEvent[e](this._container,s[i],this._fireMouseEvent,this);this.options.trackResize&&o.DomEvent[e](t,"resize",this._onResize,this)}},_onResize:function(){o.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=o.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this,!1,this._container)},_onMouseClick:function(t){!this._loaded||!t._simulated&&(this.dragging&&this.dragging.moved()||this.boxZoom&&this.boxZoom.moved())||o.DomEvent._skipped(t)||(this.fire("preclick"),this._fireMouseEvent(t))},_fireMouseEvent:function(t){if(this._loaded&&!o.DomEvent._skipped(t)){var e=t.type;if(e="mouseenter"===e?"mouseover":"mouseleave"===e?"mouseout":e,this.hasEventListeners(e)){"contextmenu"===e&&o.DomEvent.preventDefault(t);var i=this.mouseEventToContainerPoint(t),n=this.containerPointToLayerPoint(i),s=this.layerPointToLatLng(n);this.fire(e,{latlng:s,layerPoint:n,containerPoint:i,originalEvent:t})}}},_onTileLayerLoad:function(){this._tileLayersToLoad--,this._tileLayersNum&&!this._tileLayersToLoad&&this.fire("tilelayersload")},_clearHandlers:function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,this):this.on("load",t,e),this},_layerAdd:function(t){t.onAdd(this),this.fire("layeradd",{layer:t})},_getMapPanePos:function(){return o.DomUtil.getPosition(this._mapPane)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(){return this.getPixelOrigin().subtract(this._getMapPanePos())},_getNewTopLeftPoint:function(t,e){var i=this.getSize()._divideBy(2);return this.project(t,e)._subtract(i)._round()},_latLngToNewLayerPoint:function(t,e,i){var n=this._getNewTopLeftPoint(i,e).add(this._getMapPanePos());return this.project(t,e)._subtract(n)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,i){if(!i)return t;var n=this.project(t,e),s=this.getSize().divideBy(2),a=new o.Bounds(n.subtract(s),n.add(s)),r=this._getBoundsOffset(a,i,e);return this.unproject(n.add(r),e)},_limitOffset:function(t,e){if(!e)return t;var i=this.getPixelBounds(),n=new o.Bounds(i.min.add(t),i.max.add(t));return t.add(this._getBoundsOffset(n,e))},_getBoundsOffset:function(t,e,i){var n=this.project(e.getNorthWest(),i).subtract(t.min),s=this.project(e.getSouthEast(),i).subtract(t.max),a=this._rebound(n.x,-s.x),r=this._rebound(n.y,-s.y);return new o.Point(a,r)},_rebound:function(t,e){return 0<t+e?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),i=this.getMaxZoom();return Math.max(e,Math.min(i,t))}}),o.map=function(t,e){return new o.Map(t,e)},o.Projection.Mercator={MAX_LATITUDE:85.0840591556,R_MINOR:6356752.314245179,R_MAJOR:6378137,project:function(t){var e=o.LatLng.DEG_TO_RAD,i=this.MAX_LATITUDE,n=Math.max(Math.min(i,t.lat),-i),s=this.R_MAJOR,a=this.R_MINOR,r=t.lng*e*s,h=n*e,l=a/s,u=Math.sqrt(1-l*l),c=u*Math.sin(h);c=Math.pow((1-c)/(1+c),.5*u);var d=Math.tan(.5*(.5*Math.PI-h))/c;return h=-s*Math.log(d),new o.Point(r,h)},unproject:function(t){for(var e,i=o.LatLng.RAD_TO_DEG,n=this.R_MAJOR,s=this.R_MINOR,a=t.x*i/n,r=s/n,h=Math.sqrt(1-r*r),l=Math.exp(-t.y/n),u=Math.PI/2-2*Math.atan(l),p=15,_=.1;1e-7<Math.abs(_)&&0<--p;)e=h*Math.sin(u),u+=_=Math.PI/2-2*Math.atan(l*Math.pow((1-e)/(1+e),.5*h))-u;return new o.LatLng(u*i,a)}},o.CRS.EPSG3395=o.extend({},o.CRS,{code:"EPSG:3395",projection:o.Projection.Mercator,transformation:function(){var e=o.Projection.Mercator.R_MAJOR,i=.5/(Math.PI*e);return new o.Transformation(i,.5,-i,.5)}()}),o.TileLayer=o.Class.extend({includes:o.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",zoomOffset:0,opacity:1,unloadInvisibleTiles:o.Browser.mobile,updateWhenIdle:o.Browser.mobile},initialize:function(t,e){(e=o.setOptions(this,e)).detectRetina&&o.Browser.retina&&0<e.maxZoom&&(e.tileSize=Math.floor(e.tileSize/2),e.zoomOffset++,0<e.minZoom&&e.minZoom--,this.options.maxZoom--),e.bounds&&(e.bounds=o.latLngBounds(e.bounds)),this._url=t;var i=this.options.subdomains;"string"==typeof i&&(this.options.subdomains=i.split(""))},onAdd:function(t){this._map=t,this._animated=t._zoomAnimated,this._initContainer(),t.on({viewreset:this._reset,moveend:this._update},this),this._animated&&t.on({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this),this.options.updateWhenIdle||(this._limitedUpdate=o.Util.limitExecByInterval(this._update,150,this),t.on("move",this._limitedUpdate,this)),this._reset(),this._update()},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){this._container.parentNode.removeChild(this._container),t.off({viewreset:this._reset,moveend:this._update},this),this._animated&&t.off({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this),this.options.updateWhenIdle||t.off("move",this._limitedUpdate,this),this._container=null,this._map=null},bringToFront:function(){var t=this._map._panes.tilePane;return this._container&&(t.appendChild(this._container),this._setAutoZIndex(t,Math.max)),this},bringToBack:function(){var t=this._map._panes.tilePane;return this._container&&(t.insertBefore(this._container,t.firstChild),this._setAutoZIndex(t,Math.min)),this},getAttribution:function(){return this.options.attribution},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},setUrl:function(t,e){return this._url=t,e||this.redraw(),this},redraw:function(){return this._map&&(this._reset({hard:!0}),this._update()),this},_updateZIndex:function(){this._container&&this.options.zIndex!==i&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t,e){var i,n,o,s=t.children,a=-e(1/0,-1/0);for(n=0,o=s.length;n<o;n++)s[n]!==this._container&&(i=parseInt(s[n].style.zIndex,10),isNaN(i)||(a=e(a,i)));this.options.zIndex=this._container.style.zIndex=(isFinite(a)?a:0)+e(1,-1)},_updateOpacity:function(){var t,e=this._tiles;if(o.Browser.ielt9)for(t in e)o.DomUtil.setOpacity(e[t],this.options.opacity);else o.DomUtil.setOpacity(this._container,this.options.opacity)},_initContainer:function(){var t=this._map._panes.tilePane;if(!this._container){if(this._container=o.DomUtil.create("div","leaflet-layer"),this._updateZIndex(),this._animated){var e="leaflet-tile-container";this._bgBuffer=o.DomUtil.create("div",e,this._container),this._tileContainer=o.DomUtil.create("div",e,this._container)}else this._tileContainer=this._container;t.appendChild(this._container),this.options.opacity<1&&this._updateOpacity()}},_reset:function(t){for(var e in this._tiles)this.fire("tileunload",{tile:this._tiles[e]});this._tiles={},this._tilesToLoad=0,this.options.reuseTiles&&(this._unusedTiles=[]),this._tileContainer.innerHTML="",this._animated&&t&&t.hard&&this._clearBgBuffer(),this._initContainer()},_getTileSize:function(){var t=this._map,e=t.getZoom()+this.options.zoomOffset,i=this.options.maxNativeZoom,n=this.options.tileSize;return i&&i<e&&(n=Math.round(t.getZoomScale(e)/t.getZoomScale(i)*n)),n},_update:function(){if(this._map){var t=this._map,e=t.getPixelBounds(),i=t.getZoom(),n=this._getTileSize();if(!(i>this.options.maxZoom||i<this.options.minZoom)){var s=o.bounds(e.min.divideBy(n)._floor(),e.max.divideBy(n)._floor());this._addTilesFromCenterOut(s),(this.options.unloadInvisibleTiles||this.options.reuseTiles)&&this._removeOtherTiles(s)}}},_addTilesFromCenterOut:function(t){var i,n,s,a=[],r=t.getCenter();for(i=t.min.y;i<=t.max.y;i++)for(n=t.min.x;n<=t.max.x;n++)s=new o.Point(n,i),this._tileShouldBeLoaded(s)&&a.push(s);var h=a.length;if(0!==h){a.sort(function(t,e){return t.distanceTo(r)-e.distanceTo(r)});var l=e.createDocumentFragment();for(this._tilesToLoad||this.fire("loading"),this._tilesToLoad+=h,n=0;n<h;n++)this._addTile(a[n],l);this._tileContainer.appendChild(l)}},_tileShouldBeLoaded:function(t){if(t.x+":"+t.y in this._tiles)return!1;var e=this.options;if(!e.continuousWorld){var i=this._getWrapTileNum();if(e.noWrap&&(t.x<0||t.x>=i.x)||t.y<0||t.y>=i.y)return!1}if(e.bounds){var n=this._getTileSize(),o=t.multiplyBy(n),s=o.add([n,n]),a=this._map.unproject(o),r=this._map.unproject(s);if(e.continuousWorld||e.noWrap||(a=a.wrap(),r=r.wrap()),!e.bounds.intersects([a,r]))return!1}return!0},_removeOtherTiles:function(t){var e,i,n,o;for(o in this._tiles)e=o.split(":"),i=parseInt(e[0],10),n=parseInt(e[1],10),(i<t.min.x||i>t.max.x||n<t.min.y||n>t.max.y)&&this._removeTile(o)},_removeTile:function(t){var e=this._tiles[t];this.fire("tileunload",{tile:e,url:e.src}),this.options.reuseTiles?(o.DomUtil.removeClass(e,"leaflet-tile-loaded"),this._unusedTiles.push(e)):e.parentNode===this._tileContainer&&this._tileContainer.removeChild(e),o.Browser.android||(e.onload=null,e.src=o.Util.emptyImageUrl),delete this._tiles[t]},_addTile:function(t,e){var i=this._getTilePos(t),n=this._getTile();o.DomUtil.setPosition(n,i,o.Browser.chrome),this._tiles[t.x+":"+t.y]=n,this._loadTile(n,t),n.parentNode!==this._tileContainer&&e.appendChild(n)},_getZoomForUrl:function(){var t=this.options,e=this._map.getZoom();return t.zoomReverse&&(e=t.maxZoom-e),e+=t.zoomOffset,t.maxNativeZoom?Math.min(e,t.maxNativeZoom):e},_getTilePos:function(t){var e=this._map.getPixelOrigin(),i=this._getTileSize();return t.multiplyBy(i).subtract(e)},getTileUrl:function(t){return o.Util.template(this._url,o.extend({s:this._getSubdomain(t),z:t.z,x:t.x,y:t.y},this.options))},_getWrapTileNum:function(){return this._map.options.crs.getSize(this._map.getZoom()).divideBy(this._getTileSize())._floor()},_adjustTilePoint:function(t){var e=this._getWrapTileNum();this.options.continuousWorld||this.options.noWrap||(t.x=(t.x%e.x+e.x)%e.x),this.options.tms&&(t.y=e.y-t.y-1),t.z=this._getZoomForUrl()},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_getTile:function(){if(this.options.reuseTiles&&0<this._unusedTiles.length){var t=this._unusedTiles.pop();return this._resetTile(t),t}return this._createTile()},_resetTile:function(){},_createTile:function(){var t=o.DomUtil.create("img","leaflet-tile");return t.style.width=t.style.height=this._getTileSize()+"px",t.galleryimg="no",t.onselectstart=t.onmousemove=o.Util.falseFn,o.Browser.ielt9&&this.options.opacity!==i&&o.DomUtil.setOpacity(t,this.options.opacity),o.Browser.mobileWebkit3d&&(t.style.WebkitBackfaceVisibility="hidden"),t},_loadTile:function(t,e){t._layer=this,t.onload=this._tileOnLoad,t.onerror=this._tileOnError,this._adjustTilePoint(e),t.src=this.getTileUrl(e),this.fire("tileloadstart",{tile:t,url:t.src})},_tileLoaded:function(){this._tilesToLoad--,this._animated&&o.DomUtil.addClass(this._tileContainer,"leaflet-zoom-animated"),this._tilesToLoad||(this.fire("load"),this._animated&&(clearTimeout(this._clearBgBufferTimer),this._clearBgBufferTimer=setTimeout(o.bind(this._clearBgBuffer,this),500)))},_tileOnLoad:function(){var t=this._layer;this.src!==o.Util.emptyImageUrl&&(o.DomUtil.addClass(this,"leaflet-tile-loaded"),t.fire("tileload",{tile:this,url:this.src})),t._tileLoaded()},_tileOnError:function(){var t=this._layer;t.fire("tileerror",{tile:this,url:this.src});var e=t.options.errorTileUrl;e&&(this.src=e),t._tileLoaded()}}),o.tileLayer=function(t,e){return new o.TileLayer(t,e)},o.TileLayer.WMS=o.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},initialize:function(t,e){this._url=t;var i=o.extend({},this.defaultWmsParams),n=e.tileSize||this.options.tileSize;for(var s in e.detectRetina&&o.Browser.retina?i.width=i.height=2*n:i.width=i.height=n,e)this.options.hasOwnProperty(s)||"crs"===s||(i[s]=e[s]);this.wmsParams=i,o.setOptions(this,e)},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=1.3<=this._wmsVersion?"crs":"srs";this.wmsParams[e]=this._crs.code,o.TileLayer.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._map,i=this.options.tileSize,n=t.multiplyBy(i),s=n.add([i,i]),a=this._crs.project(e.unproject(n,t.z)),r=this._crs.project(e.unproject(s,t.z)),h=1.3<=this._wmsVersion&&this._crs===o.CRS.EPSG4326?[r.y,a.x,a.y,r.x].join(","):[a.x,r.y,r.x,a.y].join(","),l=o.Util.template(this._url,{s:this._getSubdomain(t)});return l+o.Util.getParamString(this.wmsParams,l,!0)+"&BBOX="+h},setParams:function(t,e){return o.extend(this.wmsParams,t),e||this.redraw(),this}}),o.tileLayer.wms=function(t,e){return new o.TileLayer.WMS(t,e)},o.TileLayer.Canvas=o.TileLayer.extend({options:{async:!1},initialize:function(t){o.setOptions(this,t)},redraw:function(){for(var t in this._map&&(this._reset({hard:!0}),this._update()),this._tiles)this._redrawTile(this._tiles[t]);return this},_redrawTile:function(t){this.drawTile(t,t._tilePoint,this._map._zoom)},_createTile:function(){var t=o.DomUtil.create("canvas","leaflet-tile");return t.width=t.height=this.options.tileSize,t.onselectstart=t.onmousemove=o.Util.falseFn,t},_loadTile:function(t,e){t._layer=this,t._tilePoint=e,this._redrawTile(t),this.options.async||this.tileDrawn(t)},drawTile:function(){},tileDrawn:function(t){this._tileOnLoad.call(t)}}),o.tileLayer.canvas=function(t){return new o.TileLayer.Canvas(t)},o.ImageOverlay=o.Class.extend({includes:o.Mixin.Events,options:{opacity:1},initialize:function(t,e,i){this._url=t,this._bounds=o.latLngBounds(e),o.setOptions(this,i)},onAdd:function(t){this._map=t,this._image||this._initImage(),t._panes.overlayPane.appendChild(this._image),t.on("viewreset",this._reset,this),t.options.zoomAnimation&&o.Browser.any3d&&t.on("zoomanim",this._animateZoom,this),this._reset()},onRemove:function(t){t.getPanes().overlayPane.removeChild(this._image),t.off("viewreset",this._reset,this),t.options.zoomAnimation&&t.off("zoomanim",this._animateZoom,this)},addTo:function(t){return t.addLayer(this),this},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},bringToFront:function(){return this._image&&this._map._panes.overlayPane.appendChild(this._image),this},bringToBack:function(){var t=this._map._panes.overlayPane;return this._image&&t.insertBefore(this._image,t.firstChild),this},setUrl:function(t){this._url=t,this._image.src=this._url},getAttribution:function(){return this.options.attribution},_initImage:function(){this._image=o.DomUtil.create("img","leaflet-image-layer"),this._map.options.zoomAnimation&&o.Browser.any3d?o.DomUtil.addClass(this._image,"leaflet-zoom-animated"):o.DomUtil.addClass(this._image,"leaflet-zoom-hide"),this._updateOpacity(),o.extend(this._image,{galleryimg:"no",onselectstart:o.Util.falseFn,onmousemove:o.Util.falseFn,onload:o.bind(this._onImageLoad,this),src:this._url})},_animateZoom:function(t){var e=this._map,i=this._image,n=e.getZoomScale(t.zoom),s=this._bounds.getNorthWest(),a=this._bounds.getSouthEast(),r=e._latLngToNewLayerPoint(s,t.zoom,t.center),h=e._latLngToNewLayerPoint(a,t.zoom,t.center)._subtract(r),l=r._add(h._multiplyBy(.5*(1-1/n)));i.style[o.DomUtil.TRANSFORM]=o.DomUtil.getTranslateString(l)+" scale("+n+") "},_reset:function(){var t=this._image,e=this._map.latLngToLayerPoint(this._bounds.getNorthWest()),i=this._map.latLngToLayerPoint(this._bounds.getSouthEast())._subtract(e);o.DomUtil.setPosition(t,e),t.style.width=i.x+"px",t.style.height=i.y+"px"},_onImageLoad:function(){this.fire("load")},_updateOpacity:function(){o.DomUtil.setOpacity(this._image,this.options.opacity)}}),o.imageOverlay=function(t,e,i){return new o.ImageOverlay(t,e,i)},o.Icon=o.Class.extend({options:{className:""},initialize:function(t){o.setOptions(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var n,i=this._getIconUrl(t);if(i)return n=e&&"IMG"===e.tagName?this._createImg(i,e):this._createImg(i),this._setIconStyles(n,t),n;if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null},_setIconStyles:function(t,e){var i,n=this.options,s=o.point(n[e+"Size"]);!(i="shadow"===e?o.point(n.shadowAnchor||n.iconAnchor):o.point(n.iconAnchor))&&s&&(i=s.divideBy(2,!0)),t.className="leaflet-marker-"+e+" "+n.className,i&&(t.style.marginLeft=-i.x+"px",t.style.marginTop=-i.y+"px"),s&&(t.style.width=s.x+"px",t.style.height=s.y+"px")},_createImg:function(t,i){return(i=i||e.createElement("img")).src=t,i},_getIconUrl:function(t){return o.Browser.retina&&this.options[t+"RetinaUrl"]?this.options[t+"RetinaUrl"]:this.options[t+"Url"]}}),o.icon=function(t){return new o.Icon(t)},o.Icon.Default=o.Icon.extend({options:{iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]},_getIconUrl:function(t){var e=t+"Url";if(this.options[e])return this.options[e];o.Browser.retina&&"icon"===t&&(t+="-2x");var i=o.Icon.Default.imagePath;if(!i)throw new Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.");return i+"/marker-"+t+".png"}}),o.Icon.Default.imagePath=function(){var t,i,n,s,a=e.getElementsByTagName("script"),r=/[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/;for(t=0,i=a.length;t<i;t++)if((n=a[t].src).match(r))return((s=n.split(r)[0])?s+"/":"")+"images"}(),o.Marker=o.Class.extend({includes:o.Mixin.Events,options:{icon:new o.Icon.Default,title:"",alt:"",clickable:!0,draggable:!1,keyboard:!0,zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250},initialize:function(t,e){o.setOptions(this,e),this._latlng=o.latLng(t)},onAdd:function(t){(this._map=t).on("viewreset",this.update,this),this._initIcon(),this.update(),this.fire("add"),t.options.zoomAnimation&&t.options.markerZoomAnimation&&t.on("zoomanim",this._animateZoom,this)},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){this.dragging&&this.dragging.disable(),this._removeIcon(),this._removeShadow(),this.fire("remove"),t.off({viewreset:this.update,zoomanim:this._animateZoom},this),this._map=null},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=o.latLng(t),this.update(),this.fire("move",{latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update(),this},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup),this},update:function(){return this._icon&&this._setPos(this._map.latLngToLayerPoint(this._latlng).round()),this},_initIcon:function(){var t=this.options,e=this._map,n=e.options.zoomAnimation&&e.options.markerZoomAnimation?"leaflet-zoom-animated":"leaflet-zoom-hide",s=t.icon.createIcon(this._icon),a=!1;s!==this._icon&&(this._icon&&this._removeIcon(),a=!0,t.title&&(s.title=t.title),t.alt&&(s.alt=t.alt)),o.DomUtil.addClass(s,n),t.keyboard&&(s.tabIndex="0"),this._icon=s,this._initInteraction(),t.riseOnHover&&o.DomEvent.on(s,"mouseover",this._bringToFront,this).on(s,"mouseout",this._resetZIndex,this);var r=t.icon.createShadow(this._shadow),h=!1;r!==this._shadow&&(this._removeShadow(),h=!0),r&&o.DomUtil.addClass(r,n),this._shadow=r,t.opacity<1&&this._updateOpacity();var l=this._map._panes;a&&l.markerPane.appendChild(this._icon),r&&h&&l.shadowPane.appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&o.DomEvent.off(this._icon,"mouseover",this._bringToFront).off(this._icon,"mouseout",this._resetZIndex),this._map._panes.markerPane.removeChild(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&this._map._panes.shadowPane.removeChild(this._shadow),this._shadow=null},_setPos:function(t){o.DomUtil.setPosition(this._icon,t),this._shadow&&o.DomUtil.setPosition(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon.style.zIndex=this._zIndex+t},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.clickable){var t=this._icon,e=["dblclick","mousedown","mouseover","mouseout","contextmenu"];o.DomUtil.addClass(t,"leaflet-clickable"),o.DomEvent.on(t,"click",this._onMouseClick,this),o.DomEvent.on(t,"keypress",this._onKeyPress,this);for(var i=0;i<e.length;i++)o.DomEvent.on(t,e[i],this._fireMouseEvent,this);o.Handler.MarkerDrag&&(this.dragging=new o.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_onMouseClick:function(t){var e=this.dragging&&this.dragging.moved();(this.hasEventListeners(t.type)||e)&&o.DomEvent.stopPropagation(t),e||(this.dragging&&this.dragging._enabled||!this._map.dragging||!this._map.dragging.moved())&&this.fire(t.type,{originalEvent:t,latlng:this._latlng})},_onKeyPress:function(t){13===t.keyCode&&this.fire("click",{originalEvent:t,latlng:this._latlng})},_fireMouseEvent:function(t){this.fire(t.type,{originalEvent:t,latlng:this._latlng}),"contextmenu"===t.type&&this.hasEventListeners(t.type)&&o.DomEvent.preventDefault(t),"mousedown"!==t.type?o.DomEvent.stopPropagation(t):o.DomEvent.preventDefault(t)},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){o.DomUtil.setOpacity(this._icon,this.options.opacity),this._shadow&&o.DomUtil.setOpacity(this._shadow,this.options.opacity)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)}}),o.marker=function(t,e){return new o.Marker(t,e)},o.DivIcon=o.Icon.extend({options:{iconSize:[12,12],className:"leaflet-div-icon",html:!1},createIcon:function(t){var i=t&&"DIV"===t.tagName?t:e.createElement("div"),n=this.options;return!1!==n.html?i.innerHTML=n.html:i.innerHTML="",n.bgPos&&(i.style.backgroundPosition=-n.bgPos.x+"px "+-n.bgPos.y+"px"),this._setIconStyles(i,"icon"),i},createShadow:function(){return null}}),o.divIcon=function(t){return new o.DivIcon(t)},o.Map.mergeOptions({closePopupOnClick:!0}),o.Popup=o.Class.extend({includes:o.Mixin.Events,options:{minWidth:50,maxWidth:300,autoPan:!0,closeButton:!0,offset:[0,7],autoPanPadding:[5,5],keepInView:!1,className:"",zoomAnimation:!0},initialize:function(t,e){o.setOptions(this,t),this._source=e,this._animated=o.Browser.any3d&&this.options.zoomAnimation,this._isOpen=!1},onAdd:function(t){this._map=t,this._container||this._initLayout();var e=t.options.fadeAnimation;e&&o.DomUtil.setOpacity(this._container,0),t._panes.popupPane.appendChild(this._container),t.on(this._getEvents(),this),this.update(),e&&o.DomUtil.setOpacity(this._container,1),this.fire("open"),t.fire("popupopen",{popup:this}),this._source&&this._source.fire("popupopen",{popup:this})},addTo:function(t){return t.addLayer(this),this},openOn:function(t){return t.openPopup(this),this},onRemove:function(t){t._panes.popupPane.removeChild(this._container),o.Util.falseFn(this._container.offsetWidth),t.off(this._getEvents(),this),t.options.fadeAnimation&&o.DomUtil.setOpacity(this._container,0),this._map=null,this.fire("close"),t.fire("popupclose",{popup:this}),this._source&&this._source.fire("popupclose",{popup:this})},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=o.latLng(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},_getEvents:function(){var t={viewreset:this._updatePosition};return this._animated&&(t.zoomanim=this._zoomAnimation),("closeOnClick"in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t,e="leaflet-popup",i=e+" "+this.options.className+" leaflet-zoom-"+(this._animated?"animated":"hide"),n=this._container=o.DomUtil.create("div",i);this.options.closeButton&&((t=this._closeButton=o.DomUtil.create("a",e+"-close-button",n)).href="#close",t.innerHTML="&#215;",o.DomEvent.disableClickPropagation(t),o.DomEvent.on(t,"click",this._onCloseButtonClick,this));var s=this._wrapper=o.DomUtil.create("div",e+"-content-wrapper",n);o.DomEvent.disableClickPropagation(s),this._contentNode=o.DomUtil.create("div",e+"-content",s),o.DomEvent.disableScrollPropagation(this._contentNode),o.DomEvent.on(s,"contextmenu",o.DomEvent.stopPropagation),this._tipContainer=o.DomUtil.create("div",e+"-tip-container",n),this._tip=o.DomUtil.create("div",e+"-tip",this._tipContainer)},_updateContent:function(){if(this._content){if("string"==typeof this._content)this._contentNode.innerHTML=this._content;else{for(;this._contentNode.hasChildNodes();)this._contentNode.removeChild(this._contentNode.firstChild);this._contentNode.appendChild(this._content)}this.fire("contentupdate")}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var i=t.offsetWidth;i=Math.min(i,this.options.maxWidth),i=Math.max(i,this.options.minWidth),e.width=i+1+"px",e.whiteSpace="",e.height="";var n=t.offsetHeight,s=this.options.maxHeight,a="leaflet-popup-scrolled";s&&s<n?(e.height=s+"px",o.DomUtil.addClass(t,a)):o.DomUtil.removeClass(t,a),this._containerWidth=this._container.offsetWidth},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=this._animated,i=o.point(this.options.offset);e&&o.DomUtil.setPosition(this._container,t),this._containerBottom=-i.y-(e?0:t.y),this._containerLeft=-Math.round(this._containerWidth/2)+i.x+(e?0:t.x),this._container.style.bottom=this._containerBottom+"px",this._container.style.left=this._containerLeft+"px"}},_zoomAnimation:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);o.DomUtil.setPosition(this._container,e)},_adjustPan:function(){if(this.options.autoPan){var t=this._map,e=this._container.offsetHeight,i=this._containerWidth,n=new o.Point(this._containerLeft,-e-this._containerBottom);this._animated&&n._add(o.DomUtil.getPosition(this._container));var s=t.layerPointToContainerPoint(n),a=o.point(this.options.autoPanPadding),r=o.point(this.options.autoPanPaddingTopLeft||a),h=o.point(this.options.autoPanPaddingBottomRight||a),l=t.getSize(),u=0,c=0;s.x+i+h.x>l.x&&(u=s.x+i-l.x+h.x),s.x-u-r.x<0&&(u=s.x-r.x),s.y+e+h.y>l.y&&(c=s.y+e-l.y+h.y),s.y-c-r.y<0&&(c=s.y-r.y),(u||c)&&t.fire("autopanstart").panBy([u,c])}},_onCloseButtonClick:function(t){this._close(),o.DomEvent.stop(t)}}),o.popup=function(t,e){return new o.Popup(t,e)},o.Map.include({openPopup:function(t,e,i){if(this.closePopup(),!(t instanceof o.Popup)){var n=t;t=new o.Popup(i).setLatLng(e).setContent(n)}return t._isOpen=!0,this._popup=t,this.addLayer(t)},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&(this.removeLayer(t),t._isOpen=!1),this}}),o.Marker.include({openPopup:function(){return this._popup&&this._map&&!this._map.hasLayer(this._popup)&&(this._popup.setLatLng(this._latlng),this._map.openPopup(this._popup)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(){return this._popup&&(this._popup._isOpen?this.closePopup():this.openPopup()),this},bindPopup:function(t,e){var i=o.point(this.options.icon.options.popupAnchor||[0,0]);return i=i.add(o.Popup.prototype.options.offset),e&&e.offset&&(i=i.add(e.offset)),e=o.extend({offset:i},e),this._popupHandlersAdded||(this.on("click",this.togglePopup,this).on("remove",this.closePopup,this).on("move",this._movePopup,this),this._popupHandlersAdded=!0),t instanceof o.Popup?(o.setOptions(t,e),(this._popup=t)._source=this):this._popup=new o.Popup(e,this).setContent(t),this},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this.togglePopup,this).off("remove",this.closePopup,this).off("move",this._movePopup,this),this._popupHandlersAdded=!1),this},getPopup:function(){return this._popup},_movePopup:function(t){this._popup.setLatLng(t.latlng)}}),o.LayerGroup=o.Class.extend({initialize:function(t){var e,i;if(this._layers={},t)for(e=0,i=t.length;e<i;e++)this.addLayer(t[e])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return!!t&&(t in this._layers||this.getLayerId(t)in this._layers)},clearLayers:function(){return this.eachLayer(this.removeLayer,this),this},invoke:function(t){var e,i,n=Array.prototype.slice.call(arguments,1);for(e in this._layers)(i=this._layers[e])[t]&&i[t].apply(i,n);return this},onAdd:function(t){this._map=t,this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t),this._map=null},addTo:function(t){return t.addLayer(this),this},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];for(var e in this._layers)t.push(this._layers[e]);return t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return o.stamp(t)}}),o.layerGroup=function(t){return new o.LayerGroup(t)},o.FeatureGroup=o.LayerGroup.extend({includes:o.Mixin.Events,statics:{EVENTS:"click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose"},addLayer:function(t){return this.hasLayer(t)?this:("on"in t&&t.on(o.FeatureGroup.EVENTS,this._propagateEvent,this),o.LayerGroup.prototype.addLayer.call(this,t),this._popupContent&&t.bindPopup&&t.bindPopup(this._popupContent,this._popupOptions),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),"off"in t&&t.off(o.FeatureGroup.EVENTS,this._propagateEvent,this),o.LayerGroup.prototype.removeLayer.call(this,t),this._popupContent&&this.invoke("unbindPopup"),this.fire("layerremove",{layer:t})):this},bindPopup:function(t,e){return this._popupContent=t,this._popupOptions=e,this.invoke("bindPopup",t,e)},openPopup:function(t){for(var e in this._layers){this._layers[e].openPopup(t);break}return this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new o.LatLngBounds;return this.eachLayer(function(e){t.extend(e instanceof o.Marker?e.getLatLng():e.getBounds())}),t},_propagateEvent:function(t){t=o.extend({layer:t.target,target:this},t),this.fire(t.type,t)}}),o.featureGroup=function(t){return new o.FeatureGroup(t)},o.Path=o.Class.extend({includes:[o.Mixin.Events],statics:{CLIP_PADDING:function(){var i=((o.Browser.mobile?1280:2e3)/Math.max(t.outerWidth,t.outerHeight)-1)/2;return Math.max(0,Math.min(.5,i))}()},options:{stroke:!0,color:"#0033ff",dashArray:null,lineCap:null,lineJoin:null,weight:5,opacity:.5,fill:!1,fillColor:null,fillOpacity:.2,clickable:!0},initialize:function(t){o.setOptions(this,t)},onAdd:function(t){this._map=t,this._container||(this._initElements(),this._initEvents()),this.projectLatlngs(),this._updatePath(),this._container&&this._map._pathRoot.appendChild(this._container),this.fire("add"),t.on({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){t._pathRoot.removeChild(this._container),this.fire("remove"),this._map=null,o.Browser.vml&&(this._container=null,this._stroke=null,this._fill=null),t.off({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},projectLatlngs:function(){},setStyle:function(t){return o.setOptions(this,t),this._container&&this._updateStyle(),this},redraw:function(){return this._map&&(this.projectLatlngs(),this._updatePath()),this}}),o.Map.include({_updatePathViewport:function(){var t=o.Path.CLIP_PADDING,e=this.getSize(),n=o.DomUtil.getPosition(this._mapPane).multiplyBy(-1)._subtract(e.multiplyBy(t)._round()),s=n.add(e.multiplyBy(1+2*t)._round());this._pathViewport=new o.Bounds(n,s)}}),o.Path.SVG_NS="http://www.w3.org/2000/svg",o.Browser.svg=!(!e.createElementNS||!e.createElementNS(o.Path.SVG_NS,"svg").createSVGRect),o.Path=o.Path.extend({statics:{SVG:o.Browser.svg},bringToFront:function(){var t=this._map._pathRoot,e=this._container;return e&&t.lastChild!==e&&t.appendChild(e),this},bringToBack:function(){var t=this._map._pathRoot,e=this._container,i=t.firstChild;return e&&i!==e&&t.insertBefore(e,i),this},getPathString:function(){},_createElement:function(t){return e.createElementNS(o.Path.SVG_NS,t)},_initElements:function(){this._map._initPathRoot(),this._initPath(),this._initStyle()},_initPath:function(){this._container=this._createElement("g"),this._path=this._createElement("path"),this.options.className&&o.DomUtil.addClass(this._path,this.options.className),this._container.appendChild(this._path)},_initStyle:function(){this.options.stroke&&(this._path.setAttribute("stroke-linejoin","round"),this._path.setAttribute("stroke-linecap","round")),this.options.fill&&this._path.setAttribute("fill-rule","evenodd"),this.options.pointerEvents&&this._path.setAttribute("pointer-events",this.options.pointerEvents),this.options.clickable||this.options.pointerEvents||this._path.setAttribute("pointer-events","none"),this._updateStyle()},_updateStyle:function(){this.options.stroke?(this._path.setAttribute("stroke",this.options.color),this._path.setAttribute("stroke-opacity",this.options.opacity),this._path.setAttribute("stroke-width",this.options.weight),this.options.dashArray?this._path.setAttribute("stroke-dasharray",this.options.dashArray):this._path.removeAttribute("stroke-dasharray"),this.options.lineCap&&this._path.setAttribute("stroke-linecap",this.options.lineCap),this.options.lineJoin&&this._path.setAttribute("stroke-linejoin",this.options.lineJoin)):this._path.setAttribute("stroke","none"),this.options.fill?(this._path.setAttribute("fill",this.options.fillColor||this.options.color),this._path.setAttribute("fill-opacity",this.options.fillOpacity)):this._path.setAttribute("fill","none")},_updatePath:function(){var t=this.getPathString();t||(t="M0 0"),this._path.setAttribute("d",t)},_initEvents:function(){if(this.options.clickable){(o.Browser.svg||!o.Browser.vml)&&o.DomUtil.addClass(this._path,"leaflet-clickable"),o.DomEvent.on(this._container,"click",this._onMouseClick,this);for(var t=["dblclick","mousedown","mouseover","mouseout","mousemove","contextmenu"],e=0;e<t.length;e++)o.DomEvent.on(this._container,t[e],this._fireMouseEvent,this)}},_onMouseClick:function(t){this._map.dragging&&this._map.dragging.moved()||this._fireMouseEvent(t)},_fireMouseEvent:function(t){if(this._map&&this.hasEventListeners(t.type)){var e=this._map,i=e.mouseEventToContainerPoint(t),n=e.containerPointToLayerPoint(i),s=e.layerPointToLatLng(n);this.fire(t.type,{latlng:s,layerPoint:n,containerPoint:i,originalEvent:t}),"contextmenu"===t.type&&o.DomEvent.preventDefault(t),"mousemove"!==t.type&&o.DomEvent.stopPropagation(t)}}}),o.Map.include({_initPathRoot:function(){this._pathRoot||(this._pathRoot=o.Path.prototype._createElement("svg"),this._panes.overlayPane.appendChild(this._pathRoot),this.options.zoomAnimation&&o.Browser.any3d?(o.DomUtil.addClass(this._pathRoot,"leaflet-zoom-animated"),this.on({zoomanim:this._animatePathZoom,zoomend:this._endPathZoom})):o.DomUtil.addClass(this._pathRoot,"leaflet-zoom-hide"),this.on("moveend",this._updateSvgViewport),this._updateSvgViewport())},_animatePathZoom:function(t){var e=this.getZoomScale(t.zoom),i=this._getCenterOffset(t.center)._multiplyBy(-e)._add(this._pathViewport.min);this._pathRoot.style[o.DomUtil.TRANSFORM]=o.DomUtil.getTranslateString(i)+" scale("+e+") ",this._pathZooming=!0},_endPathZoom:function(){this._pathZooming=!1},_updateSvgViewport:function(){if(!this._pathZooming){this._updatePathViewport();var t=this._pathViewport,e=t.min,i=t.max,n=i.x-e.x,s=i.y-e.y,a=this._pathRoot,r=this._panes.overlayPane;o.Browser.mobileWebkit&&r.removeChild(a),o.DomUtil.setPosition(a,e),a.setAttribute("width",n),a.setAttribute("height",s),a.setAttribute("viewBox",[e.x,e.y,n,s].join(" ")),o.Browser.mobileWebkit&&r.appendChild(a)}}}),o.Path.include({bindPopup:function(t,e){return t instanceof o.Popup?this._popup=t:((!this._popup||e)&&(this._popup=new o.Popup(e,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on("click",this._openPopup,this).on("remove",this.closePopup,this),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this._openPopup).off("remove",this.closePopup),this._popupHandlersAdded=!1),this},openPopup:function(t){return this._popup&&(t=t||this._latlng||this._latlngs[Math.floor(this._latlngs.length/2)],this._openPopup({latlng:t})),this},closePopup:function(){return this._popup&&this._popup._close(),this},_openPopup:function(t){this._popup.setLatLng(t.latlng),this._map.openPopup(this._popup)}}),o.Browser.vml=!o.Browser.svg&&function(){try{var t=e.createElement("div");t.innerHTML='<v:shape adj="1"/>';var i=t.firstChild;return i.style.behavior="url(#default#VML)",i&&"object"==typeof i.adj}catch(n){return!1}}(),o.Path=o.Browser.svg||!o.Browser.vml?o.Path:o.Path.extend({statics:{VML:!0,CLIP_PADDING:.02},_createElement:function(){try{return e.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return e.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return e.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),_initPath:function(){var t=this._container=this._createElement("shape");o.DomUtil.addClass(t,"leaflet-vml-shape"+(this.options.className?" "+this.options.className:"")),this.options.clickable&&o.DomUtil.addClass(t,"leaflet-clickable"),t.coordsize="1 1",this._path=this._createElement("path"),t.appendChild(this._path),this._map._pathRoot.appendChild(t)},_initStyle:function(){this._updateStyle()},_updateStyle:function(){var t=this._stroke,e=this._fill,i=this.options,n=this._container;n.stroked=i.stroke,n.filled=i.fill,i.stroke?(t||((t=this._stroke=this._createElement("stroke")).endcap="round",n.appendChild(t)),t.weight=i.weight+"px",t.color=i.color,t.opacity=i.opacity,i.dashArray?t.dashStyle=o.Util.isArray(i.dashArray)?i.dashArray.join(" "):i.dashArray.replace(/( *, *)/g," "):t.dashStyle="",i.lineCap&&(t.endcap=i.lineCap.replace("butt","flat")),i.lineJoin&&(t.joinstyle=i.lineJoin)):t&&(n.removeChild(t),this._stroke=null),i.fill?(e||(e=this._fill=this._createElement("fill"),n.appendChild(e)),e.color=i.fillColor||i.color,e.opacity=i.fillOpacity):e&&(n.removeChild(e),this._fill=null)},_updatePath:function(){var t=this._container.style;t.display="none",this._path.v=this.getPathString()+" ",t.display=""}}),o.Map.include(o.Browser.svg||!o.Browser.vml?{}:{_initPathRoot:function(){if(!this._pathRoot){var t=this._pathRoot=e.createElement("div");t.className="leaflet-vml-container",this._panes.overlayPane.appendChild(t),this.on("moveend",this._updatePathViewport),this._updatePathViewport()}}}),o.Browser.canvas=!!e.createElement("canvas").getContext,o.Path=o.Path.SVG&&!t.L_PREFER_CANVAS||!o.Browser.canvas?o.Path:o.Path.extend({statics:{CANVAS:!0,SVG:!1},redraw:function(){return this._map&&(this.projectLatlngs(),this._requestUpdate()),this},setStyle:function(t){return o.setOptions(this,t),this._map&&(this._updateStyle(),this._requestUpdate()),this},onRemove:function(t){t.off("viewreset",this.projectLatlngs,this).off("moveend",this._updatePath,this),this.options.clickable&&(this._map.off("click",this._onClick,this),this._map.off("mousemove",this._onMouseMove,this)),this._requestUpdate(),this.fire("remove"),this._map=null},_requestUpdate:function(){this._map&&!o.Path._updateRequest&&(o.Path._updateRequest=o.Util.requestAnimFrame(this._fireMapMoveEnd,this._map))},_fireMapMoveEnd:function(){o.Path._updateRequest=null,this.fire("moveend")},_initElements:function(){this._map._initPathRoot(),this._ctx=this._map._canvasCtx},_updateStyle:function(){var t=this.options;t.stroke&&(this._ctx.lineWidth=t.weight,this._ctx.strokeStyle=t.color),t.fill&&(this._ctx.fillStyle=t.fillColor||t.color),t.lineCap&&(this._ctx.lineCap=t.lineCap),t.lineJoin&&(this._ctx.lineJoin=t.lineJoin)},_drawPath:function(){var t,e,i,n,s,a;for(this._ctx.beginPath(),t=0,i=this._parts.length;t<i;t++){for(e=0,n=this._parts[t].length;e<n;e++)s=this._parts[t][e],a=(0===e?"move":"line")+"To",this._ctx[a](s.x,s.y);this instanceof o.Polygon&&this._ctx.closePath()}},_checkIfEmpty:function(){return!this._parts.length},_updatePath:function(){if(!this._checkIfEmpty()){var t=this._ctx,e=this.options;this._drawPath(),t.save(),this._updateStyle(),e.fill&&(t.globalAlpha=e.fillOpacity,t.fill(e.fillRule||"evenodd")),e.stroke&&(t.globalAlpha=e.opacity,t.stroke()),t.restore()}},_initEvents:function(){this.options.clickable&&(this._map.on("mousemove",this._onMouseMove,this),this._map.on("click dblclick contextmenu",this._fireMouseEvent,this))},_fireMouseEvent:function(t){this._containsPoint(t.layerPoint)&&this.fire(t.type,t)},_onMouseMove:function(t){this._map&&!this._map._animatingZoom&&(this._containsPoint(t.layerPoint)?(this._ctx.canvas.style.cursor="pointer",this._mouseInside=!0,this.fire("mouseover",t)):this._mouseInside&&(this._ctx.canvas.style.cursor="",this._mouseInside=!1,this.fire("mouseout",t)))}}),o.Map.include(o.Path.SVG&&!t.L_PREFER_CANVAS||!o.Browser.canvas?{}:{_initPathRoot:function(){var t,i=this._pathRoot;i||((i=this._pathRoot=e.createElement("canvas")).style.position="absolute",(t=this._canvasCtx=i.getContext("2d")).lineCap="round",t.lineJoin="round",this._panes.overlayPane.appendChild(i),this.options.zoomAnimation&&(this._pathRoot.className="leaflet-zoom-animated",this.on("zoomanim",this._animatePathZoom),this.on("zoomend",this._endPathZoom)),this.on("moveend",this._updateCanvasViewport),this._updateCanvasViewport())},_updateCanvasViewport:function(){if(!this._pathZooming){this._updatePathViewport();var t=this._pathViewport,e=t.min,i=t.max.subtract(e),n=this._pathRoot;o.DomUtil.setPosition(n,e),n.width=i.x,n.height=i.y,n.getContext("2d").translate(-e.x,-e.y)}}}),o.LineUtil={simplify:function(t,e){if(!e||!t.length)return t.slice();var i=e*e;return t=this._reducePoints(t,i),this._simplifyDP(t,i)},pointToSegmentDistance:function(t,e,i){return Math.sqrt(this._sqClosestPointOnSegment(t,e,i,!0))},closestPointOnSegment:function(t,e,i){return this._sqClosestPointOnSegment(t,e,i)},_simplifyDP:function(t,e){var n=t.length,s=new(typeof Uint8Array!=i+""?Uint8Array:Array)(n);s[0]=s[n-1]=1,this._simplifyDPStep(t,s,e,0,n-1);var a,r=[];for(a=0;a<n;a++)s[a]&&r.push(t[a]);return r},_simplifyDPStep:function(t,e,i,n,o){var s,a,r,h=0;for(a=n+1;a<=o-1;a++)h<(r=this._sqClosestPointOnSegment(t[a],t[n],t[o],!0))&&(s=a,h=r);i<h&&(e[s]=1,this._simplifyDPStep(t,e,i,n,s),this._simplifyDPStep(t,e,i,s,o))},_reducePoints:function(t,e){for(var i=[t[0]],n=1,o=0,s=t.length;n<s;n++)this._sqDist(t[n],t[o])>e&&(i.push(t[n]),o=n);return o<s-1&&i.push(t[s-1]),i},clipSegment:function(t,e,i,n){var o,s,a,r=n?this._lastCode:this._getBitCode(t,i),h=this._getBitCode(e,i);for(this._lastCode=h;;){if(!(r|h))return[t,e];if(r&h)return!1;o=r||h,s=this._getEdgeIntersection(t,e,o,i),a=this._getBitCode(s,i),o===r?(t=s,r=a):(e=s,h=a)}},_getEdgeIntersection:function(t,e,i,n){var s=e.x-t.x,a=e.y-t.y,r=n.min,h=n.max;return 8&i?new o.Point(t.x+s*(h.y-t.y)/a,h.y):4&i?new o.Point(t.x+s*(r.y-t.y)/a,r.y):2&i?new o.Point(h.x,t.y+a*(h.x-t.x)/s):1&i?new o.Point(r.x,t.y+a*(r.x-t.x)/s):void 0},_getBitCode:function(t,e){var i=0;return t.x<e.min.x?i|=1:t.x>e.max.x&&(i|=2),t.y<e.min.y?i|=4:t.y>e.max.y&&(i|=8),i},_sqDist:function(t,e){var i=e.x-t.x,n=e.y-t.y;return i*i+n*n},_sqClosestPointOnSegment:function(t,e,i,n){var s,a=e.x,r=e.y,h=i.x-a,l=i.y-r,u=h*h+l*l;return 0<u&&(1<(s=((t.x-a)*h+(t.y-r)*l)/u)?(a=i.x,r=i.y):0<s&&(a+=h*s,r+=l*s)),h=t.x-a,l=t.y-r,n?h*h+l*l:new o.Point(a,r)}},o.Polyline=o.Path.extend({initialize:function(t,e){o.Path.prototype.initialize.call(this,e),this._latlngs=this._convertLatLngs(t)},options:{smoothFactor:1,noClip:!1},projectLatlngs:function(){this._originalPoints=[];for(var t=0,e=this._latlngs.length;t<e;t++)this._originalPoints[t]=this._map.latLngToLayerPoint(this._latlngs[t])},getPathString:function(){for(var t=0,e=this._parts.length,i="";t<e;t++)i+=this._getPathPartStr(this._parts[t]);return i},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._latlngs=this._convertLatLngs(t),this.redraw()},addLatLng:function(t){return this._latlngs.push(o.latLng(t)),this.redraw()},spliceLatLngs:function(){var t=[].splice.apply(this._latlngs,arguments);return this._convertLatLngs(this._latlngs,!0),this.redraw(),t},closestLayerPoint:function(t){for(var e,i,n=1/0,s=this._parts,a=null,r=0,h=s.length;r<h;r++)for(var l=s[r],u=1,c=l.length;u<c;u++){e=l[u-1],i=l[u];var d=o.LineUtil._sqClosestPointOnSegment(t,e,i,!0);d<n&&(n=d,a=o.LineUtil._sqClosestPointOnSegment(t,e,i))}return a&&(a.distance=Math.sqrt(n)),a},getBounds:function(){return new o.LatLngBounds(this.getLatLngs())},_convertLatLngs:function(t,e){var i,n,s=e?t:[];for(i=0,n=t.length;i<n;i++){if(o.Util.isArray(t[i])&&"number"!=typeof t[i][0])return;s[i]=o.latLng(t[i])}return s},_initEvents:function(){o.Path.prototype._initEvents.call(this)},_getPathPartStr:function(t){for(var e,i=o.Path.VML,n=0,s=t.length,a="";n<s;n++)e=t[n],i&&e._round(),a+=(n?"L":"M")+e.x+" "+e.y;return a},_clipPoints:function(){var t,e,i,n=this._originalPoints,s=n.length;if(this.options.noClip)this._parts=[n];else{this._parts=[];var a=this._parts,r=this._map._pathViewport,h=o.LineUtil;for(e=t=0;t<s-1;t++)(i=h.clipSegment(n[t],n[t+1],r,t))&&(a[e]=a[e]||[],a[e].push(i[0]),(i[1]!==n[t+1]||t===s-2)&&(a[e].push(i[1]),e++))}},_simplifyPoints:function(){for(var t=this._parts,e=o.LineUtil,i=0,n=t.length;i<n;i++)t[i]=e.simplify(t[i],this.options.smoothFactor)},_updatePath:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),o.Path.prototype._updatePath.call(this))}}),o.polyline=function(t,e){return new o.Polyline(t,e)},o.PolyUtil={},o.PolyUtil.clipPolygon=function(t,e){var i,n,s,a,r,h,l,u,c,d=[1,4,2,8],p=o.LineUtil;for(n=0,l=t.length;n<l;n++)t[n]._code=p._getBitCode(t[n],e);for(a=0;a<4;a++){for(u=d[a],i=[],n=0,s=(l=t.length)-1;n<l;s=n++)r=t[n],h=t[s],r._code&u?h._code&u||((c=p._getEdgeIntersection(h,r,u,e))._code=p._getBitCode(c,e),i.push(c)):(h._code&u&&((c=p._getEdgeIntersection(h,r,u,e))._code=p._getBitCode(c,e),i.push(c)),i.push(r));t=i}return t},o.Polygon=o.Polyline.extend({options:{fill:!0},initialize:function(t,e){o.Polyline.prototype.initialize.call(this,t,e),this._initWithHoles(t)},_initWithHoles:function(t){var e,i,n;if(t&&o.Util.isArray(t[0])&&"number"!=typeof t[0][0])for(this._latlngs=this._convertLatLngs(t[0]),this._holes=t.slice(1),e=0,i=this._holes.length;e<i;e++)(n=this._holes[e]=this._convertLatLngs(this._holes[e]))[0].equals(n[n.length-1])&&n.pop();2<=(t=this._latlngs).length&&t[0].equals(t[t.length-1])&&t.pop()},projectLatlngs:function(){var t,e,i,n;if(o.Polyline.prototype.projectLatlngs.call(this),this._holePoints=[],this._holes)for(t=0,i=this._holes.length;t<i;t++)for(this._holePoints[t]=[],e=0,n=this._holes[t].length;e<n;e++)this._holePoints[t][e]=this._map.latLngToLayerPoint(this._holes[t][e])},setLatLngs:function(t){return t&&o.Util.isArray(t[0])&&"number"!=typeof t[0][0]?(this._initWithHoles(t),this.redraw()):o.Polyline.prototype.setLatLngs.call(this,t)},_clipPoints:function(){var t=this._originalPoints,e=[];if(this._parts=[t].concat(this._holePoints),!this.options.noClip){for(var i=0,n=this._parts.length;i<n;i++){var s=o.PolyUtil.clipPolygon(this._parts[i],this._map._pathViewport);s.length&&e.push(s)}this._parts=e}},_getPathPartStr:function(t){return o.Polyline.prototype._getPathPartStr.call(this,t)+(o.Browser.svg?"z":"x")}}),o.polygon=function(t,e){return new o.Polygon(t,e)},function(){function t(t){return o.FeatureGroup.extend({initialize:function(t,e){this._layers={},this._options=e,this.setLatLngs(t)},setLatLngs:function(e){var i=0,n=e.length;for(this.eachLayer(function(t){i<n?t.setLatLngs(e[i++]):this.removeLayer(t)},this);i<n;)this.addLayer(new t(e[i++],this._options));return this},getLatLngs:function(){var t=[];return this.eachLayer(function(e){t.push(e.getLatLngs())}),t}})}o.MultiPolyline=t(o.Polyline),o.MultiPolygon=t(o.Polygon),o.multiPolyline=function(t,e){return new o.MultiPolyline(t,e)},o.multiPolygon=function(t,e){return new o.MultiPolygon(t,e)}}(),o.Rectangle=o.Polygon.extend({initialize:function(t,e){o.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return[(t=o.latLngBounds(t)).getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}}),o.rectangle=function(t,e){return new o.Rectangle(t,e)},o.Circle=o.Path.extend({initialize:function(t,e,i){o.Path.prototype.initialize.call(this,i),this._latlng=o.latLng(t),this._mRadius=e},options:{fill:!0},setLatLng:function(t){return this._latlng=o.latLng(t),this.redraw()},setRadius:function(t){return this._mRadius=t,this.redraw()},projectLatlngs:function(){var t=this._getLngRadius(),e=this._latlng,i=this._map.latLngToLayerPoint([e.lat,e.lng-t]);this._point=this._map.latLngToLayerPoint(e),this._radius=Math.max(this._point.x-i.x,1)},getBounds:function(){var t=this._getLngRadius(),e=this._mRadius/40075017*360,i=this._latlng;return new o.LatLngBounds([i.lat-e,i.lng-t],[i.lat+e,i.lng+t])},getLatLng:function(){return this._latlng},getPathString:function(){var t=this._point,e=this._radius;return this._checkIfEmpty()?"":o.Browser.svg?"M"+t.x+","+(t.y-e)+"A"+e+","+e+",0,1,1,"+(t.x-.1)+","+(t.y-e)+" z":(t._round(),e=Math.round(e),"AL "+t.x+","+t.y+" "+e+","+e+" 0,23592600")},getRadius:function(){return this._mRadius},_getLatRadius:function(){return this._mRadius/40075017*360},_getLngRadius:function(){return this._getLatRadius()/Math.cos(o.LatLng.DEG_TO_RAD*this._latlng.lat)},_checkIfEmpty:function(){if(!this._map)return!1;var t=this._map._pathViewport,e=this._radius,i=this._point;return i.x-e>t.max.x||i.y-e>t.max.y||i.x+e<t.min.x||i.y+e<t.min.y}}),o.circle=function(t,e,i){return new o.Circle(t,e,i)},o.CircleMarker=o.Circle.extend({options:{radius:10,weight:2},initialize:function(t,e){o.Circle.prototype.initialize.call(this,t,null,e),this._radius=this.options.radius},projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng)},_updateStyle:function(){o.Circle.prototype._updateStyle.call(this),this.setRadius(this.options.radius)},setLatLng:function(t){return o.Circle.prototype.setLatLng.call(this,t),this._popup&&this._popup._isOpen&&this._popup.setLatLng(t),this},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius}}),o.circleMarker=function(t,e){return new o.CircleMarker(t,e)},o.Polyline.include(o.Path.CANVAS?{_containsPoint:function(t,e){var i,n,s,a,r,l,u=this.options.weight/2;for(o.Browser.touch&&(u+=10),i=0,a=this._parts.length;i<a;i++)for(n=0,s=(r=(l=this._parts[i]).length)-1;n<r;s=n++)if((e||0!==n)&&o.LineUtil.pointToSegmentDistance(t,l[s],l[n])<=u)return!0;return!1}}:{}),o.Polygon.include(o.Path.CANVAS?{_containsPoint:function(t){var e,i,n,s,a,r,h,l,u=!1;if(o.Polyline.prototype._containsPoint.call(this,t,!0))return!0;for(s=0,h=this._parts.length;s<h;s++)for(a=0,r=(l=(e=this._parts[s]).length)-1;a<l;r=a++)i=e[a],n=e[r],i.y>t.y!=n.y>t.y&&t.x<(n.x-i.x)*(t.y-i.y)/(n.y-i.y)+i.x&&(u=!u);return u}}:{}),o.Circle.include(o.Path.CANVAS?{_drawPath:function(){var t=this._point;this._ctx.beginPath(),this._ctx.arc(t.x,t.y,this._radius,0,2*Math.PI,!1)},_containsPoint:function(t){var e=this._point,i=this.options.stroke?this.options.weight/2:0;return t.distanceTo(e)<=this._radius+i}}:{}),o.CircleMarker.include(o.Path.CANVAS?{_updateStyle:function(){o.Path.prototype._updateStyle.call(this)}}:{}),o.GeoJSON=o.FeatureGroup.extend({initialize:function(t,e){o.setOptions(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,i,n,s=o.Util.isArray(t)?t:t.features;if(s){for(e=0,i=s.length;e<i;e++)((n=s[e]).geometries||n.geometry||n.features||n.coordinates)&&this.addData(s[e]);return this}var a=this.options;if(!a.filter||a.filter(t)){var r=o.GeoJSON.geometryToLayer(t,a.pointToLayer,a.coordsToLatLng,a);return r.feature=o.GeoJSON.asFeature(t),r.defaultOptions=r.options,this.resetStyle(r),a.onEachFeature&&a.onEachFeature(t,r),this.addLayer(r)}},resetStyle:function(t){var e=this.options.style;e&&(o.Util.extend(t.options,t.defaultOptions),this._setLayerStyle(t,e))},setStyle:function(t){this.eachLayer(function(e){this._setLayerStyle(e,t)},this)},_setLayerStyle:function(t,e){"function"==typeof e&&(e=e(t.feature)),t.setStyle&&t.setStyle(e)}}),o.extend(o.GeoJSON,{geometryToLayer:function(t,e,i,n){var s,a,r,h,l="Feature"===t.type?t.geometry:t,u=l.coordinates,c=[];switch(i=i||this.coordsToLatLng,l.type){case"Point":return s=i(u),e?e(t,s):new o.Marker(s);case"MultiPoint":for(r=0,h=u.length;r<h;r++)s=i(u[r]),c.push(e?e(t,s):new o.Marker(s));return new o.FeatureGroup(c);case"LineString":return a=this.coordsToLatLngs(u,0,i),new o.Polyline(a,n);case"Polygon":if(2===u.length&&!u[1].length)throw new Error("Invalid GeoJSON object.");return a=this.coordsToLatLngs(u,1,i),new o.Polygon(a,n);case"MultiLineString":return a=this.coordsToLatLngs(u,1,i),new o.MultiPolyline(a,n);case"MultiPolygon":return a=this.coordsToLatLngs(u,2,i),new o.MultiPolygon(a,n);case"GeometryCollection":for(r=0,h=l.geometries.length;r<h;r++)c.push(this.geometryToLayer({geometry:l.geometries[r],type:"Feature",properties:t.properties},e,i,n));return new o.FeatureGroup(c);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(t){return new o.LatLng(t[1],t[0],t[2])},coordsToLatLngs:function(t,e,i){var n,o,s,a=[];for(o=0,s=t.length;o<s;o++)n=e?this.coordsToLatLngs(t[o],e-1,i):(i||this.coordsToLatLng)(t[o]),a.push(n);return a},latLngToCoords:function(t){var e=[t.lng,t.lat];return t.alt!==i&&e.push(t.alt),e},latLngsToCoords:function(t){for(var e=[],i=0,n=t.length;i<n;i++)e.push(o.GeoJSON.latLngToCoords(t[i]));return e},getFeature:function(t,e){return t.feature?o.extend({},t.feature,{geometry:e}):o.GeoJSON.asFeature(e)},asFeature:function(t){return"Feature"===t.type?t:{type:"Feature",properties:{},geometry:t}}});var a={toGeoJSON:function(){return o.GeoJSON.getFeature(this,{type:"Point",coordinates:o.GeoJSON.latLngToCoords(this.getLatLng())})}};o.Marker.include(a),o.Circle.include(a),o.CircleMarker.include(a),o.Polyline.include({toGeoJSON:function(){return o.GeoJSON.getFeature(this,{type:"LineString",coordinates:o.GeoJSON.latLngsToCoords(this.getLatLngs())})}}),o.Polygon.include({toGeoJSON:function(){var t,e,i,n=[o.GeoJSON.latLngsToCoords(this.getLatLngs())];if(n[0].push(n[0][0]),this._holes)for(t=0,e=this._holes.length;t<e;t++)(i=o.GeoJSON.latLngsToCoords(this._holes[t])).push(i[0]),n.push(i);return o.GeoJSON.getFeature(this,{type:"Polygon",coordinates:n})}}),function(){function t(t){return function(){var e=[];return this.eachLayer(function(t){e.push(t.toGeoJSON().geometry.coordinates)}),o.GeoJSON.getFeature(this,{type:t,coordinates:e})}}o.MultiPolyline.include({toGeoJSON:t("MultiLineString")}),o.MultiPolygon.include({toGeoJSON:t("MultiPolygon")}),o.LayerGroup.include({toGeoJSON:function(){var e,i=this.feature&&this.feature.geometry,n=[];if(i&&"MultiPoint"===i.type)return t("MultiPoint").call(this);var s=i&&"GeometryCollection"===i.type;return this.eachLayer(function(t){t.toGeoJSON&&(e=t.toGeoJSON(),n.push(s?e.geometry:o.GeoJSON.asFeature(e)))}),s?o.GeoJSON.getFeature(this,{geometries:n,type:"GeometryCollection"}):{type:"FeatureCollection",features:n}}})}(),o.geoJson=function(t,e){return new o.GeoJSON(t,e)},o.DomEvent={addListener:function(t,e,i,n){var s,a,r,h=o.stamp(i),l="_leaflet_"+e+h;return t[l]?this:(s=function(e){return i.call(n||t,e||o.DomEvent._getEvent())},o.Browser.pointer&&0===e.indexOf("touch")?this.addPointerListener(t,e,s,h):(o.Browser.touch&&"dblclick"===e&&this.addDoubleTapListener&&this.addDoubleTapListener(t,s,h),"addEventListener"in t?"mousewheel"===e?(t.addEventListener("DOMMouseScroll",s,!1),t.addEventListener(e,s,!1)):"mouseenter"===e||"mouseleave"===e?(a=s,r="mouseenter"===e?"mouseover":"mouseout",s=function(e){return o.DomEvent._checkMouse(t,e)?a(e):void 0},t.addEventListener(r,s,!1)):("click"===e&&o.Browser.android&&(a=s,s=function(t){return o.DomEvent._filterClick(t,a)}),t.addEventListener(e,s,!1)):"attachEvent"in t&&t.attachEvent("on"+e,s),t[l]=s,this))},removeListener:function(t,e,i){var n=o.stamp(i),s="_leaflet_"+e+n,a=t[s];return a&&(o.Browser.pointer&&0===e.indexOf("touch")?this.removePointerListener(t,e,n):o.Browser.touch&&"dblclick"===e&&this.removeDoubleTapListener?this.removeDoubleTapListener(t,n):"removeEventListener"in t?"mousewheel"===e?(t.removeEventListener("DOMMouseScroll",a,!1),t.removeEventListener(e,a,!1)):"mouseenter"===e||"mouseleave"===e?t.removeEventListener("mouseenter"===e?"mouseover":"mouseout",a,!1):t.removeEventListener(e,a,!1):"detachEvent"in t&&t.detachEvent("on"+e,a),t[s]=null),this},stopPropagation:function(t){return t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,o.DomEvent._skipped(t),this},disableScrollPropagation:function(t){var e=o.DomEvent.stopPropagation;return o.DomEvent.on(t,"mousewheel",e).on(t,"MozMousePixelScroll",e)},disableClickPropagation:function(t){for(var e=o.DomEvent.stopPropagation,i=o.Draggable.START.length-1;0<=i;i--)o.DomEvent.on(t,o.Draggable.START[i],e);return o.DomEvent.on(t,"click",o.DomEvent._fakeStop).on(t,"dblclick",e)},preventDefault:function(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this},stop:function(t){return o.DomEvent.preventDefault(t).stopPropagation(t)},getMousePosition:function(t,e){if(!e)return new o.Point(t.clientX,t.clientY);var i=e.getBoundingClientRect();return new o.Point(t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop)},getWheelDelta:function(t){var e=0;return t.wheelDelta&&(e=t.wheelDelta/120),t.detail&&(e=-t.detail/3),e},_skipEvents:{},_fakeStop:function(t){o.DomEvent._skipEvents[t.type]=!0},_skipped:function(t){var e=this._skipEvents[t.type];return this._skipEvents[t.type]=!1,e},_checkMouse:function(t,e){var i=e.relatedTarget;if(!i)return!0;try{for(;i&&i!==t;)i=i.parentNode}catch(n){return!1}return i!==t},_getEvent:function(){var e=t.event;if(!e)for(var i=arguments.callee.caller;i&&(!(e=i.arguments[0])||t.Event!==e.constructor);)i=i.caller;return e},_filterClick:function(t,e){var i=t.timeStamp||t.originalEvent.timeStamp,n=o.DomEvent._lastClick&&i-o.DomEvent._lastClick;return n&&100<n&&n<500||t.target._simulatedClick&&!t._simulated?void o.DomEvent.stop(t):(o.DomEvent._lastClick=i,e(t))}},o.DomEvent.on=o.DomEvent.addListener,o.DomEvent.off=o.DomEvent.removeListener,o.Draggable=o.Class.extend({includes:o.Mixin.Events,statics:{START:o.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(t,e){this._element=t,this._dragStartTarget=e||t},enable:function(){if(!this._enabled){for(var t=o.Draggable.START.length-1;0<=t;t--)o.DomEvent.on(this._dragStartTarget,o.Draggable.START[t],this._onDown,this);this._enabled=!0}},disable:function(){if(this._enabled){for(var t=o.Draggable.START.length-1;0<=t;t--)o.DomEvent.off(this._dragStartTarget,o.Draggable.START[t],this._onDown,this);this._enabled=!1,this._moved=!1}},_onDown:function(t){if(this._moved=!1,!t.shiftKey&&(1===t.which||1===t.button||t.touches)&&(o.DomEvent.stopPropagation(t),!o.Draggable._disabled&&(o.DomUtil.disableImageDrag(),o.DomUtil.disableTextSelection(),!this._moving))){var i=t.touches?t.touches[0]:t;this._startPoint=new o.Point(i.clientX,i.clientY),this._startPos=this._newPos=o.DomUtil.getPosition(this._element),o.DomEvent.on(e,o.Draggable.MOVE[t.type],this._onMove,this).on(e,o.Draggable.END[t.type],this._onUp,this)}},_onMove:function(t){if(t.touches&&1<t.touches.length)this._moved=!0;else{var i=t.touches&&1===t.touches.length?t.touches[0]:t,s=new o.Point(i.clientX,i.clientY).subtract(this._startPoint);(s.x||s.y)&&(o.Browser.touch&&Math.abs(s.x)+Math.abs(s.y)<3||(o.DomEvent.preventDefault(t),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=o.DomUtil.getPosition(this._element).subtract(s),o.DomUtil.addClass(e.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,o.DomUtil.addClass(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(s),this._moving=!0,o.Util.cancelAnimFrame(this._animRequest),this._animRequest=o.Util.requestAnimFrame(this._updatePosition,this,!0,this._dragStartTarget)))}},_updatePosition:function(){this.fire("predrag"),o.DomUtil.setPosition(this._element,this._newPos),this.fire("drag")},_onUp:function(){for(var t in o.DomUtil.removeClass(e.body,"leaflet-dragging"),this._lastTarget&&(o.DomUtil.removeClass(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),o.Draggable.MOVE)o.DomEvent.off(e,o.Draggable.MOVE[t],this._onMove).off(e,o.Draggable.END[t],this._onUp);o.DomUtil.enableImageDrag(),o.DomUtil.enableTextSelection(),this._moved&&this._moving&&(o.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1}}),o.Handler=o.Class.extend({initialize:function(t){this._map=t},enable:function(){this._enabled||(this._enabled=!0,this.addHooks())},disable:function(){this._enabled&&(this._enabled=!1,this.removeHooks())},enabled:function(){return!!this._enabled}}),o.Map.mergeOptions({dragging:!0,inertia:!o.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,inertiaThreshold:o.Browser.touch?32:18,easeLinearity:.25,worldCopyJump:!1}),o.Map.Drag=o.Handler.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new o.Draggable(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDrag,this),t.on("viewreset",this._onViewReset,this),t.whenReady(this._onViewReset,this))}this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){var t=this._map;t._panAnim&&t._panAnim.stop(),t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(){if(this._map.options.inertia){var t=this._lastTime=+new Date,e=this._lastPos=this._draggable._newPos;this._positions.push(e),this._times.push(t),200<t-this._times[0]&&(this._positions.shift(),this._times.shift())}this._map.fire("move").fire("drag")},_onViewReset:function(){var t=this._map.getSize()._divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.project([0,180]).x},_onPreDrag:function(){var t=this._worldWidth,e=Math.round(t/2),i=this._initialWorldOffset,n=this._draggable._newPos.x,o=(n-e+i)%t+e-i,s=(n+e+i)%t-e-i,a=Math.abs(o+i)<Math.abs(s+i)?o:s;this._draggable._newPos.x=a},_onDragEnd:function(t){var e=this._map,i=e.options,n=+new Date-this._lastTime,s=!i.inertia||n>i.inertiaThreshold||!this._positions[0];if(e.fire("dragend",t),s)e.fire("moveend");else{var a=this._lastPos.subtract(this._positions[0]),r=(this._lastTime+n-this._times[0])/1e3,h=i.easeLinearity,l=a.multiplyBy(h/r),u=l.distanceTo([0,0]),c=Math.min(i.inertiaMaxSpeed,u),d=l.multiplyBy(c/u),p=c/(i.inertiaDeceleration*h),_=d.multiplyBy(-p/2).round();_.x&&_.y?(_=e._limitOffset(_,e.options.maxBounds),o.Util.requestAnimFrame(function(){e.panBy(_,{duration:p,easeLinearity:h,noMoveStart:!0})})):e.fire("moveend")}}}),o.Map.addInitHook("addHandler","dragging",o.Map.Drag),o.Map.mergeOptions({doubleClickZoom:!0}),o.Map.DoubleClickZoom=o.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,i=e.getZoom()+(t.originalEvent.shiftKey?-1:1);"center"===e.options.doubleClickZoom?e.setZoom(i):e.setZoomAround(t.containerPoint,i)}}),o.Map.addInitHook("addHandler","doubleClickZoom",o.Map.DoubleClickZoom),o.Map.mergeOptions({scrollWheelZoom:!0}),o.Map.ScrollWheelZoom=o.Handler.extend({addHooks:function(){o.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this),o.DomEvent.on(this._map._container,"MozMousePixelScroll",o.DomEvent.preventDefault),this._delta=0},removeHooks:function(){o.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll),o.DomEvent.off(this._map._container,"MozMousePixelScroll",o.DomEvent.preventDefault)},_onWheelScroll:function(t){var e=o.DomEvent.getWheelDelta(t);this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var i=Math.max(40-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o.bind(this._performZoom,this),i),o.DomEvent.preventDefault(t),o.DomEvent.stopPropagation(t)},_performZoom:function(){var t=this._map,e=this._delta,i=t.getZoom();e=0<e?Math.ceil(e):Math.floor(e),e=Math.max(Math.min(e,4),-4),e=t._limitZoom(i+e)-i,this._delta=0,this._startTime=null,e&&("center"===t.options.scrollWheelZoom?t.setZoom(i+e):t.setZoomAround(this._lastMousePos,i+e))}}),o.Map.addInitHook("addHandler","scrollWheelZoom",o.Map.ScrollWheelZoom),o.extend(o.DomEvent,{_touchstart:o.Browser.msPointer?"MSPointerDown":o.Browser.pointer?"pointerdown":"touchstart",_touchend:o.Browser.msPointer?"MSPointerUp":o.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(t,i,n){function s(t){if(!(1<(o.Browser.pointer?(_.push(t.pointerId),_.length):t.touches.length))){var i=Date.now(),n=i-(r||i);h=t.touches?t.touches[0]:t,l=0<n&&n<=250,r=i}}function a(t){if(o.Browser.pointer){var e=_.indexOf(t.pointerId);if(-1===e)return;_.splice(e,1)}if(l){if(o.Browser.pointer){var n,s={};for(var a in h)n=h[a],s[a]="function"==typeof n?n.bind(h):n;h=s}h.type="dblclick",i(h),r=null}}var r,h,l=!1,c="_leaflet_",d=this._touchstart,p=this._touchend,_=[];t[c+d+n]=s,t[c+p+n]=a;var m=o.Browser.pointer?e.documentElement:t;return t.addEventListener(d,s,!1),m.addEventListener(p,a,!1),o.Browser.pointer&&m.addEventListener(o.DomEvent.POINTER_CANCEL,a,!1),this},removeDoubleTapListener:function(t,i){var n="_leaflet_";return t.removeEventListener(this._touchstart,t[n+this._touchstart+i],!1),(o.Browser.pointer?e.documentElement:t).removeEventListener(this._touchend,t[n+this._touchend+i],!1),o.Browser.pointer&&e.documentElement.removeEventListener(o.DomEvent.POINTER_CANCEL,t[n+this._touchend+i],!1),this}}),o.extend(o.DomEvent,{POINTER_DOWN:o.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:o.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:o.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:o.Browser.msPointer?"MSPointerCancel":"pointercancel",_pointers:[],_pointerDocumentListener:!1,addPointerListener:function(t,e,i,n){switch(e){case"touchstart":return this.addPointerListenerStart(t,e,i,n);case"touchend":return this.addPointerListenerEnd(t,e,i,n);case"touchmove":return this.addPointerListenerMove(t,e,i,n);default:throw"Unknown touch event type"}},addPointerListenerStart:function(t,i,n,s){var r=this._pointers,h=function(t){"mouse"!==t.pointerType&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&o.DomEvent.preventDefault(t);for(var e=!1,i=0;i<r.length;i++)if(r[i].pointerId===t.pointerId){e=!0;break}e||r.push(t),t.touches=r.slice(),t.changedTouches=[t],n(t)};if(t["_leaflet_touchstart"+s]=h,t.addEventListener(this.POINTER_DOWN,h,!1),!this._pointerDocumentListener){var l=function(t){for(var e=0;e<r.length;e++)if(r[e].pointerId===t.pointerId){r.splice(e,1);break}};e.documentElement.addEventListener(this.POINTER_UP,l,!1),e.documentElement.addEventListener(this.POINTER_CANCEL,l,!1),this._pointerDocumentListener=!0}return this},addPointerListenerMove:function(t,e,i,n){function o(t){if(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType||0!==t.buttons){for(var e=0;e<a.length;e++)if(a[e].pointerId===t.pointerId){a[e]=t;break}t.touches=a.slice(),t.changedTouches=[t],i(t)}}var a=this._pointers;return t["_leaflet_touchmove"+n]=o,t.addEventListener(this.POINTER_MOVE,o,!1),this},addPointerListenerEnd:function(t,e,i,n){var s=this._pointers,a=function(t){for(var e=0;e<s.length;e++)if(s[e].pointerId===t.pointerId){s.splice(e,1);break}t.touches=s.slice(),t.changedTouches=[t],i(t)};return t["_leaflet_touchend"+n]=a,t.addEventListener(this.POINTER_UP,a,!1),t.addEventListener(this.POINTER_CANCEL,a,!1),this},removePointerListener:function(t,e,i){var o=t["_leaflet_"+e+i];switch(e){case"touchstart":t.removeEventListener(this.POINTER_DOWN,o,!1);break;case"touchmove":t.removeEventListener(this.POINTER_MOVE,o,!1);break;case"touchend":t.removeEventListener(this.POINTER_UP,o,!1),t.removeEventListener(this.POINTER_CANCEL,o,!1)}return this}}),o.Map.mergeOptions({touchZoom:o.Browser.touch&&!o.Browser.android23,bounceAtZoomLimits:!0}),o.Map.TouchZoom=o.Handler.extend({addHooks:function(){o.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){o.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var i=this._map;if(t.touches&&2===t.touches.length&&!i._animatingZoom&&!this._zooming){var n=i.mouseEventToLayerPoint(t.touches[0]),s=i.mouseEventToLayerPoint(t.touches[1]),a=i._getCenterLayerPoint();this._startCenter=n.add(s)._divideBy(2),this._startDist=n.distanceTo(s),this._moved=!1,this._zooming=!0,this._centerOffset=a.subtract(this._startCenter),i._panAnim&&i._panAnim.stop(),o.DomEvent.on(e,"touchmove",this._onTouchMove,this).on(e,"touchend",this._onTouchEnd,this),o.DomEvent.preventDefault(t)}},_onTouchMove:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&this._zooming){var i=e.mouseEventToLayerPoint(t.touches[0]),n=e.mouseEventToLayerPoint(t.touches[1]);this._scale=i.distanceTo(n)/this._startDist,this._delta=i._add(n)._divideBy(2)._subtract(this._startCenter),1!==this._scale&&(e.options.bounceAtZoomLimits||!(e.getZoom()===e.getMinZoom()&&this._scale<1||e.getZoom()===e.getMaxZoom()&&1<this._scale))&&(this._moved||(o.DomUtil.addClass(e._mapPane,"leaflet-touching"),e.fire("movestart").fire("zoomstart"),this._moved=!0),o.Util.cancelAnimFrame(this._animRequest),this._animRequest=o.Util.requestAnimFrame(this._updateOnMove,this,!0,this._map._container),o.DomEvent.preventDefault(t))}},_updateOnMove:function(){var t=this._map,e=this._getScaleOrigin(),i=t.layerPointToLatLng(e),n=t.getScaleZoom(this._scale);t._animateZoom(i,n,this._startCenter,this._scale,this._delta,!1,!0)},_onTouchEnd:function(){if(this._moved&&this._zooming){var t=this._map;this._zooming=!1,o.DomUtil.removeClass(t._mapPane,"leaflet-touching"),o.Util.cancelAnimFrame(this._animRequest),o.DomEvent.off(e,"touchmove",this._onTouchMove).off(e,"touchend",this._onTouchEnd);var i=this._getScaleOrigin(),n=t.layerPointToLatLng(i),s=t.getZoom(),a=t.getScaleZoom(this._scale)-s,r=0<a?Math.ceil(a):Math.floor(a),h=t._limitZoom(s+r),l=t.getZoomScale(h)/this._scale;t._animateZoom(n,h,i,l)}else this._zooming=!1},_getScaleOrigin:function(){var t=this._centerOffset.subtract(this._delta).divideBy(this._scale);return this._startCenter.add(t)}}),o.Map.addInitHook("addHandler","touchZoom",o.Map.TouchZoom),o.Map.mergeOptions({tap:!0,tapTolerance:15}),o.Map.Tap=o.Handler.extend({addHooks:function(){o.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){o.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if(o.DomEvent.preventDefault(t),this._fireClick=!0,1<t.touches.length)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var i=t.touches[0],n=i.target;this._startPos=this._newPos=new o.Point(i.clientX,i.clientY),n.tagName&&"a"===n.tagName.toLowerCase()&&o.DomUtil.addClass(n,"leaflet-active"),this._holdTimeout=setTimeout(o.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",i))},this),1e3),o.DomEvent.on(e,"touchmove",this._onMove,this).on(e,"touchend",this._onUp,this)}},_onUp:function(t){if(clearTimeout(this._holdTimeout),o.DomEvent.off(e,"touchmove",this._onMove,this).off(e,"touchend",this._onUp,this),this._fireClick&&t&&t.changedTouches){var i=t.changedTouches[0],n=i.target;n&&n.tagName&&"a"===n.tagName.toLowerCase()&&o.DomUtil.removeClass(n,"leaflet-active"),this._isTapValid()&&this._simulateEvent("click",i)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){var e=t.touches[0];this._newPos=new o.Point(e.clientX,e.clientY)},_simulateEvent:function(i,n){var o=e.createEvent("MouseEvents");o._simulated=!0,n.target._simulatedClick=!0,o.initMouseEvent(i,!0,!0,t,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),n.target.dispatchEvent(o)}}),o.Browser.touch&&!o.Browser.pointer&&o.Map.addInitHook("addHandler","tap",o.Map.Tap),o.Map.mergeOptions({boxZoom:!0}),o.Map.BoxZoom=o.Handler.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._moved=!1},addHooks:function(){o.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){o.DomEvent.off(this._container,"mousedown",this._onMouseDown),this._moved=!1},moved:function(){return this._moved},_onMouseDown:function(t){return this._moved=!1,!(!t.shiftKey||1!==t.which&&1!==t.button)&&(o.DomUtil.disableTextSelection(),o.DomUtil.disableImageDrag(),this._startLayerPoint=this._map.mouseEventToLayerPoint(t),void o.DomEvent.on(e,"mousemove",this._onMouseMove,this).on(e,"mouseup",this._onMouseUp,this).on(e,"keydown",this._onKeyDown,this))},_onMouseMove:function(t){this._moved||(this._box=o.DomUtil.create("div","leaflet-zoom-box",this._pane),o.DomUtil.setPosition(this._box,this._startLayerPoint),this._container.style.cursor="crosshair",this._map.fire("boxzoomstart"));var e=this._startLayerPoint,i=this._box,n=this._map.mouseEventToLayerPoint(t),s=n.subtract(e),a=new o.Point(Math.min(n.x,e.x),Math.min(n.y,e.y));o.DomUtil.setPosition(i,a),this._moved=!0,i.style.width=Math.max(0,Math.abs(s.x)-4)+"px",i.style.height=Math.max(0,Math.abs(s.y)-4)+"px"},_finish:function(){this._moved&&(this._pane.removeChild(this._box),this._container.style.cursor=""),o.DomUtil.enableTextSelection(),o.DomUtil.enableImageDrag(),o.DomEvent.off(e,"mousemove",this._onMouseMove).off(e,"mouseup",this._onMouseUp).off(e,"keydown",this._onKeyDown)},_onMouseUp:function(t){this._finish();var e=this._map,i=e.mouseEventToLayerPoint(t);if(!this._startLayerPoint.equals(i)){var n=new o.LatLngBounds(e.layerPointToLatLng(this._startLayerPoint),e.layerPointToLatLng(i));e.fitBounds(n),e.fire("boxzoomend",{boxZoomBounds:n})}},_onKeyDown:function(t){27===t.keyCode&&this._finish()}}),o.Map.addInitHook("addHandler","boxZoom",o.Map.BoxZoom),o.Map.mergeOptions({keyboard:!0,keyboardPanOffset:80,keyboardZoomOffset:1}),o.Map.Keyboard=o.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,173]},initialize:function(t){this._map=t,this._setPanOffset(t.options.keyboardPanOffset),this._setZoomOffset(t.options.keyboardZoomOffset)},addHooks:function(){var t=this._map._container;-1===t.tabIndex&&(t.tabIndex="0"),o.DomEvent.on(t,"focus",this._onFocus,this).on(t,"blur",this._onBlur,this).on(t,"mousedown",this._onMouseDown,this),this._map.on("focus",this._addHooks,this).on("blur",this._removeHooks,this)},removeHooks:function(){this._removeHooks();var t=this._map._container;o.DomEvent.off(t,"focus",this._onFocus,this).off(t,"blur",this._onBlur,this).off(t,"mousedown",this._onMouseDown,this),this._map.off("focus",this._addHooks,this).off("blur",this._removeHooks,this)},_onMouseDown:function(){if(!this._focused){var i=e.body,n=e.documentElement,o=i.scrollTop||n.scrollTop,s=i.scrollLeft||n.scrollLeft;this._map._container.focus(),t.scrollTo(s,o)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanOffset:function(t){var e,i,n=this._panKeys={},o=this.keyCodes;for(e=0,i=o.left.length;e<i;e++)n[o.left[e]]=[-1*t,0];for(e=0,i=o.right.length;e<i;e++)n[o.right[e]]=[t,0];for(e=0,i=o.down.length;e<i;e++)n[o.down[e]]=[0,t];for(e=0,i=o.up.length;e<i;e++)n[o.up[e]]=[0,-1*t]},_setZoomOffset:function(t){var e,i,n=this._zoomKeys={},o=this.keyCodes;for(e=0,i=o.zoomIn.length;e<i;e++)n[o.zoomIn[e]]=t;for(e=0,i=o.zoomOut.length;e<i;e++)n[o.zoomOut[e]]=-t},_addHooks:function(){o.DomEvent.on(e,"keydown",this._onKeyDown,this)},_removeHooks:function(){o.DomEvent.off(e,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){var e=t.keyCode,i=this._map;if(e in this._panKeys){if(i._panAnim&&i._panAnim._inProgress)return;i.panBy(this._panKeys[e]),i.options.maxBounds&&i.panInsideBounds(i.options.maxBounds)}else{if(!(e in this._zoomKeys))return;i.setZoom(i.getZoom()+this._zoomKeys[e])}o.DomEvent.stop(t)}}),o.Map.addInitHook("addHandler","keyboard",o.Map.Keyboard),o.Handler.MarkerDrag=o.Handler.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new o.Draggable(t,t)),this._draggable.on("dragstart",this._onDragStart,this).on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this),this._draggable.enable(),o.DomUtil.addClass(this._marker._icon,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off("dragstart",this._onDragStart,this).off("drag",this._onDrag,this).off("dragend",this._onDragEnd,this),this._draggable.disable(),o.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(){var t=this._marker,e=t._shadow,i=o.DomUtil.getPosition(t._icon),n=t._map.layerPointToLatLng(i);e&&o.DomUtil.setPosition(e,i),t._latlng=n,t.fire("move",{latlng:n}).fire("drag")},_onDragEnd:function(t){this._marker.fire("moveend").fire("dragend",t)}}),o.Control=o.Class.extend({options:{position:"topright"},initialize:function(t){o.setOptions(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this._map=t;var e=this._container=this.onAdd(t),i=this.getPosition(),n=t._controlCorners[i];return o.DomUtil.addClass(e,"leaflet-control"),-1!==i.indexOf("bottom")?n.insertBefore(e,n.firstChild):n.appendChild(e),this},removeFrom:function(t){var e=this.getPosition();return t._controlCorners[e].removeChild(this._container),this._map=null,this.onRemove&&this.onRemove(t),this},_refocusOnMap:function(){this._map&&this._map.getContainer().focus()}}),o.control=function(t){return new o.Control(t)},o.Map.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.removeFrom(this),this},_initControlPos:function(){function t(t,s){var a=i+t+" "+i+s;e[t+s]=o.DomUtil.create("div",a,n)}var e=this._controlCorners={},i="leaflet-",n=this._controlContainer=o.DomUtil.create("div",i+"control-container",this._container);t("top","left"),t("top","right"),t("bottom","left"),t("bottom","right")},_clearControlPos:function(){this._container.removeChild(this._controlContainer)}}),o.Control.Zoom=o.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"放大",zoomOutText:"-",zoomOutTitle:"缩小"},onAdd:function(t){var e="leaflet-control-zoom",i=o.DomUtil.create("div",e+" leaflet-bar");return this._map=t,this._zoomInButton=this._createButton(this.options.zoomInText,this.options.zoomInTitle,e+"-in",i,this._zoomIn,this),this._zoomOutButton=this._createButton(this.options.zoomOutText,this.options.zoomOutTitle,e+"-out",i,this._zoomOut,this),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),i},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},_zoomIn:function(t){this._map.zoomIn(t.shiftKey?3:1)},_zoomOut:function(t){this._map.zoomOut(t.shiftKey?3:1)},_createButton:function(t,e,i,n,s,a){var r=o.DomUtil.create("a",i,n);r.innerHTML=t,r.href="#",r.title=e;var h=o.DomEvent.stopPropagation;return o.DomEvent.on(r,"click",h).on(r,"mousedown",h).on(r,"dblclick",h).on(r,"click",o.DomEvent.preventDefault).on(r,"click",s,a).on(r,"click",this._refocusOnMap,a),r},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";o.DomUtil.removeClass(this._zoomInButton,e),o.DomUtil.removeClass(this._zoomOutButton,e),t._zoom===t.getMinZoom()&&o.DomUtil.addClass(this._zoomOutButton,e),t._zoom===t.getMaxZoom()&&o.DomUtil.addClass(this._zoomInButton,e)}}),o.Map.mergeOptions({zoomControl:!0}),o.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new o.Control.Zoom,this.addControl(this.zoomControl))}),o.control.zoom=function(t){return new o.Control.Zoom(t)},o.Control.Attribution=o.Control.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){o.setOptions(this,t),this._attributions={}},onAdd:function(t){for(var e in this._container=o.DomUtil.create("div","leaflet-control-attribution"),o.DomEvent.disableClickPropagation(this._container),t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return t.on("layeradd",this._onLayerAdd,this).on("layerremove",this._onLayerRemove,this),this._update(),this._container},onRemove:function(t){t.off("layeradd",this._onLayerAdd).off("layerremove",this._onLayerRemove)},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):void 0},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):void 0},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var i=[];this.options.prefix&&i.push(this.options.prefix),t.length&&i.push(t.join(", ")),this._container.innerHTML=i.join(" | ")}},_onLayerAdd:function(t){t.layer.getAttribution&&this.addAttribution(t.layer.getAttribution())},_onLayerRemove:function(t){t.layer.getAttribution&&this.removeAttribution(t.layer.getAttribution())}}),o.Map.mergeOptions({attributionControl:!0}),o.Map.addInitHook(function(){this.options.attributionControl&&(this.attributionControl=(new o.Control.Attribution).addTo(this))}),o.control.attribution=function(t){return new o.Control.Attribution(t)},o.Control.Scale=o.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0,updateWhenIdle:!1},onAdd:function(t){this._map=t;var e="leaflet-control-scale",i=o.DomUtil.create("div",e),n=this.options;return this._addScales(n,e,i),t.on(n.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),i},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,i){t.metric&&(this._mScale=o.DomUtil.create("div",e+"-line",i)),t.imperial&&(this._iScale=o.DomUtil.create("div",e+"-line",i))},_update:function(){var t=this._map.getBounds(),e=t.getCenter().lat,n=6378137*Math.PI*Math.cos(e*Math.PI/180)*(t.getNorthEast().lng-t.getSouthWest().lng)/180,o=this._map.getSize(),s=this.options,a=0;0<o.x&&(a=n*(s.maxWidth/o.x)),this._updateScales(s,a)},_updateScales:function(t,e){t.metric&&e&&this._updateMetric(e),t.imperial&&e&&this._updateImperial(e)},_updateMetric:function(t){var e=this._getRoundNum(t);this._mScale.style.width=this._getScaleWidth(e/t)+"px",this._mScale.innerHTML=e<1e3?e+" m":e/1e3+" km"},_updateImperial:function(t){var e,i,n,o=3.2808399*t,s=this._iScale;s.innerHTML=5280<o?(e=o/5280,i=this._getRoundNum(e),s.style.width=this._getScaleWidth(i/e)+"px",i+" mi"):(n=this._getRoundNum(o),s.style.width=this._getScaleWidth(n/o)+"px",n+" ft")},_getScaleWidth:function(t){return Math.round(this.options.maxWidth*t)-10},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),i=t/e;return e*(i=10<=i?10:5<=i?5:3<=i?3:2<=i?2:1)}}),o.control.scale=function(t){return new o.Control.Scale(t)},o.Control.Layers=o.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0},initialize:function(t,e,i){for(var n in o.setOptions(this,i),this._layers={},this._lastZIndex=0,this._handlingClick=!1,t)this._addLayer(t[n],n);for(n in e)this._addLayer(e[n],n,!0)},onAdd:function(t){return this._initLayout(),this._update(),t.on("layeradd",this._onLayerChange,this).on("layerremove",this._onLayerChange,this),this._container},onRemove:function(t){t.off("layeradd",this._onLayerChange,this).off("layerremove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._update(),this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._update(),this},removeLayer:function(t){var e=o.stamp(t);return delete this._layers[e],this._update(),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=o.DomUtil.create("div",t);e.setAttribute("aria-haspopup",!0),o.Browser.touch?o.DomEvent.on(e,"click",o.DomEvent.stopPropagation):o.DomEvent.disableClickPropagation(e).disableScrollPropagation(e);var i=this._form=o.DomUtil.create("form",t+"-list");if(this.options.collapsed){o.Browser.android||o.DomEvent.on(e,"mouseover",this._expand,this).on(e,"mouseout",this._collapse,this);var n=this._layersLink=o.DomUtil.create("a",t+"-toggle",e);n.href="#",n.title="Layers",o.Browser.touch?o.DomEvent.on(n,"click",o.DomEvent.stop).on(n,"click",this._expand,this):o.DomEvent.on(n,"focus",this._expand,this),o.DomEvent.on(i,"click",function(){setTimeout(o.bind(this._onInputClick,this),0)},this),this._map.on("click",this._collapse,this)}else this._expand();this._baseLayersList=o.DomUtil.create("div",t+"-base",i),this._separator=o.DomUtil.create("div",t+"-separator",i),this._overlaysList=o.DomUtil.create("div",t+"-overlays",i),e.appendChild(i)},_addLayer:function(t,e,i){var n=o.stamp(t);this._layers[n]={layer:t,name:e,overlay:i},this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex))},_update:function(){if(this._container){this._baseLayersList.innerHTML="",this._overlaysList.innerHTML="";var t,e,i=!1,n=!1;for(t in this._layers)e=this._layers[t],this._addItem(e),n=n||e.overlay,i=i||!e.overlay;this._separator.style.display=n&&i?"":"none"}},_onLayerChange:function(t){var e=this._layers[o.stamp(t.layer)];if(e){this._handlingClick||this._update();var i=e.overlay?"layeradd"===t.type?"overlayadd":"overlayremove":"layeradd"===t.type?"baselayerchange":null;i&&this._map.fire(i,e)}},_createRadioElement:function(t,i){var n='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"';i&&(n+=' checked="checked"'),n+="/>";var o=e.createElement("div");return o.innerHTML=n,o.firstChild},_addItem:function(t){var i,n=e.createElement("label"),s=this._map.hasLayer(t.layer);t.overlay?((i=e.createElement("input")).type="checkbox",i.className="leaflet-control-layers-selector",i.defaultChecked=s):i=this._createRadioElement("leaflet-base-layers",s),i.layerId=o.stamp(t.layer),o.DomEvent.on(i,"click",this._onInputClick,this);var a=e.createElement("span");return a.innerHTML=" "+t.name,n.appendChild(i),n.appendChild(a),(t.overlay?this._overlaysList:this._baseLayersList).appendChild(n),n},_onInputClick:function(){var t,e,i,n=this._form.getElementsByTagName("input"),o=n.length;for(this._handlingClick=!0,t=0;t<o;t++)e=n[t],i=this._layers[e.layerId],e.checked&&!this._map.hasLayer(i.layer)?this._map.addLayer(i.layer):!e.checked&&this._map.hasLayer(i.layer)&&this._map.removeLayer(i.layer);this._handlingClick=!1,this._refocusOnMap()},_expand:function(){o.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-layers-expanded","")}}),o.control.layers=function(t,e,i){return new o.Control.Layers(t,e,i)},o.PosAnimation=o.Class.extend({includes:o.Mixin.Events,run:function(t,e,i,n){this.stop(),this._el=t,this._inProgress=!0,this._newPos=e,this.fire("start"),t.style[o.DomUtil.TRANSITION]="all "+(i||.25)+"s cubic-bezier(0,0,"+(n||.5)+",1)",o.DomEvent.on(t,o.DomUtil.TRANSITION_END,this._onTransitionEnd,this),o.DomUtil.setPosition(t,e),o.Util.falseFn(t.offsetWidth),this._stepTimer=setInterval(o.bind(this._onStep,this),50)},stop:function(){this._inProgress&&(o.DomUtil.setPosition(this._el,this._getPos()),this._onTransitionEnd(),o.Util.falseFn(this._el.offsetWidth))},_onStep:function(){var t=this._getPos();return t?(this._el._leaflet_pos=t,void this.fire("step")):void this._onTransitionEnd()},_transformRe:/([-+]?(?:\d*\.)?\d+)\D*, ([-+]?(?:\d*\.)?\d+)\D*\)/,_getPos:function(){var e,i,n,s=this._el,a=t.getComputedStyle(s);if(o.Browser.any3d){if(!(n=a[o.DomUtil.TRANSFORM].match(this._transformRe)))return;e=parseFloat(n[1]),i=parseFloat(n[2])}else e=parseFloat(a.left),i=parseFloat(a.top);return new o.Point(e,i,!0)},_onTransitionEnd:function(){o.DomEvent.off(this._el,o.DomUtil.TRANSITION_END,this._onTransitionEnd,this),this._inProgress&&(this._inProgress=!1,this._el.style[o.DomUtil.TRANSITION]="",this._el._leaflet_pos=this._newPos,clearInterval(this._stepTimer),this.fire("step").fire("end"))}}),o.Map.include({setView:function(t,e,n){if((e=e===i?this._zoom:this._limitZoom(e),t=this._limitCenter(o.latLng(t),e,this.options.maxBounds),n=n||{},this._panAnim&&this._panAnim.stop(),this._loaded&&!n.reset&&!0!==n)&&(n.animate!==i&&(n.zoom=o.extend({animate:n.animate},n.zoom),n.pan=o.extend({animate:n.animate},n.pan)),this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,n.zoom):this._tryAnimatedPan(t,n.pan)))return clearTimeout(this._sizeTimer),this;return this._resetView(t,e),this},panBy:function(t,e){if(e=e||{},!(t=o.point(t).round()).x&&!t.y)return this;if(this._panAnim||(this._panAnim=new o.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),!1!==e.animate){o.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var i=this._getMapPanePos().subtract(t);this._panAnim.run(this._mapPane,i,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){o.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var i=this._getCenterOffset(t)._floor();return!(!0!==(e&&e.animate)&&!this.getSize().contains(i))&&(this.panBy(i,e),!0)}}),o.PosAnimation=o.DomUtil.TRANSITION?o.PosAnimation:o.PosAnimation.extend({run:function(t,e,i,n){this.stop(),this._el=t,this._inProgress=!0,this._duration=i||.25,this._easeOutPower=1/Math.max(n||.5,.2),this._startPos=o.DomUtil.getPosition(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(),this._complete())},_animate:function(){this._animId=o.Util.requestAnimFrame(this._animate,this),this._step()},_step:function(){var t=+new Date-this._startTime,e=1e3*this._duration;t<e?this._runFrame(this._easeOut(t/e)):(this._runFrame(1),this._complete())},_runFrame:function(t){var e=this._startPos.add(this._offset.multiplyBy(t));o.DomUtil.setPosition(this._el,e),this.fire("step")},_complete:function(){o.Util.cancelAnimFrame(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),o.Map.mergeOptions({zoomAnimation:!0,zoomAnimationThreshold:4}),o.DomUtil.TRANSITION&&o.Map.addInitHook(function(){this._zoomAnimated=this.options.zoomAnimation&&o.DomUtil.TRANSITION&&o.Browser.any3d&&!o.Browser.android23&&!o.Browser.mobileOpera,this._zoomAnimated&&o.DomEvent.on(this._mapPane,o.DomUtil.TRANSITION_END,this._catchTransitionEnd,this)}),o.Map.include(o.DomUtil.TRANSITION?{_catchTransitionEnd:function(t){this._animatingZoom&&0<=t.propertyName.indexOf("transform")&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,i){if(this._animatingZoom)return!0;if(i=i||{},!this._zoomAnimated||!1===i.animate||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var n=this.getZoomScale(e),o=this._getCenterOffset(t)._divideBy(1-1/n),s=this._getCenterLayerPoint()._add(o);return!(!0!==i.animate&&!this.getSize().contains(o))&&(this.fire("movestart").fire("zoomstart"),this._animateZoom(t,e,s,n,null,!0),!0)},_animateZoom:function(t,e,i,n,s,a,r){r||(this._animatingZoom=!0),o.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim"),this._animateToCenter=t,this._animateToZoom=e,o.Draggable&&(o.Draggable._disabled=!0),o.Util.requestAnimFrame(function(){this.fire("zoomanim",{center:t,zoom:e,origin:i,scale:n,delta:s,backwards:a}),setTimeout(o.bind(this._onZoomTransitionEnd,this),250)},this)},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._animatingZoom=!1,o.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),o.Util.requestAnimFrame(function(){this._resetView(this._animateToCenter,this._animateToZoom,!0,!0),o.Draggable&&(o.Draggable._disabled=!1)},this))}}:{}),o.TileLayer.include({_animateZoom:function(t){this._animating||(this._animating=!0,this._prepareBgBuffer());var e=this._bgBuffer,i=o.DomUtil.TRANSFORM,n=t.delta?o.DomUtil.getTranslateString(t.delta):e.style[i],s=o.DomUtil.getScaleString(t.scale,t.origin);e.style[i]=t.backwards?s+" "+n:n+" "+s},_endZoomAnim:function(){var t=this._tileContainer,e=this._bgBuffer;t.style.visibility="",t.parentNode.appendChild(t),o.Util.falseFn(e.offsetWidth);var i=this._map.getZoom();(i>this.options.maxZoom||i<this.options.minZoom)&&this._clearBgBuffer(),this._animating=!1},_clearBgBuffer:function(){var t=this._map;!t||t._animatingZoom||t.touchZoom._zooming||(this._bgBuffer.innerHTML="",this._bgBuffer.style[o.DomUtil.TRANSFORM]="")},_prepareBgBuffer:function(){var t=this._tileContainer,e=this._bgBuffer,i=this._getLoadedTilesPercentage(e),n=this._getLoadedTilesPercentage(t);return e&&.5<i&&n<.5?(t.style.visibility="hidden",void this._stopLoadingImages(t)):(e.style.visibility="hidden",e.style[o.DomUtil.TRANSFORM]="",this._tileContainer=e,e=this._bgBuffer=t,this._stopLoadingImages(e),void clearTimeout(this._clearBgBufferTimer))},_getLoadedTilesPercentage:function(t){var e,i,n=t.getElementsByTagName("img"),o=0;for(e=0,i=n.length;e<i;e++)n[e].complete&&o++;return o/i},_stopLoadingImages:function(t){var e,i,n,s=Array.prototype.slice.call(t.getElementsByTagName("img"));for(e=0,i=s.length;e<i;e++)(n=s[e]).complete||(n.onload=o.Util.falseFn,n.onerror=o.Util.falseFn,n.src=o.Util.emptyImageUrl,n.parentNode.removeChild(n))}}),o.Map.include({_defaultLocateOptions:{watch:!1,setView:!1,maxZoom:1/0,timeout:1e4,maximumAge:0,enableHighAccuracy:!1},locate:function(t){if(t=this._locateOptions=o.extend(this._defaultLocateOptions,t),!navigator.geolocation)return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=o.bind(this._handleGeolocationResponse,this),i=o.bind(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,i,t):navigator.geolocation.getCurrentPosition(e,i,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var e=t.code,i=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+i+"."})},_handleGeolocationResponse:function(t){var e=t.coords.latitude,i=t.coords.longitude,n=new o.LatLng(e,i),s=180*t.coords.accuracy/40075017,a=s/Math.cos(o.LatLng.DEG_TO_RAD*e),r=o.latLngBounds([e-s,i-a],[e+s,i+a]),h=this._locateOptions;if(h.setView){var l=Math.min(this.getBoundsZoom(r),h.maxZoom);this.setView(n,l)}var u={latlng:n,bounds:r,timestamp:t.timestamp};for(var c in t.coords)"number"==typeof t.coords[c]&&(u[c]=t.coords[c]);this.fire("locationfound",u)}})}(window,document),define("ViewModels/DistanceLegendViewModel",["Cesium/Core/defined","Cesium/Core/DeveloperError","Cesium/Core/EllipsoidGeodesic","Cesium/Core/Cartesian2","Cesium/Core/getTimestamp","Cesium/Core/EventHelper","KnockoutES5","Core/loadView","leaflet"],function(defined,DeveloperError,EllipsoidGeodesic,Cartesian2,getTimestamp,EventHelper,Knockout,loadView,leaflet){"use strict";var DistanceLegendViewModel=function(options){if(!defined(options)||!defined(options.terria))throw new DeveloperError("options.terria is required.");this.terria=options.terria,this._removeSubscription=void 0,this._lastLegendUpdate=void 0,this.eventHelper=new EventHelper,this.distanceLabel=void 0,this.barWidth=void 0,Knockout.track(this,["distanceLabel","barWidth"]),this.eventHelper.add(this.terria.afterWidgetChanged,function(){defined(this._removeSubscription)&&(this._removeSubscription(),this._removeSubscription=void 0)},this);var that=this;function addUpdateSubscription(){if(defined(that.terria)){var scene=that.terria.scene;that._removeSubscription=scene.postRender.addEventListener(function(){!function(viewModel,scene){var now=getTimestamp();if(now<viewModel._lastLegendUpdate+250)return;viewModel._lastLegendUpdate=now;var width=scene.canvas.clientWidth,height=scene.canvas.clientHeight,left=scene.camera.getPickRay(new Cartesian2(width/2|0,height-1)),right=scene.camera.getPickRay(new Cartesian2(1+width/2|0,height-1)),globe=scene.globe,leftPosition=globe.pick(left,scene),rightPosition=globe.pick(right,scene);if(!defined(leftPosition)||!defined(rightPosition))return viewModel.barWidth=void 0,viewModel.distanceLabel=void 0;var leftCartographic=globe.ellipsoid.cartesianToCartographic(leftPosition),rightCartographic=globe.ellipsoid.cartesianToCartographic(rightPosition);geodesic.setEndPoints(leftCartographic,rightCartographic);for(var distance,pixelDistance=geodesic.surfaceDistance,i=distances.length-1;!defined(distance)&&0<=i;--i)distances[i]/pixelDistance<100&&(distance=distances[i]);if(defined(distance)){var label;label=1e3<=distance?(distance/1e3).toString()+" km":distance.toString()+" m",viewModel.barWidth=distance/pixelDistance|0,viewModel.distanceLabel=label}else viewModel.barWidth=void 0,viewModel.distanceLabel=void 0}(this,scene)},that)}else if(defined(that.terria.leaflet)){var map=that.terria.leaflet.map,potentialChangeCallback=function(){updateDistanceLegendLeaflet(that,map)};that._removeSubscription=function(){map.off("zoomend",potentialChangeCallback),map.off("moveend",potentialChangeCallback)},map.on("zoomend",potentialChangeCallback),map.on("moveend",potentialChangeCallback),updateDistanceLegendLeaflet(that,map)}}addUpdateSubscription(),this.eventHelper.add(this.terria.afterWidgetChanged,function(){addUpdateSubscription()},this)};DistanceLegendViewModel.prototype.destroy=function(){this.eventHelper.removeAll()},DistanceLegendViewModel.prototype.show=function(container){loadView('<div class="distance-legend" data-bind="visible: distanceLabel && barWidth"><div class="distance-legend-label" data-bind="text: distanceLabel"></div><div class="distance-legend-scale-bar" data-bind="style: { width: barWidth + \'px\', left: (5 + (125 - barWidth) / 2) + \'px\' }"></div></div>',container,this)},DistanceLegendViewModel.create=function(options){var result=new DistanceLegendViewModel(options);return result.show(options.container),result};var geodesic=new EllipsoidGeodesic,distances=[1,2,3,5,10,20,30,50,100,200,300,500,1e3,2e3,3e3,5e3,1e4,2e4,3e4,5e4,1e5,2e5,3e5,5e5,1e6,2e6,3e6,5e6,1e7,2e7,3e7,5e7];function updateDistanceLegendLeaflet(viewModel,map){var halfHeight=map.getSize().y/2,maxMeters=map.containerPointToLatLng([0,halfHeight]).distanceTo(map.containerPointToLatLng([100,halfHeight])),meters=leaflet.control.scale()._getRoundNum(maxMeters),label=meters<1e3?meters+" m":meters/1e3+" km";viewModel.barWidth=meters/maxMeters*100,viewModel.distanceLabel=label}return DistanceLegendViewModel}),define("ViewModels/UserInterfaceControl",["Cesium/Core/defined","Cesium/Core/defineProperties","Cesium/Core/DeveloperError","KnockoutES5"],function(defined,defineProperties,DeveloperError,Knockout){"use strict";var UserInterfaceControl=function(terria){if(!defined(terria))throw new DeveloperError("terria is required");this._terria=terria,this.name="Unnamed Control",this.text=void 0,this.svgIcon=void 0,this.svgHeight=void 0,this.svgWidth=void 0,this.cssClass=void 0,this.isActive=!1,Knockout.track(this,["name","svgIcon","svgHeight","svgWidth","cssClass","isActive"])};return defineProperties(UserInterfaceControl.prototype,{terria:{get:function(){return this._terria}},hasText:{get:function(){return defined(this.text)&&"string"==typeof this.text}}}),UserInterfaceControl.prototype.activate=function(){throw new DeveloperError("activate must be implemented in the derived class.")},UserInterfaceControl}),define("ViewModels/NavigationControl",["ViewModels/UserInterfaceControl"],function(UserInterfaceControl){"use strict";var NavigationControl=function(terria){UserInterfaceControl.apply(this,arguments)};return NavigationControl.prototype=Object.create(UserInterfaceControl.prototype),NavigationControl}),define("SvgPaths/svgReset",[],function(){"use strict";return"M 7.5,0 C 3.375,0 0,3.375 0,7.5 0,11.625 3.375,15 7.5,15 c 3.46875,0 6.375,-2.4375 7.21875,-5.625 l -1.96875,0 C 12,11.53125 9.9375,13.125 7.5,13.125 4.40625,13.125 1.875,10.59375 1.875,7.5 1.875,4.40625 4.40625,1.875 7.5,1.875 c 1.59375,0 2.90625,0.65625 3.9375,1.6875 l -3,3 6.5625,0 L 15,0 12.75,2.25 C 11.4375,0.84375 9.5625,0 7.5,0 z"}),define("ViewModels/ResetViewNavigationControl",["Cesium/Core/defined","Cesium/Scene/Camera","Cesium/Core/Rectangle","Cesium/Core/Cartographic","ViewModels/NavigationControl","SvgPaths/svgReset"],function(defined,Camera,Rectangle,Cartographic,NavigationControl,svgReset){"use strict";var ResetViewNavigationControl=function(terria){NavigationControl.apply(this,arguments),this.name="复位",this.svgIcon=svgReset,this.svgHeight=15,this.svgWidth=15,this.cssClass="navigation-control-icon-reset"};return(ResetViewNavigationControl.prototype=Object.create(NavigationControl.prototype)).resetView=function(){var scene=this.terria.scene;if(scene.screenSpaceCameraController.enableInputs){this.isActive=!0;var camera=scene.camera;if(defined(this.terria.trackedEntity)){var trackedEntity=this.terria.trackedEntity;this.terria.trackedEntity=void 0,this.terria.trackedEntity=trackedEntity}else if(this.terria.options.defaultResetView){if(this.terria.options.defaultResetView&&this.terria.options.defaultResetView instanceof Cartographic)camera.flyTo({destination:scene.globe.ellipsoid.cartographicToCartesian(this.terria.options.defaultResetView)});else if(this.terria.options.defaultResetView&&this.terria.options.defaultResetView instanceof Rectangle)try{Rectangle.validate(this.terria.options.defaultResetView),camera.flyTo({destination:this.terria.options.defaultResetView})}catch(e){console.log("Cesium-navigation/ResetViewNavigationControl:   options.defaultResetView Cesium rectangle is  invalid!")}}else if("function"==typeof camera.flyHome){var carPos=new Cesium.Cartesian3(113.23333,23.16667,1167385.56),ellipsoid=scene.globe.ellipsoid,pos=Cesium.Cartesian3.fromDegrees(carPos.x,carPos.y,carPos.z,ellipsoid);camera.setView({destination:pos,orientation:{heading:Cesium.Math.toRadians(0),pitch:Cesium.Math.toRadians(-90),roll:0}})}else camera.flyTo({destination:Camera.DEFAULT_VIEW_RECTANGLE,duration:1});this.isActive=!1}},ResetViewNavigationControl.prototype.activate=function(){this.resetView()},ResetViewNavigationControl}),define("Core/Utils",["Cesium/Core/defined","Cesium/Core/Ray","Cesium/Core/Cartesian3","Cesium/Core/Cartographic","Cesium/Core/ReferenceFrame","Cesium/Scene/SceneMode"],function(defined,Ray,Cartesian3,Cartographic,ReferenceFrame,SceneMode){"use strict";var Utils={},unprojectedScratch=new Cartographic,rayScratch=new Ray;return Utils.getCameraFocus=function(terria,inWorldCoordinates,result){var scene=terria.scene,camera=scene.camera;if(scene.mode!=SceneMode.MORPHING&&(defined(result)||(result=new Cartesian3),result=defined(terria.trackedEntity)?terria.trackedEntity.position.getValue(terria.clock.currentTime,result):(rayScratch.origin=camera.positionWC,rayScratch.direction=camera.directionWC,scene.globe.pick(rayScratch,scene,result)),defined(result)))return scene.mode==SceneMode.SCENE2D||scene.mode==SceneMode.COLUMBUS_VIEW?(result=camera.worldToCameraCoordinatesPoint(result,result),inWorldCoordinates&&(result=scene.globe.ellipsoid.cartographicToCartesian(scene.mapProjection.unproject(result,unprojectedScratch),result))):inWorldCoordinates||(result=camera.worldToCameraCoordinatesPoint(result,result)),result},Utils}),define("ViewModels/ZoomNavigationControl",["Cesium/Core/defined","Cesium/Core/Ray","Cesium/Core/IntersectionTests","Cesium/Core/Cartesian3","Cesium/Scene/SceneMode","ViewModels/NavigationControl","Core/Utils"],function(defined,Ray,IntersectionTests,Cartesian3,SceneMode,NavigationControl,Utils){"use strict";var ZoomNavigationControl=function(terria,zoomIn){NavigationControl.apply(this,arguments),this.name="Zoom "+(zoomIn?"In":"Out"),this.text=zoomIn?"+":"-",this.cssClass="navigation-control-icon-zoom-"+(zoomIn?"in":"out"),this.relativeAmount=2,zoomIn&&(this.relativeAmount=1/this.relativeAmount)};ZoomNavigationControl.prototype.relativeAmount=1,(ZoomNavigationControl.prototype=Object.create(NavigationControl.prototype)).activate=function(){this.zoom(this.relativeAmount)};var cartesian3Scratch=new Cartesian3;return ZoomNavigationControl.prototype.zoom=function(relativeAmount){if(this.isActive=!0,defined(this.terria)){var scene=this.terria.scene,sscc=scene.screenSpaceCameraController;if(!sscc.enableInputs||!sscc.enableZoom)return;var orientation,camera=scene.camera;switch(scene.mode){case SceneMode.MORPHING:break;case SceneMode.SCENE2D:camera.zoomIn(camera.positionCartographic.height*(1-this.relativeAmount));break;default:var focus;if(focus=defined(this.terria.trackedEntity)?new Cartesian3:Utils.getCameraFocus(this.terria,!1),defined(focus))orientation={direction:camera.direction,up:camera.up};else{var ray=new Ray(camera.worldToCameraCoordinatesPoint(scene.globe.ellipsoid.cartographicToCartesian(camera.positionCartographic)),camera.directionWC);focus=IntersectionTests.grazingAltitudeLocation(ray,scene.globe.ellipsoid),orientation={heading:camera.heading,pitch:camera.pitch,roll:camera.roll}}var direction=Cartesian3.subtract(camera.position,focus,cartesian3Scratch),movementVector=Cartesian3.multiplyByScalar(direction,relativeAmount,direction),endPosition=Cartesian3.add(focus,movementVector,focus);defined(this.terria.trackedEntity)||scene.mode==SceneMode.COLUMBUS_VIEW?camera.position=endPosition:camera.flyTo({destination:endPosition,orientation:orientation,duration:.5,convert:!1})}}this.isActive=!1},ZoomNavigationControl}),define("SvgPaths/svgCompassOuterRing",[],function(){"use strict";return"m 66.5625,0 0,15.15625 3.71875,0 0,-10.40625 5.5,10.40625 4.375,0 0,-15.15625 -3.71875,0 0,10.40625 L 70.9375,0 66.5625,0 z M 72.5,20.21875 c -28.867432,0 -52.28125,23.407738 -52.28125,52.28125 0,28.87351 23.413818,52.3125 52.28125,52.3125 28.86743,0 52.28125,-23.43899 52.28125,-52.3125 0,-28.873512 -23.41382,-52.28125 -52.28125,-52.28125 z m 0,1.75 c 13.842515,0 26.368948,5.558092 35.5,14.5625 l -11.03125,11 0.625,0.625 11.03125,-11 c 8.9199,9.108762 14.4375,21.579143 14.4375,35.34375 0,13.764606 -5.5176,26.22729 -14.4375,35.34375 l -11.03125,-11 -0.625,0.625 11.03125,11 c -9.130866,9.01087 -21.658601,14.59375 -35.5,14.59375 -13.801622,0 -26.321058,-5.53481 -35.4375,-14.5 l 11.125,-11.09375 c 6.277989,6.12179 14.857796,9.90625 24.3125,9.90625 19.241896,0 34.875,-15.629154 34.875,-34.875 0,-19.245847 -15.633104,-34.84375 -34.875,-34.84375 -9.454704,0 -18.034511,3.760884 -24.3125,9.875 L 37.0625,36.4375 C 46.179178,27.478444 58.696991,21.96875 72.5,21.96875 z m -0.875,0.84375 0,13.9375 1.75,0 0,-13.9375 -1.75,0 z M 36.46875,37.0625 47.5625,48.15625 C 41.429794,54.436565 37.65625,63.027539 37.65625,72.5 c 0,9.472461 3.773544,18.055746 9.90625,24.34375 L 36.46875,107.9375 c -8.96721,-9.1247 -14.5,-21.624886 -14.5,-35.4375 0,-13.812615 5.53279,-26.320526 14.5,-35.4375 z M 72.5,39.40625 c 18.297686,0 33.125,14.791695 33.125,33.09375 0,18.302054 -14.827314,33.125 -33.125,33.125 -18.297687,0 -33.09375,-14.822946 -33.09375,-33.125 0,-18.302056 14.796063,-33.09375 33.09375,-33.09375 z M 22.84375,71.625 l 0,1.75 13.96875,0 0,-1.75 -13.96875,0 z m 85.5625,0 0,1.75 14,0 0,-1.75 -14,0 z M 71.75,108.25 l 0,13.9375 1.71875,0 0,-13.9375 -1.71875,0 z"}),define("SvgPaths/svgCompassGyro",[],function(){"use strict";return"m 72.71875,54.375 c -0.476702,0 -0.908208,0.245402 -1.21875,0.5625 -0.310542,0.317098 -0.551189,0.701933 -0.78125,1.1875 -0.172018,0.363062 -0.319101,0.791709 -0.46875,1.25 -6.91615,1.075544 -12.313231,6.656514 -13,13.625 -0.327516,0.117495 -0.661877,0.244642 -0.9375,0.375 -0.485434,0.22959 -0.901634,0.471239 -1.21875,0.78125 -0.317116,0.310011 -0.5625,0.742111 -0.5625,1.21875 l 0.03125,0 c 0,0.476639 0.245384,0.877489 0.5625,1.1875 0.317116,0.310011 0.702066,0.58291 1.1875,0.8125 0.35554,0.168155 0.771616,0.32165 1.21875,0.46875 1.370803,6.10004 6.420817,10.834127 12.71875,11.8125 0.146999,0.447079 0.30025,0.863113 0.46875,1.21875 0.230061,0.485567 0.470708,0.870402 0.78125,1.1875 0.310542,0.317098 0.742048,0.5625 1.21875,0.5625 0.476702,0 0.876958,-0.245402 1.1875,-0.5625 0.310542,-0.317098 0.582439,-0.701933 0.8125,-1.1875 0.172018,-0.363062 0.319101,-0.791709 0.46875,-1.25 6.249045,-1.017063 11.256351,-5.7184 12.625,-11.78125 0.447134,-0.1471 0.86321,-0.300595 1.21875,-0.46875 0.485434,-0.22959 0.901633,-0.502489 1.21875,-0.8125 0.317117,-0.310011 0.5625,-0.710861 0.5625,-1.1875 l -0.03125,0 c 0,-0.476639 -0.245383,-0.908739 -0.5625,-1.21875 C 89.901633,71.846239 89.516684,71.60459 89.03125,71.375 88.755626,71.244642 88.456123,71.117495 88.125,71 87.439949,64.078341 82.072807,58.503735 75.21875,57.375 c -0.15044,-0.461669 -0.326927,-0.884711 -0.5,-1.25 -0.230061,-0.485567 -0.501958,-0.870402 -0.8125,-1.1875 -0.310542,-0.317098 -0.710798,-0.5625 -1.1875,-0.5625 z m -0.0625,1.40625 c 0.03595,-0.01283 0.05968,0 0.0625,0 0.0056,0 0.04321,-0.02233 0.1875,0.125 0.144288,0.147334 0.34336,0.447188 0.53125,0.84375 0.06385,0.134761 0.123901,0.309578 0.1875,0.46875 -0.320353,-0.01957 -0.643524,-0.0625 -0.96875,-0.0625 -0.289073,0 -0.558569,0.04702 -0.84375,0.0625 C 71.8761,57.059578 71.936151,56.884761 72,56.75 c 0.18789,-0.396562 0.355712,-0.696416 0.5,-0.84375 0.07214,-0.07367 0.120304,-0.112167 0.15625,-0.125 z m 0,2.40625 c 0.448007,0 0.906196,0.05436 1.34375,0.09375 0.177011,0.592256 0.347655,1.271044 0.5,2.03125 0.475097,2.370753 0.807525,5.463852 0.9375,8.9375 -0.906869,-0.02852 -1.834463,-0.0625 -2.78125,-0.0625 -0.92298,0 -1.802327,0.03537 -2.6875,0.0625 0.138529,-3.473648 0.493653,-6.566747 0.96875,-8.9375 0.154684,-0.771878 0.320019,-1.463985 0.5,-2.0625 0.405568,-0.03377 0.804291,-0.0625 1.21875,-0.0625 z m -2.71875,0.28125 c -0.129732,0.498888 -0.259782,0.987558 -0.375,1.5625 -0.498513,2.487595 -0.838088,5.693299 -0.96875,9.25 -3.21363,0.15162 -6.119596,0.480068 -8.40625,0.9375 -0.682394,0.136509 -1.275579,0.279657 -1.84375,0.4375 0.799068,-6.135482 5.504716,-11.036454 11.59375,-12.1875 z M 75.5,58.5 c 6.043169,1.18408 10.705093,6.052712 11.5,12.15625 -0.569435,-0.155806 -1.200273,-0.302525 -1.875,-0.4375 -2.262525,-0.452605 -5.108535,-0.783809 -8.28125,-0.9375 -0.130662,-3.556701 -0.470237,-6.762405 -0.96875,-9.25 C 75.761959,59.467174 75.626981,58.990925 75.5,58.5 z m -2.84375,12.09375 c 0.959338,0 1.895843,0.03282 2.8125,0.0625 C 75.48165,71.267751 75.5,71.871028 75.5,72.5 c 0,1.228616 -0.01449,2.438313 -0.0625,3.59375 -0.897358,0.0284 -1.811972,0.0625 -2.75,0.0625 -0.927373,0 -1.831062,-0.03473 -2.71875,-0.0625 -0.05109,-1.155437 -0.0625,-2.365134 -0.0625,-3.59375 0,-0.628972 0.01741,-1.232249 0.03125,-1.84375 0.895269,-0.02827 1.783025,-0.0625 2.71875,-0.0625 z M 68.5625,70.6875 c -0.01243,0.60601 -0.03125,1.189946 -0.03125,1.8125 0,1.22431 0.01541,2.407837 0.0625,3.5625 -3.125243,-0.150329 -5.92077,-0.471558 -8.09375,-0.90625 -0.784983,-0.157031 -1.511491,-0.316471 -2.125,-0.5 -0.107878,-0.704096 -0.1875,-1.422089 -0.1875,-2.15625 0,-0.115714 0.02849,-0.228688 0.03125,-0.34375 0.643106,-0.20284 1.389577,-0.390377 2.25,-0.5625 2.166953,-0.433487 4.97905,-0.75541 8.09375,-0.90625 z m 8.3125,0.03125 c 3.075121,0.15271 5.824455,0.446046 7.96875,0.875 0.857478,0.171534 1.630962,0.360416 2.28125,0.5625 0.0027,0.114659 0,0.228443 0,0.34375 0,0.735827 -0.07914,1.450633 -0.1875,2.15625 -0.598568,0.180148 -1.29077,0.34562 -2.0625,0.5 -2.158064,0.431708 -4.932088,0.754666 -8.03125,0.90625 0.04709,-1.154663 0.0625,-2.33819 0.0625,-3.5625 0,-0.611824 -0.01924,-1.185379 -0.03125,-1.78125 z M 57.15625,72.5625 c 0.0023,0.572772 0.06082,1.131112 0.125,1.6875 -0.125327,-0.05123 -0.266577,-0.10497 -0.375,-0.15625 -0.396499,-0.187528 -0.665288,-0.387337 -0.8125,-0.53125 -0.147212,-0.143913 -0.15625,-0.182756 -0.15625,-0.1875 0,-0.0047 -0.02221,-0.07484 0.125,-0.21875 0.147212,-0.143913 0.447251,-0.312472 0.84375,-0.5 0.07123,-0.03369 0.171867,-0.06006 0.25,-0.09375 z m 31.03125,0 c 0.08201,0.03503 0.175941,0.05872 0.25,0.09375 0.396499,0.187528 0.665288,0.356087 0.8125,0.5 0.14725,0.14391 0.15625,0.21405 0.15625,0.21875 0,0.0047 -0.009,0.04359 -0.15625,0.1875 -0.147212,0.143913 -0.416001,0.343722 -0.8125,0.53125 -0.09755,0.04613 -0.233314,0.07889 -0.34375,0.125 0.06214,-0.546289 0.09144,-1.094215 0.09375,-1.65625 z m -29.5,3.625 c 0.479308,0.123125 0.983064,0.234089 1.53125,0.34375 2.301781,0.460458 5.229421,0.787224 8.46875,0.9375 0.167006,2.84339 0.46081,5.433176 0.875,7.5 0.115218,0.574942 0.245268,1.063612 0.375,1.5625 -5.463677,-1.028179 -9.833074,-5.091831 -11.25,-10.34375 z m 27.96875,0 C 85.247546,81.408945 80.919274,85.442932 75.5,86.5 c 0.126981,-0.490925 0.261959,-0.967174 0.375,-1.53125 0.41419,-2.066824 0.707994,-4.65661 0.875,-7.5 3.204493,-0.15162 6.088346,-0.480068 8.375,-0.9375 0.548186,-0.109661 1.051942,-0.220625 1.53125,-0.34375 z M 70.0625,77.53125 c 0.865391,0.02589 1.723666,0.03125 2.625,0.03125 0.912062,0 1.782843,-0.0048 2.65625,-0.03125 -0.165173,2.736408 -0.453252,5.207651 -0.84375,7.15625 -0.152345,0.760206 -0.322989,1.438994 -0.5,2.03125 -0.437447,0.03919 -0.895856,0.0625 -1.34375,0.0625 -0.414943,0 -0.812719,-0.02881 -1.21875,-0.0625 -0.177011,-0.592256 -0.347655,-1.271044 -0.5,-2.03125 -0.390498,-1.948599 -0.700644,-4.419842 -0.875,-7.15625 z m 1.75,10.28125 c 0.284911,0.01545 0.554954,0.03125 0.84375,0.03125 0.325029,0 0.648588,-0.01171 0.96875,-0.03125 -0.05999,0.148763 -0.127309,0.31046 -0.1875,0.4375 -0.18789,0.396562 -0.386962,0.696416 -0.53125,0.84375 -0.144288,0.147334 -0.181857,0.125 -0.1875,0.125 -0.0056,0 -0.07446,0.02233 -0.21875,-0.125 C 72.355712,88.946416 72.18789,88.646562 72,88.25 71.939809,88.12296 71.872486,87.961263 71.8125,87.8125 z"}),define("SvgPaths/svgCompassRotationMarker",[],function(){"use strict";return"M 72.46875,22.03125 C 59.505873,22.050338 46.521615,27.004287 36.6875,36.875 L 47.84375,47.96875 C 61.521556,34.240041 83.442603,34.227389 97.125,47.90625 l 11.125,-11.125 C 98.401629,26.935424 85.431627,22.012162 72.46875,22.03125 z"}),define("ViewModels/NavigationViewModel",["Cesium/Core/defined","Cesium/Core/Math","Cesium/Core/getTimestamp","Cesium/Core/EventHelper","Cesium/Core/Transforms","Cesium/Scene/SceneMode","Cesium/Core/Cartesian2","Cesium/Core/Cartesian3","Cesium/Core/Matrix4","Cesium/Core/BoundingSphere","Cesium/Core/HeadingPitchRange","KnockoutES5","Core/loadView","ViewModels/ResetViewNavigationControl","ViewModels/ZoomNavigationControl","SvgPaths/svgCompassOuterRing","SvgPaths/svgCompassGyro","SvgPaths/svgCompassRotationMarker","Core/Utils"],function(defined,CesiumMath,getTimestamp,EventHelper,Transforms,SceneMode,Cartesian2,Cartesian3,Matrix4,BoundingSphere,HeadingPitchRange,Knockout,loadView,ResetViewNavigationControl,ZoomNavigationControl,svgCompassOuterRing,svgCompassGyro,svgCompassRotationMarker,Utils){"use strict";var NavigationViewModel=function(options){this.terria=options.terria,this.eventHelper=new EventHelper,this.controls=options.controls,defined(this.controls)||(this.controls=[new ZoomNavigationControl(this.terria,!0),new ResetViewNavigationControl(this.terria),new ZoomNavigationControl(this.terria,!1)]),this.svgCompassOuterRing=svgCompassOuterRing,this.svgCompassGyro=svgCompassGyro,this.svgCompassRotationMarker=svgCompassRotationMarker,this.showCompass=defined(this.terria),this.heading=this.showCompass?this.terria.scene.camera.heading:0,this.isOrbiting=!1,this.orbitCursorAngle=0,this.orbitCursorOpacity=0,this.orbitLastTimestamp=0,this.orbitFrame=void 0,this.orbitIsLook=!1,this.orbitMouseMoveFunction=void 0,this.orbitMouseUpFunction=void 0,this.isRotating=!1,this.rotateInitialCursorAngle=void 0,this.rotateFrame=void 0,this.rotateIsLook=!1,this.rotateMouseMoveFunction=void 0,this.rotateMouseUpFunction=void 0,this._unsubcribeFromPostRender=void 0,Knockout.track(this,["controls","showCompass","heading","isOrbiting","orbitCursorAngle","isRotating"]);var that=this;function widgetChange(){defined(that.terria)?(that._unsubcribeFromPostRender&&(that._unsubcribeFromPostRender(),that._unsubcribeFromPostRender=void 0),that.showCompass=!0,that._unsubcribeFromPostRender=that.terria.scene.postRender.addEventListener(function(){that.heading=that.terria.scene.camera.heading})):(that._unsubcribeFromPostRender&&(that._unsubcribeFromPostRender(),that._unsubcribeFromPostRender=void 0),that.showCompass=!1)}this.eventHelper.add(this.terria.afterWidgetChanged,widgetChange,this),widgetChange()};NavigationViewModel.prototype.destroy=function(){this.eventHelper.removeAll()},NavigationViewModel.prototype.show=function(container){loadView('<div class="compass" title="拖拽外环: 旋转视图. 拖拽内部: 自由视角控制.双击: 回到操作前状态.提示: 同时您可以拖拽地图控制3D视图." data-bind="visible: showCompass, event: { mousedown: handleMouseDown, dblclick: handleDoubleClick }"><div class="compass-outer-ring-background"></div>'+" <div class=\"compass-rotation-marker\" data-bind=\"visible: isOrbiting, style: { transform: 'rotate(-' + orbitCursorAngle + 'rad)', '-webkit-transform': 'rotate(-' + orbitCursorAngle + 'rad)', opacity: orbitCursorOpacity }, cesiumSvgPath: { path: svgCompassRotationMarker, width: 145, height: 145 }\"></div> <div class=\"compass-outer-ring\" title=\"鼠标按下后拖拽可以旋转视图\" data-bind=\"style: { transform: 'rotate(-' + heading + 'rad)', '-webkit-transform': 'rotate(-' + heading + 'rad)' }, cesiumSvgPath: { path: svgCompassOuterRing, width: 145, height: 145 }\"></div> <div class=\"compass-gyro-background\"></div> <div class=\"compass-gyro\" data-bind=\"cesiumSvgPath: { path: svgCompassGyro, width: 145, height: 145 }, css: { 'compass-gyro-active': isOrbiting }\"></div></div><div class=\"navigation-controls\">\x3c!-- ko foreach: controls --\x3e<div data-bind=\"click: activate, attr: { title: $data.title }, css: $root.isLastControl($data) ? 'navigation-control-last' : 'navigation-control' \">   \x3c!-- ko if: $data.hasText --\x3e   <div data-bind=\"text: $data.text, css: $data.isActive ?  'navigation-control-icon-active ' + $data.cssClass : $data.cssClass\"></div>   \x3c!-- /ko --\x3e  \x3c!-- ko ifnot: $data.hasText --\x3e  <div data-bind=\"cesiumSvgPath: { path: $data.svgIcon, width: $data.svgWidth, height: $data.svgHeight }, css: $data.isActive ?  'navigation-control-icon-active ' + $data.cssClass : $data.cssClass\"></div>  \x3c!-- /ko --\x3e </div> \x3c!-- /ko --\x3e</div>",container,this)},NavigationViewModel.prototype.add=function(control){this.controls.push(control)},NavigationViewModel.prototype.remove=function(control){this.controls.remove(control)},NavigationViewModel.prototype.isLastControl=function(control){return control===this.controls[this.controls.length-1]};var vectorScratch=new Cartesian2;NavigationViewModel.prototype.handleMouseDown=function(viewModel,e){if(this.terria.scene.mode==SceneMode.MORPHING)return!0;var compassElement=e.currentTarget,compassRectangle=e.currentTarget.getBoundingClientRect(),maxDistance=compassRectangle.width/2,center=new Cartesian2((compassRectangle.right-compassRectangle.left)/2,(compassRectangle.bottom-compassRectangle.top)/2),clickLocation=new Cartesian2(e.clientX-compassRectangle.left,e.clientY-compassRectangle.top),vector=Cartesian2.subtract(clickLocation,center,vectorScratch),distanceFraction=Cartesian2.magnitude(vector)/maxDistance;if(distanceFraction<50/145)!function(viewModel,compassElement,cursorVector){var scene=viewModel.terria.scene,sscc=scene.screenSpaceCameraController;if(scene.mode==SceneMode.MORPHING||!sscc.enableInputs)return;switch(scene.mode){case SceneMode.COLUMBUS_VIEW:if(sscc.enableLook)break;if(!sscc.enableTranslate||!sscc.enableTilt)return;break;case SceneMode.SCENE3D:if(sscc.enableLook)break;if(!sscc.enableTilt||!sscc.enableRotate)return;break;case SceneMode.SCENE2D:if(!sscc.enableTranslate)return}document.removeEventListener("mousemove",viewModel.orbitMouseMoveFunction,!1),document.removeEventListener("mouseup",viewModel.orbitMouseUpFunction,!1),defined(viewModel.orbitTickFunction)&&viewModel.terria.clock.onTick.removeEventListener(viewModel.orbitTickFunction);viewModel.orbitMouseMoveFunction=void 0,viewModel.orbitMouseUpFunction=void 0,viewModel.orbitTickFunction=void 0,viewModel.isOrbiting=!0,viewModel.orbitLastTimestamp=getTimestamp();var camera=scene.camera;if(defined(viewModel.terria.trackedEntity))viewModel.orbitFrame=void 0,viewModel.orbitIsLook=!1;else{var center=Utils.getCameraFocus(viewModel.terria,!0,centerScratch);defined(center)?(viewModel.orbitFrame=Transforms.eastNorthUpToFixedFrame(center,scene.globe.ellipsoid,newTransformScratch),viewModel.orbitIsLook=!1):(viewModel.orbitFrame=Transforms.eastNorthUpToFixedFrame(camera.positionWC,scene.globe.ellipsoid,newTransformScratch),viewModel.orbitIsLook=!0)}function updateAngleAndOpacity(vector,compassWidth){var angle=Math.atan2(-vector.y,vector.x);viewModel.orbitCursorAngle=CesiumMath.zeroToTwoPi(angle-CesiumMath.PI_OVER_TWO);var distance=Cartesian2.magnitude(vector),maxDistance=compassWidth/2,distanceFraction=Math.min(distance/maxDistance,1),easedOpacity=.5*distanceFraction*distanceFraction+.5;viewModel.orbitCursorOpacity=easedOpacity}viewModel.orbitTickFunction=function(e){var oldTransform,timestamp=getTimestamp(),deltaT=timestamp-viewModel.orbitLastTimestamp,rate=2.5*(viewModel.orbitCursorOpacity-.5)/1e3,distance=deltaT*rate,angle=viewModel.orbitCursorAngle+CesiumMath.PI_OVER_TWO,x=Math.cos(angle)*distance,y=Math.sin(angle)*distance;defined(viewModel.orbitFrame)&&(oldTransform=Matrix4.clone(camera.transform,oldTransformScratch),camera.lookAtTransform(viewModel.orbitFrame)),scene.mode==SceneMode.SCENE2D?camera.move(new Cartesian3(x,y,0),Math.max(scene.canvas.clientWidth,scene.canvas.clientHeight)/100*camera.positionCartographic.height*distance):viewModel.orbitIsLook?(camera.look(Cartesian3.UNIT_Z,-x),camera.look(camera.right,-y)):(camera.rotateLeft(x),camera.rotateUp(y)),defined(viewModel.orbitFrame)&&camera.lookAtTransform(oldTransform),viewModel.orbitLastTimestamp=timestamp},viewModel.orbitMouseMoveFunction=function(e){var compassRectangle=compassElement.getBoundingClientRect(),center=new Cartesian2((compassRectangle.right-compassRectangle.left)/2,(compassRectangle.bottom-compassRectangle.top)/2),clickLocation=new Cartesian2(e.clientX-compassRectangle.left,e.clientY-compassRectangle.top),vector=Cartesian2.subtract(clickLocation,center,vectorScratch);updateAngleAndOpacity(vector,compassRectangle.width)},viewModel.orbitMouseUpFunction=function(e){viewModel.isOrbiting=!1,document.removeEventListener("mousemove",viewModel.orbitMouseMoveFunction,!1),document.removeEventListener("mouseup",viewModel.orbitMouseUpFunction,!1),defined(viewModel.orbitTickFunction)&&viewModel.terria.clock.onTick.removeEventListener(viewModel.orbitTickFunction),viewModel.orbitMouseMoveFunction=void 0,viewModel.orbitMouseUpFunction=void 0,viewModel.orbitTickFunction=void 0},document.addEventListener("mousemove",viewModel.orbitMouseMoveFunction,!1),document.addEventListener("mouseup",viewModel.orbitMouseUpFunction,!1),viewModel.terria.clock.onTick.addEventListener(viewModel.orbitTickFunction),updateAngleAndOpacity(cursorVector,compassElement.getBoundingClientRect().width)}(this,compassElement,vector);else{if(!(distanceFraction<1))return!0;!function(viewModel,compassElement,cursorVector){var oldTransform,scene=viewModel.terria.scene,camera=scene.camera,sscc=scene.screenSpaceCameraController;if(scene.mode==SceneMode.MORPHING||scene.mode==SceneMode.SCENE2D||!sscc.enableInputs)return;if(!sscc.enableLook&&(scene.mode==SceneMode.COLUMBUS_VIEW||scene.mode==SceneMode.SCENE3D&&!sscc.enableRotate))return;if(document.removeEventListener("mousemove",viewModel.rotateMouseMoveFunction,!1),document.removeEventListener("mouseup",viewModel.rotateMouseUpFunction,!1),viewModel.rotateMouseMoveFunction=void 0,viewModel.rotateMouseUpFunction=void 0,viewModel.isRotating=!0,viewModel.rotateInitialCursorAngle=Math.atan2(-cursorVector.y,cursorVector.x),defined(viewModel.terria.trackedEntity))viewModel.rotateFrame=void 0,viewModel.rotateIsLook=!1;else{var viewCenter=Utils.getCameraFocus(viewModel.terria,!0,centerScratch);defined(viewCenter)&&(scene.mode!=SceneMode.COLUMBUS_VIEW||sscc.enableLook||sscc.enableTranslate)?(viewModel.rotateFrame=Transforms.eastNorthUpToFixedFrame(viewCenter,scene.globe.ellipsoid,newTransformScratch),viewModel.rotateIsLook=!1):(viewModel.rotateFrame=Transforms.eastNorthUpToFixedFrame(camera.positionWC,scene.globe.ellipsoid,newTransformScratch),viewModel.rotateIsLook=!0)}defined(viewModel.rotateFrame)&&(oldTransform=Matrix4.clone(camera.transform,oldTransformScratch),camera.lookAtTransform(viewModel.rotateFrame));viewModel.rotateInitialCameraAngle=-camera.heading,defined(viewModel.rotateFrame)&&camera.lookAtTransform(oldTransform);viewModel.rotateMouseMoveFunction=function(e){var oldTransform,compassRectangle=compassElement.getBoundingClientRect(),center=new Cartesian2((compassRectangle.right-compassRectangle.left)/2,(compassRectangle.bottom-compassRectangle.top)/2),clickLocation=new Cartesian2(e.clientX-compassRectangle.left,e.clientY-compassRectangle.top),vector=Cartesian2.subtract(clickLocation,center,vectorScratch),angle=Math.atan2(-vector.y,vector.x),angleDifference=angle-viewModel.rotateInitialCursorAngle,newCameraAngle=CesiumMath.zeroToTwoPi(viewModel.rotateInitialCameraAngle-angleDifference),camera=viewModel.terria.scene.camera;defined(viewModel.rotateFrame)&&(oldTransform=Matrix4.clone(camera.transform,oldTransformScratch),camera.lookAtTransform(viewModel.rotateFrame));var currentCameraAngle=-camera.heading;camera.rotateRight(newCameraAngle-currentCameraAngle),defined(viewModel.rotateFrame)&&camera.lookAtTransform(oldTransform)},viewModel.rotateMouseUpFunction=function(e){viewModel.isRotating=!1,document.removeEventListener("mousemove",viewModel.rotateMouseMoveFunction,!1),document.removeEventListener("mouseup",viewModel.rotateMouseUpFunction,!1),viewModel.rotateMouseMoveFunction=void 0,viewModel.rotateMouseUpFunction=void 0},document.addEventListener("mousemove",viewModel.rotateMouseMoveFunction,!1),document.addEventListener("mouseup",viewModel.rotateMouseUpFunction,!1)}(this,compassElement,vector)}};var oldTransformScratch=new Matrix4,newTransformScratch=new Matrix4,centerScratch=new Cartesian3;return NavigationViewModel.prototype.handleDoubleClick=function(viewModel,e){var scene=viewModel.terria.scene,camera=scene.camera,sscc=scene.screenSpaceCameraController;if(scene.mode==SceneMode.MORPHING||!sscc.enableInputs)return!0;if(scene.mode!=SceneMode.COLUMBUS_VIEW||sscc.enableTranslate){if(scene.mode==SceneMode.SCENE3D||scene.mode==SceneMode.COLUMBUS_VIEW){if(!sscc.enableLook)return;if(scene.mode==SceneMode.SCENE3D&&!sscc.enableRotate)return}var center=Utils.getCameraFocus(viewModel.terria,!0,centerScratch);if(defined(center)){var cameraPosition=scene.globe.ellipsoid.cartographicToCartesian(camera.positionCartographic,new Cartesian3),surfaceNormal=scene.globe.ellipsoid.geodeticSurfaceNormal(center),focusBoundingSphere=new BoundingSphere(center,0);camera.flyToBoundingSphere(focusBoundingSphere,{offset:new HeadingPitchRange(0,CesiumMath.PI_OVER_TWO-Cartesian3.angleBetween(surfaceNormal,camera.directionWC),Cartesian3.distance(cameraPosition,center)),duration:1.5})}else this.controls[1].resetView()}},NavigationViewModel.create=function(options){var result=new NavigationViewModel(options);return result.show(options.container),result},NavigationViewModel}),define("CesiumNavigation",["Cesium/Core/defined","Cesium/Core/defineProperties","Cesium/Core/Event","KnockoutES5","Core/registerKnockoutBindings","ViewModels/DistanceLegendViewModel","ViewModels/NavigationViewModel"],function(defined,defineProperties,CesiumEvent,Knockout,registerKnockoutBindings,DistanceLegendViewModel,NavigationViewModel){"use strict";var CesiumNavigation=function(viewerCesiumWidget){(function(viewerCesiumWidget,options){if(!defined(viewerCesiumWidget))throw new DeveloperError("CesiumWidget or Viewer is required.");var cesiumWidget=defined(viewerCesiumWidget.cesiumWidget)?viewerCesiumWidget.cesiumWidget:viewerCesiumWidget,container=document.createElement("div");container.className="cesium-widget-cesiumNavigationContainer",cesiumWidget.container.appendChild(container),this.terria=viewerCesiumWidget,this.terria.options=options,this.terria.afterWidgetChanged=new CesiumEvent,this.terria.beforeWidgetChanged=new CesiumEvent,this.container=container,this.navigationDiv=document.createElement("div"),this.navigationDiv.setAttribute("id","navigationDiv"),this.distanceLegendDiv=document.createElement("div"),this.navigationDiv.setAttribute("id","distanceLegendDiv"),container.appendChild(this.navigationDiv),container.appendChild(this.distanceLegendDiv),registerKnockoutBindings(),this.distanceLegendViewModel=DistanceLegendViewModel.create({container:this.distanceLegendDiv,terria:this.terria,mapElement:container}),this.navigationViewModel=NavigationViewModel.create({container:this.navigationDiv,terria:this.terria})}).apply(this,arguments),this._onDestroyListeners=[]};return CesiumNavigation.prototype.distanceLegendViewModel=void 0,CesiumNavigation.prototype.navigationViewModel=void 0,CesiumNavigation.prototype.navigationDiv=void 0,CesiumNavigation.prototype.distanceLegendDiv=void 0,CesiumNavigation.prototype.terria=void 0,CesiumNavigation.prototype.container=void 0,CesiumNavigation.prototype._onDestroyListeners=void 0,CesiumNavigation.prototype.destroy=function(){defined(this.navigationViewModel)&&this.navigationViewModel.destroy(),defined(this.distanceLegendViewModel)&&this.distanceLegendViewModel.destroy(),defined(this.navigationDiv)&&this.navigationDiv.parentNode.removeChild(this.navigationDiv),delete this.navigationDiv,defined(this.distanceLegendDiv)&&this.distanceLegendDiv.parentNode.removeChild(this.distanceLegendDiv),delete this.distanceLegendDiv,defined(this.container)&&this.container.parentNode.removeChild(this.container),delete this.container;for(var i=0;i<this._onDestroyListeners.length;i++)this._onDestroyListeners[i]()},CesiumNavigation.prototype.addOnDestroyListener=function(callback){"function"==typeof callback&&this._onDestroyListeners.push(callback)},CesiumNavigation}),define("dummy/require-less/less/dummy",[],function(){}),define("viewerCesiumNavigationMixin",["Cesium/Core/defined","Cesium/Core/defineProperties","Cesium/Core/DeveloperError","CesiumNavigation","dummy/require-less/less/dummy"],function(defined,defineProperties,DeveloperError,CesiumNavigation){"use strict";function viewerCesiumNavigationMixin(viewer,options){if(!defined(viewer))throw new DeveloperError("viewer is required.");init(viewer,options).addOnDestroyListener(function(viewer){return function(){delete viewer.cesiumNavigation}}(viewer)),defineProperties(viewer,{cesiumNavigation:{configurable:!0,get:function(){return viewer.cesiumWidget.cesiumNavigation}}})}viewerCesiumNavigationMixin.mixinWidget=function(cesiumWidget,options){return init.apply(void 0,arguments)};var init=function(viewerCesiumWidget,options){var cesiumNavigation=new CesiumNavigation(viewerCesiumWidget,options),cesiumWidget=defined(viewerCesiumWidget.cesiumWidget)?viewerCesiumWidget.cesiumWidget:viewerCesiumWidget;return defineProperties(cesiumWidget,{cesiumNavigation:{configurable:!0,get:function(){return cesiumNavigation}}}),cesiumNavigation.addOnDestroyListener(function(cesiumWidget){return function(){delete cesiumWidget.cesiumNavigation}}(cesiumWidget)),cesiumNavigation};return viewerCesiumNavigationMixin}),c=".full-window{position:absolute;top:0;left:0;right:0;bottom:0;margin:0;overflow:hidden;padding:0;-webkit-transition:left .25s ease-out;-moz-transition:left .25s ease-out;-ms-transition:left .25s ease-out;-o-transition:left .25s ease-out;transition:left .25s ease-out}.transparent-to-input{pointer-events:none}.opaque-to-input{pointer-events:auto}.clickable{cursor:pointer}.markdown a:hover,.markdown u,a:hover{text-decoration:underline}.modal,.modal-background{top:0;left:0;bottom:0;right:0}.modal-background{pointer-events:auto;background-color:rgba(0,0,0,.5);z-index:1000;position:fixed}.modal{position:absolute;margin:auto;background-color:#2f353c;max-height:100%;max-width:100%;font-family:'Roboto',sans-serif;color:#fff}.modal-header{background-color:rgba(0,0,0,.2);border-bottom:1px solid rgba(100,100,100,.6);font-size:15px;line-height:40px;margin:0}.modal-header h1{font-size:15px;color:#fff;margin-left:15px}.modal-content{margin-left:15px;margin-right:15px;margin-bottom:15px;padding-top:15px;overflow:auto}.modal-close-button{position:absolute;right:15px;cursor:pointer;font-size:18px;color:#fff}#ui{z-index:2100}@media print{.full-window{position:initial}}.markdown img{max-width:100%}.markdown svg{max-height:100%}.markdown fieldset,.markdown input,.markdown select,.markdown textarea{font-family:inherit;font-size:1rem;box-sizing:border-box;margin-top:0;margin-bottom:0}.markdown label{vertical-align:middle}.markdown h1,.markdown h2,.markdown h3,.markdown h4,.markdown h5,.markdown h6{font-family:inherit;font-weight:700;line-height:1.25;margin-top:1em;margin-bottom:.5em}.markdown h1{font-size:2rem}.markdown h2{font-size:1.5rem}.markdown h3{font-size:1.25rem}.markdown h4{font-size:1rem}.markdown h5{font-size:.875rem}.markdown h6{font-size:.75rem}.markdown dl,.markdown ol,.markdown p,.markdown ul{margin-top:0;margin-bottom:1rem}.markdown strong{font-weight:700}.markdown em{font-style:italic}.markdown small{font-size:80%}.markdown mark{color:#000;background:#ff0}.markdown s{text-decoration:line-through}.markdown ol{list-style:decimal inside}.markdown ul{list-style:disc inside}.markdown code,.markdown pre,.markdown samp{font-family:monospace;font-size:inherit}.markdown pre{margin-top:0;margin-bottom:1rem;overflow-x:scroll}.markdown a{color:#68adfe;text-decoration:none}.markdown code,.markdown pre{background-color:transparent;border-radius:3px}.markdown hr{border:0;border-bottom-style:solid;border-bottom-width:1px;border-bottom-color:rgba(0,0,0,.125)}.markdown .left-align{text-align:left}.markdown .center{text-align:center}.markdown .right-align{text-align:right}.markdown .justify{text-align:justify}.markdown .truncate{max-width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.markdown ol.upper-roman{list-style-type:upper-roman}.markdown ol.lower-alpha{list-style-type:lower-alpha}.markdown ul.circle{list-style-type:circle}.markdown ul.square{list-style-type:square}.markdown .list-reset{list-style:none;padding-left:0}.floating,.floating-horizontal,.floating-vertical{pointer-events:auto;position:absolute;border-radius:15px;background-color:rgba(47,53,60,.8)}.floating-horizontal{padding-left:5px;padding-right:5px}.floating-vertical{padding-top:5px;padding-bottom:5px}@media print{.floating{display:none}}.distance-legend{display:none;pointer-events:auto;position:absolute;border-radius:1px;background-color:rgba(68,79,91,0.5);padding-left:3px;padding-right:3px;right:1px;bottom:1px;height:26px;width:125px;border:1px solid rgba(68,79,91,0.5);box-sizing:content-box}.distance-legend-label{display:inline-block;font-family:'Roboto',sans-serif;font-size:12px;font-weight:lighter;line-height:22px;color:#fff;width:125px;text-align:center}.distance-legend-scale-bar{border-left:1px solid #fff;border-right:1px solid #fff;border-bottom:1px solid #fff;position:absolute;height:10px;top:15px}@media print{.distance-legend{display:none}}@media screen and (max-width:700px),screen and (max-height:420px){.distance-legend{display:none}}.navigation-controls{position:absolute;right:30px;top:110px;width:30px;background:rgba(0,60,136,.7);border:1px solid rgba(255,255,255,.1);font-weight:300;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.navigation-control{cursor:pointer;border-bottom:1px solid #555}.naviagation-control:active{color:#fff}.navigation-control-last{cursor:pointer;border-bottom:0}.navigation-control-icon-zoom-in{padding-bottom:4px}.navigation-control-icon-zoom-in,.navigation-control-icon-zoom-out{position:relative;text-align:center;font-size:20px;color:#fff}.navigation-control-icon-reset{position:relative;left:10px;width:10px;height:10px;fill:rgba(255,255,255,.8);padding-top:6px;padding-bottom:6px;box-sizing:content-box}.compass,.compass-outer-ring{position:absolute;width:95px;height:95px}.compass{pointer-events:auto;right:0;overflow:hidden;top:10px}.compass-outer-ring{top:0;fill:rgba(255,255,255,.5)}.compass-outer-ring-background{position:absolute;top:14px;left:14px;width:44px;height:44px;border-radius:44px;border:12px solid rgba(0,60,136,.6);box-sizing:content-box}.compass-gyro{pointer-events:none;position:absolute;top:0;width:95px;height:95px;fill:#ccc}.compass-gyro-active,.compass-gyro-background:hover+.compass-gyro{fill:#68adfe}.compass-gyro-background{position:absolute;top:30px;left:30px;width:33px;height:33px;border-radius:33px;background-color:rgba(0,60,136,.6);border:1px solid rgba(255,255,255,.2);box-sizing:content-box}.compass-rotation-marker{position:absolute;top:0;width:95px;height:95px;fill:#68adfe}@media screen and (max-width:700px),screen and (max-height:420px){.compass,.navigation-controls{display:none}}@media print{.compass,.navigation-controls{display:none}}",d=document,a="appendChild",i="styleSheet",(s=d.createElement("style")).type="text/css",d.getElementsByTagName("head")[0][a](s),s[i]?s[i].cssText=c:s[a](d.createTextNode(c)),define("Cesium/Core/defined",function(){return Cesium.defined}),define("Cesium/Core/defineProperties",function(){return Cesium.defineProperties}),define("Cesium/Core/defaultValue",function(){return Cesium.defaultValue}),define("Cesium/Core/Event",function(){return Cesium.Event}),define("Cesium/Widgets/getElement",function(){return Cesium.getElement}),define("Cesium/Widgets/SvgPathBindingHandler",function(){return Cesium.SvgPathBindingHandler}),define("Cesium/Core/Ray",function(){return Cesium.Ray}),define("Cesium/Core/Cartesian3",function(){return Cesium.Cartesian3}),define("Cesium/Core/Cartographic",function(){return Cesium.Cartographic}),define("Cesium/Core/ReferenceFrame",function(){return Cesium.ReferenceFrame}),define("Cesium/Scene/SceneMode",function(){return Cesium.SceneMode}),define("Cesium/Core/DeveloperError",function(){return Cesium.DeveloperError}),define("Cesium/Core/EllipsoidGeodesic",function(){return Cesium.EllipsoidGeodesic}),define("Cesium/Core/Cartesian2",function(){return Cesium.Cartesian2}),define("Cesium/Core/getTimestamp",function(){return Cesium.getTimestamp}),define("Cesium/Core/EventHelper",function(){return Cesium.EventHelper}),define("Cesium/Core/Math",function(){return Cesium.Math}),define("Cesium/Core/Transforms",function(){return Cesium.Transforms}),define("Cesium/Core/Matrix4",function(){return Cesium.Matrix4}),define("Cesium/Core/BoundingSphere",function(){return Cesium.BoundingSphere}),define("Cesium/Core/HeadingPitchRange",function(){return Cesium.HeadingPitchRange}),define("Cesium/Scene/Camera",function(){return Cesium.Camera}),define("Cesium/Core/Rectangle",function(){return Cesium.Rectangle}),define("Cesium/Core/IntersectionTests",function(){return Cesium.IntersectionTests}),require("viewerCesiumNavigationMixin")});var globeMap3D={},Map3DSDK=Map3DSDK||{};!function(){var map3d=Map3DSDK.Map=function(divID,tileOptions,viewOptions){var terrain=null,images=null;viewOptions&&null!=viewOptions&&null!=viewOptions&&(viewOptions.terrain&&(terrain=viewOptions.terrain),images=viewOptions.images?viewOptions.images:[{name:"google",type:"UrlTemplate",url:"http://www.google.cn/maps/vt?lyrs=s@748&gl=cn&x={x}&y={y}&z={z}",visible:!0,maximumLevel:14,scheme:"Geographic-level-0"}]);var cegoreParam=null;cegoreParam=null!=terrain?{fullscreenElement:divID,fullscreenButton:!1,geocoder:!0,sceneMode:Cesium.defaultValue(viewOptions.sceneMode,Cesium.SceneMode.SCENE3D),terrain:terrain,images:images,currentTime:new Date(2017,12,26,12,0,0)}:{fullscreenElement:divID,fullscreenButton:!1,sceneMode:Cesium.defaultValue(viewOptions.sceneMode,Cesium.SceneMode.SCENE3D),geocoder:!0,images:images,currentTime:new Date(2017,12,26,12,0,0)};var cegore=new Cegore.Viewer(divID,cegoreParam);cegore.camera.setView({rect:[-95.59,40.03,-95.6,40.04]}),this.divID=divID,this.cegore=cegore,this.cesium=cegore._czData,(globeMap3D[divID]=this).handlerArray=[],this.dmap=[61437120,30718560,22914940,15003300,7679640,3839820,1484560,763e3,381010,196080,91300,46070,23210,11290,5730,2900,1450,750,360,180,100,50],this.Keyflags={looking:!0,moveUp:!1,moveLeft:!1,moveRight:!1,moveForward:!1,moveBackward:!1},this.controls={},this.layerMap={},(viewOptions=viewOptions||{}).navigation&&this.cesium.viewer.extend(Cesium.viewerCesiumNavigationMixin,{}),Map3DSDK.map3DView=this};function GetActiveMap(){var map=null;for(var key in globeMap3D){map=globeMap3D[key];break}return map}map3d.prototype.GetCegore=function(){return this.cegore},map3d.prototype.GetCesium=function(){return this.cesium},map3d.prototype.EnableDebug=function(enable){enable&&this.cesium.viewer.extend(Cesium.viewerCesiumInspectorMixin)},map3d.prototype.GetMap=function(){return this.cesium},map3d.prototype.GetView=function(){return this.cesium.viewer},map3d.prototype.SetKeyBoardMsg=function(options){this.Keyflags=options},map3d.prototype.GetKeyBoardMsg=function(){return this.Keyflags},map3d.prototype.RegisterKeyBoard=function(){var viewer=this.GetView(),canvas=viewer.canvas,ellipsoid=viewer.scene.globe.ellipsoid,flags=(new Cesium.ScreenSpaceEventHandler(canvas),this.Keyflags);viewer.clock.onTick.addEventListener(function(clock){var camera=viewer.camera,moveRate=ellipsoid.cartesianToCartographic(camera.position).height/100;flags.moveForward&&camera.moveForward(moveRate),flags.moveBackward&&camera.moveBackward(moveRate),flags.moveUp&&camera.moveUp(moveRate),flags.moveDown&&camera.moveDown(moveRate),flags.moveLeft&&camera.moveLeft(moveRate),flags.moveRight&&camera.moveRight(moveRate)})},map3d.prototype.JW2MapExtent=function(srcExtent){var JWExtent=srcExtent;if("EPSG:900913"==this.GetProjectCode()){var min=Map3DSDK.Convert("EPSG:4326","EPSG:900913",[srcExtent[0],srcExtent[1]]),max=Map3DSDK.Convert("EPSG:4326","EPSG:900913",[srcExtent[2],srcExtent[3]]);JWExtent=[min[0],min[1],max[0],max[1]]}return JWExtent},map3d.prototype.IsInView=function(cen){var mapCoord=this.JW2MapCoord(cen),rect=this.GetViewRect();return!(mapCoord[0]<rect[0]||mapCoord[0]>rect[2]||mapCoord[1]<rect[1]||mapCoord[1]>rect[3])},map3d.prototype.CenterAndZoom=function(cen,zoom){this.SetViewCenter(cen[0],cen[1]),this.SetZoom(zoom)},map3d.prototype.AddTileMapLayer=function(catalogName){var imageLayer=new Cegore.ImageLayer({name:catalogName,type:"ZMapImage",url:GetGISServerAddress()+"zs/catalogws/data"+catalogName+"/tile/map",visible:!1,maximumLevel:18,scheme:"Geographic-level-0"});return this.AddLayer(imageLayer)},map3d.prototype.AddLayer=function(layer){try{var name=this.GetLayerName(layer);if(this.layerMap[name])throw"exist layer: "+name;var ceisum=this.GetMap(),n=ceisum.viewer.imageryLayers.length;ceisum.viewer.imageryLayers.add(layer._czLayer,n),this.layerMap[layer.name]=layer}catch(e){return null}},map3d.prototype.GetLayerName=function(layer){return layer.name},map3d.prototype.GetUnkLayer=function(name){this.GetMap();var layer=this.layerMap[name];return null==layer&&(layer=this.GetCegore().images.get(name))&&(this.layerMap[name]=layer),layer},map3d.prototype._GetInnerZMapLayer=function(layer){return"string"==typeof layer?this.GetUnkLayer(layer):layer instanceof Cesium.ImageryLayer?layer._ZMapLayer:(Cegore.NetCDFImageLayer,layer)},map3d.prototype._GetCzLayer=function(layer){return"string"==typeof layer?rLayer=this.GetUnkLayer(layer):layer instanceof"ImageryLayer"?rLayer=layer._ZMapLayer:layer instanceof"NetCDFImageLayer"&&(rLayer=layer),rLayer._czLayer},map3d.prototype.RemoveLayer=function(layer){var fname,rLayer=this._GetInnerZMapLayer(layer);if(null!=rLayer){fname=rLayer.name;var name=this.GetLayerName(rLayer);delete this.layerMap[name];for(var ceisum=this.GetMap(),size=ceisum.viewer.imageryLayers.length,i=0;i<size;i++){if((name=(layer=ceisum.viewer.imageryLayers._layers[i])._ZMapLayer.name)==fname){ceisum.viewer.imageryLayers.remove(layer);break}}}},map3d.prototype.GetLayers=function(){var layer=[];for(var key in this.layerMap)layer.push(this.layerMap[key]);return layer},map3d.prototype.SetVisible=function(unkLayerName,visible){var layer=this._GetCzLayer(unkLayerName);layer&&(layer.show=visible)},map3d.prototype.IsVisible=function(unkLayerName){return this._GetCzLayer(unkLayerName).show},map3d.prototype.JW2MapCoord=function(srccoord){return srccoord},map3d.prototype.GetCameraParams=function(){this.GetView()},map3d.prototype.GetViewCenter=function(){var viewer=this.GetView(),result=viewer.camera.pickEllipsoid(new Cesium.Cartesian2(viewer.canvas.clientWidth/2,viewer.canvas.clientHeight/2)),curPosition=Cesium.Ellipsoid.WGS84.cartesianToCartographic(result);return[180*curPosition.longitude/Math.PI,180*curPosition.latitude/Math.PI,curPosition.height]},map3d.prototype.FlyTo=function(x,y,options){options=options||{};var camera=this.GetView().camera,height=options.height?options.height:15e4,carPos=new Cesium.Cartesian3(x,y,height),ellipsoid=(camera=this.GetView().camera,this.GetView().scene.globe.ellipsoid),destination=Cesium.Cartesian3.fromDegrees(carPos.x,carPos.y,carPos.z,ellipsoid);camera.flyTo({destination:destination,duration:options.duration?options.duration:2,orientation:{heading:Cesium.Math.toRadians(options.heading?options.heading:0),pitch:Cesium.Math.toRadians(options.pitch?options.pitch:-90),roll:Cesium.Math.toRadians(options.roll?options.roll:0)}})},map3d.prototype.SetViewCenter=function(x,y,options){var height=(options=options||{}).height?options.height:15e4,carPos=new Cesium.Cartesian3(x,y,height),camera=this.GetView().camera,ellipsoid=this.GetView().scene.globe.ellipsoid,pos=Cesium.Cartesian3.fromDegrees(carPos.x,carPos.y,carPos.z,ellipsoid);camera.setView({destination:pos,orientation:{heading:Cesium.Math.toRadians(options.heading?options.heading:0),pitch:Cesium.Math.toRadians(options.pitch?options.pitch:-90),roll:Cesium.Math.toRadians(options.roll?options.roll:0)}})},map3d.prototype.SetZoom=function(zoom){for(var w=$("#"+this.divID).width(),h=$("#"+this.divID).height(),scale=(h<w?w:h)/1366,temp=[],i=0;i<this.dmap.length;i++)temp.push(this.dmap[i]*scale);var centerMapLevel=[99999999999];for(i=1;i<temp.length;++i)centerMapLevel[i]=(temp[i-1]+temp[i])/2;centerMapLevel[centerMapLevel.length]=0;var d=(centerMapLevel[zoom-1]+centerMapLevel[zoom])/2,center=this.GetViewCenter(),carPos=new Cesium.Cartesian3(center[0],center[1],d),camera=this.GetView().camera,ellipsoid=this.GetView().scene.globe.ellipsoid,pos=Cesium.Cartesian3.fromDegrees(carPos.x,carPos.y,carPos.z,ellipsoid);camera.setView({destination:pos,endTransform:Cesium.Matrix4.IDENTITY})},map3d.prototype.GetZoom=function(){for(var w=$("#"+this.divID).width(),h=$("#"+this.divID).height(),scale=(h<w?w:h)/1366,temp=[],i=0;i<this.dmap.length;i++)temp.push(this.dmap[i]*scale);var centerMapLevel=[99999999999];for(i=1;i<temp.length;++i)centerMapLevel[i]=(temp[i-1]+temp[i])/2;centerMapLevel[centerMapLevel.length]=0;var pos=this.GetView().camera.position,d=this.cesium.ellipsoid.cartesianToCartographic(pos).height;for(i=0;i<centerMapLevel.length;++i)if(d>=centerMapLevel[i])return i;return centerMapLevel.length},map3d.prototype.GetViewRect=function(){var toDegree=180/Math.PI,rect=this.GetView().camera.computeViewRectangle();return[rect.west*toDegree,rect.south*toDegree,rect.east*toDegree,rect.north*toDegree]},map3d.prototype.SetViewRect=function(xmin,ymin,xmax,ymax,options){options=options||{},this.GetView().camera.flyTo({destination:Cesium.Rectangle.fromDegrees(xmin,ymin,xmax,ymax),duration:options.duration?options.duration:1})},map3d.prototype.GetPixelFromCoordinate=function(x,y){this.Screen2MapCoord([x,y])},map3d.prototype.Screen2MapCoord=function(screen){var xy={x:screen[0],y:screen[1]},cesium=this.cesium,pickRay=cesium.scene.camera.getPickRay(xy),cartesian=cesium.scene.globe.pick(pickRay,cesium.viewer.scene);if(!cartesian)return null;var geo=cesium.ellipsoid.cartesianToCartographic(cartesian);return[(geo.longitude/Math.PI*180).toFixed(6),(geo.latitude/Math.PI*180).toFixed(6),geo.height]},map3d.prototype.MapCoord2Screen=function(mapcoord){var lon=mapcoord[0],lat=mapcoord[1],hei=mapcoord[2]?mapcoord[2]:0,cesium=this.cesium,cart3=Cesium.Cartesian3.fromDegrees(lon,lat,hei),scr=Cesium.SceneTransforms.wgs84ToWindowCoordinates(cesium.scene,cart3);return[scr.x,scr.y]},map3d.prototype.cartesianTo2MapCoord=function(cartesian){var geo=this.cesium.ellipsoid.cartesianToCartographic(cartesian);return[parseFloat((geo.longitude/Math.PI*180).toFixed(6)),parseFloat((geo.latitude/Math.PI*180).toFixed(6)),geo.height]},map3d.prototype.SetCursorStyle=function(style){$("#"+this.divID).css("cursor",style)},Map3DSDK.DefaultStyle=void 0,Map3DSDK.Style=function(opt_options){},Map3DSDK.IconStyle=function(opt_options){},Map3DSDK.GeomStyle=function(opt_options){},Map3DSDK.TextStyle=function(opt_options){},Map3DSDK.Icon=function(opt_options){},Map3DSDK.Point=function(x,y,convert){var map=GetActiveMap();map?0==convert?Array:x instanceof Array?map.JW2MapCoord(x):map.JW2MapCoord([x,y]):Array},Map3DSDK.MultiPoint=function(coords,convert){var JWArray,map=GetActiveMap();if(map){JWArray=[];for(var i=0;i<coords.length;i++)0==convert?JWArray.push(coords[i]):JWArray.push(map.JW2MapCoord(coords[i]))}else JWArray=coords},Map3DSDK.Line=function(coordArray,convert){var JWArray,map=GetActiveMap();if(map){JWArray=[];for(var i=0;i<coordArray.length;i++)0==convert?JWArray.push(coordArray[i]):JWArray.push(map.JW2MapCoord(coordArray[i]))}else JWArray=coordArray},Map3DSDK.MultiLine=function(lineArray,convert,style){var JWlinArray;if(GetActiveMap()){JWlinArray=[];for(var i=0;i<lineArray.length;i++)for(var j=0;j<lineArray[i].length;j++)0==convert?JWlinArray.push(parseFloat(lineArray[i][j])):JWlinArray.push(parseFloat(this.JW2MapCoord(lineArray[i][j])))}else JWlinArray=lineArray;var width=0;return width=style&&style.width?style.width:5,new Cesium.PolylineGeometry({positions:Cesium.Cartesian3.fromDegreesArray(JWlinArray),width:width,vertexFormat:Cesium.PolylineColorAppearance.VERTEX_FORMAT})},Map3DSDK.Polygon=function(poly,convert){for(var outRing=poly,jwpoly=[],i=0;i<outRing.length;i++)for(var j=0;j<outRing[i].length;j++)0==convert?jwpoly.push(parseFloat(outRing[i][j])):jwpoly.push(parseFloat(this.JW2MapCoord(outRing[i][j])));for(i=1;i<poly.length;i++);return new Cesium.PolygonGeometry({polygonHierarchy:new Cesium.PolygonHierarchy(Cesium.Cartesian3.fromDegreesArray(jwpoly)),height:0})},Map3DSDK.MultiPolygon=function(polys){},Map3DSDK.Circle=function(cen,radius){var center=cen.center,R=Map3DSDK.GetMap().GetCegore()._scene.globe._czGlobe._ellipsoid._maximumRadius;radius=Cesium.Math.toRadians(R*cen.radius);return new Cesium.CircleGeometry({center:Cesium.Cartesian3.fromDegrees(center[0],center[1]),radius:radius})},Map3DSDK.Feature=function(option){},Map3DSDK.GetMap=function(){return this.map3DView},map3d.prototype.AddGeometrys=function(unklayName,geoms,style,bClear,exparam){var viewer=this.GetView();exparam=exparam||{};var color=[];color=style&&style.color?style.color:[1,1,0,1];var geomInstance=new Cesium.GeometryInstance({id:unklayName,geometry:geoms,asynchronous:!!exparam.asynchronous&&exparam.asynchronous,attributes:{color:new Cesium.ColorGeometryInstanceAttribute(color[0],color[1],color[2],color[3])}}),defAppearance=null;if(geoms._width)defAppearance=new Cesium.PolylineColorAppearance({translucent:!1});else{var material=Cesium.Material.fromType("Color",{color:new Cesium.Color(color[0],color[1],color[2],color[3])});defAppearance=new Cesium.EllipsoidSurfaceAppearance({material:material,aboveGround:!0})}var primitive=new Cesium.Primitive({geometryInstances:geomInstance,appearance:defAppearance});viewer.scene.primitives.add(primitive)},map3d.prototype.RemoveGeometrys=function(unklayName){for(var viewer=this.GetView(),primitives=viewer.scene.primitives,i=0;i<primitives.length;i++){var prim=primitives.get(i);if(prim instanceof Cesium.Primitive)if(prim.getGeometryInstanceAttributes(unklayName)){viewer.scene.primitives.remove(prim);break}}},map3d.prototype.AddEntity=function(unklayName,polygon,style,bClear,exparam){for(var jwpoly=[],outRing=polygon[0],i=0;i<outRing.length;i++)jwpoly.push(outRing[i][0]),jwpoly.push(outRing[i][1]);for(i=1;i<polygon.length;i++);Cesium.Material.fromType("Color",{color:new Cesium.Color(1,1,0,.45)});exparam=exparam||{};var viewer=this.GetView(),se=null;se="image"==exparam.type?new Cesium.ImageMaterialProperty({image:exparam.imgUrl,transparent:exparam.transparent}):"heatmap"==exparam.type?exparam.material:new Cesium.Color(1,1,0,.45),viewer.entities.add({id:unklayName,name:unklayName,polygon:{hierarchy:Cesium.Cartesian3.fromDegreesArray(jwpoly),extrudedHeight:0,perPositionHeight:!0,material:se,outline:!exparam.outline||exparam.outline,outlineColor:Cesium.Color.RED}})},map3d.prototype.GetEntity=function(modelID){var entity=this.GetView().entities.getById(modelID);return entity&&null!=entity&&null!=entity||(entity=null),entity},map3d.prototype.RemoveEntity=function(unklayName){return this.GetView().entities.removeById(unklayName)},map3d.prototype.AddFeatures=function(unklayName,features,bClear,exparam){},map3d.prototype.AddBatchTextLayer=function(options){},map3d.prototype.AddTextLabel=function(labelName,x,y,text,options){options=options||{};var color,pixelOffset,viewer=this.GetView(),entity=viewer.entities.getById(labelName);if(pixelOffset=options?(color=options.color||Cesium.Color.WHITE,options.pixelOffset||[0,0]):(color=Cesium.Color.WHITE,[0,0]),entity)entity.position.setValue(Cesium.Cartesian3.fromDegrees(parseFloat(x),parseFloat(y))),entity.label.text.setValue(text);else{var height=options.height?options.height:0;entity=viewer.entities.add({id:labelName,position:Cesium.Cartesian3.fromDegrees(parseFloat(x),parseFloat(y),parseFloat(height)),label:{text:text,font:"14pt monospace",fillColor:color,style:Cesium.LabelStyle.FILL_AND_OUTLINE,outlineWidth:2,verticalOrigin:Cesium.VerticalOrigin.Center,pixelOffset:new Cesium.Cartesian2(pixelOffset[0],pixelOffset[1])}})}return entity},map3d.prototype.AddImageLabel=function(labelName,x,y,icondiv,aligned,convert,options){options=options||{};var viewer=this.GetView(),entity=viewer.entities.getById(labelName);if(entity)entity.position.setValue(Cesium.Cartesian3.fromDegrees(parseFloat(x),parseFloat(y)));else{entity=viewer.entities.add({id:labelName,position:Cesium.Cartesian3.fromDegrees(parseFloat(x),parseFloat(y)),billboard:{image:icondiv,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,horizontalOrigin:Cesium.HorizontalOrigin.Center}});var scene=this.GetView().scene;(entity.handler=new Cesium.ScreenSpaceEventHandler(scene.canvas)).setInputAction(function(click){for(var ent=entity,pickedObjects=scene.drillPick(click.position),i=0;i<pickedObjects.length;i++){if(pickedObjects[i].id.id==ent.id){options.callback&&options.callback(click);break}}},Cesium.ScreenSpaceEventType.LEFT_CLICK)}return entity},map3d.prototype.RemoveLabel=function(labelName){var viewer=this.GetView(),entity=viewer.entities.getById(labelName);entity&&entity&&entity.handler&&entity.handler.destroy(),viewer.entities.removeById(labelName)},map3d.prototype.RemoveAllLabel=function(labelName){this.GetView().entities.removeAll()},map3d.prototype.AddControl=function(control){this.controls[control.name]=control.element},map3d.prototype.RemoveControl=function(control){if(control){var bFind=!1;for(var key in this.controls){var element=this.controls[key];if(element===control.element){bFind=!0,element.remove(),delete this.controls[key];break}}return bFind}},map3d.prototype.RemoveAllControl=function(){for(var key in this.controls){var element=this.controls[control.name];document.removeChild(element)}this.controls={}},map3d.prototype.AddCustomControl=function(uqkName,bkCol,divLeft,divTop,divWidth,divHeigth,divContent,func){var button=document.getElementById(uqkName);null==button&&(button=document.createElement("button")),button.id=uqkName,button.innerHTML=divContent,button.title=uqkName,button.addEventListener("click",func,!1),button.addEventListener("touchstart",func,!1),bkCol&&(button.style.backgroundColor=bkCol),button.style.width="calc(100% - 0.1em)",button.style.height="calc(100% - 0.1em)";var myElement=document.createElement("div");if(myElement){myElement.className="gmap-custom-control",myElement.style.left=divLeft+"px",myElement.style.top=divTop+"px",myElement.style.width=divWidth+"px",myElement.style.height=divHeigth+"px",myElement.appendChild(button),document.body.appendChild(myElement);var myControl={};myControl.name=uqkName,myControl.element=myElement,this.AddControl(myControl)}return myControl},map3d.prototype.RemoveCustomControl=function(ctlName){var element=this.controls[control.name];document.removeChild(element),delete this.controls[control.name]},map3d.prototype.AddEventListener=function(eName,eFun,modifier){var eventType;switch(eName){case"click":eventType=Cesium.ScreenSpaceEventType.LEFT_CLICK;break;case"dblclick":eventType=Cesium.ScreenSpaceEventType.DBLEFT_CLICK;break;case"mousemove":eventType=Cesium.ScreenSpaceEventType.MOUSE_MOVE;break;case"leftDown":eventType=Cesium.ScreenSpaceEventType.LEFT_DOWN;break;case"leftup":eventType=Cesium.ScreenSpaceEventType.LEFT_UP;break;case"wheel":eventType=Cesium.ScreenSpaceEventType.WHEEL}this.cesium;var handler=new Cesium.ScreenSpaceEventHandler(this.cegore.canvas);return handler.setInputAction(function(movement){eFun&&eFun(movement)},eventType,modifier),handler},map3d.prototype.RemoveEventListener=function(handler){return handler.destroy()},map3d.prototype.IsEnableDragging=function(){return this.GetView().scene.screenSpaceCameraController.enableTranslate},map3d.prototype.EnableDragging=function(enable){this.GetView().scene.screenSpaceCameraController.enableTranslate=enable},map3d.prototype.IsEnableWheel=function(){return this.GetView().scene.screenSpaceCameraController.enableZoom},map3d.prototype.EnableWheel=function(enable){this.GetView().scene.screenSpaceCameraController.enableZoom=enable},map3d.prototype.IsEnableKeyboardPan=function(){return this.GetView().scene.screenSpaceCameraController.enableTranslate},map3d.prototype.EnableKeyboardPan=function(enable){return this.GetView().scene.screenSpaceCameraController.enableTranslate=enable},map3d.prototype.IsEnableKeyboardZoom=function(){return this.GetView().scene.screenSpaceCameraController.enableZoom},map3d.prototype.EnableKeyboardZoom=function(enable){this.GetView().scene.screenSpaceCameraController.enableZoom=enable},map3d.prototype.IsEnableRotate=function(){return this.GetView().scene.screenSpaceCameraController.enableRotate},map3d.prototype.EnableRotate=function(enable){this.GetView().scene.screenSpaceCameraController.enableRotate=enable},map3d.prototype.IsEnableTilt=function(){return this.GetView().scene.screenSpaceCameraController.enableTilt},map3d.prototype.EnableTilt=function(enable){this.GetView().scene.screenSpaceCameraController.enableTilt=enable},map3d.prototype.IsEnableLook=function(){return this.GetView().scene.screenSpaceCameraController.enableLook},map3d.prototype.EnableLook=function(enable){this.GetView().scene.screenSpaceCameraController.enableLook=enable},map3d.prototype.SetInputActive=function(name,enable){},map3d.prototype.IsInputActive=function(name){return this.GetView().scene.screenSpaceCameraController.enableZoom},map3d.prototype.EnableInput=function(enable){this.GetView().scene.screenSpaceCameraController.enableInputs=enable},map3d.prototype.AddSingleImage=function(option){var name=option.name?option.name:"testE",url=option.url?option.url:"image/entity.jpg",polygon=option.polygon?option.polygon:[[[109.080842,25.002073],[105.91517,25.002073],[104.058488,24.996596],[104.053011,23.002989],[104.053011,21.003906],[105.728954,20.998429],[107.919731,21.003906],[109.04798,20.998429],[111.047063,20.998429],[111.047063,22.000709],[111.047063,24.476286],[111.05254,25.002073]]],exparam={type:"image",imgUrl:url,transparent:!!option.transparent&&option.transparent};this.AddEntity(name,polygon,void 0,void 0,exparam)},map3d.prototype.RemoveSingImage=function(name){name=name;this.RemoveEntity(name)},Map3DSDK.InfoWindow=function(point,content,obj){point[2]||(point[2]=0),this.InfoWindowPoint=point,this.InfoWindowSite=obj,this.divid=obj.divid?obj.divid:"trackPopUp";var infoDiv='<div id="'+this.divid+'" style="display:block;"><div id="'+this.divid+'Content" class="leaflet-popup" style="top:5px;left:0;"><a class="leaflet-popup-close-button" data_id ="'+this.divid+'" href="#">×</a><div class="leaflet-popup-content-wrapper"><div id="'+this.divid+'Link" class="leaflet-popup-content" style="max-width: 300px;"></div></div><div class="leaflet-popup-tip-container"><div class="leaflet-popup-tip"></div></div></div></div>';$("#"+obj.viewer.divID).append(infoDiv),$(".cesium-selection-wrapper").show(),$("#"+this.divid+"Link").empty(),$("#"+this.divid+"Link").append(content);var client=obj.viewer.MapCoord2Screen([parseFloat(point[0]),parseFloat(point[1]),parseFloat(point[2])]),c=new Cesium.Cartesian2(parseFloat(client[0]),parseFloat(client[1]));positionPopUp(c,obj),$("#"+this.divid).hide(),this.viewer=obj.viewer;obj.viewer;var viewer=obj.viewer.GetCesium().viewer,scene=viewer.scene,infowindow=this,addHandler=scene.postRender.addEventListener(function(){var pos;pos=Cesium.Cartesian3.fromDegrees(parseFloat(infowindow.InfoWindowPoint[0]),parseFloat(infowindow.InfoWindowPoint[1]),parseFloat(infowindow.InfoWindowPoint[2]));try{var changedC=Cesium.SceneTransforms.wgs84ToWindowCoordinates(viewer.scene,pos);changedC=new Cesium.Cartesian2(parseFloat(changedC.x),parseFloat(changedC.y)),c.x===changedC.x&&c.y===changedC.y||(positionPopUp(changedC,infowindow.InfoWindowSite),c=changedC)}catch(e){}});function positionPopUp(c,siteParams){var InfoWindowSite=siteParams;InfoWindowSite&&null!=InfoWindowSite?(InfoWindowSite.xoffset||(InfoWindowSite.xoffset=0),InfoWindowSite.yoffset||(InfoWindowSite.yoffset=0),InfoWindowSite.positioning||(InfoWindowSite.positioning="bottom-center")):InfoWindowSite={xoffset:0,yoffset:0,positioning:"bottom-center"};var positioning=InfoWindowSite.positioning,x=0,y=0;y=0<positioning.indexOf("top")?c.y+2+InfoWindowSite.yoffset:c.y-$("#"+InfoWindowSite.divid+"Content").height()+2+InfoWindowSite.yoffset,x=0<positioning.indexOf("left")?c.x+10+InfoWindowSite.xoffset:0<positioning.indexOf("right")?c.x-$("#"+InfoWindowSite.divid+"Content").width()+10+InfoWindowSite.xoffset:c.x-$("#"+InfoWindowSite.divid+"Content").width()/2+10+InfoWindowSite.xoffset,$("#"+InfoWindowSite.divid+"Content").css("transform","translate3d("+x+"px, "+y+"px, 0)")}return this.addHandler=addHandler,$(".leaflet-popup-close-button").click(function(){var divid=$(this).attr("data_id");return $("#"+divid).hide(),$("#"+divid+"Link").empty(),$(".cesium-selection-wrapper").hide(),addHandler.call(),!1}),this},Map3DSDK.InfoWindow.prototype.SetContent=function(content){var InfoWindowSite=this.InfoWindowSite;$("#"+InfoWindowSite.divid+"Link").empty(),$("#"+InfoWindowSite.divid+"Link").append(content)},Map3DSDK.InfoWindow.prototype.SetPosition=function(newPoint){newPoint[2]||(newPoint[2]=0);var client=this.viewer.MapCoord2Screen([parseFloat(newPoint[0]),parseFloat(newPoint[1]),parseFloat(newPoint[2])]),c=new Cesium.Cartesian2(parseFloat(client[0]),parseFloat(client[1]));this.InfoWindowPoint=newPoint;var InfoWindowSite=this.InfoWindowSite;InfoWindowSite&&null!=InfoWindowSite?(InfoWindowSite.xoffset||(InfoWindowSite.xoffset=0),InfoWindowSite.yoffset||(InfoWindowSite.yoffset=0),InfoWindowSite.positioning||(InfoWindowSite.positioning="bottom-center")):InfoWindowSite={xoffset:0,yoffset:0,positioning:"bottom-center"};var positioning=InfoWindowSite.positioning,x=0,y=0;y=0<positioning.indexOf("top")?c.y+2+InfoWindowSite.yoffset:c.y-$("#"+InfoWindowSite.divid+"Content").height()+2+InfoWindowSite.yoffset,x=0<positioning.indexOf("left")?c.x+10+InfoWindowSite.xoffset:0<positioning.indexOf("right")?c.x-$("#"+InfoWindowSite.divid+"Content").width()+10+InfoWindowSite.xoffset:c.x-$("#"+InfoWindowSite.divid+"Content").width()/2+10+InfoWindowSite.xoffset,$("#"+InfoWindowSite.divid+"Content").css("transform","translate3d("+x+"px, "+y+"px, 0)")},map3d.prototype.OpenInfoWindow=function(infowindow){$("#"+infowindow.divid).show()},map3d.prototype.UpdatePosition=function(infoWindow,position){infoWindow&&infoWindow.SetPosition(position)},map3d.prototype.CloseInfoWindow=function(infoWindow){$("#"+infoWindow.divid).hide(),$("#"+infoWindow.divid).remove(),infoWindow={}},map3d.prototype.AddModel=function(modelID,option,ifFlyTo){var oldmodel=this.GetModel(modelID);null==oldmodel&&null==oldmodel||this.RemoveModel(modelID);var czviewer=this.GetView(),rotate=option.rotate?option.rotate:[0,0,0],posiArr=[];if(option.position){var po=option.position;posiArr[0]=parseFloat(po[0]),posiArr[1]=parseFloat(po[1]),posiArr[2]=po[2]?parseFloat(po[2]):0}else posiArr=[110.05254,25.002073,0];var position=Cesium.Cartesian3.fromDegrees(posiArr[0],posiArr[1],posiArr[2]),heading=Cesium.Math.toRadians(parseFloat(rotate[0])),pitch=Cesium.Math.toRadians(parseFloat(rotate[1])),roll=Cesium.Math.toRadians(parseFloat(rotate[2])),hpr=new Cesium.HeadingPitchRoll(heading,pitch,roll),orientation=Cesium.Transforms.headingPitchRollQuaternion(position,hpr),model=czviewer.entities.add({position:position,shadows:!0,id:modelID||"testModel",name:modelID||"testModel",orientation:orientation,model:{uri:option.url?option.url:"./gltf/test.gltf"}});return 0==ifFlyTo||czviewer.camera.flyTo({destination:Cesium.Cartesian3.fromDegrees(posiArr[0],posiArr[1],posiArr[2]+1e3)}),model},map3d.prototype.GetModel=function(modelID){this.GetView();return this.GetEntity(modelID)},map3d.prototype.PickModel=function(position){var viewer=this.GetCegore(),scene=(viewer=this.GetView()).scene,pick={},pixel={x:parseFloat(position.x),y:parseFloat(position.y)},pickedObject=scene.pick(pixel);if(scene.pickPositionSupported&&Cesium.defined(pickedObject)&&pickedObject.node){var cartesian=viewer.scene.pickPosition(pixel);if(Cesium.defined(cartesian)){var cartographic=Cesium.Cartographic.fromCartesian(cartesian),lng=Cesium.Math.toDegrees(cartographic.longitude),lat=Cesium.Math.toDegrees(cartographic.latitude),height=cartographic.height;pick.coord={x:lng.toFixed(6),y:lat.toFixed(6),z:height.toFixed(6)}}}else{var ray=viewer.camera.getPickRay(pixel);cartesian=viewer.scene.globe.pick(ray,scene),cartographic=Cesium.Cartographic.fromCartesian(cartesian),lng=Cesium.Math.toDegrees(cartographic.longitude),lat=Cesium.Math.toDegrees(cartographic.latitude);pick.coord={x:lng.toFixed(6),y:lat.toFixed(6),z:cartographic.height.toFixed(6)}}return pick.models=pickedObject,pick},map3d.prototype.RotateModel=function(modelID,rotate){var entity=this.GetModel(modelID),position=entity.position._value,heading=Cesium.Math.toRadians(parseFloat(rotate[0])),pitch=Cesium.Math.toRadians(parseFloat(rotate[1])),roll=Cesium.Math.toRadians(parseFloat(rotate[2])),hpr=new Cesium.HeadingPitchRoll(heading,pitch,roll),orientation=Cesium.Transforms.headingPitchRollQuaternion(position,hpr);entity.orientation=orientation},map3d.prototype.RemoveModel=function(modelID){this.GetView().entities.removeById(modelID)},map3d.prototype.createDnyLinePoints=function(spoint,epoint,heightRatio){var rePoint=[];lat1=Math.PI/180*spoint[1],lat2=Math.PI/180*epoint[1],lon1=Math.PI/180*spoint[0],lon2=Math.PI/180*epoint[0];var a=Math.cos(lat1)*Math.cos(lat2)*Math.cos(lon1-lon2)+Math.sin(lat1)*Math.sin(lat2);1<a&&(a=1),a<-1&&(a=-1);var len=Math.acos(a),y=Math.sin(lon2-lon1)*Math.cos(lat2),x=Math.cos(lat1)*Math.sin(lat2)-Math.sin(lat1)*Math.cos(lat2)*Math.cos(lon2-lon1);azi=Math.atan2(y,x);for(var i=0;i<=100;++i){var pyx=.02*i,pyz=1e6*(2*pyx-pyx*pyx)*heightRatio;if(0===i)rePoint.push(spoint[0]),rePoint.push(spoint[1]),rePoint.push(pyz);else if(100===i)rePoint.push(epoint[0]),rePoint.push(epoint[1]),rePoint.push(pyz);else{var sinlat1=Math.sin(lat1),coslat1=Math.cos(lat1),sindis=Math.sin(.01*len*i),cosdis=Math.cos(.01*len*i),sinazi=Math.sin(azi),cosazi=Math.cos(azi),processy=Math.asin(sinlat1*cosdis+coslat1*sindis*cosazi),processx=lon1+Math.atan2(sinazi*sindis*coslat1,cosdis-sinlat1*Math.sin(processy));rePoint.push(180*processx/Math.PI),rePoint.push(180*processy/Math.PI),rePoint.push(pyz)}}return rePoint},map3d.prototype.createDnyLine=function(param){var czviewer=this.GetView(),points=this.createDnyLinePoints(param.stponit,param.enpoint,param.heightRatio);if(param.flymove){var mat=new PolylineDynMaterialProperty({color:param.bottomColor,color2:param.flyColor,lineLength:1,lineSpeed:1});czviewer.entities.add({name:"Glowing blue line on the surface",polyline:{positions:Cesium.Cartesian3.fromDegreesArrayHeights(points),width:param.linewidth?param.linewidth:3,material:mat,shadows:Cesium.ShadowMode.ENABLED,followSurface:!1}});this.cesium.scene.preRender.addEventListener(function(t){mat.update(.01)})}else czviewer.entities.add({name:"Glowing blue line on the surface",polyline:{positions:Cesium.Cartesian3.fromDegreesArrayHeights(points),width:param.linewidth?param.linewidth:3,material:param.noflycolor,shadows:Cesium.ShadowMode.ENABLED,followSurface:!1}})},map3d.prototype.shearzmap=function(param){for(var czviewer=this.GetView(),globe=czviewer.scene.globe,midpoint=param.bootomface.midpoint,position=Cesium.Cartesian3.fromDegrees(midpoint[0],midpoint[1],midpoint[2]),entity=czviewer.entities.add({position:position,polygon:{hierarchy:Cesium.Cartesian3.fromDegreesArray(param.bootomface.ponits),height:param.bootomface.bheight?param.bootomface.bheight:-50,material:param.bootomface.facematmaterial?param.bootomface.facematmaterial:Cesium.Color.RED}}),plans=[],i=0;i<param.plans.length;i++){var oneplane=param.plans[i],clippingPlane=new Cesium.ClippingPlane(new Cesium.Cartesian3(oneplane[0],oneplane[1],oneplane[2]),oneplane[3]);plans.push(clippingPlane)}globe.depthTestAgainstTerrain=!0,globe.clippingPlanes=new Cesium.ClippingPlaneCollection({modelMatrix:entity.computeModelMatrix(Cesium.JulianDate.now()),planes:plans,shearedgewidth:param.shearedgewidth?param.shearedgewidth:1,shearedgeclor:param.shearedgeclor?param.shearedgeclor:Cesium.Color.WHITE,enabled:!0}),czviewer.trackedEntity=entity;var verticalface=param.verticalface;if(verticalface)for(i=0;i<verticalface.length;i++){var topheight=verticalface[i].topheight;topheight&&0!==topheight||(topheight=1e-6);var botheight=verticalface[i].botheight;topheight||(botheight=50);var spoint=verticalface[i].points,epont=verticalface[i].pointe;czviewer.entities.add({wall:{positions:Cesium.Cartesian3.fromDegreesArrayHeights([spoint[0],spoint[1],topheight,epont[0],epont[1],topheight]),minimumHeights:[botheight,botheight],material:verticalface[i].facematerial?verticalface[i].facematerial:Cesium.Color.RED,outline:!1}})}},map3d.prototype.addHeatmap=function(heatmapID,option){var heatid=heatmapID;this.GetView().entities.removeById(heatid);var heatDoc=document.createElement("div");heatDoc.setAttribute("style","width:1000px;height:1000px;margin: 0px;display: none;"),document.body.appendChild(heatDoc);for(var zoom=this.GetZoom(),ra=parseInt(17150/(zoom*zoom*zoom)),gradient=option.gradient?option.gradient:{.9:"red",.8:"orange",.7:"yellow",.5:"blue",.3:"green"},heatMap=h337.create({container:heatDoc,radius:ra,blur:.95,gradient:gradient,opacity:.8}),dataArr=option.data,max=0,i=0;i<dataArr.length;i++)parseFloat(dataArr[i].value)>max&&(max=parseFloat(dataArr[i].value));heatMap.setData({max:max,data:dataArr});var polygon=option.polygon?option.polygon:[[[105.91517,25.002073],[104.058488,24.996596],[104.053011,23.002989],[104.053011,21.003906],[105.728954,20.998429],[107.919731,21.003906],[109.04798,20.998429],[111.047063,20.998429],[111.047063,22.000709],[111.047063,24.476286],[111.05254,25.002073]]],exparam={type:"heatmap",material:heatMap._renderer.canvas,outline:!1};this.AddEntity(heatid,polygon,void 0,void 0,exparam);var mapView=this,habds={heatmapID:this.AddEventListener("wheel",function(){var zoom=mapView.GetZoom(),radius=parseInt(17150/(zoom*zoom*zoom)),heatMap2=h337.create({container:heatDoc,radius:radius,opacity:.8,blur:.95,gradient:gradient});heatMap2.setData({max:max,data:dataArr}),mapView.GetEntity(heatid).polygon.material=heatMap2._renderer.canvas})},handlA=this.handlerArray;handlA.push(habds),this.handlerArray=handlA},Map3DSDK.Map=map3d}();var Cegore,GmMap3D=Map3DSDK,ZMap3D=Map3DSDK;!function(Cegore){var NetCDFImageLayer=function(){function NetCDFImageLayer(options){if(!Cegore.TypeCheck.isObject(options))throw"Invalid iamge info";var provider=this.createProvider(options);if(!Cegore.TypeCheck.isDefined(provider))throw'Can not create image layer by type : "'+options.type+'"';this._name=Cegore.AutoNames.genName(options.name,"NetCDFImageLayer"),this._type=options.type,this._czLayer=new Cesium.ImageryLayer(provider),(this._czLayer._ZMapLayer=this)._params=Cegore.TypeCheck.defaultValue(options.params,{}),this.visible=Cegore.TypeCheck.defaultValue(options.visible,!0),this.alpha=Cegore.TypeCheck.defaultValue(options.alpha,1)}return Object.defineProperty(NetCDFImageLayer.prototype,"_czlayer",{get:function(){return this._czLayer},enumerable:!0,configurable:!0}),Object.defineProperty(NetCDFImageLayer.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(NetCDFImageLayer.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(NetCDFImageLayer.prototype,"visible",{get:function(){return this._visible},set:function(value){this._visible=value,this._czLayer.show=value},enumerable:!0,configurable:!0}),Object.defineProperty(NetCDFImageLayer.prototype,"alpha",{get:function(){return this._alpha},set:function(value){this._alpha=value,this._czLayer.alpha=value},enumerable:!0,configurable:!0}),NetCDFImageLayer.prototype.createProvider=function(options){var copy={};for(var key in options)this.hasOwnProperty(key)||(copy[key]=options[key]);return Cegore.Providers.ImageProviders.createProvider(options.type,copy)},NetCDFImageLayer}();Cegore.NetCDFImageLayer=NetCDFImageLayer}(Cegore||(Cegore={})),function(Cegore){var NetCDFImageLayerCollection=function(){function NetCDFImageLayerCollection(globe){this._layers=new Cegore.HashMap,this._globe=globe,this._czLayers=this._globe._czglobe.imageryLayers}return Object.defineProperty(NetCDFImageLayerCollection.prototype,"length",{get:function(){return this._czLayers.length},enumerable:!0,configurable:!0}),NetCDFImageLayerCollection.prototype.add=function(layer,index){if(Cegore.TypeCheck.isInstanceOf(layer,Cegore.NetCDFImageLayer)||(layer=new Cegore.NetCDFImageLayer(layer)),this._layers.exist(layer.name))throw"image layer named :"+layer.name+" allready exist.";this._czLayers.add(layer._czlayer,index),this._layers.put(layer.name,layer)},NetCDFImageLayerCollection.prototype.get=function(id){if(Cegore.TypeCheck.isNumber(id)){var czlayer=this._czLayers.get(id);if(czlayer)return czlayer._ZMapLayer}else if(Cegore.TypeCheck.isString(id))return this._layers.get(id);throw"id must be string or number"},NetCDFImageLayerCollection.prototype.remove=function(id){if(Cegore.TypeCheck.isNumber(id)&&Cegore.TypeCheck.isString(id))this.remove(this.get(id));else if(Cegore.TypeCheck.isInstanceOf(id,Cegore.NetCDFImageLayer)){var layer=id;this._czLayers.remove(layer._czlayer),this._layers.remove(id.name)}throw"id must be string or number or NetCDFImageLayer"},NetCDFImageLayerCollection.prototype.removeAll=function(){this._czLayers.removeAll(),this._layers.removeAll()},NetCDFImageLayerCollection.prototype.clear=function(){this.removeAll()},NetCDFImageLayerCollection}();Cegore.NetCDFImageLayerCollection=NetCDFImageLayerCollection}(Cegore||(Cegore={})),function(Cegore){var ZMapNetCDFImageProvider=function(){function ZMapNetCDFImageProvider(opt){this.getTileCredits=function(x,y,level){},this.requestImage=function(x,y,level){if(!this._ready)throw new Cesium.DeveloperError("requestImage must not be called before the imagery provider is ready.");var url=ZMapNetCDFImageProvider.buildImageUrl(this,x,y,level);return Cesium.ImageryProvider.loadImage(this,url)};var defaultCredit=new Cesium.Credit("WMTS");opt=Cesium.defaultValue(opt,{});var url=Cesium.defaultValue(opt.url,"http://localhost:88/wmts");/\/$/.test(url),this._initurl=opt.url,this._url=url,this._params=opt.params,this._proxy=opt.proxy,this._tileDiscardPolicy=opt.tileDiscardPolicy,this._scheme=Cesium.defaultValue(opt.scheme,"Geographic"),"WebMercator"===this._scheme?this._tilingScheme=new Cesium.WebMercatorTilingScheme({ellipsoid:opt.ellipsoid}):0<this._scheme.indexOf("level-0")?this._tilingScheme=new Cesium.GeographicTilingScheme({ellipsoid:opt.ellipsoid}):this._tilingScheme=new Cesium.GeographicTilingScheme({ellipsoid:opt.ellipsoid,numberOfLevelZeroTilesX:8,numberOfLevelZeroTilesY:4}),this._tileWidth=256,this._tileHeight=256,this._minimumLevel=Cesium.defaultValue(opt.minimumLevel,0),this._maximumLevel=Cesium.defaultValue(opt.maximumLevel,18),this._extent=Cesium.defaultValue(opt.extent,this._tilingScheme.extent),this._rectangle=Cesium.defaultValue(opt.rectangle,this._tilingScheme.rectangle),this._errorEvent=new Cesium.Event,this._ready=!0;var credit=Cesium.defaultValue(opt.credit,defaultCredit);"string"==typeof credit&&(credit=new Cesium.Credit(credit)),this._credit=credit}return Object.defineProperty(ZMapNetCDFImageProvider.prototype,"url",{get:function(){return this._url},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapNetCDFImageProvider.prototype,"hasAlphaChannel",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapNetCDFImageProvider.prototype,"proxy",{get:function(){return this._proxy},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapNetCDFImageProvider.prototype,"tileWidth",{get:function(){return this._tileWidth},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapNetCDFImageProvider.prototype,"tileHeight",{get:function(){return this._tileHeight},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapNetCDFImageProvider.prototype,"maximumLevel",{get:function(){return this._maximumLevel},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapNetCDFImageProvider.prototype,"minimumLevel",{get:function(){return this._minimumLevel},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapNetCDFImageProvider.prototype,"tilingScheme",{get:function(){return this._tilingScheme},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapNetCDFImageProvider.prototype,"extent",{get:function(){return this._extent},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapNetCDFImageProvider.prototype,"rectangle",{get:function(){return this._rectangle},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapNetCDFImageProvider.prototype,"ileDiscardPolicy",{get:function(){return this._tileDiscardPolicy},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapNetCDFImageProvider.prototype,"errorEvent",{get:function(){return this._errorEvent},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapNetCDFImageProvider.prototype,"ready",{get:function(){return this._ready},enumerable:!0,configurable:!0}),Object.defineProperty(ZMapNetCDFImageProvider.prototype,"credit",{get:function(){return this._credit},enumerable:!0,configurable:!0}),ZMapNetCDFImageProvider.getRealUrl=function(urls){var url=urls;if(urls.indexOf("catalogws")<0)return urls;var obj=this;return url=(url=urls.replace("/catalogws","")).replace("/tile/map","")+"?f=json",$.ajax({url:url,dataType:"json",async:!1,success:function(data){url=obj.JudgePower(data)<2?data.attributes.url:urls},error:function(e){url=urls}}),url},ZMapNetCDFImageProvider.JudgePower=function(data){return"公开"==data.descriptions.保密模式||""==data.descriptions.保密模式?1:"普通保密"==data.descriptions.保密模式?2:3},ZMapNetCDFImageProvider.buildImageUrl=function(provider,x,y,level){var proxy=provider._proxy;"WebMercator"!==provider._scheme&&(0<provider._scheme.indexOf("level-0")?level+=1:level=level),null==provider.realUrl&&(provider.realUrl=this.getRealUrl(provider._initurl));var rectangle=provider._tilingScheme.tileXYToRectangle(x,y,level-1),bbox=[Cesium.Math.toDegrees(rectangle.west),Cesium.Math.toDegrees(rectangle.south),Cesium.Math.toDegrees(rectangle.east),Cesium.Math.toDegrees(rectangle.north)],url=provider.realUrl+"?lvl="+level+"&col="+y+"&row="+x+"&west="+bbox[0]+"&south="+bbox[1]+"&east="+bbox[2]+"&north="+bbox[3],params=provider._params;for(var key in params)url+="&"+key+"="+params[key];return Cesium.defined(proxy)&&(url=proxy.getURL(url)),url},ZMapNetCDFImageProvider}(),ZMapNetCDFImageProviderFactory=function(){function ZMapNetCDFImageProviderFactory(){}return ZMapNetCDFImageProviderFactory.prototype.createProvider=function(options){return new ZMapNetCDFImageProvider(options)},ZMapNetCDFImageProviderFactory}();Cegore.Providers.ImageProviders.regFactory("ZMapNetCDFImage",new ZMapNetCDFImageProviderFactory)}(Cegore||(Cegore={})),Cesium.MousePositionCtl=function(opt_options){var map=opt_options.map;this.map3d=map,this.cesium=map.GetMap(),this.style=opt_options.style?opt_options.style:{top:0,left:0},this.Init()},Cesium.MousePositionCtl.prototype={Init:function(){this._createBar(),this._registerEvent()},_createBar:function(){var style=this.style,top=style.top,left=style.left,height=parseInt($("canvas").css("height"))+top-20,html='<div id="bottom" class="gmap-mouse-position" style="height:18px; top:'+(height+="px")+"; left:"+left+'px;" border="0" cellspacing="0" cellpadding="0"></div>';$("body").append(html)},_registerEvent:function(){var cesium=this.cesium;new Cesium.ScreenSpaceEventHandler(cesium.scene._canvas).setInputAction(function(movement){var pickRay=cesium.scene.camera.getPickRay(movement.endPosition),cartesian=cesium.scene.globe.pick(pickRay,cesium.viewer.scene);if(cartesian){var geo=cesium.ellipsoid.cartesianToCartographic(cartesian),text="经度: "+(geo.longitude/Math.PI*180).toFixed(6)+" ";text+="纬度: "+(geo.latitude/Math.PI*180).toFixed(6)+" ",text+="高度: "+geo.height.toFixed(2)+" （米）",$("#bottom").html(text)}else $("#bottom").html("")},Cesium.ScreenSpaceEventType.MOUSE_MOVE)}};var Map3DSDKLib=Map3DSDKLib||{};!function(){var Input3DTool=function(){var ellipsoid=Cesium.Ellipsoid.WGS84;function _(map){var cesium=(this._map=map).GetMap();this._scene=cesium.scene,this._surfaces=[],this.initialiseHandlers(),this.enhancePrimitives()}_.prototype.EnableInput=function(enable){this._scene.screenSpaceCameraController.enableInputs=enable},_.prototype.StartPointTool=function(StartCallBack,EndCallBack){this.ClearAll(),this.startDrawingPoint({callstart:StartCallBack,callback:EndCallBack})},_.prototype.StartLineTool=function(StartCallBack,EndCallBack){this.ClearAll(),this.startDrawingPolyline({callstart:StartCallBack,callback:EndCallBack})},_.prototype.StartSingleLineTool=function(StartCallBack,EndCallBack){this.ClearAll(),this.startDrawingSingleline({callstart:StartCallBack,callback:EndCallBack})},_.prototype.StartRectTool=function(StartCallBack,EndCallBack){this.ClearAll(),this.startDrawingExtent({callstart:StartCallBack,callback:EndCallBack})},_.prototype.StartCircleTool=function(StartCallBack,EndCallBack){this.ClearAll(),this.startDrawingCircle({callstart:StartCallBack,callback:EndCallBack})},_.prototype.StartPolygonTool=function(StartCallBack,EndCallBack,lineWidth){this.ClearAll();var options={callstart:StartCallBack,callback:EndCallBack};lineWidth&&(options.lineWidth=lineWidth),this.startDrawingPolygon(options)},_.prototype.StartAnyPolygonTool=function(StartCallBack,EndCallBack){},_.prototype.ClearAll=function(){this.disableAllEditMode(),this.editCleanUp&&this.editCleanUp()},_.prototype.ClearGeometry=function(){this.disableAllEditMode()},_.prototype.initialiseHandlers=function(){var mouseOutObject,scene=this._scene,_self=this,handler=new Cesium.ScreenSpaceEventHandler(scene.canvas);function callPrimitiveCallback(name,position){if(1!=_self._handlersMuted){var pickedObject=scene.pick(position);pickedObject&&pickedObject.primitive&&pickedObject.primitive[name]&&pickedObject.primitive[name](position)}}handler.setInputAction(function(movement){callPrimitiveCallback("leftClick",movement.position)},Cesium.ScreenSpaceEventType.LEFT_CLICK),handler.setInputAction(function(movement){callPrimitiveCallback("leftDoubleClick",movement.position)},Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),handler.setInputAction(function(movement){if(1!=_self._handlersMuted){var pickedObject=scene.pick(movement.endPosition);!mouseOutObject||pickedObject&&mouseOutObject==pickedObject.primitive||((!mouseOutObject.isDestroyed||!mouseOutObject.isDestroyed())&&mouseOutObject.mouseOut(movement.endPosition),mouseOutObject=null),pickedObject&&pickedObject.primitive&&((pickedObject=pickedObject.primitive).mouseOut&&(mouseOutObject=pickedObject),pickedObject.mouseMove&&pickedObject.mouseMove(movement.endPosition))}},Cesium.ScreenSpaceEventType.MOUSE_MOVE),handler.setInputAction(function(movement){callPrimitiveCallback("leftUp",movement.position)},Cesium.ScreenSpaceEventType.LEFT_UP),handler.setInputAction(function(movement){callPrimitiveCallback("leftDown",movement.position)},Cesium.ScreenSpaceEventType.LEFT_DOWN)},_.prototype.setListener=function(primitive,type,callback){primitive[type]=callback},_.prototype.muteHandlers=function(muted){this._handlersMuted=muted,this.EnableInput(!muted)},_.prototype.registerEditableShape=function(surface){var _self=this;setListener(surface,"mouseMove",function(position){surface.setHighlighted(!0),surface._editMode||_self._tooltip.showAt(position,"点击可以编辑这个要素")}),setListener(surface,"mouseOut",function(position){surface.setHighlighted(!1),_self._tooltip.setVisible(!1)}),setListener(surface,"leftClick",function(position){surface.setEditMode(!0)})},_.prototype.startDrawing=function(cleanUp){this.disableAllEditMode(),this.editCleanUp&&this.editCleanUp(),this.editCleanUp=cleanUp,this.muteHandlers(!0)},_.prototype.stopDrawing=function(){this.editCleanUp&&(this.editCleanUp(),this.editCleanUp=null),this.muteHandlers(!1)},_.prototype.disableAllHighlights=function(){this.setHighlighted(void 0)},_.prototype.setHighlighted=function(surface){this._highlightedSurface&&!this._highlightedSurface.isDestroyed()&&this._highlightedSurface!=surface&&this._highlightedSurface.setHighlighted(!1),this._highlightedSurface=surface},_.prototype.disableAllEditMode=function(){this.setEdited(void 0)},_.prototype.setEdited=function(surface){this._editedSurface&&!this._editedSurface.isDestroyed()&&this._editedSurface.setEditMode(!1),this._editedSurface=surface};var material=Cesium.Material.fromType(Cesium.Material.ColorType);material.uniforms.color=new Cesium.Color(1,1,0,.5);var defaultShapeOptions={ellipsoid:Cesium.Ellipsoid.WGS84,textureRotationAngle:0,height:60,asynchronous:!0,show:!0,debugShowBoundingVolume:!1},defaultSurfaceOptions=copyOptions(defaultShapeOptions,{appearance:new Cesium.EllipsoidSurfaceAppearance({aboveGround:!1}),material:material,granularity:Math.PI/180}),defaultPolygonOptions=copyOptions(defaultShapeOptions,{}),defaultCircleOptions=(copyOptions(defaultShapeOptions,{}),copyOptions(defaultShapeOptions,{})),defaultEllipseOptions=copyOptions(defaultSurfaceOptions,{rotation:0}),defaultPolylineOptions=copyOptions(defaultShapeOptions,{width:5,geodesic:!0,granularity:1e4,appearance:new Cesium.PolylineMaterialAppearance({aboveGround:!1}),material:material}),ChangeablePrimitive=function(){function _(){}return _.prototype.initialiseOptions=function(options){fillOptions(this,options),this._ellipsoid=void 0,this._granularity=void 0,this._height=void 0,this._textureRotationAngle=void 0,this._id=void 0,this._createPrimitive=!0,this._primitive=void 0,this._outlinePolygon=void 0},_.prototype.setAttribute=function(name,value){this[name]=value,this._createPrimitive=!0},_.prototype.getAttribute=function(name){return this[name]},_.prototype.update=function(context,frameState,commandList){if(!Cesium.defined(this.ellipsoid))throw new Cesium.DeveloperError("this.ellipsoid must be defined.");if(!Cesium.defined(this.appearance))throw new Cesium.DeveloperError("this.material must be defined.");if(this.granularity<0)throw new Cesium.DeveloperError("this.granularity and scene2D/scene3D overrides must be greater than zero.");if(this.show&&(this._createPrimitive||Cesium.defined(this._primitive))){if(this._createPrimitive||this._ellipsoid!==this.ellipsoid||this._granularity!==this.granularity||this._height!==this.height||this._textureRotationAngle!==this.textureRotationAngle||this._id!==this.id){var geometry=this.getGeometry();if(!geometry)return;this._createPrimitive=!1,this._ellipsoid=this.ellipsoid,this._granularity=this.granularity,this._height=this.height,this._textureRotationAngle=this.textureRotationAngle,this._id=this.id,this._primitive=this._primitive&&this._primitive.destroy(),this._primitive=new Cesium.Primitive({geometryInstances:new Cesium.GeometryInstance({geometry:geometry,id:this.id,pickPrimitive:this}),appearance:this.appearance,asynchronous:this.asynchronous}),this._outlinePolygon=this._outlinePolygon&&this._outlinePolygon.destroy(),this.strokeColor&&this.getOutlineGeometry&&(console.log(context),this._outlinePolygon=new Cesium.Primitive({geometryInstances:new Cesium.GeometryInstance({geometry:this.getOutlineGeometry(),attributes:{color:Cesium.ColorGeometryInstanceAttribute.fromColor(this.strokeColor)}}),appearance:new Cesium.PerInstanceColorAppearance({flat:!0,renderState:{depthTest:{enabled:!0},lineWidth:1}})}))}var primitive=this._primitive;primitive.appearance.material=this.material,primitive.debugShowBoundingVolume=this.debugShowBoundingVolume,primitive.update(context,frameState,commandList),this._outlinePolygon&&this._outlinePolygon.update(context,frameState,commandList)}},_.prototype.isDestroyed=function(){return!1},_.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),Cesium.destroyObject(this)},_.prototype.setStrokeStyle=function(strokeColor,strokeWidth){this.strokeColor&&this.strokeColor.equals(strokeColor)&&this.strokeWidth==strokeWidth||(this._createPrimitive=!0,this.strokeColor=strokeColor,this.strokeWidth=strokeWidth)},_}();_.ExtentPrimitive=function(){function _(options){if(!Cesium.defined(options.extent))throw new Cesium.DeveloperError("Extent is required");options=copyOptions(options,defaultSurfaceOptions),this.initialiseOptions(options),this.setExtent(options.extent)}return(_.prototype=new ChangeablePrimitive).setExtent=function(extent){this.setAttribute("extent",extent)},_.prototype.getExtent=function(){return this.getAttribute("extent")},_.prototype.getGeometry=function(){if(Cesium.defined(this.extent))return new Cesium.RectangleGeometry({rectangle:this.extent,height:this.height,vertexFormat:Cesium.EllipsoidSurfaceAppearance.VERTEX_FORMAT,stRotation:this.textureRotationAngle,ellipsoid:this.ellipsoid,granularity:this.granularity})},_.prototype.getOutlineGeometry=function(){return new Cesium.RectangleOutlineGeometry({rectangle:this.extent})},_}(),_.PointPrimitive=function(){function _(options){if(!Cesium.defined(options.center)||!Cesium.defined(options.radius))throw new Cesium.DeveloperError("Center and radius are required");options=copyOptions(options,defaultSurfaceOptions),this.initialiseOptions(options),this.setRadius(options.radius)}return(_.prototype=new ChangeablePrimitive).setCenter=function(center){this.setAttribute("center",center)},_.prototype.setRadius=function(radius){this.setAttribute("radius",Math.max(.1,radius))},_.prototype.getCenter=function(){return this.getAttribute("center")},_.prototype.getRadius=function(){return this.getAttribute("radius")},_.prototype.getGeometry=function(){if(Cesium.defined(this.center)&&Cesium.defined(this.radius))return new Cesium.CircleGeometry({center:this.center,radius:this.radius,height:this.height,vertexFormat:Cesium.EllipsoidSurfaceAppearance.VERTEX_FORMAT,stRotation:this.textureRotationAngle,ellipsoid:this.ellipsoid,granularity:this.granularity})},_.prototype.getOutlineGeometry=function(){return new Cesium.CircleOutlineGeometry({center:this.getCenter(),radius:this.getRadius()})},_}(),_.PolylinePrimitive=function(){function _(options){options=copyOptions(options,defaultPolylineOptions),this.initialiseOptions(options)}return(_.prototype=new ChangeablePrimitive).setPositions=function(positions){this.setAttribute("positions",positions)},_.prototype.setWidth=function(width){this.setAttribute("width",width)},_.prototype.setGeodesic=function(geodesic){this.setAttribute("geodesic",geodesic)},_.prototype.getPositions=function(){return this.getAttribute("positions")},_.prototype.getWidth=function(){return this.getAttribute("width")},_.prototype.getGeodesic=function(geodesic){return this.getAttribute("geodesic")},_.prototype.getGeometry=function(){if(Cesium.defined(this.positions)&&!(this.positions.length<2))return new Cesium.PolylineGeometry({positions:this.positions,height:this.height,width:this.width<1?1:this.width,vertexFormat:Cesium.EllipsoidSurfaceAppearance.VERTEX_FORMAT,ellipsoid:this.ellipsoid})},_}(),_.PolygonPrimitive=function(){function _(options){options=copyOptions(options,defaultSurfaceOptions),this.initialiseOptions(options),this.isPolygon=!0}return(_.prototype=new ChangeablePrimitive).setPositions=function(positions){this.setAttribute("positions",positions)},_.prototype.getPositions=function(){return this.getAttribute("positions")},_.prototype.getGeometry=function(){if(Cesium.defined(this.positions)&&!(this.positions.length<3))return Cesium.PolygonGeometry.fromPositions({positions:this.positions,height:this.height,vertexFormat:Cesium.EllipsoidSurfaceAppearance.VERTEX_FORMAT,stRotation:this.textureRotationAngle,ellipsoid:this.ellipsoid,granularity:this.granularity})},_.prototype.getOutlineGeometry=function(){return Cesium.PolygonOutlineGeometry.fromPositions({positions:this.getPositions()})},_}(),_.CirclePrimitive=function(){function _(options){if(!Cesium.defined(options.center)||!Cesium.defined(options.radius))throw new Cesium.DeveloperError("Center and radius are required");options=copyOptions(options,defaultSurfaceOptions),this.initialiseOptions(options),this.setRadius(options.radius)}return(_.prototype=new ChangeablePrimitive).setCenter=function(center){this.setAttribute("center",center)},_.prototype.setRadius=function(radius){this.setAttribute("radius",Math.max(.1,radius))},_.prototype.getCenter=function(){return this.getAttribute("center")},_.prototype.getRadius=function(){return this.getAttribute("radius")},_.prototype.getGeometry=function(){if(Cesium.defined(this.center)&&Cesium.defined(this.radius))return new Cesium.CircleGeometry({center:this.center,radius:this.radius,height:this.height,vertexFormat:Cesium.EllipsoidSurfaceAppearance.VERTEX_FORMAT,stRotation:this.textureRotationAngle,ellipsoid:this.ellipsoid,granularity:this.granularity})},_.prototype.getOutlineGeometry=function(){return new Cesium.CircleOutlineGeometry({center:this.getCenter(),radius:this.getRadius()})},_}(),_.EllipsePrimitive=function(){function _(options){if(!(Cesium.defined(options.center)&&Cesium.defined(options.semiMajorAxis)&&Cesium.defined(options.semiMinorAxis)))throw new Cesium.DeveloperError("Center and semi major and semi minor axis are required");options=copyOptions(options,defaultEllipseOptions),this.initialiseOptions(options)}return(_.prototype=new ChangeablePrimitive).setCenter=function(center){this.setAttribute("center",center)},_.prototype.setSemiMajorAxis=function(semiMajorAxis){semiMajorAxis<this.getSemiMinorAxis()||this.setAttribute("semiMajorAxis",semiMajorAxis)},_.prototype.setSemiMinorAxis=function(semiMinorAxis){semiMinorAxis>this.getSemiMajorAxis()||this.setAttribute("semiMinorAxis",semiMinorAxis)},_.prototype.setRotation=function(rotation){return this.setAttribute("rotation",rotation)},_.prototype.getCenter=function(){return this.getAttribute("center")},_.prototype.getSemiMajorAxis=function(){return this.getAttribute("semiMajorAxis")},_.prototype.getSemiMinorAxis=function(){return this.getAttribute("semiMinorAxis")},_.prototype.getRotation=function(){return this.getAttribute("rotation")},_.prototype.getGeometry=function(){if(Cesium.defined(this.center)&&Cesium.defined(this.semiMajorAxis)&&Cesium.defined(this.semiMinorAxis))return new Cesium.EllipseGeometry({ellipsoid:this.ellipsoid,center:this.center,semiMajorAxis:this.semiMajorAxis,semiMinorAxis:this.semiMinorAxis,rotation:this.rotation,height:this.height,vertexFormat:Cesium.EllipsoidSurfaceAppearance.VERTEX_FORMAT,stRotation:this.textureRotationAngle,ellipsoid:this.ellipsoid,granularity:this.granularity})},_.prototype.getOutlineGeometry=function(){return new Cesium.EllipseOutlineGeometry({center:this.getCenter(),semiMajorAxis:this.getSemiMajorAxis(),semiMinorAxis:this.getSemiMinorAxis(),rotation:this.getRotation()})},_}();var defaultBillboard={iconUrl:"./Images/dragIcon.png",shiftX:0,shiftY:0},dragBillboard={iconUrl:"./Images/dragIcon.png",shiftX:0,shiftY:0},dragHalfBillboard={iconUrl:"./Images/dragIconLight.png",shiftX:0,shiftY:0};function getExtentCorners(value){return ellipsoid.cartographicArrayToCartesianArray([Cesium.Rectangle.northwest(value),Cesium.Rectangle.northeast(value),Cesium.Rectangle.southeast(value),Cesium.Rectangle.southwest(value)])}function getExtent(mn,mx){var e=new Cesium.Rectangle;e.west=Math.min(mn.longitude,mx.longitude),e.east=Math.max(mn.longitude,mx.longitude),e.south=Math.min(mn.latitude,mx.latitude),e.north=Math.max(mn.latitude,mx.latitude);var epsilon=Cesium.Math.EPSILON7;return e.east-e.west<epsilon&&(e.east+=2*epsilon),e.north-e.south<epsilon&&(e.north+=2*epsilon),e}function clone(from,to){if(null==from||"object"!=typeof from)return from;if(from.constructor!=Object&&from.constructor!=Array)return from;if(from.constructor==Date||from.constructor==RegExp||from.constructor==Function||from.constructor==String||from.constructor==Number||from.constructor==Boolean)return new from.constructor(from);for(var name in to=to||new from.constructor,from)to[name]=void 0===to[name]?clone(from[name],null):to[name];return to}function fillOptions(options,defaultOptions){var option;for(option in options=options||{},defaultOptions)void 0===options[option]&&(options[option]=clone(defaultOptions[option]))}function copyOptions(options,defaultOptions){var option,newOptions=clone(options);for(option in defaultOptions)void 0===newOptions[option]&&(newOptions[option]=clone(defaultOptions[option]));return newOptions}function setListener(primitive,type,callback){primitive[type]=callback}function enhanceWithListeners(element){element._listeners={},element.addListener=function(name,callback){return this._listeners[name]=this._listeners[name]||[],this._listeners[name].push(callback),this._listeners[name].length},element.executeListeners=function(event,defaultCallback){if(this._listeners[event.name]&&0<this._listeners[event.name].length)for(var index=0;index<this._listeners[event.name].length;index++)this._listeners[event.name][index](event);else defaultCallback&&defaultCallback(event)}}return _.prototype.createBillboardGroup=function(points,options,callbacks){var markers=new _.BillboardGroup(this,options);return markers.addBillboards(points,callbacks),markers},(_.BillboardGroup=function(drawHelper,options){this._drawHelper=drawHelper,this._scene=drawHelper._scene,this._options=copyOptions(options,defaultBillboard);var b=new Cesium.BillboardCollection;this._scene.primitives.add(b),this._billboards=b,this._orderedBillboards=[]}).prototype.createBillboard=function(position,callbacks){var billboard=this._billboards.add({show:!0,position:position,pixelOffset:new Cesium.Cartesian2(this._options.shiftX,this._options.shiftY),eyeOffset:new Cesium.Cartesian3(0,0,0),horizontalOrigin:Cesium.HorizontalOrigin.CENTER,verticalOrigin:Cesium.VerticalOrigin.CENTER,scale:1,image:this._options.iconUrl,height:500,color:new Cesium.Color(1,1,1,1)});if(callbacks){var _self=this,screenSpaceCameraController=this._scene.screenSpaceCameraController;function enableRotation(enable){screenSpaceCameraController.enableRotate=enable}function getIndex(){for(var i=0,I=_self._orderedBillboards.length;i<I&&_self._orderedBillboards[i]!=billboard;++i);return i}if(callbacks.dragHandlers){_self=this;setListener(billboard,"leftDown",function(position){function onDragEnd(position){handler.destroy(),enableRotation(!0),callbacks.dragHandlers.onDragEnd&&callbacks.dragHandlers.onDragEnd(getIndex(),position)}var handler=new Cesium.ScreenSpaceEventHandler(_self._scene.canvas);handler.setInputAction(function(movement){var cartesian=_self._scene.camera.pickEllipsoid(movement.endPosition,ellipsoid);cartesian?function(position){billboard.position=position;for(var i=0,I=_self._orderedBillboards.length;i<I&&_self._orderedBillboards[i]!=billboard;++i);callbacks.dragHandlers.onDrag&&callbacks.dragHandlers.onDrag(getIndex(),position)}(cartesian):onDragEnd(cartesian)},Cesium.ScreenSpaceEventType.MOUSE_MOVE),handler.setInputAction(function(movement){onDragEnd(_self._scene.camera.pickEllipsoid(movement.position,ellipsoid))},Cesium.ScreenSpaceEventType.LEFT_UP),enableRotation(!1),callbacks.dragHandlers.onDragStart&&callbacks.dragHandlers.onDragStart(getIndex(),_self._scene.camera.pickEllipsoid(position,ellipsoid))})}callbacks.onDoubleClick&&setListener(billboard,"leftDoubleClick",function(position){callbacks.onDoubleClick(getIndex())}),callbacks.onClick&&setListener(billboard,"leftClick",function(position){callbacks.onClick(getIndex())}),callbacks.tooltip&&(setListener(billboard,"mouseMove",function(position){_self._drawHelper._tooltip.showAt(position,callbacks.tooltip())}),setListener(billboard,"mouseOut",function(position){_self._drawHelper._tooltip.setVisible(!1)}))}return billboard},_.BillboardGroup.prototype.insertBillboard=function(index,position,callbacks){this._orderedBillboards.splice(index,0,this.createBillboard(position,callbacks))},_.BillboardGroup.prototype.addBillboard=function(position,callbacks){this._orderedBillboards.push(this.createBillboard(position,callbacks))},_.BillboardGroup.prototype.addBillboards=function(positions,callbacks){for(var index=0;index<positions.length;index++)this.addBillboard(positions[index],callbacks)},_.BillboardGroup.prototype.updateBillboardsPositions=function(positions){for(var index=0;index<positions.length;index++)this.getBillboard(index).position=positions[index]},_.BillboardGroup.prototype.countBillboards=function(){return this._orderedBillboards.length},_.BillboardGroup.prototype.getBillboard=function(index){return this._orderedBillboards[index]},_.BillboardGroup.prototype.removeBillboard=function(index){this._billboards.remove(this.getBillboard(index)),this._orderedBillboards.splice(index,1)},_.BillboardGroup.prototype.remove=function(){this._billboards=this._billboards&&this._billboards.removeAll()&&this._billboards.destroy()},_.BillboardGroup.prototype.setOnTop=function(){this._scene.primitives.raiseToTop(this._billboards)},_.prototype.startDrawingMarker=function(options){options=copyOptions(options,defaultBillboard);this.startDrawing(function(){try{markers&&markers.remove(),mouseHandler.destroy()}catch(e){}});var _self=this,scene=this._scene,markers=(scene.primitives,new _.BillboardGroup(this,options)),mouseHandler=new Cesium.ScreenSpaceEventHandler(scene.canvas);mouseHandler.setInputAction(function(movement){if(null!=movement.position){var cartesian=scene.camera.pickEllipsoid(movement.position,ellipsoid);cartesian&&(markers.addBillboard(cartesian),_self.stopDrawing(),options.callback(cartesian))}},Cesium.ScreenSpaceEventType.LEFT_CLICK),mouseHandler.setInputAction(function(movement){var position=movement.endPosition;if(null!=position)scene.camera.pickEllipsoid(position,ellipsoid)},Cesium.ScreenSpaceEventType.MOUSE_MOVE)},_.prototype.startDrawingPolyline=function(options){options=copyOptions(options,defaultPolylineOptions);this.startDrawingmultiline(!1,options)},_.prototype.startDrawingSingleline=function(options){options=copyOptions(options,defaultPolylineOptions);this.startDrawingSline(!1,options)},_.prototype.startDrawingPolygon=function(options){options=copyOptions(options,defaultSurfaceOptions);this.startDrawingPolyshape(!0,options)},_.prototype.startDrawingPoint=function(options){options=copyOptions(options,defaultSurfaceOptions);this.startDrawing(function(){try{null!=circle&&primitives.remove(circle),markers&&markers.remove(),mouseHandler.destroy()}catch(e){}});var _self=this,scene=this._scene,primitives=this._scene.primitives,circle=null,markers=null;var mouseHandler=new Cesium.ScreenSpaceEventHandler(scene.canvas);mouseHandler.setInputAction(function(movement){if(null!=movement.position){var cartesian=scene.camera.pickEllipsoid(movement.position,ellipsoid);if(cartesian){movement.position;var geoc=ellipsoid.cartesianToCartographic(cartesian),point=[Cesium.Math.toDegrees(geoc.longitude),Cesium.Math.toDegrees(geoc.latitude)],radius=1e6/Math.pow(2,_self._map.GetZoom());options.callstart({screen:movement.position,type:"point",geometry:point}),null==circle?(circle=new _.PointPrimitive({center:cartesian,radius:radius,asynchronous:!1,material:options.material}),primitives.add(circle)):(circle.setCenter(cartesian),circle.setRadius(radius)),options.callback({screen:movement.position,type:"point",geometry:point}),_self.EnableInput(!0)}}},Cesium.ScreenSpaceEventType.LEFT_DOWN)},_.prototype.startDrawingPolyshape=function(isPolygon,options){this.startDrawing(function(){try{markers&&markers.remove(),mouseHandler.destroy(),primitives.remove(poly),primitives.remove(polyline)}catch(e){}});var poly,polyline,_self=this,scene=this._scene,primitives=scene.primitives,minPoints=isPolygon?3:2,lineWidth=options.lineWidth;(poly=isPolygon?(lineWidth&&(defaultPolylineOptions.width=lineWidth),(polyline=new Input3DTool.PolylinePrimitive(defaultPolylineOptions)).asynchronous=!1,primitives.add(polyline),new Input3DTool.PolygonPrimitive(options)):new Input3DTool.PolylinePrimitive(options)).asynchronous=!1,primitives.add(poly);var positions=[],markers=new _.BillboardGroup(this,defaultBillboard),mouseHandler=new Cesium.ScreenSpaceEventHandler(scene.canvas);mouseHandler.setInputAction(function(movement){if(null!=movement.position){var cartesian=scene.camera.pickEllipsoid(movement.position,ellipsoid);cartesian&&(0==positions.length&&(options.callstart({screen:movement.position,firstPoint:cartesian}),positions.push(cartesian.clone()),markers.addBillboard(positions[0])),positions.push(cartesian),positions.length>=minPoints&&(poly.positions=positions,poly._createPrimitive=!0),markers.addBillboard(cartesian))}},Cesium.ScreenSpaceEventType.LEFT_CLICK),mouseHandler.setInputAction(function(movement){var position=movement.endPosition;if(null!=position)if(0==positions.length);else{var cartesian=scene.camera.pickEllipsoid(position,ellipsoid);if(cartesian.z=cartesian.z+20,cartesian){if(positions.pop(),cartesian.y+=1+Math.random(),positions.push(cartesian),positions.length>=minPoints)poly.positions=positions,poly._createPrimitive=!0;else{var newPnts=[new Cesium.Cartesian3(positions[0].x,positions[0].y,positions[0].z),new Cesium.Cartesian3(positions[1].x,positions[1].y,positions[1].z)];polyline&&(polyline.positions=newPnts,polyline._createPrimitive=!0)}markers.getBillboard(positions.length-1).position=cartesian}}},Cesium.ScreenSpaceEventType.MOUSE_MOVE),mouseHandler.setInputAction(function(movement){var position=movement.position;if(null!=position){if(positions.length<minPoints+2)return;if(scene.camera.pickEllipsoid(position,ellipsoid)&&(_self.stopDrawing(),"function"==typeof options.callback)){positions.length;for(var polygon=[],i=0;i<positions.length-1;i++){var geoc=ellipsoid.cartesianToCartographic(positions[i]);polygon.push([Cesium.Math.toDegrees(geoc.longitude),Cesium.Math.toDegrees(geoc.latitude)])}geoc=ellipsoid.cartesianToCartographic(positions[0]),polygon.push([Cesium.Math.toDegrees(geoc.longitude),Cesium.Math.toDegrees(geoc.latitude)]),options.callback({geometry:polygon,type:"polygon"})}}},Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK)},_.prototype.startDrawingmultiline=function(isPolygon,options){this.startDrawing(function(){try{markers&&markers.remove(),mouseHandler.destroy(),primitives.remove(poly),primitives.remove(void 0)}catch(e){}});var poly,_self=this,scene=this._scene,primitives=scene.primitives,minPoints=isPolygon?3:2;(poly=new Input3DTool.PolylinePrimitive(options)).asynchronous=!1,primitives.add(poly);var positions=[],markers=new _.BillboardGroup(this,defaultBillboard),mouseHandler=new Cesium.ScreenSpaceEventHandler(scene.canvas);mouseHandler.setInputAction(function(movement){if(null!=movement.position){var cartesian=scene.camera.pickEllipsoid(movement.position,ellipsoid);cartesian&&(0==positions.length&&(options.callstart({screen:movement.position,firstPoint:cartesian}),positions.push(cartesian.clone()),markers.addBillboard(positions[0])),positions.push(cartesian),positions.length>=minPoints&&(poly.positions=positions,poly._createPrimitive=!0),markers.addBillboard(cartesian))}},Cesium.ScreenSpaceEventType.LEFT_CLICK),mouseHandler.setInputAction(function(movement){var position=movement.endPosition;if(null!=position)if(0==positions.length);else{var cartesian=scene.camera.pickEllipsoid(position,ellipsoid);if(cartesian){if(positions.pop(),cartesian.y+=1+Math.random(),positions.push(cartesian),positions.length>=minPoints)poly.positions=positions,poly._createPrimitive=!0;else{new Cesium.Cartesian3(positions[0].x,positions[0].y,positions[0].z),new Cesium.Cartesian3(positions[1].x,positions[1].y,positions[1].z);void 0}markers.getBillboard(positions.length-1).position=cartesian}}},Cesium.ScreenSpaceEventType.MOUSE_MOVE),mouseHandler.setInputAction(function(movement){var position=movement.position;if(null!=position){if(positions.length<minPoints+2)return;if(scene.camera.pickEllipsoid(position,ellipsoid)&&(_self.stopDrawing(),"function"==typeof options.callback)){positions.length;for(var polygon=[],i=0;i<positions.length-1;i++){var geoc=ellipsoid.cartesianToCartographic(positions[i]);polygon.push([Cesium.Math.toDegrees(geoc.longitude),Cesium.Math.toDegrees(geoc.latitude)])}options.callback({geometry:polygon,type:"polyline"})}}},Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK)},_.prototype.startDrawingSline=function(isPolygon,options){this.startDrawing(function(){try{markers&&markers.remove(),mouseHandler.destroy(),primitives.remove(poly),primitives.remove(void 0)}catch(e){}});var poly,_self=this,scene=this._scene,primitives=scene.primitives,minPoints=isPolygon?3:2;(poly=new Input3DTool.PolylinePrimitive(options)).asynchronous=!1,primitives.add(poly);var positions=[],markers=new _.BillboardGroup(this,defaultBillboard),mouseHandler=new Cesium.ScreenSpaceEventHandler(scene.canvas);mouseHandler.setInputAction(function(movement){if(null!=movement.position){var cartesian=scene.camera.pickEllipsoid(movement.position,ellipsoid);if(cartesian){if(0==positions.length)options.callstart({screen:movement.position,firstPoint:cartesian}),positions.push(cartesian.clone()),markers.addBillboard(positions[0]);else if(_self.stopDrawing(),"function"==typeof options.callback){positions.length;for(var polygon=[],i=0;i<positions.length;i++){var geoc=ellipsoid.cartesianToCartographic(positions[i]);polygon.push([Cesium.Math.toDegrees(geoc.longitude),Cesium.Math.toDegrees(geoc.latitude)])}options.callback({geometry:polygon,type:"singleline"})}positions.push(cartesian),positions.length>=minPoints&&(poly.positions=positions,poly._createPrimitive=!0),markers.addBillboard(cartesian)}}},Cesium.ScreenSpaceEventType.LEFT_CLICK),mouseHandler.setInputAction(function(movement){var position=movement.endPosition;if(null!=position)if(0==positions.length);else{var cartesian=scene.camera.pickEllipsoid(position,ellipsoid);if(cartesian){if(positions.pop(),cartesian.y+=1+Math.random(),positions.push(cartesian),positions.length>=minPoints)poly.positions=positions,poly._createPrimitive=!0;else{new Cesium.Cartesian3(positions[0].x,positions[0].y,positions[0].z),new Cesium.Cartesian3(positions[1].x,positions[1].y,positions[1].z);void 0}markers.getBillboard(positions.length-1).position=cartesian}}},Cesium.ScreenSpaceEventType.MOUSE_MOVE),mouseHandler.setInputAction(function(movement){if(null!=movement.position&&(_self.stopDrawing(),"function"==typeof options.callback)){positions.length;for(var polygon=[],i=0;i<positions.length;i++){var geoc=ellipsoid.cartesianToCartographic(positions[i]);polygon.push([Cesium.Math.toDegrees(geoc.longitude),Cesium.Math.toDegrees(geoc.latitude)])}options.callback({geometry:polygon,type:"singleline"})}},Cesium.ScreenSpaceEventType.RIGHT_CLICK)},_.prototype.startDrawingExtent=function(options){options=copyOptions(options,defaultSurfaceOptions);this.startDrawing(function(){try{null!=extent&&primitives.remove(extent),markers&&markers.remove(),mouseHandler.destroy()}catch(e){}});var _self=this,scene=this._scene,primitives=this._scene.primitives,firstPoint=null,firstPixel=null,extent=null,markers=null,mouseHandler=new Cesium.ScreenSpaceEventHandler(scene.canvas);function updateExtent(value){null==extent&&(options.extent=value,(extent=new _.ExtentPrimitive(options)).asynchronous=!1,primitives.add(extent)),extent.setExtent(value),extent._createPrimitive=!0;var corners=getExtentCorners(value);null==markers?(markers=new _.BillboardGroup(_self,defaultBillboard)).addBillboards(corners):markers.updateBillboardsPositions(corners)}mouseHandler.setInputAction(function(movement){if(null!=movement.position){var cartesian=scene.camera.pickEllipsoid(movement.position,ellipsoid);if(cartesian)if(null==extent)options.callstart({screen:movement.position,firstPoint:cartesian}),firstPixel=movement.position,updateExtent(getExtent(firstPoint=ellipsoid.cartesianToCartographic(cartesian),firstPoint));else if(_self.stopDrawing(),"function"==typeof options.callback){var rect=getExtent(firstPoint,ellipsoid.cartesianToCartographic(cartesian)),degRect=[Cesium.Math.toDegrees(rect.west),Cesium.Math.toDegrees(rect.south),Cesium.Math.toDegrees(rect.east),Cesium.Math.toDegrees(rect.north)];options.callback({geometry:degRect,type:"rectangle"})}}},Cesium.ScreenSpaceEventType.LEFT_DOWN),mouseHandler.setInputAction(function(movement){if(null!=movement.position){var cartesian=scene.camera.pickEllipsoid(movement.position,ellipsoid);if(cartesian&&null!=extent){var secPoint=ellipsoid.cartesianToCartographic(cartesian);if(p1=firstPixel,p2=movement.position,Math.abs(p1.x-p2.x)<5&&Math.abs(p1.x-p2.x)<5)return;if(_self.stopDrawing(),"function"==typeof options.callback){var rect=getExtent(firstPoint,secPoint),degRect=[Cesium.Math.toDegrees(rect.west),Cesium.Math.toDegrees(rect.south),Cesium.Math.toDegrees(rect.east),Cesium.Math.toDegrees(rect.north)];options.callback({geometry:degRect,type:"rectangle"})}}}var p1,p2},Cesium.ScreenSpaceEventType.LEFT_UP),mouseHandler.setInputAction(function(movement){var position=movement.endPosition;if(null!=position)if(null==extent);else{var cartesian=scene.camera.pickEllipsoid(position,ellipsoid);if(cartesian)updateExtent(getExtent(firstPoint,ellipsoid.cartesianToCartographic(cartesian)))}},Cesium.ScreenSpaceEventType.MOUSE_MOVE)},_.prototype.startDrawingCircle=function(options){options=copyOptions(options,defaultSurfaceOptions);this.startDrawing(function(){try{null!=circle&&primitives.remove(circle),markers&&markers.remove(),mouseHandler.destroy()}catch(e){}});var _self=this,scene=this._scene,primitives=this._scene.primitives,circle=null,markers=null,firstPixel=null;var mouseHandler=new Cesium.ScreenSpaceEventHandler(scene.canvas);mouseHandler.setInputAction(function(movement){if(null!=movement.position){var cartesian=scene.camera.pickEllipsoid(movement.position,ellipsoid);if(cartesian)if(firstPixel=movement.position,null==circle)options.callstart({screen:movement.position,firstPoint:cartesian}),circle=new _.CirclePrimitive({center:cartesian,radius:0,asynchronous:!1,material:options.material}),primitives.add(circle),(markers=new _.BillboardGroup(_self,defaultBillboard)).addBillboards([cartesian]);else{if("function"==typeof options.callback){var geoc=ellipsoid.cartesianToCartographic(circle.getCenter()),param={center:[Cesium.Math.toDegrees(geoc.longitude),Cesium.Math.toDegrees(geoc.latitude)],radius:Cesium.Math.toDegrees(circle.getRadius()/ellipsoid._maximumRadius)};options.callback({geometry:param,type:"circle"})}_self.stopDrawing()}}},Cesium.ScreenSpaceEventType.LEFT_DOWN),mouseHandler.setInputAction(function(movement){var p1,p2;if(null!=movement.position&&scene.camera.pickEllipsoid(movement.position,ellipsoid)){if(p1=firstPixel,p2=movement.position,Math.abs(p1.x-p2.x)<5&&Math.abs(p1.x-p2.x)<5)return;if(circle){if("function"==typeof options.callback){var geoc=ellipsoid.cartesianToCartographic(circle.getCenter()),param={center:[Cesium.Math.toDegrees(geoc.longitude),Cesium.Math.toDegrees(geoc.latitude)],radius:Cesium.Math.toDegrees(circle.getRadius()/ellipsoid._maximumRadius)};options.callback({geometry:param,type:"circle"})}_self.stopDrawing()}}},Cesium.ScreenSpaceEventType.LEFT_UP),mouseHandler.setInputAction(function(movement){var position=movement.endPosition;if(null!=position)if(null==circle);else{var cartesian=scene.camera.pickEllipsoid(position,ellipsoid);cartesian&&(circle.setRadius(Cesium.Cartesian3.distance(circle.getCenter(),cartesian)),markers.updateBillboardsPositions(cartesian))}},Cesium.ScreenSpaceEventType.MOUSE_MOVE)},_.prototype.enhancePrimitives=function(){var drawHelper=this;function setHighlighted(highlighted){drawHelper._scene;this._highlighted&&this._highlighted==highlighted||!0!==this._editMode&&((this._highlighted=highlighted)?(drawHelper.setHighlighted(this),this._strokeColor=this.strokeColor,this.setStrokeStyle(Cesium.Color.fromCssColorString("white"),this.strokeWidth)):this._strokeColor?this.setStrokeStyle(this._strokeColor,this.strokeWidth):this.setStrokeStyle(void 0,void 0))}function setEditMode(editMode){if(this._editMode!=editMode)if(drawHelper.disableAllHighlights(),editMode){drawHelper.setEdited(this);var scene=drawHelper._scene,_self=this;if(null==this._markers){var markers=new _.BillboardGroup(drawHelper,dragBillboard),editMarkers=new _.BillboardGroup(drawHelper,dragHalfBillboard);function updateHalfMarkers(index,positions){var editIndex=index-1<0?positions.length-1:index-1;editIndex<editMarkers.countBillboards()&&(editMarkers.getBillboard(editIndex).position=calculateHalfMarkerPosition(editIndex)),(editIndex=index)<editMarkers.countBillboards()&&(editMarkers.getBillboard(editIndex).position=calculateHalfMarkerPosition(editIndex))}function onEdited(){_self.executeListeners({name:"onEdited",positions:_self.positions})}var handleMarkerChanges={dragHandlers:{onDrag:function(index,position){_self.positions[index]=position,updateHalfMarkers(index,_self.positions),_self._createPrimitive=!0},onDragEnd:function(index,position){_self._createPrimitive=!0,onEdited()}},onDoubleClick:function(index){_self.positions.length<4||(_self.positions.splice(index,1),_self._createPrimitive=!0,markers.removeBillboard(index),editMarkers.removeBillboard(index),updateHalfMarkers(index,_self.positions),onEdited())},tooltip:function(){if(3<_self.positions.length)return"双击移动这个点"}};function calculateHalfMarkerPosition(index){var positions=_self.positions;return ellipsoid.cartographicToCartesian(new Cesium.EllipsoidGeodesic(ellipsoid.cartesianToCartographic(positions[index]),ellipsoid.cartesianToCartographic(positions[index<positions.length-1?index+1:0])).interpolateUsingFraction(.5))}markers.addBillboards(_self.positions,handleMarkerChanges),this._markers=markers;for(var halfPositions=[],index=0,length=_self.positions.length+(this.isPolygon?0:-1);index<length;index++)halfPositions.push(calculateHalfMarkerPosition(index));var handleEditMarkerChanges={dragHandlers:{onDragStart:function(index,position){this.index=index+1,_self.positions.splice(this.index,0,position),_self._createPrimitive=!0},onDrag:function(index,position){_self.positions[this.index]=position,_self._createPrimitive=!0},onDragEnd:function(index,position){markers.insertBillboard(this.index,position,handleMarkerChanges),editMarkers.getBillboard(this.index-1).position=calculateHalfMarkerPosition(this.index-1),editMarkers.insertBillboard(this.index,calculateHalfMarkerPosition(this.index),handleEditMarkerChanges),_self._createPrimitive=!0,onEdited()}},tooltip:function(){return"拖拽可以产生新的点"}};editMarkers.addBillboards(halfPositions,handleEditMarkerChanges),this._editMarkers=editMarkers,this._globeClickhandler=new Cesium.ScreenSpaceEventHandler(scene.canvas),this._globeClickhandler.setInputAction(function(movement){var pickedObject=scene.pick(movement.position);pickedObject&&pickedObject.primitive||_self.setEditMode(!1)},Cesium.ScreenSpaceEventType.LEFT_CLICK),markers.setOnTop(),editMarkers.setOnTop()}this._editMode=!0}else null!=this._markers&&(this._markers.remove(),this._editMarkers.remove(),this._markers=null,this._editMarkers=null,this._globeClickhandler.destroy()),this._editMode=!1}Cesium.Billboard.prototype.setEditable=function(){if(!this._editable){this._editable=!0;var billboard=this,_self=this;setListener(billboard,"leftDown",function(position){function onDragEnd(position){handler.destroy(),enableRotation(!0),_self.executeListeners({name:"dragEnd",positions:position})}var handler=new Cesium.ScreenSpaceEventHandler(drawHelper._scene.canvas);handler.setInputAction(function(movement){var position,cartesian=drawHelper._scene.camera.pickEllipsoid(movement.endPosition,ellipsoid);cartesian?(position=cartesian,billboard.position=position,_self.executeListeners({name:"drag",positions:position})):onDragEnd(cartesian)},Cesium.ScreenSpaceEventType.MOUSE_MOVE),handler.setInputAction(function(movement){onDragEnd(drawHelper._scene.camera.pickEllipsoid(movement.position,ellipsoid))},Cesium.ScreenSpaceEventType.LEFT_UP),enableRotation(!1)}),enhanceWithListeners(billboard)}function enableRotation(enable){drawHelper._scene.screenSpaceCameraController.enableRotate=enable}},Input3DTool.PolylinePrimitive.prototype.setEditable=function(){if(!this.setEditMode){this.isPolygon=!1,this.asynchronous=!1,drawHelper.registerEditableShape(this),this.setEditMode=setEditMode;var originalWidth=this.width;this.setHighlighted=function(highlighted){!0!==this._editMode&&(highlighted?(drawHelper.setHighlighted(this),this.setWidth(2*originalWidth)):this.setWidth(originalWidth))},this.getExtent=function(){return Cesium.Extent.fromCartographicArray(ellipsoid.cartesianArrayToCartographicArray(this.positions))},enhanceWithListeners(this),this.setEditMode(!1)}},Input3DTool.PolygonPrimitive.prototype.setEditable=function(){this.asynchronous=!1;drawHelper._scene;drawHelper.registerEditableShape(this),this.setEditMode=setEditMode,this.setHighlighted=setHighlighted,enhanceWithListeners(this),this.setEditMode(!1)},Input3DTool.ExtentPrimitive.prototype.setEditable=function(){if(!this.setEditMode){var extent=this,scene=drawHelper._scene;drawHelper.registerEditableShape(extent),extent.asynchronous=!1,extent.setEditMode=function(editMode){if(this._editMode!=editMode)if(drawHelper.disableAllHighlights(),editMode){if(drawHelper.setEdited(this),null==this._markers){var markers=new _.BillboardGroup(drawHelper,dragBillboard);var handleMarkerChanges={dragHandlers:{onDrag:function(index,position){var corner=markers.getBillboard((index+2)%4).position;extent.setExtent(getExtent(ellipsoid.cartesianToCartographic(corner),ellipsoid.cartesianToCartographic(position))),markers.updateBillboardsPositions(getExtentCorners(extent.extent))},onDragEnd:function(index,position){extent.executeListeners({name:"onEdited",extent:extent.extent})}},tooltip:function(){return"Drag to change the corners of this extent"}};markers.addBillboards(getExtentCorners(extent.extent),handleMarkerChanges),this._markers=markers,this._globeClickhandler=new Cesium.ScreenSpaceEventHandler(scene.canvas),this._globeClickhandler.setInputAction(function(movement){var pickedObject=scene.pick(movement.position);pickedObject&&!pickedObject.isDestroyed()&&pickedObject.primitive||extent.setEditMode(!1)},Cesium.ScreenSpaceEventType.LEFT_CLICK),markers.setOnTop()}this._editMode=!0}else null!=this._markers&&(this._markers.remove(),this._markers=null,this._globeClickhandler.destroy()),this._editMode=!1},extent.setHighlighted=setHighlighted,enhanceWithListeners(extent),extent.setEditMode(!1)}},_.EllipsePrimitive.prototype.setEditable=function(){if(!this.setEditMode){var ellipse=this,scene=drawHelper._scene;ellipse.asynchronous=!1,drawHelper.registerEditableShape(ellipse),ellipse.setEditMode=function(editMode){if(this._editMode!=editMode)if(drawHelper.disableAllHighlights(),editMode){drawHelper.setEdited(this);var _self=this;if(null==this._markers){var markers=new _.BillboardGroup(drawHelper,dragBillboard);function getMarkerPositions(){return Cesium.Shapes.computeEllipseBoundary(ellipsoid,ellipse.getCenter(),ellipse.getSemiMajorAxis(),ellipse.getSemiMinorAxis(),ellipse.getRotation()+Math.PI/2,Math.PI/2).splice(0,4)}var handleMarkerChanges={dragHandlers:{onDrag:function(index,position){var distance=Cesium.Cartesian3.distance(ellipse.getCenter(),position);index%2==0?ellipse.setSemiMajorAxis(distance):ellipse.setSemiMinorAxis(distance),markers.updateBillboardsPositions(getMarkerPositions())},onDragEnd:function(index,position){ellipse.executeListeners({name:"onEdited",center:ellipse.getCenter(),semiMajorAxis:ellipse.getSemiMajorAxis(),semiMinorAxis:ellipse.getSemiMinorAxis(),rotation:0})}},tooltip:function(){return"拖拽改变半径"}};markers.addBillboards(getMarkerPositions(),handleMarkerChanges),this._markers=markers,this._globeClickhandler=new Cesium.ScreenSpaceEventHandler(scene.canvas),this._globeClickhandler.setInputAction(function(movement){var pickedObject=scene.pick(movement.position);pickedObject&&pickedObject.primitive||_self.setEditMode(!1)},Cesium.ScreenSpaceEventType.LEFT_CLICK),markers.setOnTop()}this._editMode=!0}else null!=this._markers&&(this._markers.remove(),this._markers=null,this._globeClickhandler.destroy()),this._editMode=!1},ellipse.setHighlighted=setHighlighted,enhanceWithListeners(ellipse),ellipse.setEditMode(!1)}},_.CirclePrimitive.prototype.getCircleCartesianCoordinates=function(granularity){for(var value,geometry=Cesium.CircleOutlineGeometry.createGeometry(new Cesium.CircleOutlineGeometry({ellipsoid:ellipsoid,center:this.getCenter(),radius:this.getRadius(),granularity:granularity})),count=0,values=[];count<geometry.attributes.position.values.length;count+=3)value=geometry.attributes.position.values,values.push(new Cesium.Cartesian3(value[count],value[count+1],value[count+2]));return values},_.CirclePrimitive.prototype.setEditable=function(){if(!this.setEditMode){var circle=this,scene=drawHelper._scene;circle.asynchronous=!1,drawHelper.registerEditableShape(circle),circle.setEditMode=function(editMode){if(this._editMode!=editMode)if(drawHelper.disableAllHighlights(),editMode){drawHelper.setEdited(this);var _self=this;if(null==this._markers){var markers=new _.BillboardGroup(drawHelper,dragBillboard);function getMarkerPositions(){return _self.getCircleCartesianCoordinates(Cesium.Math.PI_OVER_TWO)}var handleMarkerChanges={dragHandlers:{onDrag:function(index,position){circle.setRadius(Cesium.Cartesian3.distance(circle.getCenter(),position)),markers.updateBillboardsPositions(getMarkerPositions())},onDragEnd:function(index,position){circle.executeListeners({name:"onEdited",center:circle.getCenter(),radius:circle.getRadius()})}},tooltip:function(){return"拖拽改变半径"}};markers.addBillboards(getMarkerPositions(),handleMarkerChanges),this._markers=markers,this._globeClickhandler=new Cesium.ScreenSpaceEventHandler(scene.canvas),this._globeClickhandler.setInputAction(function(movement){var pickedObject=scene.pick(movement.position);pickedObject&&pickedObject.primitive||_self.setEditMode(!1)},Cesium.ScreenSpaceEventType.LEFT_CLICK),markers.setOnTop()}this._editMode=!0}else null!=this._markers&&(this._markers.remove(),this._markers=null,this._globeClickhandler.destroy()),this._editMode=!1},circle.setHighlighted=setHighlighted,enhanceWithListeners(circle),circle.setEditMode(!1)}}},_.Input3DToolWidget=function(drawHelper,options){if(!Cesium.defined(options.container))throw new Cesium.DeveloperError("Container is required");fillOptions(options,{markerIcon:"./images/glyphicons_242_google_maps.png",polylineIcon:"./images/glyphicons_097_vector_path_line.png",polygonIcon:"./images/glyphicons_096_vector_path_polygon.png",circleIcon:"./images/glyphicons_095_vector_path_circle.png",clearIcon:"./images/glyphicons_067_cleaning.png",polylineDrawingOptions:defaultPolylineOptions,polygonDrawingOptions:defaultPolygonOptions,circleDrawingOptions:defaultCircleOptions});var _self=this,toolbar=document.createElement("DIV");function addIcon(id,url,title,html,callback){var div=document.createElement("DIV");div.className="draw_button",div.id="draw_"+id,div.title=title,toolbar.appendChild(div),div.onclick=callback;var span=document.createElement("SPAN");div.appendChild(span);var image=document.createElement("IMG");image.src=url,image.style.width="20px",image.style.height="20px";var htmlImg='<img src="'+url+'"style="width:31px;height:25px;left: 8px;position=absolute"/>'+html;return span.innerHTML=htmlImg,span.style.color="white",div}toolbar.className="toolbar",options.container.appendChild(toolbar),drawHelper._scene,addIcon("marker",options.markerIcon,"点击开始绘制点",'<p class="draw_p">绘制点</p>',function(){drawHelper.startDrawingMarker({callback:function(position){_self.executeListeners({name:"markerCreated",position:position})}})}),addIcon("polyline",options.polylineIcon,"点击开始绘制线",'<p class="draw_p">绘制线</p>',function(){drawHelper.startDrawingPolyline({callback:function(positions){_self.executeListeners({name:"polylineCreated",positions:positions})}})}),addIcon("polygon",options.polygonIcon,"点击开始绘制面",'<p class="draw_p">绘制面</p>',function(){drawHelper.startDrawingPolygon({callback:function(positions){_self.executeListeners({name:"polygonCreated",positions:positions})}})}),addIcon("circle",options.circleIcon,"点击开始绘制圆",'<p class="draw_p">绘制圆</p>',function(){drawHelper.startDrawingCircle({callback:function(center,radius){_self.executeListeners({name:"circleCreated",center:center,radius:radius})}})}),enhanceWithListeners(this)},_.prototype.addToolbar=function(container,options){return options=copyOptions(options,{container:container}),new _.Input3DToolWidget(this,options)},_}();Map3DSDKLib.Input3DTool=Input3DTool,Map3DSDKLib.Math=function(){};Map3DSDKLib.Math.Degree2Rad=function(d){return d*Math.PI/180},Map3DSDKLib.Math.CalcFlatDistance=function(lng1,lat1,lng2,lat2){var s,c,w,r,f=Map3DSDKLib.Math.Degree2Rad((lat1+lat2)/2),g=Map3DSDKLib.Math.Degree2Rad((lat1-lat2)/2),l=Map3DSDKLib.Math.Degree2Rad((lng1-lng2)/2),sg=Math.sin(g),sl=Math.sin(l),sf=Math.sin(f);return s=(sg*=sg)*(1-(sl*=sl))+(1-(sf*=sf))*sl,c=(1-sg)*(1-sl)+sf*sl,2*(w=Math.atan(Math.sqrt(s/c)))*6378137*(1+1/298.257*((3*(r=Math.sqrt(s*c)/w)-1)/2/c*sf*(1-sg)-(3*r+1)/2/s*(1-sf)*sg))},Map3DSDKLib.Math.CalcTriAngleArea=function(lon1,lat1,lon2,lat2,lon3,lat3){var a=Map3DSDKLib.Math.CalcFlatDistance(lon1,lat1,lon2,lat2),b=Map3DSDKLib.Math.CalcFlatDistance(lon2,lat2,lon3,lat3),c=Map3DSDKLib.Math.CalcFlatDistance(lon1,lat1,lon3,lat3),p=(a+b+c)/2;return Math.sqrt(p*(p-a)*(p-b)*(p-c))},Map3DSDKLib.Math.CalcAnyPolyArea=function(polys){polys=function(inLine){var outline=[];if(null!=inLine){for(var m=0;m<inLine.length;m++){var coor={x:inLine[m].x,y:inLine[m].y,z:inLine[m].z},point=map3DView.cartesianTo2MapCoord(coor);outline.push(point[0]),outline.push(point[1])}return outline}}(polys);for(var area=0,i=1;i<=polys.length/2-3;i++)area+=Map3DSDKLib.Math.CalcTriAngleArea(polys[2*i-2],polys[2*i-1],polys[2*i],polys[2*i+1],polys[2*i+2],polys[2*i+3]);return area};var toolMap={};var distanceTool=Map3DSDKLib.DistanceTool=function(divMap){this.divMap=divMap,this.Input3DTool=new Map3DSDKLib.Input3DTool(map),toolMap.dist=this};distanceTool.prototype.GetMap=function(){return this.divMap},distanceTool.prototype.ClearGeometry=function(){this.Input3DTool.ClearGeometry()};var onlyTip=null;function LineStartCallBack(e){if(toolMap.dist.ClearGeometry(),toolMap.dist.GetMap().RemoveLabel("distance-tip"),e){var st_ed=e.currentTarget.finishCoordinate_;toolMap.dist.GetMap().AddTextLabel("distance-tip-start",st_ed[0],st_ed[1],"起点")}}function LineEndCallBack(e){e.feature.values_.geometry.extent_;for(var polys=e.feature.values_.geometry.flatCoordinates,len=polys.length,length=0,i=1;i<polys.length/2;i++)length+=Map3DSDKLib.Math.CalcFlatDistance(polys[2*i-2],polys[2*i-1],polys[2*i],polys[2*i+1]);length/=1e3,toolMap.dist.GetMap().AddTextLabel("distance-tip",polys[len-2],polys[len-1],"总长:"+length.toFixed(2)+"公里")}distanceTool.prototype.AddFlashTip=function(text,miniSeconds){if(this.CloseFlashTip(),null==onlyTip){null==miniSeconds&&(miniSeconds=3e3);var cen=this.GetMap().GetViewCenter();if(null==cen)return void this.CloseFlashTip();toolMap.dist.GetMap().AddTextLabel("only-tip",cen[0],cen[1],text),onlyTip=window.setInterval(this.CloseFlashTip,miniSeconds)}},distanceTool.prototype.CloseFlashTip=function(){null!=onlyTip&&(toolMap.dist.GetMap().RemoveLabel("only-tip"),window.clearInterval(onlyTip),onlyTip=null)},distanceTool.prototype.Start=function(){LineStartCallBack(),this.AddFlashTip("距离提示：左击开始，双击左键结束!",2e3),this.Input3DTool.StartLineTool(LineStartCallBack,LineEndCallBack)},distanceTool.prototype.End=function(){this.Input3DTool.ClearAll(),this.GetMap().RemoveLabel("distance-tip-start"),this.GetMap().RemoveLabel("distance-tip")},Map3DSDKLib.DistanceTool=distanceTool;var areaTool=Map3DSDKLib.AreaTool=function(divMap){this.divMap=divMap,this.Input3DTool=new Map3DSDKLib.Input3DTool(divMap),toolMap.area=this};areaTool.prototype.GetMap=function(){return this.divMap},areaTool.prototype.ClearGeometry=function(){this.Input3DTool.ClearGeometry()};onlyTip=null;function PolyStartCallBack(e){toolMap.area.ClearGeometry(),toolMap.area.GetMap().RemoveLabel("area-tip-start"),toolMap.area.GetMap().RemoveLabel("area-tip")}function PolyEndCallBack(e){for(var polys=e.feature.values_.geometry.flatCoordinates,tooltipCoord=e.feature.values_.geometry.getInteriorPoint().getCoordinates(),area=(polys.length,0),i=1;i<=polys.length/2-3;i++)area+=Map3DSDKLib.Math.CalcTriAngleArea(polys[2*i-2],polys[2*i-1],polys[2*i],polys[2*i+1],polys[2*i+2],polys[2*i+3]);var tip="";tip=1e6<area?"总面积:"+(area/=1e6).toFixed(2)+"平方公里":"总面积:"+area.toFixed(2)+"平方米",toolMap.area.GetMap().AddTextLabel("area-tip",tooltipCoord[0],tooltipCoord[1],tip)}areaTool.prototype.AddFlashTip=function(text,miniSeconds){if(this.CloseFlashTip(),null==onlyTip){null==miniSeconds&&(miniSeconds=3e3);var cen=this.GetMap().GetViewCenter();if(null==cen)return void this.CloseFlashTip();toolMap.area.GetMap().AddTextLabel("only-tip",cen[0],cen[1],text),onlyTip=window.setInterval(this.CloseFlashTip,miniSeconds)}},areaTool.prototype.CloseFlashTip=function(){null!=onlyTip&&(toolMap.area.GetMap().RemoveLabel("only-tip"),window.clearInterval(onlyTip),onlyTip=null)},areaTool.prototype.Start=function(){PolyStartCallBack(),this.AddFlashTip("距离提示：左击开始，双击左键结束!",2e3),this.Input3DTool.StartPolygonTool(PolyStartCallBack,PolyEndCallBack)},areaTool.prototype.End=function(){this.Input3DTool.ClearAll(),this.GetMap().RemoveLabel("area-tip-start"),this.GetMap().RemoveLabel("area-tip")},Map3DSDKLib.AreaTool=areaTool}();var ZMap3DLib=Map3DSDKLib,GmMap3DLib=Map3DSDKLib;function PathFly(viewer,models,pathArray){models[0],models[1],models[2];var _currentModel=null,_time=new Cesium.JulianDate,oldTime=new Cesium.JulianDate,_position=null,_ctargets=null;!function(json){_position=new Cesium.SampledPositionProperty,_ctargets=new Cesium.SampledPositionProperty;for(var positinsArray=json.RowValue,i=0;i<positinsArray.length;i++){var props=positinsArray[i],time=Cesium.JulianDate.addSeconds(_time,props[0],new Cesium.JulianDate),positon=Cesium.Cartesian3.fromDegrees(props[4],props[5],props[6]),cpositon=Cesium.Cartesian3.fromDegrees(props[1],props[2],props[3]);_position.addSample(time,positon),_ctargets.addSample(time,cpositon)}}(pathArray);var _orientation=new Cesium.VelocityOrientationProperty(_position),_pauseFlag=!1,_speed=1,_isLock=!0;function print(){!function(time){var cartesian=_position.getValue(time),quaternion=_orientation.getValue(time);if(cartesian&&quaternion){var cartographic=Cesium.Cartographic.fromCartesian(cartesian);if(_isLock){var cpositon=_ctargets.getValue(time);cpositon=Cesium.Cartographic.fromCartesian(cpositon),viewer.camera.lookAtFromTo(cpositon,cartographic)}}}(_time)}_position.setInterpolationOptions({interpolationDegree:2,interpolationAlgorithm:Cesium.LagrangePolynomialApproximation}),function(models){for(var i in models)models[i]._czEntity.show=!1,viewer.models.add(models[i])}(models),this.play=function(){_pauseFlag?this.resume():(this.resume(),viewer._czdata.viewer.scene.postRender.addEventListener(print),viewer._czdata.viewer.scene.postRender.addEventListener(tick))},this.stop=function(){_currentModel&&(_currentModel._czEntity.show=!1),viewer._czdata.viewer.scene.postRender.removeEventListener(tick),viewer._czdata.viewer.scene.postRender.removeEventListener(print),_time=new Cesium.JulianDate,oldTime=new Cesium.JulianDate,_pauseFlag=!1,_speed=1,_currentModel=null,viewer.camera.clearLookAt()},this.pause=function(){_pauseFlag=!0},this.resume=function(){_pauseFlag=!1},this.speedUp=function(x){x=parseInt(x),_speed=x},this.lock=function(){_isLock=!0},this.unlock=function(){_isLock=!1,viewer.camera.clearLookAt()};var originalTime=new Cesium.JulianDate;function tick(scene,nowTime){var seconds=Cesium.JulianDate.secondsDifference(nowTime,oldTime);oldTime.equals(originalTime)?nowTime.clone(oldTime):(nowTime.clone(oldTime),_pauseFlag||Cesium.JulianDate.addSeconds(_time,seconds*_speed,_time))}this.destroy=function(){for(var i in models)viewer.models.remove(models[i])}}Map3DSDK=Map3DSDK||{};!function(){var MapGltf=function(map,options){this._map=map,this._viewer=map.cesium.viewer,this._scale=options.scale?options.scale:3,this._url=options.url?options.url:"image/glmodel.gltf",this._center=options.center?options.center:[113.3981,22.6983,6]};MapGltf.prototype.AddGltf=function(ifFlyTo){var viewer=this._viewer,scene=viewer.scene,center=this._center,modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(Cesium.Cartesian3.fromDegrees(center[0],center[1],center[2]));scene.primitives.add(Cesium.Model.fromGltf({url:this._url,modelMatrix:modelMatrix,scale:this._scale}));1==ifFlyTo&&viewer.camera.flyTo({destination:Cesium.Cartesian3.fromDegrees(center[0],center[1],center[2])})},MapGltf.prototype.SetVisible=function(visible){},MapGltf.prototype.IsVisible=function(visible){this._map.GetView();return!!this._volpri&&this._volpri.show},MapGltf.prototype.Destroy=function(){},Map3DSDK.MapGltf=MapGltf}();Map3DSDK=Map3DSDK||{};!function(){var MapVolume=function(map,options){this._map=map,this._box=options.box,this._scale=options.scale?options.scale:[1,1,1],this._offset=options.offset?options.offset:[0,0,0],this._line=[0,0,80,1e3,0,0,0,0,0,0,0,0,0,0,0,0],this._vol={pri:null,apprance:null,mat:null},this._sect={pri:[],apprance:null,mat:null},this._filter={pri:null,apprance:null,mat:null},this._url=options.url?options.url:"BaseWhite";var stamp=Date.parse(new Date);this._name=options.name?options.name:"Volume_TimeStap_"+stamp,this._sectpri=[]};MapVolume.prototype.InitShader=function(){$.ajax({url:"./libs/zmap3dgl/glsl/glsl.htm",async:!1,dataType:"text",success:function(xml){var data=xml;$(document.body).append(data)},error:function(e){console.log(e.message)}}),$.ajax({url:"./libs/zmap3dgl/glsl/filter.htm",async:!1,dataType:"text",success:function(xml){var data=xml;$(document.body).append(data)},error:function(e){console.log(e.message)}}),$.ajax({url:"./libs/zmap3dgl/glsl/sect.htm",async:!1,dataType:"text",success:function(xml){var data=xml;$(document.body).append(data)},error:function(e){console.log(e.message)}})},MapVolume.prototype.Reset=function(){return this._scale=[1,1,1],this._offset=[0,0,0],this.Refresh()},MapVolume.prototype.Refresh=function(){this.Destroy(),this.ShowVolume()},MapVolume.prototype.SetVisible=function(visible){this._map.GetView();this._vol.pri&&(this._vol.pri.show=visible)},MapVolume.prototype.IsVisible=function(visible){this._map.GetView();return!!this._vol.pri&&this._vol.pri.show},MapVolume.prototype.ShowVolume=function(){this._CreateModel(1),this.SetVisible(!0)},MapVolume.prototype.Destroy=function(){var pris=this._map.GetView().scene.primitives;this._vol.pri&&(pris.remove(this._vol.pri),this._vol.pri=null)},MapVolume.prototype.EnableFilterAnlyze=function(enable){enable?this._CreateModel(2):this._CreateModel(1)},MapVolume.prototype.EnableSectAnlyze=function(enable){enable?this._CreateModel(3):this._CreateModel(1)},MapVolume.prototype.SetSectPlaneAnlyze=function(mode,nav,x){this._sectpri[mode]},MapVolume.prototype.SetBox=function(box){this._box=box},MapVolume.prototype.GetBox=function(){return this._box},MapVolume.prototype.SetScale=function(scale){this._scale=scale,this.Refresh()},MapVolume.prototype.GetScale=function(scale){return this._scale},MapVolume.prototype.Filter=function(fitArr){Array.isArray(fitArr)&&(this._filter.pri&&(this._filter.pri.appearance.material.uniforms.line=fitArr))},MapVolume.prototype.SetMinHei=function(value){null!=value&&(this._vol.pri&&(this._vol.pri.appearance.material.uniforms.minHeight=value))},MapVolume.prototype.SetMinLon=function(value){null!=value&&(this._vol.pri&&(this._vol.pri.appearance.material.uniforms.minLongitude=value))},MapVolume.prototype.SetMinLat=function(value){null!=value&&(this._vol.pri&&(this._vol.pri.appearance.material.uniforms.minLatitude=value))},MapVolume.prototype.SetMaxHei=function(value){null!=value&&(this._vol.pri&&(this._vol.pri.appearance.material.uniforms.maxHeight=value))},MapVolume.prototype.SetMaxLon=function(value){null!=value&&(this._vol.pri&&(this._vol.pri.appearance.material.uniforms.maxLongitude=value))},MapVolume.prototype.SetMaxLat=function(value){null!=value&&(this._vol.pri&&(this._vol.pri.appearance.material.uniforms.maxLatitude=value))},MapVolume.prototype.SetOffset=function(arr){this._offset=arr,this.Refresh()},MapVolume.prototype._calcScaleOffsetBox=function(){var newBox={},box=this._box,offset=this._offset,scale=this._scale,xoffset=offset[0],yoffset=offset[1],zoffset=offset[2],xscale=scale[0],yscale=scale[1],zscale=scale[2];return newBox.xmin=xoffset+box.xmin*xscale,newBox.xmax=xoffset+box.xmax*xscale,newBox.ymin=yoffset+box.ymin*yscale,newBox.ymax=yoffset+box.ymax*yscale,newBox.zmin=zoffset+box.zmin*zscale,newBox.zmax=zoffset+box.zmax*zscale,newBox},MapVolume.prototype._getModelMatrix=function(){return this._vol.pri.modelMatrix},MapVolume.prototype._setModelMatrix=function(mat){this._vol.pri.modelMatrix=mat},MapVolume.prototype.SetModelMatrix=function(value,priName){null==priName?this._vol.pri.modelMatrix=this.CalculateMatrix(value):this.getSecPri(priName).modelMatrix=this.CalculateMatrix(value)},MapVolume.prototype.CalculateMatrix=function(input){return Cesium.Matrix4.multiplyByTranslation(Cesium.Transforms.eastNorthUpToFixedFrame(Cesium.Cartesian3.fromDegrees(input[0],input[1],input[2])),new Cesium.Cartesian3(0,0,0),new Cesium.Matrix4)},MapVolume.prototype._calcModelMatrix=function(){this._offset;var scale=this._scale,box=(new Cesium.Matrix4,this._box),trs=(box.xmin,box.xmax,box.ymin,box.ymin,new Cesium.TranslationRotationScale),hpr=Cesium.HeadingPitchRoll.fromDegrees(0,0,0,new Cesium.HeadingPitchRoll);return trs.rotation=Cesium.Quaternion.fromHeadingPitchRoll(hpr,new Cesium.Quaternion),trs.scale=Cesium.Cartesian3.fromElements(scale[0],scale[1],scale[2],new Cesium.Cartesian3),Cesium.Matrix4.fromTranslationRotationScale(trs,new Cesium.Matrix4)},MapVolume.prototype._calcParam=function(){this._scale,this._offset;var box=this._calcScaleOffsetBox(),xcen=(box.xmin+box.xmax)/2,ycen=(box.ymin+box.ymax)/2,zcen=(box.zmin+box.zmax)/2,deltaH=box.zmax-box.zmin,deltaMinH=box.zmin,deltaMaxH=box.zmax,a=Cesium.Cartesian3.fromDegrees(box.xmin,box.ymax,deltaMinH),c=Cesium.Cartesian3.fromDegrees(box.xmin,box.ymin,deltaMinH),d=Cesium.Cartesian3.fromDegrees(box.xmax,box.ymax,deltaMinH),deltaX=Math.sqrt((d.x-a.x)*(d.x-a.x)+(d.y-a.y)*(d.y-a.y)+(d.z-a.z)*(d.z-a.z)),deltaY=Math.sqrt((c.x-a.x)*(c.x-a.x)+(c.y-a.y)*(c.y-a.y)+(c.z-a.z)*(c.z-a.z)),cenMatrix=Cesium.Matrix4.multiplyByTranslation(Cesium.Transforms.eastNorthUpToFixedFrame(Cesium.Cartesian3.fromDegrees(box.xmin,box.ymin,deltaMinH)),new Cesium.Cartesian3(0,0,0),new Cesium.Matrix4),invCenMatrixs=new Cesium.Matrix4;return{xcen:xcen,ycen:ycen,zcen:zcen,deltaH:deltaH,deltaMinH:deltaMinH,deltaMaxH:deltaMaxH,a:a,c:c,d:d,deltaX:deltaX,deltaY:deltaY,cenMatrix:cenMatrix,invCenMatrix:invCenMatrixs=Cesium.Matrix4.inverse(cenMatrix,invCenMatrixs)}},MapVolume.prototype._CreateModel=function(mode){"use strict";var viewer=this._map.GetView(),param=this._calcParam(),xcen=param.xcen,ycen=param.ycen,zcen=param.zcen,deltaMinH=(param.deltaH,param.deltaMinH),deltaMaxH=param.deltaMaxH,deltaX=param.deltaX,deltaY=param.deltaY,matrix=param.cenMatrix,invMatrixs=param.invCenMatrix;if(1==mode){var material=null;this._vol.mat?((material=this._vol.mat).uniforms.invMat=Cesium.Matrix4.toArray(invMatrixs),material.uniforms.boxLon=deltaX,material.uniforms.boxLat=deltaY,material.uniforms.boxHeight=deltaMaxH,material.uniforms.minHeight=0,material.uniforms.minLongitude=0,material.uniforms.minLatitude=0,material.uniforms.maxHeight=deltaMaxH,material.uniforms.maxLongitude=deltaX,material.uniforms.maxLatitude=deltaY):material=this._vol.mat=new Cesium.Material({fabric:{type:"PramLQ",uniforms:{cubeTex:this._url,transferTex:"./color.jpg",invMat:Cesium.Matrix4.toArray(invMatrixs),boxLon:deltaX,boxLat:deltaY,boxHeight:deltaMaxH,minHeight:0,minLongitude:0,minLatitude:0,maxHeight:deltaMaxH,maxLongitude:deltaX,maxLatitude:deltaY,line:this._line}}});var box=new Cesium.BoxGeometry({maximum:new Cesium.Cartesian3(deltaX,deltaY,deltaMaxH),minimum:new Cesium.Cartesian3(0,0,deltaMinH)}),boxGeometry=null;boxGeometry=this._vol.geom?this._vol.geom:this._vol.geom=Cesium.BoxGeometry.createGeometry(box);var appearance=null;if(appearance=this._vol.apperance?this._vol.apperance:this._vol.apperance=new Cesium.MaterialAppearance({material:material,vertexShaderSource:document.getElementById("filterVertexShaderPass").textContent,fragmentShaderSource:document.getElementById("filterFragmentShaderPass").textContent,faceForward:!0,closed:!0}),!this._vol.pri){var pri=this._vol.pri=new Cesium.Primitive({geometryInstances:new Cesium.GeometryInstance({geometry:boxGeometry,debugShowBoundingVolume:!0,modelMatrix:matrix,id:this._name}),asynchronous:!1,appearance:appearance});viewer.scene.primitives.add(pri)}}else if(2==mode){this._vol.pri&&(this._vol.pri.show=!1);material=this._vol.mat,boxGeometry=this._vol.geom;if(appearance=this._filter.apperance?this._filter.apperance:this._filter.apperance=new Cesium.MaterialAppearance({material:material,vertexShaderSource:document.getElementById("filterVertexShaderPass").textContent,fragmentShaderSource:document.getElementById("filterFragmentShaderPass").textContent,faceForward:!0,closed:!0}),!this._filter.pri){pri=this._filter.pri=new Cesium.Primitive({geometryInstances:new Cesium.GeometryInstance({geometry:boxGeometry,debugShowBoundingVolume:!0,modelMatrix:matrix,id:this._name}),asynchronous:!1,appearance:appearance});viewer.scene.primitives.add(pri)}}else{var xstart=this._box.xmin,ystart=this._box.ymin,zstart=this._box.zmin;this._sectpri=[];material=new Cesium.Material({fabric:{type:"PramLQ",uniforms:{cubeTex:"./radar.png",transferTex:"./color.jpg",invMat:Cesium.Matrix4.toArray(invMatrixs),boxLong:deltaX,boxWidth:deltaY,boxHeight:deltaMaxH}}});var nameArray=["lonSection","latSection","heiSection"],sliceArray=[],normalsArray=[],texCoorsArray=[],indexsArray=[],modelMatrixArray=[],xSlice=new Float64Array([1e-6,0,0,0,deltaY,0,0,0,deltaMaxH,0,deltaY,deltaMaxH]),xNormals=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1]),xTexCoords=new Float32Array([0,1,0,.5,.5,0,1,1]),modelMatrix=Cesium.Matrix4.multiplyByTranslation(Cesium.Transforms.eastNorthUpToFixedFrame(Cesium.Cartesian3.fromDegrees(xcen,ystart,zstart)),new Cesium.Cartesian3(0,0,0),new Cesium.Matrix4),xIndexs=new Uint32Array([0,1,3,3,2,0]);sliceArray.push(xSlice),normalsArray.push(xNormals),texCoorsArray.push(xTexCoords),indexsArray.push(xIndexs),modelMatrixArray.push(modelMatrix);var ySlice=new Float64Array([0,1e-8,0,deltaX,0,0,0,0,deltaMaxH,deltaX,0,deltaMaxH]),yNormals=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1]),yTexCoords=new Float32Array([0,1,0,.5,.5,0,1,1]),yIndexs=(modelMatrix=Cesium.Matrix4.multiplyByTranslation(Cesium.Transforms.eastNorthUpToFixedFrame(Cesium.Cartesian3.fromDegrees(xstart,ycen,zstart)),new Cesium.Cartesian3(0,0,0),new Cesium.Matrix4),new Uint32Array([0,1,3,3,2,0]));sliceArray.push(ySlice),normalsArray.push(yNormals),texCoorsArray.push(yTexCoords),indexsArray.push(yIndexs),modelMatrixArray.push(modelMatrix);var zSlice=new Float64Array([0,0,1e-6,deltaX,0,0,0,deltaY,0,deltaX,deltaY,0]),zNormals=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1]),zTexCoords=new Float32Array([0,1,0,.5,.5,0,1,1]),zIndexs=new Uint32Array([0,1,3,3,2,0]);modelMatrix=Cesium.Matrix4.multiplyByTranslation(Cesium.Transforms.eastNorthUpToFixedFrame(Cesium.Cartesian3.fromDegrees(xstart,ystart,zcen)),new Cesium.Cartesian3(0,0,0),new Cesium.Matrix4);sliceArray.push(zSlice),normalsArray.push(zNormals),texCoorsArray.push(zTexCoords),indexsArray.push(zIndexs),modelMatrixArray.push(modelMatrix);for(var i=0;i<nameArray.length;i++){var attributes=new Cesium.GeometryAttributes;attributes.position=new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:sliceArray[i]}),attributes.normal=new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:normalsArray[i]}),attributes.st=new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:texCoorsArray[i]});var geo=new Cesium.Geometry({attributes:attributes,indices:indexsArray[i],primitiveType:Cesium.PrimitiveType.TRIANGLES,boundingSphere:Cesium.BoundingSphere.fromVertices(sliceArray[i])});pri=new Cesium.Primitive({geometryInstances:new Cesium.GeometryInstance({geometry:geo,id:nameArray[i]}),modelMatrix:modelMatrixArray[i],asynchronous:!1,appearance:new Cesium.MaterialAppearance({material:material,vertexShaderSource:document.getElementById("sliceVertexShaderPass").textContent,fragmentShaderSource:document.getElementById("sliceFragmentShaderPass").textContent,faceForward:!0})});this._sectpri.push(pri),viewer.scene.primitives.add(pri)}}},MapVolume.prototype.getSecPri=function(name){for(var secpriArr=this._sectpri,secpri=null,i=0;i<secpriArr.length;i++)if(secpriArr[i]._instanceIds[0]==name){secpri=secpriArr[i];break}return secpri},Map3DSDK.MapVolume=MapVolume}();var FilterEdit=function(param){this._line=param?(this._name_X=param.name_X?param.name_X:"属性值",this._split_X=param.split_X?param.split_X:4,this._max_X=param.max_X?param.max_X:1e3,this._min_X=param.min_X?param.min_X:0,this._name_Y=param.name_Y?param.name_Y:"透明度",this._split_Y=param.split_Y?param.split_Y:5,this._max_Y=param.max_Y?param.max_Y:1e3,this._min_Y=param.min_Y?param.min_Y:0,this.tolerance=param.tolerance?param.tolerance:3,param.line?param.line:[[this._min_X,this._min_Y],[this._max_X,this._max_Y]]):(this._name_X="属性值",this._split_X=4,this._max_X=1e3,this._min_X=0,this._name_Y="透明度",this._split_Y=5,this._max_Y=1e3,this._min_Y=0,this.tolerance=3,[[0,0],[this._max_X,this._max_Y]])};function relation(point,line,tole){for(var obj={},i=0;i<line.length;i++)if(pp_distance(point,line[i])<=tole+2)return obj.relation=1,obj.position=i,obj;for(i=0;i<line.length-1;i++)if(PointLine_Disp(point[0],point[1],line[i][0],line[i][1],line[i+1][0],line[i+1][1])<=tole)return obj.relation=2,obj.point=point,obj.position=i+1,obj;return obj.relation=0,obj}function pp_distance(point1,point2){var xdiff=point1[0]-point2[0],ydiff=point1[1]-point2[1];return Math.pow(xdiff*xdiff+ydiff*ydiff,.5)}function PointLine_Disp(xx,yy,x1,y1,x2,y2){var a,b,c,ang1,ang2,ang,m;return 0==(a=Math.sqrt((x1-xx)*(x1-xx)+(y1-yy)*(y1-yy)))?-1:0==(b=Math.sqrt((x2-xx)*(x2-xx)+(y2-yy)*(y2-yy)))?-1:0==(c=Math.sqrt((x1-x2)*(x1-x2)+(y1-y2)*(y1-y2)))?a:a<b?(y1==y2?ang1=x1<x2?0:Math.PI:(1e-5<(m=(x2-x1)/c)-1&&(m=1),ang1=Math.acos(m),y2<y1&&(ang1=2*Math.PI-ang1)),1e-5<(m=(xx-x1)/a)-1&&(m=1),ang2=Math.acos(m),yy<y1&&(ang2=2*Math.PI-ang2),(ang=ang2-ang1)<0&&(ang=-ang),ang>Math.PI&&(ang=2*Math.PI-ang),ang>Math.PI/2?a:a*Math.sin(ang)):(y1==y2?ang1=x1<x2?Math.PI:0:(1e-5<(m=(x1-x2)/c)-1&&(m=1),ang1=Math.acos(m),y1<y2&&(ang1=2*Math.PI-ang1)),1e-5<(m=(xx-x2)/b)-1&&(m=1),ang2=Math.acos(m),yy<y2&&(ang2=2*Math.PI-ang2),(ang=ang2-ang1)<0&&(ang=-ang),ang>Math.PI&&(ang=2*Math.PI-ang),ang>Math.PI/2?b:b*Math.sin(ang))}FilterEdit.prototype={constructor:FilterEdit,_init:function(div){this.x_axis=30,this.y_axis=40,this._width=div.offsetWidth,this._height=div.offsetHeight,this.painter=document.createElement("canvas"),this.painter.width=this._width,this.painter.height=this._height;var point_line,lbtn_down=0,thisobj=this;this.parse_line();var highlight_status=-1;this.painter.addEventListener("mousedown",function(e){1==point_line.relation?lbtn_down=1:2==point_line.relation&&(thisobj.trans_line.splice(point_line.position,0,point_line.point),lbtn_down=1,highlight_status=point_line.position,thisobj._draw(highlight_status),thisobj.reverse_parse_line())}),this.painter.addEventListener("mousemove",function(e){if(1==lbtn_down){var yposition;if(yposition=e.offsetY<=50?50:e.offsetY>thisobj._height-thisobj.x_axis?thisobj._height-thisobj.x_axis:e.offsetY,0==point_line.position)thisobj.trans_line[point_line.position]=[thisobj.y_axis,yposition];else if(point_line.position==thisobj.trans_line.length-1)thisobj.trans_line[point_line.position]=[thisobj._width-50,yposition];else{thisobj.trans_line[point_line.position]=[e.offsetX,yposition];for(var i=1;i<thisobj.trans_line.length-1-point_line.position;i++)thisobj.trans_line[point_line.position+i][0]<=e.offsetX&&(thisobj.trans_line[point_line.position+i][0]=e.offsetX);for(i=0;i<point_line.position;i++)thisobj.trans_line[i][0]>=e.offsetX&&(thisobj.trans_line[i][0]=e.offsetX);e.offsetX>=thisobj._width-50&&(thisobj.trans_line.splice(point_line.position+1,thisobj.trans_line.length-1-point_line.position),thisobj.trans_line[point_line.position]=[thisobj._width-50,yposition]),e.offsetX<=thisobj.y_axis&&(thisobj.trans_line.splice(0,point_line.position),point_line.position=0,thisobj.trans_line[0]=[thisobj.y_axis,yposition])}highlight_status=point_line.position,thisobj._draw(point_line.position),thisobj.reverse_parse_line(),thisobj.onchangestatus(point_line.position,thisobj._line)}else{var point=[e.offsetX,e.offsetY];1==(point_line=relation(point,thisobj.trans_line,thisobj.tolerance)).relation?(thisobj.highlight(point_line.position),highlight_status=point_line.position):0<=highlight_status&&(thisobj._draw(),highlight_status=-1)}}),this.painter.addEventListener("mouseup",function(e){1==lbtn_down&&(lbtn_down=0,thisobj.onchangestatus_over(point_line.position,thisobj._line))}),this.painter.addEventListener("mouseout",function(e){1==lbtn_down&&(lbtn_down=0,thisobj.onchangestatus_over(point_line.position,thisobj._line))}),div.appendChild(this.painter)},_draw:function(i){this.clearCanvas(),this._draw_arrow(),this._draw_line(i)},_draw_arrow:function(){var context=this.painter.getContext("2d");context.beginPath(),context.lineWidth="1",context.strokeStyle="#272727",context.font="12px Courier New",context.fillStyle="black",context.moveTo(this.y_axis,this._height-this.x_axis),context.lineTo(this.y_axis,30),context.lineTo(this.y_axis-4,34),context.moveTo(this.y_axis,30),context.lineTo(this.y_axis+4,34),context.moveTo(this.y_axis,this._height-this.x_axis),context.lineTo(this._width-30,this._height-this.x_axis),context.lineTo(this._width-34,this._height-this.x_axis-4),context.moveTo(this._width-30,this._height-this.x_axis),context.lineTo(this._width-34,this._height-this.x_axis+4);for(var cell_x=(this._width-50-this.y_axis)/this._split_X,cell_x_value=((this._max_X-this._min_X)/this._split_X).toFixed(0),i=1;i<=this._split_X;i++)context.moveTo(cell_x*i+this.y_axis,this._height-this.x_axis),context.lineTo(cell_x*i+this.y_axis,this._height-this.x_axis+5),context.fillText(this._min_X+cell_x_value*i,cell_x*i+this.y_axis-12,this._height-this.x_axis+15);context.moveTo(this._width-50,this._height-30),context.lineTo(this._width-50,50),context.fillText(this._name_X,this._width-40,this._height-this.x_axis-11),context.fillText(this._name_Y,this.y_axis-15,20),context.stroke(),context.beginPath(),context.strokeStyle="#4DFFFF",context.lineWidth="1";var cell_y=(this._height-this.x_axis-50)/this._split_Y,cell_y_value=((this._max_Y-this._min_Y)/this._split_Y).toFixed(0);for(i=0;i<this._split_Y;i++)context.moveTo(this.y_axis,cell_y*i+50),context.lineTo(this._width-50,cell_y*i+50),context.fillText(this._max_Y-cell_y_value*i,this.y_axis-30,cell_y*i+55);context.stroke()},_draw_line:function(position){var context=this.painter.getContext("2d");context.beginPath(),context.lineWidth="1",context.strokeStyle="#272727",context.moveTo(this.trans_line[0][0],this.trans_line[0][1]);for(var i=1;i<this.trans_line.length;i++)context.lineTo(this.trans_line[i][0],this.trans_line[i][1]);context.stroke();for(i=0;i<this.trans_line.length;i++)context.beginPath(),context.arc(this.trans_line[i][0],this.trans_line[i][1],4,0,2*Math.PI),context.fill();position&&this.highlight(position)},highlight:function(i){var context=this.painter.getContext("2d");context.beginPath(),context.lineWidth="1",context.strokeStyle="#271616",context.arc(this.trans_line[i][0],this.trans_line[i][1],6,0,2*Math.PI),context.fill()},clearCanvas:function(){var context=this.painter.getContext("2d");context.beginPath(),context.fillStyle="#fff",context.fillRect(0,0,this._width,this._height),context.closePath()},parse_line:function(){this.trans_line=[];for(var i=0;i<this._line.length;i++){var re=[];re[0]=(this._line[i][0]-this._min_X)/(this._max_X-this._min_X)*(this._width-this.y_axis-50)+this.y_axis,re[1]=this._height-this.x_axis-(this._line[i][1]-this._min_Y)/(this._max_Y-this._min_Y)*(this._height-this.x_axis-50),this.trans_line.push(re)}},reverse_parse_line:function(){this._line=[];for(var i=0;i<this.trans_line.length;i++){var re=[];re[0]=((this.trans_line[i][0]-this.y_axis)/(this._width-this.y_axis-50)*(this._max_X-this._min_X)+this._min_X).toFixed(1),re[1]=((this._height-this.x_axis-this.trans_line[i][1])/(this._height-this.x_axis-50)*(this._max_Y-this._min_Y)+this._min_Y).toFixed(1),this._line.push(re)}},onchangestatus:function(){},onchangestatus_over:function(){}};var Color=Cesium.Color,defined=Cesium.defined,defineProperties=Cesium.defineProperties,Event=Cesium.Event,createPropertyDescriptor=Cesium.createPropertyDescriptor,Property=Cesium.Property,Material=Cesium.Material;function PolylineDynMaterialProperty(options){options=options||{},this._definitionChanged=new Event,this.color=options.color,this.color2=options.color2||Color.RED,this.lineLength=1,this.lineSpeed=1,this.startPos=0,this.endPos=1,this.moveTime=Delay+2,this.stopTime=1}PolylineDynMaterialProperty.MaterialType="PolylineDyn",PolylineDynMaterialProperty.MaterialShader="uniform vec4 color;uniform vec4 color2;uniform float startPos;uniform float endPos;uniform float moveTime;uniform float stopTime;uniform float tranDelay;uniform float lineLength;uniform float lineSpeed;czm_material czm_getMaterial(czm_materialInput materialInput){    czm_material material = czm_getDefaultMaterial(materialInput);    vec2 st = materialInput.st;    vec4 c;    float cl = 0.01;    float s = st.s * lineLength;    float t = st.t * lineLength;    if(endPos<=cl){        if (s < startPos) c = color;        else if (s < endPos) {            float h = 0.04*t*t-0.04*t+cl;            float h_s = endPos-s;            if(h_s<h){                c = color;            }else{                c = color2;            }        }        else c = color;    }else{        if (s < startPos) c = color;        else if (s < endPos) {            float st_l = endPos-cl;            float st_l2 = endPos-0.2;            if(s>=st_l){                float h = 0.04*t*t-0.04*t+cl;                float h_s = endPos-s;                if(h_s<h){                    c = color;                }else{                    c = color2;                }            }else{                if(s>=st_l2){                    if(t<0.2||t>0.8){                        c = color;                    }else{                        float t_t = (s - startPos) / lineSpeed;                        float d = (tranDelay - moveTime + t_t) / tranDelay;                        if (d < 0.0) d = 0.0;                        c = mix(color, color2, d);                    }                }else{                    c = color;                }            }        }        else c = color;    }    material.emission = c.rgb;    material.alpha = c.a;    return material;}",defineProperties(PolylineDynMaterialProperty.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}}}),PolylineDynMaterialProperty.prototype.getType=function(time){return PolylineDynMaterialProperty.MaterialType},PolylineDynMaterialProperty.prototype.getValue=function(time,result){return defined(result)||(result={}),result.color=this.color,result.color2=this.color2,result.startPos=this.startPos,result.endPos=this.endPos,result.moveTime=this.moveTime,result.stopTime=this.stopTime,result.tranDelay=Delay,result.lineLength=this.lineLength,result.lineSpeed=this.lineSpeed,result};var Delay=1;PolylineDynMaterialProperty.prototype.update=function(passed){this.moveTime+=passed,this.stopTime?this.moveTime-this.stopTime>Delay&&(this.startPos=0,this.endPos=this.startPos,this.moveTime=0,this.stopTime=0):this.endPos>this.lineLength?this.stopTime=this.moveTime:this.endPos+=passed*this.lineSpeed},PolylineDynMaterialProperty.prototype.equals=function(other){return this===other},Material._materialCache.addMaterial(PolylineDynMaterialProperty.MaterialType,{fabric:{type:PolylineDynMaterialProperty.MaterialType,uniforms:{color:new Color(1,1,1,1),color2:Color.RED,startPos:0,endPos:0,stopTime:0,moveTime:0,tranDelay:Delay,lineSpeed:1,lineLength:1},source:PolylineDynMaterialProperty.MaterialShader},translucent:!0}),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.axios=t():e.axios=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){"use strict";function r(e){var t=new s(e),n=i(s.prototype.request,t);return o.extend(n,s.prototype,t),o.extend(n,t),n}var o=n(2),i=n(3),s=n(5),u=n(6),a=r(u);a.Axios=s,a.create=function(e){return r(o.merge(u,e))},a.Cancel=n(23),a.CancelToken=n(24),a.isCancel=n(20),a.all=function(e){return Promise.all(e)},a.spread=n(25),e.exports=a,e.exports.default=a},function(e,t,n){"use strict";function r(e){return"[object Array]"===R.call(e)}function f(e){return null!==e&&"object"==typeof e}function h(e){return"[object Function]"===R.call(e)}function v(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),r(e))for(var n=0,o=e.length;n<o;n++)t.call(null,e[n],n,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}var E=n(3),C=n(4),R=Object.prototype.toString;e.exports={isArray:r,isArrayBuffer:function(e){return"[object ArrayBuffer]"===R.call(e)},isBuffer:C,isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:f,isUndefined:function(e){return void 0===e},isDate:function(e){return"[object Date]"===R.call(e)},isFile:function(e){return"[object File]"===R.call(e)},isBlob:function(e){return"[object Blob]"===R.call(e)},isFunction:h,isStream:function(e){return f(e)&&h(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:v,merge:function x(){function e(e,n){"object"==typeof t[n]&&"object"==typeof e?t[n]=x(t[n],e):t[n]=e}for(var t={},n=0,r=arguments.length;n<r;n++)v(arguments[n],e);return t},extend:function(e,t,n){return v(t,function(t,r){e[r]=n&&"function"==typeof t?E(t,n):t}),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(e,t){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},function(e,t){function n(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}e.exports=function(e){return null!=e&&(n(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&n(e.slice(0,0))}(e)||!!e._isBuffer)}},function(e,t,n){"use strict";function r(e){this.defaults=e,this.interceptors={request:new s,response:new s}}var o=n(6),i=n(2),s=n(17),u=n(18);r.prototype.request=function(e){"string"==typeof e&&(e=i.merge({url:arguments[0]},arguments[1])),(e=i.merge(o,{method:"get"},this.defaults,e)).method=e.method.toLowerCase();var t=[u,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)n=n.then(t.shift(),t.shift());return n},i.forEach(["delete","get","head","options"],function(e){r.prototype[e]=function(t,n){return this.request(i.merge(n||{},{method:e,url:t}))}}),i.forEach(["post","put","patch"],function(e){r.prototype[e]=function(t,n,r){return this.request(i.merge(r||{},{method:e,url:t,data:n}))}}),e.exports=r},function(e,t,n){"use strict";function r(e,t){!i.isUndefined(e)&&i.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var i=n(2),s=n(7),u={"Content-Type":"application/x-www-form-urlencoded"},a={adapter:function(){var e;return"undefined"!=typeof XMLHttpRequest?e=n(8):"undefined"!=typeof process&&(e=n(8)),e}(),transformRequest:[function(e,t){return s(t,"Content-Type"),i.isFormData(e)||i.isArrayBuffer(e)||i.isBuffer(e)||i.isStream(e)||i.isFile(e)||i.isBlob(e)?e:i.isArrayBufferView(e)?e.buffer:i.isURLSearchParams(e)?(r(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):i.isObject(e)?(r(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return 200<=e&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};i.forEach(["delete","get","head"],function(e){a.headers[e]={}}),i.forEach(["post","put","patch"],function(e){a.headers[e]=i.merge(u)}),e.exports=a},function(e,t,n){"use strict";var r=n(2);e.exports=function(e,t){r.forEach(e,function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])})}},function(e,t,n){"use strict";var r=n(2),o=n(9),i=n(12),s=n(13),u=n(14),a=n(10),c="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||n(15);e.exports=function(e){return new Promise(function(t,f){var p=e.data,d=e.headers;r.isFormData(p)&&delete d["Content-Type"];var l=new XMLHttpRequest,h="onreadystatechange",m=!1;if("undefined"==typeof window||!window.XDomainRequest||"withCredentials"in l||u(e.url)||(l=new window.XDomainRequest,h="onload",m=!0,l.onprogress=function(){},l.ontimeout=function(){}),e.auth){var y=e.auth.username||"",w=e.auth.password||"";d.Authorization="Basic "+c(y+":"+w)}if(l.open(e.method.toUpperCase(),i(e.url,e.params,e.paramsSerializer),!0),l.timeout=e.timeout,l[h]=function(){if(l&&(4===l.readyState||m)&&(0!==l.status||l.responseURL&&0===l.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in l?s(l.getAllResponseHeaders()):null,i={data:e.responseType&&"text"!==e.responseType?l.response:l.responseText,status:1223===l.status?204:l.status,statusText:1223===l.status?"No Content":l.statusText,headers:n,config:e,request:l};o(t,f,i),l=null}},l.onerror=function(){f(a("Network Error",e,null,l)),l=null},l.ontimeout=function(){f(a("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",l)),l=null},r.isStandardBrowserEnv()){var g=n(16),v=(e.withCredentials||u(e.url))&&e.xsrfCookieName?g.read(e.xsrfCookieName):void 0;v&&(d[e.xsrfHeaderName]=v)}if("setRequestHeader"in l&&r.forEach(d,function(e,t){void 0===p&&"content-type"===t.toLowerCase()?delete d[t]:l.setRequestHeader(t,e)}),e.withCredentials&&(l.withCredentials=!0),e.responseType)try{l.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&l.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&l.upload&&l.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(e){l&&(l.abort(),f(e),l=null)}),void 0===p&&(p=null),l.send(p)})}},function(e,t,n){"use strict";var r=n(10);e.exports=function(e,t,n){var o=n.config.validateStatus;n.status&&o&&!o(n.status)?t(r("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},function(e,t,n){"use strict";var r=n(11);e.exports=function(e,t,n,o,i){var s=new Error(e);return r(s,t,n,o,i)}},function(e,t){"use strict";e.exports=function(e,t,n,r,o){return e.config=t,n&&(e.code=n),e.request=r,e.response=o,e}},function(e,t,n){"use strict";function r(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var o=n(2);e.exports=function(e,t,n){if(!t)return e;var i;if(n)i=n(t);else if(o.isURLSearchParams(t))i=t.toString();else{var s=[];o.forEach(t,function(e,t){null!=e&&(o.isArray(e)?t+="[]":e=[e],o.forEach(e,function(e){o.isDate(e)?e=e.toISOString():o.isObject(e)&&(e=JSON.stringify(e)),s.push(r(t)+"="+r(e))}))}),i=s.join("&")}return i&&(e+=(-1===e.indexOf("?")?"?":"&")+i),e}},function(e,t,n){"use strict";var r=n(2),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,i,s={};return e&&r.forEach(e.split("\n"),function(e){if(i=e.indexOf(":"),t=r.trim(e.substr(0,i)).toLowerCase(),n=r.trim(e.substr(i+1)),t){if(s[t]&&0<=o.indexOf(t))return;s[t]="set-cookie"===t?(s[t]?s[t]:[]).concat([n]):s[t]?s[t]+", "+n:n}}),s}},function(e,t,n){"use strict";var r=n(2);e.exports=r.isStandardBrowserEnv()?function(){function e(e){var t=e;return n&&(o.setAttribute("href",t),t=o.href),o.setAttribute("href",t),{href:o.href,protocol:o.protocol?o.protocol.replace(/:$/,""):"",host:o.host,search:o.search?o.search.replace(/^\?/,""):"",hash:o.hash?o.hash.replace(/^#/,""):"",hostname:o.hostname,port:o.port,pathname:"/"===o.pathname.charAt(0)?o.pathname:"/"+o.pathname}}var t,n=/(msie|trident)/i.test(navigator.userAgent),o=document.createElement("a");return t=e(window.location.href),function(n){var o=r.isString(n)?e(n):n;return o.protocol===t.protocol&&o.host===t.host}}():function(){return!0}},function(e,t){"use strict";function n(){this.message="String contains an invalid character"}(n.prototype=new Error).code=5,n.prototype.name="InvalidCharacterError",e.exports=function(e){for(var t,r,i=String(e),s="",u=0,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.charAt(0|u)||(a="=",u%1);s+=a.charAt(63&t>>8-u%1*8)){if(255<(r=i.charCodeAt(u+=.75)))throw new n;t=t<<8|r}return s}},function(e,t,n){"use strict";var r=n(2);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,n,o,i,s){var u=[];u.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&u.push("expires="+new Date(n).toGMTString()),r.isString(o)&&u.push("path="+o),r.isString(i)&&u.push("domain="+i),!0===s&&u.push("secure"),document.cookie=u.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,n){"use strict";function r(){this.handlers=[]}var o=n(2);r.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},r.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},r.prototype.forEach=function(e){o.forEach(this.handlers,function(t){null!==t&&e(t)})},e.exports=r},function(e,t,n){"use strict";function r(e){e.cancelToken&&e.cancelToken.throwIfRequested()}var o=n(2),i=n(19),s=n(20),u=n(6),a=n(21),c=n(22);e.exports=function(e){return r(e),e.baseURL&&!a(e.url)&&(e.url=c(e.baseURL,e.url)),e.headers=e.headers||{},e.data=i(e.data,e.headers,e.transformRequest),e.headers=o.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),o.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]}),(e.adapter||u.adapter)(e).then(function(t){return r(e),t.data=i(t.data,t.headers,e.transformResponse),t},function(t){return s(t)||(r(e),t&&t.response&&(t.response.data=i(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})}},function(e,t,n){"use strict";var r=n(2);e.exports=function(e,t,n){return r.forEach(n,function(n){e=n(e,t)}),e}},function(e,t){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t){"use strict";function n(e){this.message=e}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,e.exports=n},function(e,t,n){"use strict";function r(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e});var n=this;e(function(e){n.reason||(n.reason=new o(e),t(n.reason))})}var o=n(23);r.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},r.source=function(){var e;return{token:new r(function(t){e=t}),cancel:e}},e.exports=r},function(e,t){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}}])});
//# sourceMappingURL=zmap3d.min.js.map
